define("odsp-next/actions/SortActionMode",["require","exports"],function(){var e;return function(e){e[e.Column=0]="Column",e[e.Order=1]="Order"}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/SortAction",["require","exports","../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ControlResourceKeys","../resources/PagesResourceKeys","./SortActionMode"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){e.call(this,t),this.name="Sort",this._sortManager=this.resources.consume(s.sortManager),this._currentItemSet=this.resources.consume(r.currentItemSet),this._mode=t.mode,this._column=t.column,this._ascending=t.ascending}return __extends(t,e),t.getSortedColumn=function(e){for(var t,i=e(),n=0;n<i.length;n++)if(Boolean(i[n])&&i[n].isSorted){t=i[n];break}return t},t.prototype.onExecute=function(){var e=t.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=e);var i={sortMode:a[this._mode],sortAscending:"Ascending"};return this._column&&(i.sortColumn=this._column.internalName||this._column.key),this._mode===a.Column?this.updateCurrentSort(this._column,e.isAscending):this._mode===a.Order?this._currentItemSet&&this._currentItemSet().schema&&(i.sortAscending=this._ascending?"Ascending":"Descending",this.updateCurrentSort(e,this._ascending)):n.default.wrap({resultType:o.ResultTypeEnum.Failure}),n.default.wrap({resultType:o.ResultTypeEnum.Success,extraData:i})},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){var e=!1;if(this._mode===a.Column&&this._column)e=this._column.isSorted;else if(this._mode===a.Order&&this._currentItemSet&&this._currentItemSet().schema){var i=t.getSortedColumn(this._currentItemSet().schema);e=i&&i.isAscending===this._ascending}return e},t.prototype.updateCurrentSort=function(e,t){if(e){var i=e.internalName||e.key;this._sortManager.updateSort(i,t)}},t}(i);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/commands/SortMenuBuilder",["require","exports","odsp-shared/base/BaseModel","./CommandViewModel","knockout","../../actions/SortAction","../../actions/SortActionMode"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){var i=this;e.call(this,t),this.sortItems=o.observableArray();var a=t.itemsToAppend,l=t.currentItemSet;this.createComputed(function(){var e=l().schema().filter(function(e){return e.sortable&&Boolean(e.name)}),t=[];e.length>0&&(t=e.map(function(e,t,o){return new n({text:e.name,isToggleable:!0,action:new(i.managed(r))({mode:s.Column,column:e}),hasLineBreakAfter:a&&t===o.length-1})}).concat(a||[])),i.sortItems(t)})}return __extends(t,e),t}(i);return a}),define("odsp-next/utilities/newFeatureExperience/NewFeatureAnchorName",["require","exports"],function(){var e;return function(e){e[e.TopBarNew=1]="TopBarNew",e[e.TopBarLeftInfoPane=2]="TopBarLeftInfoPane",e[e.TopBarRightInfoPane=3]="TopBarRightInfoPane"}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/spo/commandSets/CommandSetHelper",["require","exports","odsp-shared/base/BaseModel","../../../../controls/commands/CommandViewModel","../../../../resources/ControlResourceKeys","../../../../utilities/icons/Icon","../../../../resources/SPOResourceKeys"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){e.call(this,t),this._actionMap=this.resources.consume(o.actionMap),this._listContext=this.resources.consume(s.listContext)}return __extends(t,e),t.prototype.isCustomContentTypesDisabled=function(e){return!e||0===e.length||1===e.length&&(!e[0].templateUrl||-1!==e[0].templateUrl.indexOf("/Forms/template.do"))},t.prototype.isGenericList=function(){return this._listContext&&this._listContext.listTemplateType&&"100"===this._listContext.listTemplateType?!0:!1},t.prototype.generateAndAppendContentTypeContextMenu=function(e,t,i){for(var o=0;o<t.length;o++){var s=t[o],a=new n({text:s.displayName,icon:r.document,action:new(this.managed(this._actionMap.ContentTypeNavigationAction))({url:s.templateUrl}),engagementName:s.description+i});e.push(a)}return e},t}(i);return a}),define("odsp-next/utilities/icons/OfficeFileNameHelper",["require","exports","../../controls/commands/Commands.resx","./Icon","knockout"],function(e,t,i,n,o){var r=i.strings,s="ms-word",a="onenote|UsePlain",l="ms-powerpoint",c="ms-excel",d="ms-visio",u="ms-publisher",p="ms-access",h="ms-project",m=function(){function e(){}return e.getOfficeOnlineStringMap=function(e){var t="";switch(e){case s:t=r.OpenInWordOnline;break;case a:t=r.OpenInOneNoteOnline;break;case l:t=r.OpenInPowerPointOnline;break;case c:t=r.OpenInExcelOnline}return t},e.getOfficeStringMap=function(e){var t;switch(e){case s:t=r.OpenInWord;break;case a:t=r.OpenInOneNote;break;case l:t=r.OpenInPowerPoint;break;case c:t=r.OpenInExcel;break;case d:t=r.OpenInVisio;break;case u:t=r.OpenInPublisher;break;case h:t=r.OpenInProject}return t},e.getOfficeIconMap=function(e){var t;switch(e){case s:t=n.word;break;case a:t=n.onenote;break;case l:t=n.powerpoint;break;case c:t=n.excel;break;case d:t=n.document;break;case u:t=n.document}return t},e.getApp=function(t){var i=t.appMap,n="Word";switch(t.extension&&".pdf"===t.extension.toLowerCase()&&(i="pdf"),i){case e.wordType:n="Word";break;case"pdf":n="WordPdf";break;case e.excelType:n="Excel";break;case e.powerpointType:n="PowerPoint";break;case e.onenoteType:n="OneNote"}return n},e.getItemApp=function(e){var t,i=e&&e.selection();if(i&&1===i.length){var n=o.utils.unwrapObservable(i[0]);n.appMap&&(t=n.appMap)}return t},e.wordType=s,e.onenoteType=a,e.powerpointType=l,e.excelType=c,e.OfficeIconFileTypeMap={Accdb:p,Doc:s,Docm:s,Docx:s,Dot:s,Dotm:s,Dotx:s,Pdf:s,Odp:l,Ods:c,Odt:s,One:a,Onepkg:a,Onetoc2:a,Mpp:h,Notebook:a,Pot:l,Potm:l,Potx:l,Ppa:l,Ppam:l,Pps:l,Ppsm:l,Ppsx:l,Ppt:l,Pptm:l,Pptx:l,Pub:u,Vdw:d,Vsd:d,Vsdm:d,Vsdx:d,Vsl:d,Vss:d,Vssm:d,Vssx:d,Vst:d,Vstm:d,Vstx:d,Xla:c,Xlam:c,Xll:c,Xls:c,Xlsb:c,Xlsm:c,Xlsx:c,Xlt:c,Xltm:c,Xltx:c},e}();return m});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/folderBuilder/FolderBuilderViewModel",["require","exports","odsp-shared/base/ViewModel","./FolderBuilder.resx","../peoplePicker/PeoplePicker","knockout"],function(e,t,i,n,o,r){var s=function(e){function t(t){e.call(this,t),this.namePlaceholder=n.strings.FolderNamePlaceholder,this.nameLabel=n.strings.FolderNameLabel,this.addEditors=n.strings.AddEditors,this.editorsLabel=n.strings.EditorsLabel,this.editorsDescription=n.strings.EditorsDescription,this.editorsNotePlaceholder=n.strings.EditorsNotePlaceholder,this.peoplePickerTagName=o.tagName,this.name=t.name,this.status=t.status||r.observable(""),this.hasError=t.hasError||r.observable(!1),this.isEnabled=t.isEnabled||r.observable(!0),this.hasFocus=t.hasFocus||r.observable(!0),this.maxNameLength=t.maxNameLength,this.supportInlineSharing=t.supportInlineSharing,this.sharingNote=t.sharingNote,this.selectedPeople=t.selectedPeople,this.peoplePickerParams={selectedPeople:this.selectedPeople,peoplePickerQueryParams:null},this.areSharingFieldsVisible=r.observable(!1)}return __extends(t,e),t.prototype.onAddEditorsClicked=function(){this.areSharingFieldsVisible(!0)},t}(i);return s}),define("odsp-next/controls/folderBuilder/FolderBuilder.html",[],function(){return'<div class=od-FolderBuilder><div class=ms-TextField><label class="od-FolderBuilder-nameLabel ms-Label" data-bind="text: nameLabel"></label> <input class="od-FolderBuilder-nameInput ms-TextField-field" type=text data-bind="value: name, textInput: name, hasFocus: hasFocus, attr: { placeholder: namePlaceholder, maxlength: maxNameLength }, automation: automationId, css: { \'od-FolderBuilder-nameInput--error\': hasError }, enable: isEnabled"><div data-bind="visible: supportInlineSharing"><button class="od-FolderBuilder-addEditorsButton ms-Button" data-bind="visible: !areSharingFieldsVisible(), click: onAddEditorsClicked, text: addEditors"></button><div class=od-FolderBuilder-sharingFields data-bind="visible: areSharingFieldsVisible"><label class="od-FolderBuilder-editorsLabel ms-Label" data-bind="text: editorsLabel"></label><div class=od-FolderBuilder-peoplePicker data-bind="component: { name: peoplePickerTagName, params: peoplePickerParams }"></div><div><textarea class=od-FolderBuilder-noteInput data-bind="value: sharingNote, attr: { placeholder: editorsNotePlaceholder, maxlength: 4000 }">\n                </textarea></div></div><div class="od-FolderBuilder-sharingDescription ms-font-s" data-bind="text: editorsDescription"></div></div></div><div class=od-FolderBuilder-status data-bind="text: status, css: { \'od-FolderBuilder-status--error\': hasError }"></div></div>'}),define("odsp-next/controls/folderBuilder/FolderBuilder.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-FolderBuilder-nameLabel,.od-FolderBuilder-peoplePicker .PeoplePicker-resolvedItem-persona .ms-Persona-emailText{display:none}.od-FolderBuilder-status{margin-top:12px;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:#094AB2}.od-FolderBuilder-status--error{color:#a80000}.od-FolderBuilder-input--error{border-color:#a80000!important}.od-FolderBuilder-addEditorsButton.ms-Button,.od-FolderBuilder-sharingFields{margin-top:20px}.od-FolderBuilder-sharingDescription{margin-top:5px}.od-FolderBuilder-peoplePicker .AutoFill{min-width:100%;max-width:100%}.od-FolderBuilder-noteInput{height:80px;width:100%;box-sizing:border-box;border:1px solid #a6a6a6;overflow-y:auto;padding:5px;margin:10px 0 5px}")}),define("odsp-next/controls/folderBuilder/FolderBuilder",["require","exports","./FolderBuilderViewModel","odsp-shared/utilities/knockout/ComponentFactory","./FolderBuilder.html","./FolderBuilder.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-folder-builder",template:e("./FolderBuilder.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/CreateFolderAction",["require","exports","knockout","../base/BaseItemAction","../resources/ProviderResourceKeys","../resources/ControlResourceKeys","../models/dialog/DialogState","../controls/folderBuilder/FolderBuilder","../controls/commands/Commands.resx","odsp-utilities/logging/events/Qos.event","../dataSources/url/QueryType","../utilities/features/Features","../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){var h=function(e){function t(t){e.call(this,t),this.name="CreateFolder",this.maxNameLength=255,this._operatorProvider=this.resources.consume(o.operator),this._dialogProvider=this.resources.consume(o.dialog),u.default.isFeatureEnabled(u.default.EnableCreateSharedFolder)&&(this.supportInlineSharing=!0)}return __extends(t,e),t.prototype.onIsAvailable=function(){return this.item().queryType===d.Files},t.prototype.onExecute=function(){var e=this,t=this.resources.consume(r.currentItem),n=i.observable(""),o=i.observable(""),d=i.observable(!1),u=i.observable(!0),h=i.observable(!0),m=i.observable([]),g=i.observable(""),f=function(){return o(l.strings.Saving),u(!1),d(!1),e._operatorProvider.createFolder({parent:t(),folderName:n(),sharingNote:g(),selectedPeople:m().filter(function(e){return e.isResolved})}).then(function(){return s.completed},function(e){return d(!0),u(!0),h(!0),o(e.message),s.opened})},b=this._dialogProvider.requestDialog({title:l.strings.CreateFolder,component:{name:a.tagName,params:{name:n,automationId:"createFolderDialog",status:o,hasError:d,isEnabled:u,maxNameLength:this.maxNameLength,hasFocus:h,supportInlineSharing:this.supportInlineSharing,selectedPeople:m,sharingNote:g}},actions:[{name:l.strings.CreateCommit,execute:f,isAvailable:i.pureComputed(function(){return!!n()&&u()}),isDefault:!0,icon:p.save,automationId:"createFolderDialogCommit"}]});return b.wait().then(function(){return{resultType:c.ResultTypeEnum.Success}})},t}(n);return h});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/CreateFolderAction",["require","exports","../CreateFolderAction","./PermissionMask","../../resources/SPOResourceKeys"],function(e,t,i,n,o){var r=function(e){function t(t){e.call(this,t),this.maxPathLength=260,this.hostSettings=this.resources.consume(o.hostSettings)}return __extends(t,e),t.prototype.onIsAvailable=function(){return e.prototype.onIsAvailable.call(this)&&n.hasItemPermission(this.item(),n.InsertListItems)},t.prototype.onExecute=function(t,i){var n=this.hostSettings.webAbsoluteUrl.replace(this.hostSettings.webServerRelativeUrl,"")+this.item().id+"/";return this.maxNameLength=this.maxPathLength-n.length,e.prototype.onExecute.call(this,t,i)},t}(i);return r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/CreateDocumentAction",["require","exports","knockout","../base/BaseItemAction","../resources/UtilityResourceKeys","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","./DocumentType","../controls/itemNameEditor/ItemNameEditor","../models/dialog/DialogState","odsp-utilities/async/Promise","../controls/commands/Commands.resx","../dataSources/url/QueryType","../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h){var m=u.strings,g=function(e){function t(t){e.call(this,t),this.name="CreateDocument",this.openInNewTab=!1,this.docType=t.docType,this.askForFileName=this.docType===a.OneNote}return __extends(t,e),t.prototype.onIsAvailable=function(){return this.item().queryType===p.Files},t.prototype.isCommandSupported=function(){return!0},t.prototype.onExecute=function(){return this.isCommandSupported()?this.onExecuteCore():d.default.wrap({resultType:s.ResultTypeEnum.Success})},t.prototype.onExecuteCore=function(){var e=this.item();return this.askForFileName?this._createDocumentWithDialog(e):this._createDocument(e)},t.prototype._getDialogTitle=function(){var e="";switch(this.docType){case a.Word:e=m.CreateWord;break;case a.Excel:e=m.CreateExcel;break;case a.PowerPoint:e=m.CreatePowerPoint;break;case a.OneNote:e=m.CreateOneNote;break;case a.ExcelSurvey:e=m.CreateExcelSurvey;break;case a.Text:e=m.CreateText}return e},t.prototype._createDocumentWithDialog=function(e){var t=this,n=this.resources.consume(r.dialog),d=i.observable(""),p=i.observable(""),g=i.observable(!1),f=i.observable(!0),b=null,y=function(){var i=t.resources.consume(r.item);return p(u.strings.Saving),f(!1),g(!1),i.createDocument(e.key,t.docType,d()).then(function(e){return b=e,c.completed},function(e){return g(!0),f(!0),p(e),c.opened})},v=n.requestDialog({title:this._getDialogTitle(),component:{name:l.tagName,params:{name:d,automationId:"createDocumentDialog",extension:this.docType===a.ExcelSurvey?".xlsx":null,status:p,hasError:g,isEnabled:f}},actions:[{name:m.CreateCommit,execute:y,isAvailable:i.pureComputed(function(){return!!d()&&f()}),isDefault:!0,icon:h.save,automationId:"createDocumentDialogCommit"}]}),S=v.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}});return S.done(function(){if(b){var e=t.resources.consume(o.navigation);t.async.setImmediate(function(){return e.navigateTo({url:b,frameId:t.openInNewTab?"_blank":null})})}}),S},t.prototype._createDocument=function(e,t){var i=this,n=this.resources.consume(o.navigation),a=this.resources.consume(r.item),l=null,c=a.createDocument(e.key,this.docType,t).then(function(e){return e&&(l=e),d.default.wrap({resultType:s.ResultTypeEnum.Success})});return c.done(function(){l&&i.async.setImmediate(function(){return n.navigateTo({url:l,frameId:i.openInNewTab?"_blank":null})})}),c},t}(n);return g});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/CreateDocumentAction",["require","exports","knockout","../CreateDocumentAction","../DocumentType","../../dataSources/url/QueryType","./PermissionMask","odsp-utilities/async/Promise","../../resources/ProviderResourceKeys","../../controls/textContainer/TextContainer","./Actions.resx","../../controls/commands/Commands.resx","../../models/dialog/DialogState","../../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h){var m=function(e){function t(t){e.call(this,t),this.askForFileName=this.docType===o.OneNote||this.docType===o.ExcelSurvey,this.openInNewTab=!0}return __extends(t,e),t.prototype.isCommandSupported=function(){var e=this;if(this.docType===o.ExcelSurvey){var t=this.resources.consume(l.shareByLink),i=t.getShareByLinkInfo(),n=this.item(),r=Boolean(n.properties.commandsSupported&&n.properties.commandsSupported.canShareLinkForNewDocument);return i.then(function(t){Boolean(t)&&t.isExternalSharingTipEnabled&&r?e.onExecuteCore():e.ShareByLinkNotSupported()},function(){e.ShareByLinkNotSupported()}),!1}return!0},t.prototype.onIsAvailable=function(){return this.item().queryType===r.Files&&this.docType!==o.Text&&s.hasItemPermission(this.item(),s.InsertListItems)},t.prototype.ShareByLinkNotSupported=function(){var e=this.resources.consume(l.dialog),t=e.requestDialog({title:d.strings.CreateExcelSurveyTitle,component:{name:c.tagName,params:{text:d.strings.CreateExcelSurveyError}},actions:[{name:u.strings.ok,execute:function(){return a.default.wrap(p.completed)},isAvailable:i.observable(!0),icon:h.x,isDefault:!0}]});t.wait().then(function(){})},t}(n);return m});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/CreateShortcutAction",["require","exports","../base/BaseItemAction","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event"],function(e,t,i,n,o){var r=function(e){function t(t){e.call(this,t),this.name="CreateShortcut",this.filename=t.filename,this.url=t.url,this.onComplete=t.onComplete}return __extends(t,e),t.prototype.onExecute=function(){var e=this;this.onComplete();var t=this.resources.consume(n.shortcut),i=this.item();return o.Qos.instrumentPromise({name:"CreateShortcutAction.CreateShortcut"},function(){return t.createShortcut(i.key,e.filename(),e.url()).then(function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})},function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})},t.prototype.onIsAvailable=function(){return!0},t}(i);return r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/createShortcut/CreateShortcutCommandSet",["require","exports","knockout","../../actions/CreateShortcutAction","odsp-shared/base/BaseModel","../commands/CommandViewModel","../commands/Commands.resx","../../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){e.call(this,t),this.commands=i.observableArray(),this.isDisabled=i.observable(!1),this.isLabelVisible=i.observable(!0),this.onComplete=t.commandViewModel.onComplete,this.fullFileName=function(){return t.commandViewModel.filename()+t.commandViewModel.fileExtension};var o={filename:this.fullFileName,url:t.commandViewModel.url,onComplete:this.onComplete};this.commands=i.observableArray([new r({text:s.strings.CreateShortcutButton,isLabelVisible:this.isLabelVisible,isDisabled:this.isDisabled,icon:a.check,action:new(this.managed(n))(o),engagementName:"CreateShortcut.CreateShortcutCommandTop"})])}return __extends(t,e),t}(o);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/createShortcut/CreateShortcutViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","./CreateShortcutCommandSet","../../resources/ProviderResourceKeys","../../resources/UtilityResourceKeys","./CreateShortcut.resx","../../dataSources/item/odb/ShortcutLinkDataSource","odsp-next/utilities/uri/Uri","odsp-shared/utilities/knockout/Projections"],function(e,t,i,n,o,r,s,a,l,c){var d=a.strings,u=function(e){function t(t){var n=this;e.call(this,t),this.urlLabel=d.CreateShortcutLabel,this.namePlaceholder=d.CreateShortcutPlaceholder,this.fileNameLabel="File name",this.fileExtension=".url",this.typingTimeout=1e3,this.url=i.observable(""),this.filename=i.observable(""),this.isActive=i.observable(!0),this.onComplete=t.onComplete,this.urlSubscription=this.url.subscribe(function(){n.typingTimestamp=Date.now(),n.async.setTimeout(function(){n.typingTimestamp+n.typingTimeout<=Date.now()&&n.getPreview()},n.typingTimeout)}),this._platform=this.resources.consume(s.platformDetection),this.isMobile=this._platform.isMobile,this.commandSet=new(this.managed(o))({commandViewModel:this}),this.commandBarParams={commandSet:this.commandSet,isMobile:this.isMobile,isActive:this.isActive},this.shortcutProvider=this.resources.consume(r.shortcut),this.isSharePointUrl=this.createPureComputed(function(){return l.default.isSharePointUrl(n.url())})}return __extends(t,e),t.prototype.getPreview=function(){var e=this;if(this.isSharePointUrl())this.shortcutProvider.getFileByUrl(this.url()).then(function(t){e.filename(t.Name)});else{var t=new c(this.url());this.filename(t.getHost())}},t}(n);return u}),define("odsp-next/controls/createShortcut/CreateShortcut.html",[],function(){return'<div class=CreateShortcut-commandBar data-bind="component: { name: \'ms-command-bar\', params: {commandSet: commandSet, isActive: isActive } }"></div><div class=CreateShortcut data-bind><div class=CreateShortcut-url><div class=ms-TextField><label class="CreateShortcut-label ms-font-xl ms-fontWeight-semilight" data-bind="text: urlLabel"></label> <span class=CreateShortcut-url-Input><input class=ms-TextField-field type=text data-bind="value: url, textInput: url, selectOnFocus, attr: { placeholder: namePlaceholder }"></span></div></div><div class=CreateShortcut-fileName><div class=ms-TextField><label class=CreateShortcut-label data-bind="text: fileNameLabel"></label> <span class=CreateShortcut-fileName-input><input class=ms-TextField-field type=text data-bind="value: filename, textInput: filename, selectOnFocus"></span> <span data-bind="text: fileExtension"></span></div><div class=CreateShortcut-fileName-status data-bind="text: status"></div></div></div>'}),define("odsp-next/controls/createShortcut/CreateShortcut.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".CreateShortcut{box-sizing:border-box}.CreateShortcut:after,.CreateShortcut:before{display:table;content:\"\";line-height:0}.CreateShortcut:after{clear:both}.CreateShortcut-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:#e6f2fb}.CreateShortcut-label{display:block;margin-bottom:20px}.CreateShortcut-fileName-input{display:inline-block;width:90%}.CreateShortcut-sectionHeaderText{color:#333;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.CreateShortcut-section{padding:20px 20px 22px 40px;box-sizing:border-box;display:inline-block;width:100%}html[dir=rtl] .CreateShortcut-section{padding:20px 40px 22px 20px}.CreateShortcut-sectionHeader{position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:32px;line-height:32px;cursor:pointer}.CreateShortcut-sectionExpandButton.ms-Icon{font-size:17px;position:absolute;color:#666;width:32px;height:32px;line-height:32px;text-align:center;transition:-webkit-transform 167ms cubic-bezier(.1,.9,.2,1);transition:transform 167ms cubic-bezier(.1,.9,.2,1);transition:transform 167ms cubic-bezier(.1,.9,.2,1),-webkit-transform 167ms cubic-bezier(.1,.9,.2,1)}html[dir=ltr] .CreateShortcut-sectionExpandButton.ms-Icon{left:-32px}html[dir=rtl] .CreateShortcut-sectionExpandButton.ms-Icon{right:-32px}.CreateShortcut-section.is-expanded .CreateShortcut-sectionExpandButton.ms-Icon{-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.CreateShortcut-section .CreateShortcut-sectionContent{display:none}.CreateShortcut-section.is-expanded .CreateShortcut-sectionContent{display:block}.CreateShortcut-sectionContent{margin-top:10px;font-size:12px}.CreateShortcut-selectionMessage{margin:0 0 20px 14px}html[dir=rtl] .CreateShortcut-selectionMessage{margin:0 14px 20px 0}.lg .CreateShortcut-selectionMessage,.xlg .CreateShortcut-selectionMessage,.xxlg .CreateShortcut-selectionMessage,.xxxlg .CreateShortcut-selectionMessage{margin-top:18px;font-size:21px}.od-CreateShortcut-selectFile{color:#333;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;margin:0 0 20px 14px}html[dir=rtl] .od-CreateShortcut-selectFile{margin:0 14px 20px 0}.od-CreateShortcut--lg .od-CreateShortcut-section{width:50%;margin:0 50% 0 0}html[dir=rtl] .od-CreateShortcut--lg .od-CreateShortcut-section{margin:0 0 0 50%}.od-CreateShortcut--lg .od-CreateShortcut-section:nth-child(-n+3){margin:0;float:right;clear:right}html[dir=rtl] .od-CreateShortcut--lg .od-CreateShortcut-section:nth-child(-n+3){margin:0}.od-CreateShortcut--lg .od-CreateShortcut-section:nth-child(1){width:100%;float:none;clear:both}.od-CreateShortcut--xlg .od-CreateShortcut-section,.od-CreateShortcut--xxlg .od-CreateShortcut-section,.od-CreateShortcut--xxxlg .od-CreateShortcut-section{width:33.33333333%;margin:0 33.33333333%}html[dir=rtl] .od-CreateShortcut--xlg .od-CreateShortcut-section,html[dir=rtl] .od-CreateShortcut--xxlg .od-CreateShortcut-section,html[dir=rtl] .od-CreateShortcut--xxxlg .od-CreateShortcut-section{margin:0 33.33333333%}.od-CreateShortcut--xlg .od-CreateShortcut-section:nth-child(-n+4),.od-CreateShortcut--xxlg .od-CreateShortcut-section:nth-child(-n+4),.od-CreateShortcut--xxxlg .od-CreateShortcut-section:nth-child(-n+4){margin:0;float:left;clear:left}html[dir=rtl] .od-CreateShortcut--xlg .od-CreateShortcut-section:nth-child(-n+4),html[dir=rtl] .od-CreateShortcut--xxlg .od-CreateShortcut-section:nth-child(-n+4),html[dir=rtl] .od-CreateShortcut--xxxlg .od-CreateShortcut-section:nth-child(-n+4){margin:0}.od-CreateShortcut--xlg .od-CreateShortcut-section:nth-child(1),.od-CreateShortcut--xxlg .od-CreateShortcut-section:nth-child(1),.od-CreateShortcut--xxxlg .od-CreateShortcut-section:nth-child(1){width:100%;float:none;clear:both}.od-CreateShortcut--xlg .od-CreateShortcut-section:nth-child(2),.od-CreateShortcut--xxlg .od-CreateShortcut-section:nth-child(2),.od-CreateShortcut--xxxlg .od-CreateShortcut-section:nth-child(2){float:right;clear:both}")}),define("odsp-next/controls/createShortcut/CreateShortcut",["require","exports","knockout","./CreateShortcutViewModel","odsp-shared/utilities/knockout/ComponentFactory","./CreateShortcut.html","./CreateShortcut.css","../iFrameCtrl/IFrameCtrl"],function(e,t,i,n,o){var r=o.registerComponent({tagName:"ms-createShortcut-pane",template:e("./CreateShortcut.html"),viewModel:n,synchronous:!0});return i.components.isRegistered(r.tagName)||i.components.register(r.tagName,r),r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/LaunchCreateShortcutPanel",["require","exports","../../base/BaseItemAction","./PermissionMask","odsp-utilities/logging/events/Qos.event","../../controls/commands/Commands.resx","../../resources/ProviderResourceKeys","../../controls/createShortcut/CreateShortcut","../../models/panel/PanelState"],function(e,t,i,n,o,r,s,a,l){var c=r.strings,d=function(e){function t(t){e.call(this,t),this._panelProvider=this.resources.consume(s.panel)}return __extends(t,e),t.prototype.onIsAvailable=function(){return e.prototype.onIsAvailable.call(this)&&n.hasItemPermission(this.item(),n.InsertListItems)},t.prototype.onExecute=function(){var e=this._panelProvider.requestPanel({hasCommandBar:!0,noTitle:!0,component:{name:a.tagName,params:{onComplete:function(){e.state(l.closed)},title:c.CreateShortcut,resources:this.resources}}});return e.wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})},t}(i);return d});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/DeleteAction",["require","exports","knockout","../base/BaseSelectionAction","odsp-utilities/async/Promise","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../dataSources/url/QueryType","../models/dialog/DialogState","../controls/commands/Commands.resx","../controls/textContainer/TextContainer","odsp-shared/utilities/string/StringHelper","../dataSources/item/DeletionType","../models/sharing/SharingRole","../models/item/ItemType","../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g){var f=function(e){function t(t){e.call(this,t),this.name="Delete",this.showConfirmDialogBeforeDelete=!0,this.showConfirmDialogBeforeSharedItemDelete=!1,this.allowUndo=!0,this._dialogProvider=this.resources.consume(r.dialog),this._operatorProvider=this.resources.consume(r.operator)}return __extends(t,e),t.prototype.onSelectionExecute=function(e){var t,n=this,r=this.item(),f=p.Recycle,b="",y="",v=!1;if(0===e.length)return o.default.wrap({resultType:s.ResultTypeEnum.ExpectedFailure});if(r.queryType===a.RecycleBin?(f=p.PermanantDelete,b=1===e.length?u.format(c.strings.recycleBinDeleteConfirmTextSingleSelection,e[0].name):c.strings.recycleBinDeleteConfirmTextMultiSelection,y=c.strings.recycleBinDeleteConfirmTitle,v=!0):this.showConfirmDialogBeforeSharedItemDelete&&e[0].sharingRole!==h.Owner?(1===e.length?(b=c.strings.deleteSharedSingleItem,y=c.strings.deleteSharedSingleItemPromptTitle):(b=c.strings.deleteSharedMultipleItems,y=c.strings.deleteSharedMultipleItemPromptTitle),v=!0):this.showConfirmDialogBeforeDelete&&(b=c.strings.deleteConfirmText,y=c.strings.deleteConfirmTitle,v=!0),v){var S=this._dialogProvider.requestDialog({title:y,component:{name:d.tagName,params:{text:b}},actions:[{name:c.strings.DeleteItem,execute:function(){return o.default.wrap(l.completed)},isAvailable:i.observable(!0),icon:g.trash,isDefault:!0}]});t=S.wait()}else t=o.default.wrap();return t.then(function(){return n.selectionModel&&n.selectionModel.clear(),n._operatorProvider.deleteItems({parentKey:r.key,items:e,deletionType:f,allowUndo:n.allowUndo}).then(function(){var t={deletionType:p[f]},i={count:e.length};return 1===e.length&&(t.fileType=m[e[0].type],t.extension=e[0].extension||""),{resultType:s.ResultTypeEnum.Success,extraData:t,extraMetrics:i}
})})},t}(n);return f});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/DeleteAction",["require","exports","../DeleteAction","./PermissionMask"],function(e,t,i,n){var o=function(e){function t(){e.apply(this,arguments),this.allowUndo=!1}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return n.hasItemPermission(t,n.DeleteListItems)},t}(i);return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/DownloadAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/DataSourceResourceKeys","../models/item/ItemType"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){e.call(this,t),this.name="Download",this.isSingleSelectAction=!0,this._downloadDataSource=this.resources.consume(r.download)}return __extends(t,e),t.prototype.onPreDownloadItems=function(){return n.default.wrap(!0)},t.prototype.onSelectionExecute=function(e){var t,i=this;return t={items:e},this.onPreDownloadItems(t.items).then(function(e){return e?i._downloadDataSource.downloadItems(t).then(function(){var e={},i={count:t.items.length};return 1===t.items.length&&(e.fileType=s[t.items[0].type],e.extension=t.items[0].extension||""),{resultType:o.ResultTypeEnum.Success,extraData:e,extraMetrics:i}}):n.default.wrap({resultType:o.ResultTypeEnum.ExpectedFailure})})},t}(i);return a}),define("odsp-next/actions/odb/ActionHelper",["require","exports","../../models/item/ItemType"],function(e,t,i){var n=function(){function e(){}return e.isNotFolder=function(t){return t&&t.type!==i.Folder&&"1"!==t.properties[e.FileTypeProperty]},e.isCheckedOut=function(t){return"undefined"!=typeof t.properties[e.CheckOutUserProperty]&&""!==t.properties[e.CheckOutUserProperty]},e.CheckOutUserProperty="CheckedOutUserId",e.FileTypeProperty="FSObjType",e}();return n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/DownloadAction",["require","exports","../DownloadAction","./ActionHelper","../../dataSources/url/QueryType"],function(e,t,i,n,o){var r=function(e){function t(){e.apply(this,arguments),this.name="Download"}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return this.item().queryType===o.Files&&n.isNotFolder(t)},t}(i);return r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/syncDialog/SyncDialogViewModel",["require","exports","odsp-shared/base/ViewModel","./SyncDialog.resx","../../utilities/uri/Uri","../../resources/SPOResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){e.call(this,t),this.syncLabel=n.strings.SyncLabel,this.syncNow=n.strings.SyncNow,this.getSync=n.strings.GetSync,this.item=t.item}return __extends(t,e),t.stringToASCIIAlnum=function(e){for(var i=97,n="",o=0;o<e.length;o++){var r=e[o];if(t.isWAsciiAlnum(r))n+=r;else{n+="_";var s=r.charCodeAt(0);99>=s?n+=s.toString():(n+=String.fromCharCode(i+Math.floor(s/4096)),n+=String.fromCharCode(i+Math.floor(s/256)%16),n+=String.fromCharCode(i+Math.floor(s/16)%16),n+=String.fromCharCode(i+s%16))}}return n},t.isWAsciiAlnum=function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||e>="0"&&"9">=e},t.getScopeName=function(e){switch(e){case 1:return"OPENSITE";case 2:return"OPENLIST";case 3:return"OPENFOLDER";default:throw"ArgumentException: Incorrect offline scope value"}},t.prototype.onClick=function(){var e=[];e.push("/");var i=this.resources.consume(r.context),n=this.resources.consume(r.listContext),a=i.webUrl,l=n.listId,c="";if(null!==n.folderPath){c=n.folderPath;var d=c.indexOf(n.listUrl);0===d&&(c=c.substring(n.listUrl.length))}Boolean(l)&&(e.push(t.stringToASCIIAlnum(a)),e.push(t.stringToASCIIAlnum(l)),e.push(t.stringToASCIIAlnum("700")),c.length>0&&e.push(t.stringToASCIIAlnum(c)));var u=new o(e.join("/"));u.setScheme("grvopen");var p=u.toString()+"?"+t.getScopeName(c.length>0?3:2);window.location.assign(p);var h=this.resources.consume(s.dialog).currentDialog();h.complete()},t}(i);return a}),define("odsp-next/controls/syncDialog/SyncDialog.html",[],function(){return'<p class=ms-Dialog-title data-bind="text: syncLabel"></p><br><a data-bind="click: onClick" href=javascript:; class="od-SyncDialog-syncButton ms-Dialog-content"><span class=od-syncButtonIconParent><img class=od-syncButtonIcon src=/_layouts/15/images/spcommon.png></span>&nbsp;<!--ko text: syncNow--><!--/ko--></a><br><a href="http://go.microsoft.com/fwlink/?LinkID=398035" class=ms-Dialog-content target=_blank data-bind="text: getSync"></a>'}),define("odsp-next/controls/syncDialog/SyncDialog.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-syncButtonIconParent{height:16px;width:16px;position:relative;display:inline-block;overflow:hidden;vertical-align:middle}.od-syncButtonIcon{position:absolute;left:-200px;top:-66px}.od-SyncDialog-syncButton{display:block}.od-SyncDialog-syncButton:hover{background-color:#a8d1ef}")}),define("odsp-next/controls/syncDialog/SyncDialog",["require","exports","./SyncDialogViewModel","odsp-shared/utilities/knockout/ComponentFactory","./SyncDialog.html","./SyncDialog.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-sync-dialog-builder",template:e("./SyncDialog.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/SyncAction",["require","exports","../../base/BaseSelectionAction","odsp-utilities/async/Promise","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../../controls/syncDialog/SyncDialog","../../dataSources/url/QueryType","./PermissionMask"],function(e,t,i,n,o,r,s,a,l,c){var d=function(e){function t(){e.apply(this,arguments),this.name="Sync"}return __extends(t,e),t.prototype.onExecute=function(){var e=this.resources.consume(r.dialog),t=this.resources.consume(o.currentItem),i=e.requestDialog({title:"",component:{name:a.tagName,params:{item:t,resources:this.resources}},actions:[]});return i.wait().then(function(){}),n.default.wrap({resultType:s.ResultTypeEnum.Success})},t.prototype.onIsAvailable=function(){return this.item().queryType===l.Files&&c.hasItemPermission(this.item(),c.OpenItems)},t}(i);return d});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/inPageEditor/InPageEditorViewModel",["require","exports","odsp-shared/base/ViewModel","knockout"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.isOpen=n.observable(!0),this.isLoading=n.observable(!0),this.onClose=t.onClose,this.iframeLoaderParams={url:t.inPageEditorUrl,showLoadingLabel:!0,onload:this.iframeOnLoad.bind(this),isLoading:this.isLoading,isInFullPage:!0}}return __extends(t,e),t.prototype.iframeOnLoad=function(e){var t=e.target;t&&t.contentWindow&&(this._setupIframeElementFunctions(t),this.isLoading(!1))},t.prototype._setupIframeElementFunctions=function(e){var t=this,i=function(){t.isOpen(!1)};e.cancelPopUp=i},t}(i);return o}),define("odsp-next/controls/inPageEditor/InPageEditor.html",[],function(){return"<div data-bind=\"component: { name: 'od-listfocus-editorhost' , params: { isOpen: isOpen, onClose: onClose } }\"><div class=od-InPageEditor-iframe><!--ko component: { name: 'ms-iframe-loader', params: iframeLoaderParams }--><!--/ko--></div></div>"}),define("odsp-next/controls/inPageEditor/InPageEditor.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-InPageEditor-iframe{position:absolute;top:10%;left:10%;height:80%;width:80%}")}),define("odsp-next/controls/inPageEditor/InPageEditor",["require","exports","./InPageEditorViewModel","odsp-shared/utilities/knockout/ComponentFactory","./InPageEditor.html","./InPageEditor.css","../iframeLoader/IframeLoader"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-inpageeditor",template:e("./InPageEditor.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/EditAction",["require","exports","knockout","odsp-utilities/async/Promise","../../base/BaseSelectionAction","../../resources/SPOResourceKeys","../../dataSources/url/QueryType","../../resources/UtilityResourceKeys","../../resources/ProviderResourceKeys","./PermissionMask","../../dataSources/url/odb/UrlQueryKeys","odsp-utilities/logging/events/Qos.event","odsp-shared/utilities/string/StringHelper","../../controls/inPageEditor/InPageEditor"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){var h=function(e){function t(){e.apply(this,arguments),this.name="EditList",this.element=null}return __extends(t,e),t.prototype.onIsAvailable=function(){return this.item().queryType===s.Files&&c.hasItemPermission(this.item(),c.EditListItems)},t.prototype.onExecute=function(){var e=this;return this.element=document.createElement("div"),this.element.setAttribute("data-bind",'component: { name: "ms-inpageeditor", params: $data }'),document.body.appendChild(this.element),i.applyBindings({resources:this.resources,inPageEditorUrl:this.getIPEUrl(),onClose:function(){e.async.setTimeout(function(){e.refreshItemSet()},500)}},this.element),n.default.wrap({resultType:u.ResultTypeEnum.Success})},t.prototype.refreshItemSet=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);var e=this.resources.consume(l.item),t=this.item();e.invalidateItem(t.key)},t.prototype.getIPEUrl=function(){var e=this.resources.consume(r.listContext),t=this.resources.consume(a.navigation),i=t.viewParams[d.default.idParamKey];i=i?"&RootFolder="+i:"";var n=window.location.protocol+"//"+window.location.host+window.location.pathname;if(p.doesStringEndWith(n,"/_layouts/15/items.aspx")){var o=this.resources.consume(r.context);n=o.serverUrl+e.listUrl+"/forms/allitems.aspx"}return n+"?Minimized=TRUE"+i+"#InplviewHash"+e.viewId.toLowerCase()+"=ShowInGrid%3DTrue"},t}(o);return h});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/AlertAction",["require","exports","../../base/BaseItemAction","../../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../../dataSources/url/QueryType","../../controls/commands/Commands.resx","./PermissionMask","../../controls/alert/AlertViewer","../../utilities/browser/WindowSize","../../resources/SPOResourceKeys","odsp-utilities/encoding/UriEncoding"],function(e,t,i,n,o,r,s,a,l,c,d,u){var p=function(e){function t(t){e.call(this,t),this.name="Alert"}return __extends(t,e),t.prototype.onExecute=function(){var e=this.resources.consume(n.dialog),t=e.requestDialog({title:s.strings.AlertMe,size:c.XLarge,component:{name:l.tagName,params:{alertUrl:this.getAlertUrl(),showInDialog:!0}}});return t.wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})},t.prototype.onIsAvailable=function(){return this.item().queryType===r.Files&&a.hasItemPermission(this.item(),a.CreateAlerts)},t.prototype.getAlertUrl=function(){var e=[],t=this.resources.consume(d.context),i=this.resources.consume(d.listContext);return e.push(t.webUrl),e.push("/"),e.push(t.layoutsUrl),e.push("/SubNew.aspx?List="),e.push(u.encodeURIComponent(i.listId)),e.push("&IsDlg=1"),e.join("")},t}(i);return p});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/OpenShortcutAction",["require","exports","knockout","odsp-utilities/logging/events/Qos.event","odsp-next/base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-next/resources/SPOResourceKeys","odsp-next/dataSources/item/odb/ShortcutLinkDataSource","odsp-next/resources/UtilityResourceKeys","odsp-next/resources/ProviderResourceKeys","odsp-next/controls/commands/Commands.resx","odsp-next/models/dialog/DialogState","odsp-next/controls/textContainer/TextContainer","odsp-next/utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h){var m=function(e){function t(t){e.call(this,t),this.name="OpenShortcut";var i=this.resources.consume(s.hostSettings);this._shortcutLinkDataSource=new a.default(i),this._navigation=this.resources.consume(l.navigation),this._dialogProvider=this.resources.consume(c.dialog)}return __extends(t,e),t.prototype.onIsAvailable=function(){return null!=this.item},t.prototype.onExecute=function(){var e,t=this,o=this._shortcutLinkDataSource.getShortcutTargetData(this.item.peek().id);return o.then(function(o){if(o.isInternal)e=r.default.wrap();else{var s=t._dialogProvider.requestDialog({title:d.strings.confirmNavigateDialogTitle,component:{name:p.tagName,params:{text:d.strings.openShortcutNavigateToExternalWarning}},actions:[{name:d.strings.navigationDialogConfirmButtonLabel,execute:function(){return r.default.wrap(u.completed)},isAvailable:i.observable(!0),icon:h.arrowRight,isDefault:!0}]});e=s.wait()}return e.then(function(){return t._navigation.navigateTo({url:o.url,frameId:"_blank"}),{resultType:n.ResultTypeEnum.Success}})})},t}(o);return m});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/ContentTypeNavigationAction",["require","exports","../../base/BaseAction","../NavigationAction","../../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../../controls/commands/Commands.resx","../../utilities/browser/WindowSize","../../resources/DataSourceResourceKeys","odsp-next/resources/ControlResourceKeys","../../resources/SPOResourceKeys","../../dataSources/url/QueryType","../../controls/alert/AlertViewer","odsp-utilities/encoding/UriEncoding","knockout"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m){var g=function(e){function t(t){var i={};m.utils.extend(i,t),i.target="_blank",e.call(this,i);var o=t.url;this._viewParams=this.resources.consume(c.viewParams),this._urlDataSource=this.resources.consume(l.url),this._url=m.isObservable(o)?o.peek():o,this._navigationAction=new(this.managed(n))(i)}return __extends(t,e),t.prototype.onExecute=function(e){if(this._url.indexOf("?id=")>0){var t=this.resources.consume(o.dialog),i=this.resources.consume(d.listContext),n=this._url+"&SaveLocation="+h.encodeURIComponent(i.listUrl)+"&IsDlg=1&Source="+h.encodeURIComponent(i.listUrl),l=t.requestDialog({title:s.strings.CreateNew,size:a.Large,component:{name:p.tagName,params:{alertUrl:n,showInDialog:!0}}});return l.wait().then(function(){return{resultType:r.ResultTypeEnum.Success}})}return this._navigationAction.execute(e)},t.prototype.onIsAvailable=function(){return this._viewParams(),!!this._url&&this._urlDataSource.getQueryType()===u.Files&&this._navigationAction.isAvailable()},t}(i);return g}),define("odsp-next/models/sharing/SharingNetworks",["require","exports","./SharingNetwork.resx"],function(e,t,i){var n=function(){function e(){}return e.open=function(e,t){var i=e.popupWidth,n=e.popupHeight,o=window.screenLeft||window.screenX||0,r=window.innerWidth||0,s=r/2-i/2+o,a=window.screenTop||window.screenY||0,l=window.innerHeight||0,c=l/2-n/2+a,d=e.url.replace("{{url}}",t);window.open(d,"sharing_"+e.name,"resizable, width="+i+", height="+n+", left="+s+", top="+c)},e.Facebook={name:"fb",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}",popupWidth:626,popupHeight:436,text:i.strings.facebook,iconPath:"/images/networks/facebook.png"},e.Twitter={name:"twitter",url:"http://twitter.com/share?url={{url}}",popupWidth:550,popupHeight:300,text:i.strings.twitter,iconPath:"/images/networks/twitter.png"},e.LinkedIn={name:"linkedin",url:"http://www.linkedin.com/shareArticle?mini=true&url={{url}}",popupWidth:550,popupHeight:427,text:i.strings.linkedin,iconPath:"/images/networks/linkedin.png"},e.Weibo={name:"weibo",url:"http://service.weibo.com/share/share.php?url={{url}}",popupWidth:600,popupHeight:400,text:i.strings.weibo,iconPath:"/images/networks/weibo.png"},e}();return n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/sharingByLink/SharingByLinkViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../resources/UtilityResourceKeys","../loadingSpinner/LoadingSpinner","./SharingByLink.resx","../../models/sharing/SharingRole","../../models/sharing/SharingLinkType","../../models/sharing/SharingNetworks","odsp-utilities/logging/events/Engagement.event","../../bindings/focus/SelectOnFocusBinding","../../utilities/browser/ClipboardData","../sharingWizard/SharingWizardState","../../bindings/keyboard/KeyboardBinding","./SharingByLinkStringHelper"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g,f,b,y){var v=function(t){function n(n){var d=this;t.call(this,n),this.loadingSpinnerTagName=l.tagName,this._areNetworksSupported=!1,this._params=n,this.addBindingHandlers({selectOnFocus:m.default,keyboard:b}),this._strings=c.strings,this.supportsCopy=g.CanUseClipboardData(),this._selectionModel=this.resources.consume(o.itemsSelection),this.error=i.observable(""),this._item=n.item,this._sharingProvider=this.resources.consume(s.sharing),this._platform=this.resources.consume(a.platformDetection),this._mediaBaseUrl=e.toUrl(this.resources.consume(r.settings).mediaBaseUrl),this.loading=i.observable(!0),this.hasLoadingError=i.observable(!1),this.isSingleLinkLabelVisible=i.observable(!1),this.getSharingSettings(),this.linksCollection=i.observableArray(),this.currentSharingLink=Boolean(n.currentLink)?n.currentLink:i.observable(null),this.allowEditChecked=i.observable(!1),this.isAllowEditVisible=i.observable(!1),this.isLinkDisabled=i.observable(!1),this.sharingLinkUrl=i.observable(""),this.isNetworksSectionVisible=i.observable(!1),this.isNetworksListVisible=i.observable(!1),this.networksList=[p.Facebook,p.Twitter,p.LinkedIn,p.Weibo],this.linkTitle=this._strings.ChangeLinkTitle,this.inviteText=this._strings.AddPeople,this.getLinkText=this._strings.GetLink,this.copyText=this._strings.CopyLinkText,this.moreOptionsText=this._strings.MoreOptions,this.allowEditText=this._strings.AllowEdit,this.createComputed(function(){var e=d.allowEditChecked();d.currentSharingLink.peek()&&d.canManageLinks&&d._toggleCurrentLink(e)}),this._companyDisplayName=i.observable("");var u=this.resources.consume(s.suiteNav);u&&u.loadData().then(function(e){d._companyDisplayName(e.CompanyDisplayName)}),this.sharingHintText=this.createPureComputed(function(){return y.getLinkHintText(d.currentSharingLink(),d._companyDisplayName())});var h=!1;this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection().length>1&&(this.hasLoadingError(!1),this.loading(!1),h=!0);var f=this._sharingProvider.getSharingData(this._getCurrentItem());f.getSettings().done(function(e){d.canManageLinks=e.canManageLinks,d.supportsLinks=e.anonymousLinksEnabled||e.organizationLinksEnabled,d._areNetworksSupported=e.networkLinksEnabled},function(){}),h||(f.getLinks().then(function(e){null!=e&&(d.linksCollection(e),d._params.canToggleEditInline||d.isSingleLinkLabelVisible(e.length<2))},function(){d.error(c.strings.ServerError),d.loading(!1)}),null===this.currentSharingLink()?this.isReady=f.getBestSharingLink().then(function(e){d.loading(!1),e&&(d.currentSharingLink(e),d._updateLinkExists())},function(){d.error(c.strings.ServerError)}):this._updateLinkExists())}return __extends(n,t),n.prototype.showInvite=function(){if(this._params.dialogStateArray){h.Engagement.logData({name:"AddPeople.SharingByLink.Click"});var e=this._params.dialogStateArray();e.push(f.invite),this._params.dialogStateArray(e)}return!1},n.prototype.showLinkCreate=function(){if(this._params.canToggleEditInline&&this.canManageLinks)this._toggleCurrentLink(!1);else if(this._params.dialogStateArray){var e=this._params.dialogStateArray();e.push(f.createLink),this._params.dialogStateArray(e)}return!1},n.prototype.switchLinks=function(){if(this._params.canToggleEditInline&&this.canManageLinks)this.isAllowEditVisible(!0);else if(this._params.dialogStateArray){h.Engagement.logData({name:"SwitchLinks.SharingByLink.Click"});var e=this._params.dialogStateArray();e.push(f.switchLinks),this._params.dialogStateArray(e)}},n.prototype.logCopy=function(){return h.Engagement.logData({name:this.currentSharingLink().tag+"Link.SharingByLink.Copy"}),!0},n.prototype.onClickCopyLink=function(e,t){return this.logCopy(e,t),g.CopyToClipboard(this.currentSharingLink().url),!0},n.prototype.onMoreOptionsClicked=function(){return this.isNetworksListVisible(!0),!1},n.prototype.getNetworkIcon=function(e){return this._mediaBaseUrl+e.iconPath},n.prototype.onNetworkClicked=function(e){return p.open(e,this.currentSharingLink().url),!1},n.prototype._updateLinkExists=function(){this.isNetworksSectionVisible(this._areNetworksSupported&&!this._platform.isMobile),this.hasLoadingError(!1),this.loading(!1),this.sharingLinkUrl(this.currentSharingLink().url),this.currentSharingLink().role===d.Edit&&this.allowEditChecked(!0)},n.prototype._toggleCurrentLink=function(e){var t=this,i=this.currentSharingLink(),n=i&&i.type;if(!i||n===u.Edit&&!e||n===u.View&&e){this.isLinkDisabled(!0);for(var o,r=0,s=this.linksCollection();r<s.length;r++){var a=s[r];if(n===u.Edit&&a.type===u.View){o=a;break}if(n===u.View&&a.type===u.Edit){o=a;break}}o?(this.currentSharingLink(o),this.async.setTimeout(function(){t.isLinkDisabled(!1),t.sharingLinkUrl(t.currentSharingLink().url)},500)):this._sharingProvider.manageSharingLinks({item:this._getCurrentItem(),type:e?u.Edit:u.View,role:e?d.Edit:d.View,create:!0}).then(function(e){var n=t.linksCollection();n.push(e[0]),t.linksCollection(n),t.currentSharingLink(e[0]),t.isLinkDisabled(!1),t.sharingLinkUrl(t.currentSharingLink().url),i||t._updateLinkExists()})}},n.prototype.getSharingSettings=function(){var e=this,t=this._sharingProvider.getSharingData(this._getCurrentItem());this.isReady=t.getSettings().then(function(t){e._sharingSettings=t},function(t){e.error(t&&403===t.status?c.strings.AccessDenied:c.strings.ServerError),e.hasLoadingError(!0),e.loading(!1)})},n.prototype._getCurrentItem=function(){return this._item?this._item:i.utils.unwrapObservable(this._selectionModel.selection()[0])},n}(n);return v}),define("odsp-next/controls/sharingByLink/SharingByLink.html",[],function(){return'<div class=od-SharingByLink><!--ko if:loading--><div class=od-SharingByLink-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div><!--/ko--><!--ko ifnot:loading--><div aria-live=assertive class=od-SharingByLink-error data-bind="if: error"><span data-bind="text: error"></span></div><div data-bind="ifnot: hasLoadingError"><div class="od-SharingByLink-table od-SharingByLink-linkSection"><div class=od-SharingByLink-row><div class="od-SharingByLink-cell od-SharingByLink-iconCell"><!--ko if: currentSharingLink()--><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--link"></i></div><!--/ko--><!--ko if: !currentSharingLink()--><a href=# class=od-SharingByLink-linkText id=od-SharingByLink-linkText data-bind="click: showLinkCreate"><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--link"></i></div><span data-bind="text: getLinkText"></span></a><!--/ko--></div><!--ko if: currentSharingLink()--><div class=od-SharingByLink-cell><div class="od-SharingByLink-table od-SharingByLink-url"><div class=od-SharingByLink-row><div class=od-SharingByLink-cell><input class=od-SharingByLink-input readonly data-bind="value: sharingLinkUrl, hasFocus: true, selectOnFocus: { isPermanent: true }, event: { copy: logCopy }, css: { \'is-disabled\': isLinkDisabled }, attr: { \'aria-label\': sharingHintText, \'disabled\': isLinkDisabled }"></div><div class=od-SharingByLink-cell><button class="ms-Dialog-action ms-Button ms-Button--primary od-SharingByLink-copyButton" data-bind="visible: supportsCopy, click: onClickCopyLink"><span class="ms-Button-label od-SharingByLink-copyButton-label" data-bind="text: copyText"></span></button></div></div></div><!--ko if: isAllowEditVisible()--><div><input type=checkbox id=od-SharingByLink-allowEdit data-bind="checked: allowEditChecked"> <label for=od-SharingByLink-allowEdit data-bind="text: allowEditText"></label></div><!--/ko--><!--ko if: !isAllowEditVisible()--><!--ko if: !isSingleLinkLabelVisible()--><a href=javascript:; class=od-SharingByLink-linkSwitcher data-bind="attr: {title: linkTitle}, click: switchLinks, text: sharingHintText"></a><!--/ko--><!--ko if: isSingleLinkLabelVisible()--><span class=od-SharingByLink-linkSwitcher data-bind="text: sharingHintText"></span><!--/ko--><!--/ko--></div><!--/ko--></div></div><div class=od-SharingByLink-mailRow><a href=# class=od-SharingByLink-mailText id=od-SharingByLink-mailText data-bind="click: showInvite"><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--mail"></i></div><span data-bind="text: inviteText"></span></a></div><!--ko if: isNetworksSectionVisible--><div class=od-SharingByLink-networksSection><a href=# data-bind="text: moreOptionsText, click: onMoreOptionsClicked, visible: !isNetworksListVisible()"></a><!--ko if: isNetworksListVisible--><div class=od-sharingByLinks-networksList data-bind="foreach: { data: networksList, as: \'network\' }"><div class=od-SharingByLink-networksRow><a href=# class=od-SharingByLink-networkText data-bind="click: $parent.onNetworkClicked.bind($parent)"><div class=od-SharingByLink-icon><img data-bind="attr: {src: $parent.getNetworkIcon(network)}"></div><span data-bind="text: network.text"></span></a></div></div><!--/ko--></div><!--/ko--></div><!--/ko--></div>'}),define("odsp-next/controls/sharingByLink/SharingByLink.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-SharingByLink-loadingSpinner{text-align:center;padding:75px 0}.od-SharingByLink-iconCell{width:50px;vertical-align:top}.od-SharingByLink-icon{display:inline-block;background-color:#094AB2;color:#fff;font-size:20px;border-radius:50%;width:40px;height:40px}html[dir=ltr] .od-SharingByLink-icon{margin-right:20px}html[dir=rtl] .od-SharingByLink-icon{margin-left:20px}.od-SharingByLink-icon .ms-Icon--link{position:relative;top:6px}html[dir=ltr] .od-SharingByLink-icon .ms-Icon--link{left:7px}html[dir=rtl] .od-SharingByLink-icon .ms-Icon--link{right:7px}.od-SharingByLink-icon .ms-Icon--mail{position:relative;top:5px}html[dir=ltr] .od-SharingByLink-icon .ms-Icon--mail{left:10px}html[dir=rtl] .od-SharingByLink-icon .ms-Icon--mail{right:10px}.od-SharingByLink-networksRow .od-SharingByLink-icon{background:0 0}.od-SharingByLink-mailRow{white-space:nowrap}.od-SharingByLink-mailRow .od-SharingByLink-icon,.od-SharingByLink-networksRow .od-SharingByLink-icon{vertical-align:middle}.od-SharingByLink-linkSwitcher{display:inline-block;margin-bottom:10px}a.od-SharingByLink-linkSwitcher{cursor:pointer}.od-SharingByLink-url .od-SharingByLink-cell{width:100%}.od-SharingByLink-input{padding:3px;width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingByLink-input.is-disabled{color:#a6a6a6}button.od-SharingByLink-copyButton{padding:0 10px;height:1.9em}.od-SharingByLink-copyButton-label{position:relative;top:-1px}.od-SharingByLink-linkText,.od-SharingByLink-mailText,.od-SharingByLink-networkText{color:#333;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.od-SharingByLink-table{display:table;width:100%}.od-SharingByLink-row{display:table-row}.od-SharingByLink-cell{display:table-cell}.od-SharingByLink-linkSection,.od-SharingByLink-mailRow,.od-SharingByLink-networksRow{min-height:50px}")}),define("odsp-next/controls/sharingByLink/SharingByLink",["require","exports","./SharingByLinkViewModel","odsp-shared/utilities/knockout/ComponentFactory","./SharingByLink.html","./SharingByLink.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-sharebylink",template:e("./SharingByLink.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/sharingLinksSwitcher/SharingLinksSwitcherViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","odsp-utilities/async/Promise","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","odsp-utilities/logging/events/Engagement.event","../loadingSpinner/LoadingSpinner","../progressSpinnerFlat/ProgressSpinnerFlat","./SharingLinksSwitcher.resx","../../models/sharing/SharingLinkType","../../models/sharing/SharingRole","../../bindings/css/VisibilityBinding","../../utilities/features/Features","../commands/CommandViewModel","../../bindings/contextMenu/ContextMenuAlignment","../../bindings/dismiss/DismissBinding","../../utilities/selection/SelectionHelper","odsp-shared/utilities/string/StringHelper","../../actions/SwitchSharingLinkAction","../../bindings/html/BindableHtmlBinding","../../utilities/locale/Locale","../../bindings/focus/SelectOnFocusBinding"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g,f,b,y,v,S,x,w,k){var _=function(e){function t(t){var n=this;e.call(this,t),this.loadingSpinnerTagName=l.tagName,this.progressSpinnerFlatTagName=c.tagName,this._anonymousLinksEnabled=!1,this._organizationLinksEnabled=!1,t.item&&(this._item=t.item),this._stateArray=t.dialogStateArray||i.observable([]),this.addBindingHandlers({bindableHtml:x,dismiss:b,selectOnFocus:k,visibility:h}),this._selectionModel=this.resources.consume(r.itemsSelection),this._sharingProvider=this.resources.consume(s.sharing),this.loading=i.observable(!0),this.sharingLinksSelectorStrings=d.strings,this.isAnonymousLinkExpirationFeatureEnabled=m.default.isFeatureEnabled(m.default.AnonymousLinkExpiration),this.error=i.observable(""),this.links=i.observable([]),this._unsavedLinkType=i.observable(u.Direct),this.sharingLinkMenuItems=i.observableArray(),this.isSharingLinkMenuOpen=i.observable(!1),this.menuAlignment=i.observable(w.isRightToLeft?f.Left:f.Right),this.menuLeft=i.observable(w.isRightToLeft?"0":"auto"),this.linkSelectorCurrentLabelText=i.observable(""),this.currentSharingLink=Boolean(t.currentLink)?t.currentLink:i.observable(null),this.selectedSharingLinkType=i.observable(t.currentLink&&t.currentLink()?t.currentLink().type:u.Direct),this.editChecked=i.observable(!1),this.editVisible=i.observable(!0),this.isUpdatingLink=i.observable(!1),this.processingSharingLink=i.observable(!0),this.sharingLinkError=i.observable(""),this.linkExpirationMenuItems=i.observableArray(),this.isLinkExpirationMenuOpen=i.observable(!1),this.shouldShowLinkExpiration=i.observable(!1),this.shouldShowCustomExpiration=i.observable(!1),this.sharingLinkExpirationDate=i.observable(""),this.sharingLinkExpirationNumDays=i.observable(0),this.sharingLinkExpirationLabel=this.createComputed(function(){return 0===n.sharingLinkExpirationNumDays()?n.sharingLinksSelectorStrings.SetSharingLinkExpiration:n.sharingLinksSelectorStrings.UpdateSharingLinkExpiration
}),this._companyDisplayName=i.observable("");var o=this.resources.consume(s.suiteNav);o&&o.loadData().then(function(e){n._companyDisplayName(e.CompanyDisplayName),null!=n.currentSharingLink()&&n._setCurrentLinkLabelText(n.currentSharingLink().type)});var a=!1;this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection().length>1&&(a=!0);var g=this._sharingProvider.getSharingData(this._getCurrentItem());a||(null==this.currentSharingLink()?this.isReady=g.getBestSharingLink().then(function(e){e&&(n._setSelectedType(e.type),n._setCurrentSharingLink(e),n.editChecked(e.type===u.Edit||e.type===u.Organization&&e.role===p.Edit),n.processingSharingLink(!1))},function(){n._handleSharingLinkError()}):(this.editChecked(this.currentSharingLink().type===u.Edit||this.currentSharingLink().type===u.Organization&&this.currentSharingLink().role===p.Edit),this.processingSharingLink(!1))),this.isSingleLinkLabelVisible=!1,g.getSettings().done(function(e){n.canManageLinks=e.canManageLinks,n._anonymousLinksEnabled=e.anonymousLinksEnabled,n._organizationLinksEnabled=e.organizationLinksEnabled,null!=n.currentSharingLink()&&(n._setSelectedType(n.currentSharingLink().type),n._setCurrentSharingLink(n.currentSharingLink())),n.loading(!1)},function(){}),this._getSharingLinks().then(function(e){null!=e&&e.length>0&&(n.links(e),n.isSingleLinkLabelVisible=e.length<2,null==n.currentSharingLink()&&n._setSelectedType(e[0].type))},function(){n._handleSharingLinkError(),n.loading(!1)})}return __extends(t,e),t.prototype.onClickSharingLinkMenu=function(){var e=this,t=new g({text:this._getLinkLabelText(u.Direct),subtext:this._getLinkLabelSubtext(u.Direct),isToggleable:!1,callback:function(){e.menuItemClick(u.Direct),a.Engagement.logData({name:"SwitchToDirectLink.Menu.SharingLinksSwitcher.Click"})}}),i=new g({text:this._getLinkLabelText(u.Organization),subtext:this._getLinkLabelSubtext(u.Organization),isToggleable:!1,callback:function(){e.menuItemClick(u.Organization),a.Engagement.logData({name:"SwitchToOrganizationLink.Menu.SharingLinksSwitcher.Click"})}}),n=new g({text:this._getLinkLabelText(u.View),subtext:this._getLinkLabelSubtext(u.View),isToggleable:!1,callback:function(){e.menuItemClick(u.View),a.Engagement.logData({name:"SwitchToAnonymousLink.Menu.SharingLinksSwitcher.Click"})}}),o=[t];return this._organizationLinksEnabled&&o.push(i),this._anonymousLinksEnabled&&o.push(n),this.sharingLinkMenuItems(o),this.isSharingLinkMenuOpen(!this.isSharingLinkMenuOpen()),o},t.prototype.menuItemClick=function(e){this._setSelectedType(e),this._unsavedLinkType(e),this._setCurrentLinkLabelText(e)},t.prototype.onDismissSharingLinksMenu=function(){this.isSharingLinkMenuOpen(!1)},t.prototype.onClickLinkExpirationMenu=function(){var e=this;if(this.processingSharingLink())return null;var t=this,i=[],n=this._getAvailableExpirationOptions();return Object.keys(n).forEach(function(o){var r=n[o],s=!isNaN(r)&&r>=0?e._calculateLinkExpiration(r):"CUSTOM",a=new g({text:o,isToggleable:!1,callback:function(){t.expiryDateChanged(s,r/1440)}});i.push(a)}),this.linkExpirationMenuItems(i),this.isLinkExpirationMenuOpen(!this.isLinkExpirationMenuOpen()),i},t.prototype.expiryDateChanged=function(e,t){Boolean(e)&&"CUSTOM"===e?this.shouldShowCustomExpiration(!0):Boolean(e)?(this.sharingLinkExpirationNumDays(t),this.shouldShowCustomExpiration(!0)):(this.sharingLinkExpirationDate(null),this.sharingLinkExpirationNumDays(0),this.shouldShowCustomExpiration(!1))},t.prototype.onDismissLinkExpirationMenu=function(){this.isLinkExpirationMenuOpen(!1)},t.prototype.switchLinksClick=function(){var e=this,t=this.selectedSharingLinkType();t===u.View&&this.editChecked()&&(t=u.Edit);var i;this.links().forEach(function(n){n.type===t&&(t!==u.Organization||t===u.Organization&&n.role===p.Edit&&e.editChecked()||t===u.Organization&&n.role===p.View&&!e.editChecked())&&(i=n)}),i||(i={type:t,role:this.editChecked()?p.Edit:p.View,url:""});var n=i&&i.expiration;if(this.shouldShowLinkExpiration()){var r=parseInt(String(this.sharingLinkExpirationNumDays()),10);if(!(String(this.sharingLinkExpirationNumDays())===String(r)&&r>=0&&730>=r))return void this._handleSharingLinkError(this.sharingLinksSelectorStrings.LinkExpiration_InvalidValueErrorMessage);var l=1440;n=r>0?this._calculateLinkExpiration(r*l):null}var c,d=this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection();if(d&&d.length>1){var h=this.resources.consume(s.dialog);c=y.default.resolveSelection({selectionModel:this._selectionModel,dialogProvider:h})}else c=o.default.wrap({});c.then(function(t){var o=new(e.managed(S))({item:e._getCurrentItem(),items:t,link:i,expiration:n,isExecuting:e.isUpdatingLink,successCallback:function(t){if(e.shouldShowCustomExpiration(!1),null!=t){a.Engagement.logData(Boolean(n)?"CUSTOM"===n?{name:"SwitchTo"+t.tag+"Link.Custom.LinkExpiration.SharingLinksSwitcher.Click"}:{name:"SwitchTo"+t.tag+"Link.LinkExpiration.SharingLinksSwitcher.Click"}:{name:"SwitchTo"+t.tag+"Link.SharingLinksSwitcher.Click"}),e.currentSharingLink()&&t.type===e.currentSharingLink().type&&t.role===e.currentSharingLink().role&&t.expiration===e.currentSharingLink().expiration||(i.url=t.url,i.expiration=t.expiration,i.isActive=!!i.url,e._setCurrentSharingLink(i),e.processingSharingLink(!1));var o=e._stateArray();o.pop(),e._stateArray(o)}else e._handleSharingLinkError()},failureCallback:function(t){e._handleSharingLinkError(t)}});o.execute(null)})},t.prototype.onClickCancelCustomExpiration=function(){return this.processingSharingLink()?!1:(this.sharingLinkExpirationDate(null),this.sharingLinkExpirationNumDays(0),this.shouldShowCustomExpiration(!1),void this.sharingLinkError(""))},t.prototype._getAvailableExpirationOptions=function(){var e=this,t=[1,30,60],i=[],n=1440;return i[this.sharingLinksSelectorStrings.LinkExpiration_Never]=0,t.forEach(function(t){var o=1===t?e.sharingLinksSelectorStrings.LinkExpiration_SingleDay:v.format(e.sharingLinksSelectorStrings.LinkExpiration_MultiDay,t),r=t*n;i[o]=r}),i[this.sharingLinksSelectorStrings.LinkExpiration_Custom]=-1,i},t.prototype._getSharingLinks=function(){var e=this,t=this._sharingProvider.getSharingData(this._getCurrentItem());return t.getLinks().then(function(e){return e},function(){return e.error(e.sharingLinksSelectorStrings.ServerError),null})},t.prototype._setSelectedType=function(e){e===u.Edit&&(e=u.View),this.selectedSharingLinkType(e),this._setCurrentLinkLabelText(e),this.editVisible(e===u.Direct?!1:!0),this.shouldShowLinkExpiration(e!==u.View&&e!==u.Edit?!1:this.isAnonymousLinkExpirationFeatureEnabled)},t.prototype._setCurrentSharingLink=function(e){if(e&&(this.currentSharingLink(e),this._setCurrentLinkLabelText(e.type),this.shouldShowLinkExpiration(this.isAnonymousLinkExpirationFeatureEnabled&&e.supportsExpiration),e.supportsExpiration)){var t=e.expiration?new Date(e.expiration).toLocaleDateString():null,i=e.expiration?Math.abs(new Date(e.expiration).getTime()-(new Date).getTime()):0,n=Math.ceil(i/864e5);this.sharingLinkExpirationNumDays(n),this.sharingLinkExpirationDate(t?v.format(this.sharingLinksSelectorStrings.LinkExpiration_DateDescription,t):"")}},t.prototype._setCurrentLinkLabelText=function(e){this.linkSelectorCurrentLabelText(this._getLinkLabelText(e))},t.prototype._getLinkLabelSubtext=function(e){switch(e){case u.Direct:return this.sharingLinksSelectorStrings.DirectLinkSubtext;case u.Organization:return Boolean(this._companyDisplayName())?v.format(this.sharingLinksSelectorStrings.OrganizationSubtext,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case u.View:case u.Edit:return this.sharingLinksSelectorStrings.AnonymousLinkSubtext}return""},t.prototype._getLinkLabelText=function(e){switch(e){case u.Direct:return this.sharingLinksSelectorStrings.DirectLinkLabel;case u.Organization:return Boolean(this._companyDisplayName())?v.format(this.sharingLinksSelectorStrings.OrganizationTenantAccountRequired,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case u.View:case u.Edit:return this.sharingLinksSelectorStrings.NoSignInRequiredLabel}return""},t.prototype._calculateLinkExpiration=function(e){if(e>0){var t=new Date;return t.setMinutes(t.getMinutes()+e),t.toString()}return null},t.prototype._getCurrentItem=function(){return this._item?this._item:i.utils.unwrapObservable(this._selectionModel.selection()[0])},t.prototype._handleSharingLinkError=function(e){this.processingSharingLink(!1),this.sharingLinkError(Boolean(e)?e:this.sharingLinksSelectorStrings.ServerError)},t}(n);return _}),define("odsp-next/controls/sharingLinksSwitcher/SharingLinksSwitcher.html",[],function(){return'<!--ko if:loading--><div class=od-SharingLinksSwitcher-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div><!--/ko--><!--ko ifnot:loading--><div aria-live=assertive class=od-SharingLinksSwitcher-error data-bind="if: error"><span data-bind="text: error"></span></div><div class=od-SharingLinksSwitcher-sharingLinkSelector><div class=od-SharingLinksSwitcher-linkPickerArea><span class=od-SharingLinksSwitcher-linkLabel data-bind="text: sharingLinksSelectorStrings.LinkLabelText"></span><!--ko if:isSingleLinkLabelVisible--><span class=od-SharingLinksSwitcher-linkInput-label data-bind="text: linkSelectorCurrentLabelText()"></span><!--/ko--><!--ko ifnot:isSingleLinkLabelVisible--><a href=javascript:; class="od-SharingLinksSwitcher-dropdownLinkContainer ms-font-color-neutralPrimary ms-lines ms-fullWidth" aria-haspopup=true data-bind="click: onClickSharingLinkMenu, hasFocus: true, dismiss: onDismissSharingLinksMenu, attr: {\'aria-expanded\': isSharingLinkMenuOpen}"><span class=od-SharingLinksSwitcher-dropdownText data-bind="text: linkSelectorCurrentLabelText()"></span> <i class="ms-Icon ms-Icon--chevronDown od-SharingLinksSwitcher-dropdownArrow" data-bind="title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: sharingLinkMenuItems, isOpen: isSharingLinkMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu><!--/ko--></div><!--ko if: editVisible--><div><input type=checkbox id=od-SharingLinkSwitcher-canEdit data-bind="checked: editChecked"> <label for=od-SharingLinkSwitcher-canEdit data-bind="text: sharingLinksSelectorStrings.CanEditLabel"></label></div><!--/ko--><!--ko if:shouldShowLinkExpiration--><div class=od-SharingLinksSwitcher-linkExpirationArea><div data-bind="visible: !shouldShowCustomExpiration(), automation: \'SharingLinksSwitcher-expiration-selector\'"><span class=od-SharingLinksSwitcher-expiration-expirationText data-bind="visible: Boolean(sharingLinkExpirationDate()), text: sharingLinkExpirationDate, automation: \'SharingLinksSwitcher-expiration-expirationSpan\'"></span> <span class=od-SharingLinksSwitcher-LinkExpirationMenuArea><a tabindex=0 class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-dropdownLinkContainer" aria-haspopup=true data-bind="click: onClickLinkExpirationMenu, dismiss: onDismissLinkExpirationMenu, attr: {\'aria-expanded\': isLinkExpirationMenuOpen}"><span class="od-SharingLinksSwitcher-expiration-dropdownText ms-uppercase" data-bind="text: sharingLinkExpirationLabel"></span> <i class="ms-Icon ms-Icon--chevronDown ms-callout-icon od-SharingLinksSwitcher-expiration-dropdownArrow" data-bind="title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: linkExpirationMenuItems, isOpen: isLinkExpirationMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></span></div><div class=ms-fullWidth data-bind="visible: shouldShowCustomExpiration"><div class=od-SharingLinksSwitcher-expiration-expirationText><span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_BeforeTextBox"></span> <input type=text class=od-SharingLinksSwitcher-expirationInput data-bind="selectOnFocus, value:sharingLinkExpirationNumDays, title:sharingLinksSelectorStrings.LinkExpiration_CustomValueTooltip"> <span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_AfterTextBox"></span></div><div class=od-SharingLinksSwitcher-expiration-buttons><a href=javascript:; class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-expirationSave" data-bind="click: onClickCancelCustomExpiration, text: sharingLinksSelectorStrings.CancelCustomExpiration, automation: \'SharingLinksSwitcher-expiration-cancelLink\'"></a></div></div></div><!--/ko--><div class=od-SharingLinksSwitcher-rightArea><!--ko if: isUpdatingLink--><div class=od-SharingLinksSwitcher-processing data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: \'\' } }"></div><!--/ko--><button class="ms-Dialog-action ms-Button" data-bind="css: { \'ms-Button--primary\': true }, click: switchLinksClick, enable: !isUpdatingLink()"><span class=ms-Button-label data-bind="text: sharingLinksSelectorStrings.OkayButtonLabel"></span></button></div><div aria-live=assertive class=od-SharingLinksSwitcher-error data-bind="if: sharingLinkError"><span data-bind="text: sharingLinkError"></span></div></div><!--/ko-->'}),define("odsp-next/controls/sharingLinksSwitcher/SharingLinksSwitcher.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles("html[dir=ltr] .od-SharingLinksSwitcher-rightArea{float:right}html[dir=rtl] .od-SharingLinksSwitcher-rightArea{float:left}.od-SharingLinksSwitcher-processing{display:inline-block;padding-bottom:7px;vertical-align:bottom}html[dir=ltr] .od-SharingLinksSwitcher-processing{padding-right:5px}html[dir=rtl] .od-SharingLinksSwitcher-processing{padding-left:5px}.od-SharingLinksSwitcher-loadingSpinner{text-align:center;padding:75px 0}.od-SharingLinksSwitcher-linkInput-label{color:#666;display:block;padding-top:5px}.od-SharingLinksSwitcher-linkLabel{display:block;padding-bottom:5px}.od-SharingLinksSwitcher-updateLinkButton{color:#333;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;text-transform:uppercase;white-space:nowrap;display:inline-block;cursor:pointer}a.od-SharingLinksSwitcher-updateLinkButton{color:#0078d7;text-decoration:none}.od-SharingLinksSwitcher-linksSection{padding-bottom:20px}.od-SharingLinksSwitcher-error{color:#a80000}.od-SharingLinksSwitcher-linkPickerArea{margin-bottom:14px}.od-SharingLinksSwitcher-dropdownLinkContainer{color:inherit;display:inline-block;box-sizing:border-box;border:1px solid #666;width:100%;padding:4px 10px 2px}@media (max-width:639px){.od-SharingLinksSwitcher-dropdownLinkContainer{width:223px}}.od-SharingLinksSwitcher-dropdownLinkContainer:hover,.od-SharingLinksSwitcher-dropdownLinkContainer:visited{color:inherit;text-decoration:none}.od-SharingLinksSwitcher-dropdownArrow,.od-SharingLinksSwitcher-expiration-dropdownArrow{display:inline-block;position:relative;top:5px}html[dir=ltr] .od-SharingLinksSwitcher-dropdownArrow,html[dir=ltr] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:right}html[dir=rtl] .od-SharingLinksSwitcher-dropdownArrow,html[dir=rtl] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:left}.od-SharingLinksSwitcher-linkTypeText{padding:10px}.od-SharingLinksSwitcher-expiry-div{border-collapse:separate}.od-SharingLinksSwitcher-singleLinkLabel{display:inline-block;width:433px;padding:4px 0;margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharingLinksSwitcher-dropdownText{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639px){.od-SharingLinksSwitcher-singleLinkLabel{width:223px}.od-SharingLinksSwitcher-dropdownText{width:183px}}.od-SharingLinksSwitcher-expiration-dropdownText{display:inline-block;overflow:hidden}.od-SharingLinksSwitcher-linkBoxArea{margin-bottom:5px}.od-SharingLinksSwitcher-sharingLinkSelector .od-SharingLinksSwitcher-linkInput-textbox{box-sizing:border-box;width:95%}.od-SharingLinksSwitcher-linkExpirationArea{margin-bottom:7px}.od-SharingLinksSwitcher-LinkExpirationMenuArea{display:inline-block}.od-SharingLinksSwitcher-expiration-dropdownLinkContainer{display:inline-block;vertical-align:middle}.od-SharingLinksSwitcher-expiration-expirationText{display:inline-block}html[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationText{padding-right:10px}html[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationText{padding-left:10px}.od-SharingLinksSwitcher-expirationInput{display:inline-block;width:30px;margin-top:-5px;cursor:text}.od-SharingLinksSwitcher-expiration-buttons{display:inline-block}.od-SharingLinksSwitcher-expiration-expirationSave{display:inline-block;vertical-align:text-bottom}html[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationSave{margin-right:10px}html[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationSave{margin-left:10px}.od-SharingLinksSwitcher-expiration-expirationError{margin-top:6px}.od-SharingLinksSwitcher-sharingLinkSelector a.od-ContextualMenu-item{padding:10px}#od-SharingLinkSwitcher-canEdit{display:inline-block;vertical-align:sub;margin-bottom:15px}html[dir=ltr] #od-SharingLinkSwitcher-canEdit{margin-right:5px}html[dir=rtl] #od-SharingLinkSwitcher-canEdit{margin-left:5px}")}),define("odsp-next/controls/sharingLinksSwitcher/SharingLinksSwitcher",["require","exports","./SharingLinksSwitcherViewModel","odsp-shared/utilities/knockout/ComponentFactory","./SharingLinksSwitcher.html","./SharingLinksSwitcher.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-sharingLinksSwitcher",template:e("./SharingLinksSwitcher.html"),viewModel:i});return o}),define("odsp-next/controls/sharingWizard/SharingWizardTemplates",["require","exports","./SharingWizardState","./SharingWizard.resx","../sharingByLink/SharingByLink","../sharedWith/SharedWith","../sharing/Sharing","../sharingLinksSwitcher/SharingLinksSwitcher"],function(e,t,i,n,o,r,s,a){function l(e){"use strict";switch(e){case i.shareByLink:return o.tagName;case i.sharedWith:return r.tagName;case i.invite:return s.tagName;case i.createLink:case i.switchLinks:return a.tagName;default:return o.tagName}}function c(e){"use strict";switch(e){case i.invite:case i.shareByLink:return n.strings.SharedWithText;case i.sharedWith:return n.strings.AddPeopleText}}function d(e){"use strict";switch(e){case i.shareByLink:case i.invite:return i.sharedWith;case i.sharedWith:return i.invite;default:return i.shareByLink}}t.getTemplateName=l,t.getActionName=c,t.getBottomAction=d});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/sharingWizard/SharingWizardViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../providers/sharing/CachedSharingProvider","../loadingSpinner/LoadingSpinner","./SharingWizardState","./SharingWizardTemplates","odsp-utilities/logging/events/Engagement.event","../sharingWizard/SharingWizard.resx","odsp-shared/utilities/string/StringHelper","../../bindings/css/VisibilityBinding"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h){var m=function(e){function t(t){var n=this;e.call(this,t),this.loadingSpinnerTagName=a.tagName,this._params=t,this.addBindingHandlers({visibility:h}),this._sharingProvider=this.resources.expose(r.sharing,new(this.managed(s))),this._selectionModel=this.resources.consume(o.itemsSelection),this._stateStack=t.stateArray,this._currentState=this.createComputed(function(){return this._stateStack()[this._stateStack().length-1]}),this.currentLink=i.observable(null),this._item=t.item,this.componentDefinition=this.createComputed(function(){return n._getComponentDefinition()}),this.bottomActionText=this.createComputed(function(){return c.getActionName(n._currentState())}),this.showBottomAction=this.createPureComputed(function(){return n._currentState()!==l.switchLinks}),this.isLoading=i.observable(!0),this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection().length>1?(this._shareDialogTitle=p.format(u.strings.MultiShareTitleText,this._selectionModel.selection().length),this._params.dialogTitle(this._shareDialogTitle),this.isLoading(!1)):this._getSharingSettings()}return __extends(t,e),t.prototype.switchComponents=function(){var e=this._stateStack(),t=c.getBottomAction(this._currentState());switch(e.push(t),t){case l.sharedWith:d.Engagement.logData({name:"SharedWith.SharingWizard.Click"});break;case l.invite:d.Engagement.logData({name:"AddPeople.SharingWizard.Click"})}this._stateStack(e)},t.prototype._getSharingSettings=function(){var e=this,t=this._getCurrentItem(),i=this._sharingProvider.getSharingData(t);this.isReady=i.getSettings().then(function(t){e._sharingSettings=t,e._shareDialogTitle=p.format(u.strings.TitleText,t.itemName),e._params.dialogTitle(e._shareDialogTitle),e.isLoading(!1)},function(){e._shareDialogTitle=p.format(u.strings.TitleText,t.name),e._params.dialogTitle(e._shareDialogTitle),e.isLoading(!1)})},t.prototype._getCurrentItem=function(){return this._item?this._item:i.utils.unwrapObservable(this._selectionModel.selection()[0])},t.prototype._getComponentDefinition=function(){var e=c.getTemplateName(this._currentState()),t={item:this._item,dialogStateArray:this._stateStack,includeLinks:!0,currentLink:this.currentLink,height:"500px",canToggleEditInline:this._params.canToggleEditInline};return this._params.dialogTitle(this._currentState()===l.switchLinks?u.strings.SwitchLink:this._shareDialogTitle),this._currentState()===l.invite&&(t={selectedPeople:i.observableArray([]),roleValue:i.observable(""),emailMessage:i.observable(""),errorMessage:i.observable(""),sendEmail:i.observable(!0),requireSignIn:i.observable(!0),propagateSharing:i.observable(!1),hasUnresolvedText:i.observable(!1),dialogTitle:i.observable(""),hideOptions:!0,onExecuteAction:this._params.onExecuteAction,item:this._item}),{name:e,params:t}},t}(n);return m}),define("odsp-next/controls/sharingWizard/SharingWizard.html",[],function(){return'<div class=od-SharingWizard><!--ko if: isLoading--><div class=od-SharingWizard-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div><!--/ko--><!--ko ifnot: isLoading--><div class=od-SharingWizard-component data-bind="component: componentDefinition"></div><div class=od-SharingWizard-bottom data-bind="visibility: showBottomAction"><a class=od-SharingWizard-text href=# data-bind="click: switchComponents, text: bottomActionText"></a></div><!--/ko--></div>'}),define("odsp-next/controls/sharingWizard/SharingWizard.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".ms-Dialog-content .od-SharingWizard{margin:-16px -32px -20px}.od-SharingWizard-loadingSpinner{margin-top:90px;text-align:center;margin-bottom:90px}.od-SharingWizard-component{padding:10px 32px}.od-SharingWizard-bottom{background-color:#f4f4f4}.od-SharingWizard-text{margin:15px 32px;display:inline-block;color:#333;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}")}),define("odsp-next/controls/sharingWizard/SharingWizard",["require","exports","./SharingWizardViewModel","odsp-shared/utilities/knockout/ComponentFactory","../sharingByLink/SharingByLink","./SharingWizard.html","./SharingWizard.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-shareWizard",template:e("./SharingWizard.html"),viewModel:i,synchronous:!0});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/ShareByLinkAction",["require","exports","knockout","odsp-utilities/async/Promise","../base/BaseSelectionAction","../resources/ProviderResourceKeys","../controls/sharingWizard/SharingWizard","../models/dialog/DialogState","odsp-utilities/logging/events/Qos.event","../utilities/browser/WindowSize","../models/item/ItemType","../controls/sharingWizard/SharingWizardState","../controls/sharingWizard/SharingWizard.resx","odsp-utilities/logging/events/Engagement.event","../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m){var g=function(e){function t(t){e.call(this,t),this.name="ShareByLink",this.canFallbackToParent=!1,this.isSingleSelectAction=!0,this.canToggleEditInline=!1,this._initialState=t&&t.startState?[u.shareByLink,t.startState]:[u.shareByLink]}return __extends(t,e),t.prototype.onSelectionExecute=function(e){var t=this.resources.consume(r.dialog),o=i.observable(this._initialState),g=i.observable(""),f=t.requestDialog({title:g,size:c.Medium,component:{name:s.tagName,params:{item:e[0],items:e,dialogTitle:g,stateArray:o,canToggleEditInline:this.canToggleEditInline,onExecuteAction:function(){return f.state(a.completed)}}},titleAction:{name:p.strings.BackButtonText,execute:function(){var e=o(),t=e.pop();switch(t){case u.sharedWith:h.Engagement.logData({name:"GoBackSharedWith.SharingWizard.Click"});break;case u.invite:h.Engagement.logData({name:"GoBackAddPeople.SharingWizard.Click"})}return o(e),n.default.wrap(a.opened)},icon:m.arrowLeft,isVisible:i.pureComputed(function(){return o().length>1})}});return f.wait().then(function(){var t={},i={count:e.length};return 1===e.length&&(t.fileType=d[e[0].type],t.extension=e[0].extension||""),{resultType:l.ResultTypeEnum.Success,extraData:t,extraMetrics:i}})},t}(o);return g});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/ShowPropertiesAction",["require","exports","knockout","../base/BaseSelectionAction","odsp-utilities/async/Promise","../resources/PagesResourceKeys","odsp-utilities/logging/events/Qos.event"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){e.call(this,t),this.name="ShowProperties",this.isSingleSelectAction=!0,this._useToggleBehavior=t?t.useToggleBehavior:!1}return __extends(t,e),t.prototype.onSelectionExecute=function(){try{var e=this.resources.consume(r.files.isInfoPaneExpanded);return e(!this._useToggleBehavior||!e()),i.utils.triggerEvent(document.body,"resize"),o.default.wrap({resultType:s.ResultTypeEnum.Success})}catch(t){return o.default.wrap({resultType:s.ResultTypeEnum.Failure})}},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){return this.resources.consume(r.files.isInfoPaneExpanded)()},t}(n);return a});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/ShowSelectionAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/UtilityResourceKeys"],function(e,t,i,n,o,r){var s=function(e){function t(t){e.call(this,t),this.name="ShowSelection",this._mobile=this.resources.consume(r.mobile)}return __extends(t,e),t.prototype.onIsAvailable=function(){return this.selectionModel.selection().length>0},t.prototype.onExecute=function(){var e=this._mobile.showItemCheck.peek();return this.selectionModel.selection.peek().length>0?(this.selectionModel.clear(),this._mobile.showItemCheck(!1)):this._mobile.showItemCheck(!e),n.default.wrap({resultType:o.ResultTypeEnum.Success})},t}(i);return s});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/ToggleListLayoutAction",["require","exports","../base/BaseItemAction","../resources/PagesResourceKeys","../controls/list/layouts/LayoutType","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/RequireHelper"],function(e,t,i,n,o,r,s,a){var l=function(t){function i(e){t.call(this,e),this.name="ToggleListLayout",this.layoutType=e.layoutType}return __extends(i,t),i.prototype.onExecute=function(){var t=this,i=this.resources.consume(n.files.layoutType),l=a.promise(e,"../controls/list/"+o.Path[this.layoutType]);l.then(function(){i(t.layoutType)});var c={layout:this.layoutType};return r.default.wrap({resultType:s.ResultTypeEnum.Success,extraData:c})},i.prototype.onIsAvailable=function(){return!this.onIsToggled()},i.prototype.onIsToggled=function(){return this.layoutType===this.resources.consume(n.files.layoutType)()},i}(i);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/UploadAction",["require","exports","../UploadAction","./PermissionMask"],function(e,t,i,n){var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.onIsAvailable=function(){return e.prototype.onIsAvailable.call(this)&&n.hasItemPermission(this.item(),n.InsertListItems)},t}(i);return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/UndoCheckOutAction",["require","exports","knockout","../../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../../resources/ProviderResourceKeys","./ActionHelper","../../controls/commands/Commands.resx","../../controls/textContainer/TextContainer","../../models/dialog/DialogState","./PermissionMask","../../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){var h=function(e){function t(){e.apply(this,arguments),this.name="UndoCheckOut",this.isSingleSelectAction=!0}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return a.isNotFolder(t)&&a.isCheckedOut(t)&&u.hasItemPermission(t,u.EditListItems)&&u.hasItemPermission(t,u.CancelCheckout)},t.prototype.onSelectionExecute=function(e){var t=this.resources.consume(s.versionControl),n=this.item(),a=e[0],u=l.strings.undoCheckoutConfirmText,h=l.strings.undoCheckoutConfirmTitle,m=this.resources.consume(s.dialog),g=m.requestDialog({title:h,component:{name:c.tagName,params:{text:u}},actions:[{name:l.strings.UndoCheckOut,execute:function(){return o.default.wrap(d.completed)},isAvailable:i.observable(!0),icon:p.x,isDefault:!0}]});return g.wait().then(function(){return t.undoCheckOutItem({parentKey:n.key,item:a}).then(function(){return{resultType:r.ResultTypeEnum.Success}},function(){return{resultType:r.ResultTypeEnum.Failure}})})},t}(n);return h});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/checkInEditor/CheckInEditorViewModel",["require","exports","odsp-shared/base/ViewModel","./CheckInEditor.resx"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.commentsPlaceholder=n.strings.CommentsPlaceholder,this.commentsLabel=n.strings.CommentsLabel,this.comments=t.comments}return __extends(t,e),t}(i);return o}),define("odsp-next/controls/checkInEditor/CheckInEditor.html",[],function(){return'<div class=CheckInEditor><div class="ms-TextField ms-TextField--multiline"><label class=ms-Label for=CheckInEditorTextArea data-bind="text: commentsLabel"></label> <textarea id=CheckInEditorTextArea class="CheckInEditor-textarea ms-TextField-field" rows=5 cols=45 title=commentsLabel data-bind="value: comments, textInput: comments, hasFocus: true, attr: { placeholder: commentsPlaceholder }"></textarea></div></div>'}),define("odsp-next/controls/checkInEditor/CheckInEditor.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".CheckInEditor-textarea{overflow:auto;width:100%;border:1px solid #c8c8c8;border-radius:0;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;color:#333}.CheckInEditor-textarea:hover{border-color:#767676}.CheckInEditor-textarea:focus{border-color:#094AB2}")
}),define("odsp-next/controls/checkInEditor/CheckInEditor",["require","exports","./CheckInEditorViewModel","odsp-shared/utilities/knockout/ComponentFactory","./CheckInEditor.html","./CheckInEditor.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-checkin-dialog-builder",template:e("./CheckInEditor.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/CheckInAction",["require","exports","knockout","../../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../../resources/ProviderResourceKeys","../../controls/commands/Commands.resx","../../controls/checkInEditor/CheckInEditor","../../models/dialog/DialogState","./ActionHelper","./PermissionMask","../../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){var h=function(e){function t(){e.apply(this,arguments),this.name="CheckIn",this.isSingleSelectAction=!0}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return d.isNotFolder(t)&&d.isCheckedOut(t)&&u.hasItemPermission(t,u.EditListItems)},t.prototype.onSelectionExecute=function(e){var t=this.resources.consume(s.dialog),n=this.resources.consume(s.versionControl),d=this.item(),u=e[0],h=i.observable(""),m=t.requestDialog({title:a.strings.CheckIn,component:{name:l.tagName,params:{comments:h}},actions:[{name:a.strings.CheckInCommit,execute:function(){return o.default.wrap(c.completed)},isAvailable:i.observable(!0),isDefault:!0,icon:p.save,automationId:"checkInDialogCommit"}]});return m.wait().then(function(){return n.checkInItem({parentKey:d.key,item:u,comments:h()}).then(function(){return{resultType:r.ResultTypeEnum.Success}},function(){return{resultType:r.ResultTypeEnum.Failure}})})},t}(n);return h});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/versionHistoryViewer/VersionHistoryViewerViewModel",["require","exports","odsp-shared/base/ViewModel","../../resources/ProviderResourceKeys","../../resources/UtilityResourceKeys","knockout"],function(e,t,i,n,o,r){var s=function(e){function t(t){e.call(this,t),this.isLoading=r.observable(!0),this.showInDialog=t.showInDialog,this.iframeLoaderParams={url:t.versionHistoryUrl,showLoadingLabel:!0,onload:this.iframeOnLoad.bind(this),isLoading:this.isLoading}}return __extends(t,e),t.prototype.iframeOnLoad=function(e){var t=e.target;if(t&&t.contentWindow){var i=t.contentWindow.document;this.showInDialog&&(this._appendIsDlgToAllSortHrefs(i),this._setupIframeElementFunctions(t)),this.isLoading(!1);var n=i.getElementsByClassName("ms-settingsframe"),o=null;n.length>0&&(o=n[0]),t.style.width=(o?o.clientWidth:i.body.clientWidth)+"px",t.style.height=.85*i.body.clientHeight+"px";var r=i.getElementById("s4-workspace");r&&(r.style.height=t.style.height)}},t.prototype._appendIsDlgToHref=function(e){e&&e.href&&-1===e.href.indexOf("&IsDlg=1")&&(e.href+="&IsDlg=1")},t.prototype._appendIsDlgToAllSortHrefs=function(e){for(var t=["diidVersionsSortNumber","diidVersionsSortModified","diidVersionsSortModifiedBy","diidVersionsSortSize","diidVersionsSortComments"],i=0;i<t.length;i++){var n=e.getElementById(t[i]);this._appendIsDlgToHref(n)}},t.prototype._setupIframeElementFunctions=function(e){var t=this,i=function(){var e=t.resources.consume(n.dialog);e.currentDialog().dismiss()},r=function(){var e=t.resources.consume(n.dialog);e.currentDialog().complete()},s=function(e){var i=t.resources.consume(o.navigation);i.navigateTo(e)};e.cancelPopUp=i,e.commitPopup=r,e.navigateParent=s},t}(i);return s}),define("odsp-next/controls/versionHistoryViewer/VersionHistoryViewer.html",[],function(){return"<div class=od-VersionHistoryViewer><!--ko component: { name: 'ms-iframe-loader', params: iframeLoaderParams }--><!--/ko--></div>"}),define("odsp-next/controls/versionHistoryViewer/VersionHistoryViewer.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-VersionHistoryViewer iframe{border:none;width:100%}.od-VersionHistoryViewer .od-VersionHistoryViewer-ProgressContainer{width:250px;padding:15px 0}")}),define("odsp-next/controls/versionHistoryViewer/VersionHistoryViewer",["require","exports","./VersionHistoryViewerViewModel","odsp-shared/utilities/knockout/ComponentFactory","./VersionHistoryViewer.html","./VersionHistoryViewer.css","../iframeLoader/IframeLoader"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-version-history-viewer",template:e("./VersionHistoryViewer.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/ShowVersionHistoryAction",["require","exports","../../base/BaseSelectionAction","odsp-utilities/logging/events/Qos.event","../../utilities/browser/WindowSize","../../resources/ProviderResourceKeys","../../controls/commands/Commands.resx","../../controls/versionHistoryViewer/VersionHistoryViewer","./ActionHelper","./PermissionMask"],function(e,t,i,n,o,r,s,a,l,c){var d=function(e){function t(){e.apply(this,arguments),this.name="VersionHistory",this.isSingleSelectAction=!0}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return l.isNotFolder(t)&&c.hasItemPermission(t,c.ViewVersions)},t.prototype.onSelectionExecute=function(e){var t=this.resources.consume(r.dialog),i=this.resources.consume(r.item),l=this.resources.consume(r.versionControl),c=this.item(),d=e[0],u=l.getVersionHistoryUrl(d.id),p=t.requestDialog({title:s.strings.ShowVersionHistory,size:o.XLarge,component:{name:a.tagName,params:{versionHistoryUrl:u,showInDialog:!0}},actions:[]});return p.wait().then(function(){return i.invalidateItem(c.key),{resultType:n.ResultTypeEnum.Success}})},t}(i);return d});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/ClearSelectionAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event"],function(e,t,i,n,o){var r=function(e){function t(){e.apply(this,arguments),this.name="ClearSelection"}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e){return e>0},t.prototype.onExecute=function(){return this.selectionModel.clear(),n.default.wrap({resultType:o.ResultTypeEnum.Success})},t}(i);return r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/RenameAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ControlResourceKeys","../resources/ProviderResourceKeys","../controls/commands/Commands.resx","../controls/itemNameEditor/ItemNameEditor","../models/dialog/DialogState","knockout","../resources/DataSourceResourceKeys","../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){var h=function(e){function t(t){e.call(this,t),this.name="Rename",this.canFallbackToParent=!0,this.isSingleSelectAction=!0,this._dialogProvider=this.resources.consume(s.dialog),this._operatorProvider=this.resources.consume(s.operator),this._urlDataSource=this.resources.consume(u.url),this._parentItem=this.resources.consume(r.currentItem)}return __extends(t,e),t.prototype.onSelectionExecute=function(e){return this.executeRenameOperation(e,!1)},t.prototype.executeRenameOperation=function(e,t){var i=this,r=e[0],s=r.properties.FileName||r.name,u=r.extension;t&&(s+=r.extension,u=null);var h=d.observable(s),m=d.observable(""),g=d.observable(!1),f=d.observable(!0),b=d.observable(!0),y=function(){return h()===s?n.default.wrap(c.completed):(m(a.strings.Saving),f(!1),g(!1),i._operatorProvider.renameItem({parentKey:i._parentItem().key,newName:h(),nameHasExtension:t,item:r,ownerId:i._urlDataSource?i._urlDataSource.getOwnerId():""}).then(function(){return c.completed},function(e){return g(!0),f(!0),b(!0),m(e.message),c.opened}))},v=this._dialogProvider.requestDialog({title:a.strings.Rename,component:{name:l.tagName,params:{name:h,extension:u,status:m,hasError:g,isEnabled:f,hasFocus:b}},actions:[{name:a.strings.RenameCommit,execute:y,isDefault:!0,isAvailable:f,automationId:"renameDialogCommit",icon:p.save}]});return v.wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})},t}(i);return h});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/RenameAction",["require","exports","../RenameAction","./PermissionMask"],function(e,t,i,n){var o=function(e){function t(){e.apply(this,arguments),this.canFallbackToParent=!1}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return n.hasItemPermission(t,n.EditListItems)},t}(i);return o}),define("odsp-next/utilities/protocolHandler/ProtocolHandlerHelper",["require","exports"],function(){var e=function(){function e(){}return e.CreateProtocolHandlerUrl=function(e,t,i,n,o){var r=[],s=e.split("|");return 2===s.length?(r.push(s[0]),r.push(":"),r.push(t),r.join("")):(3===s.length&&(e=s[0]),r.push(e),r.push(":"),r.push(i),r.push("|u|"),r.push(t),i===this.protocolCommand.New&&(r.push("|s|"),r.push(n)),o?encodeURI(r.join("")):r.join(""))},e.protocolCommand={View:"ofv",Edit:"ofe",New:"nft"},e}();return e});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/OpenInClientAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","../utilities/protocolHandler/ProtocolHandlerHelper","odsp-utilities/logging/events/Qos.event","../resources/DataSourceResourceKeys","../resources/UtilityResourceKeys"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){e.call(this,t),this.name="OpenInClient",this.isSingleSelectAction=!0}return __extends(t,e),t.prototype.onSelectionExecute=function(e){var t=e[0],i=t.appMap,l=this.resources.consume(s.url),c=l.getItemUrl(t.key),d=this.resources.consume(a.platformDetection),u=o.CreateProtocolHandlerUrl(i,c,o.protocolCommand.View,"",d.isChrome&&d.isMac);return window.location.href=u,n.default.wrap({resultType:r.ResultTypeEnum.Success})},t.prototype.onSelectionIsAvailable=function(e,t){return!!(t&&t.openUrl&&t.appMap)},t}(i);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/keyboardMap/KeyboardMapViewModel",["require","exports","odsp-shared/base/ViewModel","../../resources/UtilityResourceKeys","./KeyboardMap.resx"],function(e,t,i,n,o){var r=function(e){function t(t){e.call(this,t),this.strings=o.strings;var i=this.resources.consume(n.platformDetection);this.isMac=i.isMac,this.isPC=!i.isMac}return __extends(t,e),t}(i);return r}),define("odsp-next/controls/keyboardMap/KeyboardMap.html",[],function(){return'<div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="attr: { \'aria-label\': strings.arrowsAria }">&uarr; &darr; &larr; &rarr;</span> <span class=od-KeyboardMap-val data-bind="text: strings.arrowsDesc"></span></li><!--ko if: isMac--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="attr: { \'aria-label\': strings.selectAllMacAria }, text: strings.selectAllMacKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.selectAllDesc"></span></li><!--/ko--><!--ko if: isPC--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="attr: { \'aria-label\': strings.selectAllPCAria }, text: strings.selectAllPCKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.selectAllDesc"></span></li><!--/ko--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="attr: { \'aria-label\': strings.escAria }, text: strings.escKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.escDesc"></span></li><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.spaceKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.spaceDesc"></span></li><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.enterKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.enterDesc"></span></li><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.showNewKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.showNewDesc"></span></li></ul></div><div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.renameKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.renameDesc"></span></li><!--ko if: isMac--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="attr: { \'aria-label\': strings.deleteMacAria }, text: strings.deleteMacKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.deleteDesc"></span></li><!--/ko--><!--ko if: isPC--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.deletePCKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.deleteDesc"></span></li><!--/ko--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.createFolderKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.createFolderDesc"></span></li><!--ko if: strings.uploadKey && strings.uploadDesc--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.uploadKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.uploadDesc"></span></li><!--/ko--><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.toggleInfoKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.toggleInfoDesc"></span></li><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.toggleViewKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.toggleViewDesc"></span></li><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.showKeymapKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.showKeymapDesc"></span></li><li class=od-KeyboardMap-row><span class=od-KeyboardMap-key data-bind="text: strings.showShareKey"></span> <span class=od-KeyboardMap-val data-bind="text: strings.showShareDesc"></span></li></ul></div>'}),define("odsp-next/controls/keyboardMap/KeyboardMap.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-KeyboardMap-group{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.od-KeyboardMap-table{display:table;list-style:none;margin:0;padding:0}.od-KeyboardMap-row{display:table-row}.od-KeyboardMap-row span{display:table-cell}.od-KeyboardMap-key{color:#094AB2;min-width:50px}.od-KeyboardMap-val{padding:4px 8px}")}),define("odsp-next/controls/keyboardMap/KeyboardMap",["require","exports","./KeyboardMapViewModel","odsp-shared/utilities/knockout/ComponentFactory","./KeyboardMap.html","./KeyboardMap.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"od-keyboard-map",template:e("./KeyboardMap.html"),viewModel:i});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/ShowKeyboardMapAction",["require","exports","../base/BaseAction","odsp-utilities/async/Promise","../resources/ProviderResourceKeys","../models/dialog/DialogState","../controls/keyboardMap/KeyboardMap","../controls/commands/Commands.resx","odsp-utilities/logging/events/Qos.event","../utilities/browser/WindowSize","../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a,l,c,d){var u=a.strings,p=function(e){function t(){e.apply(this,arguments),this.name="ShowKeymap"}return __extends(t,e),t.prototype.onExecute=function(){var e=this.resources.consume(o.dialog),t=e.requestDialog({title:u.keyboardShortcutsTitle,size:c.Large,component:{name:s.tagName,params:{}},actions:[{name:u.ok,icon:d.x,isDefault:!0,execute:function(){return n.default.wrap(r.completed)}}]});return t.wait().then(function(){return{resultType:l.ResultTypeEnum.Success}})},t}(i);return p}),define("odsp-next/controls/folderTree/FolderTreeUtility",["require","exports","knockout","../../models/item/ItemType"],function(e,t,i,n){var o=function(){function e(){}return e.convertItem=function(e,t){var n={name:t.name,key:t.key,type:t.type,id:t.id,iconName:t.iconName,focused:i.observable(!1),selected:i.observable(!1),children:i.observableArray(),isOpen:i.observable(!1),retrievedChildren:i.observable(!1),iconVisible:i.observable(!0),isRoot:!1,isLoading:i.observable(!1),level:0,parent:e,showNewFolderInput:i.observable(!1),focusNewFolderInput:i.observable(!1)};return n},e.convertChildren=function(t,o){for(var r=[],s=0;s<o.length;s++)if(o[s]&&o[s]().type===n.Folder){var a=i.observable(e.convertItem(t,o[s]()));a().level=t.level+1,r.push(a)}return r},e}();return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/MoveCopyAction",["require","exports","../base/BaseSelectionAction","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event"],function(e,t,i,n,o){var r=function(e){function t(t){e.call(this,t),this.name="MoveCopy",this.context=t.context,this.onComplete=t.onComplete,this.isMove=t.isMove,this._itemProvider=this.resources.consume(n.item)}return __extends(t,e),t.prototype.onExecute=function(){return this.onComplete(),this._itemProvider.copyItems(this.context()).then(function(){return{resultType:o.ResultTypeEnum.Success}})},t.prototype.onIsAvailable=function(){return this.context().isMove===this.isMove},t}(i);return r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/folderTree/FolderTreeCommandSet",["require","exports","knockout","odsp-shared/base/BaseModel","../commands/CommandViewModel","../commands/Commands.resx","../../utilities/icons/Icon","../../resources/ControlResourceKeys","../../actions/MoveCopyAction"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){var n=this;e.call(this,t),this.commands=i.observableArray();var l=".FolderPanelTopMenu",c=r.strings;this._actionMap=this.resources.consume(a.actionMap),this.isLabelVisible=i.observable(!0),this.componentViewModel=t.componentViewModel,this.context=t.componentViewModel.context,this.onComplete=t.componentViewModel.onComplete,this.isDisabled=t.componentViewModel.isDisabled,this.isNewFolderDisabled=t.componentViewModel.isNewFolderDisabled;var d={context:this.context,onComplete:this.onComplete,isMove:!0},u={context:this.context,onComplete:this.onComplete,isMove:!1};this.commands=i.observableArray([new o({text:c.moveConfirmButton,isLabelVisible:this.isLabelVisible,isDisabled:this.isDisabled,icon:s.check,action:new(this.managed(this._actionMap.MoveCopyAction))(d),engagementName:"Move"+l}),new o({text:c.copyConfirmButton,isLabelVisible:this.isLabelVisible,isDisabled:this.isDisabled,icon:s.check,action:new(this.managed(this._actionMap.MoveCopyAction))(u),engagementName:"Copy"+l}),new(this.managed(o))({text:c.createFolder,isLabelVisible:this.isLabelVisible,isDisabled:this.isNewFolderDisabled,icon:s.circlePlus,callback:function(){n.componentViewModel.focusedItem().showNewFolderInput(!0),n.componentViewModel.focusedItem().focusNewFolderInput(!0),n.isNewFolderDisabled(!0)},engagementName:"NewFolder"+l})])}return __extends(t,e),t}(n);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/folderTree/FolderTreeViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","./FolderTreeUtility","../../bindings/selection/SelectionBinding","../../bindings/keyboard/KeyboardBinding","../../models/selection/SelectionModel","../../resources/DataSourceResourceKeys","../../resources/UtilityResourceKeys","./FolderTreeCommandSet","odsp-utilities/async/Promise","../../models/sharing/SharingRole","../../controls/groups/groupHeader/GroupHeader.resx","../../dataSources/url/QueryType"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g,f){var b=function(t){function n(n){t.call(this,n),this._folderTreeWidth=260,this._folderTreeIndent=20,this.context=n.context,this.onComplete=n.onComplete,this.title=n.title,this.dataUpdated=i.observable(!1),this.isDisabled=i.observable(!1),this.isNewFolderDisabled=i.observable(!1),this.commandSet=new(this.managed(p))({componentViewModel:this}),this.hasData=i.observable(!1),this.isActive=i.observable(!0),this.height=document.body.clientHeight+"px",this._platform=this.resources.consume(u.platformDetection),this.isMobile=this._platform.isMobile,this.rootFolderItem=i.observable(),this.sharedFolderItem=i.observable(),this.focusedItem=i.observable(),this.selectedItems=i.observableArray(),this.selectionModel=new c,this.itemArrayForSelection=i.observableArray(),this.loadingImageUrl=e.toUrl(this.resources.consume(d.settings).mediaBaseUrl+"/images/loading/loadingspinner.gif"),this._urlDataSource=this.resources.consume(d.url),this.newFolderName=i.observable(""),this.needsRefocus=i.observable(!1),this.loadingText=g.strings.loadingText,this.addBindingHandlers({selection:a,keyboard:l}),this.keyboardOptions=[{isActive:this.isActive,target:null,useRtlMappings:!0,mappings:{Down:this.keyDown,Up:this.keyUp,Left:this.keyLeft,Right:this.keyRight,Enter:this.onEnter}},{isActive:this.isActive,useRtlMappings:!0,target:window,mappings:{}}],this.subscribe(this.dataUpdated,this._updateItemSet),this.subscribe(this.needsRefocus,this._setFocus),this._itemProvider=this.resources.consume(r.item),this._actionMap=this.resources.consume(o.actionMap),this._currentSet=this.resources.consume(o.currentItemSet),this._itemSet=i.observable(null),this._sharedItemSet=i.observable(null);var s=this._currentSet().item();this.showSharedRoot=this._itemProvider.getCapabilities().supportsMoveCopyOnShared&&s.sharingRole!==m.Owner&&s.queryType!==f.SharedWithMe,this._fetchParentItem(s)}return __extends(n,t),n.prototype.getWidth=function(e,t){var i=e._folderTreeWidth-e._folderTreeIndent*t.level;return i},n.prototype.onClick=function(e,t){e.focusedItem()&&e.focusedItem().showNewFolderInput(!1),e._selectFolder(t),t.isOpen()?(e._closeChildren(t),e._updateSelectionArray()):(t.isLoading(!0),e._showChildren(t))},n.prototype.keyLeft=function(e,t){if(this.focusedItem().showNewFolderInput(!1),this.focusedItem().isOpen())e._closeChildren(this.focusedItem()),e._updateSelectionArray();else if(this.focusedItem().parent){var i=this.focusedItem().parent;e._changeSelection(i),e._selectFolder(i)}return t.stopPropagation(),!0},n.prototype.keyRight=function(e,t){if(this.focusedItem().showNewFolderInput(!1),this.focusedItem().isOpen()){if(this.focusedItem().children().length>0){var i=this.focusedItem().children()[0]();e._changeSelection(i),e._selectFolder(i)}}else e.focusedItem().isLoading(!0),e._showChildren(this.focusedItem());return t.stopPropagation(),!0},n.prototype.keyUp=function(e){this.focusedItem().showNewFolderInput(!1);var t=this.itemArrayForSelection.indexOf(this.focusedItem());return 0!==t&&e._selectFolder(this.itemArrayForSelection()[t-1]),!0},n.prototype.keyDown=function(e){this.focusedItem().showNewFolderInput(!1);var t=this.itemArrayForSelection.indexOf(this.focusedItem());return t!==this.itemArrayForSelection().length-1&&e._selectFolder(this.itemArrayForSelection()[t+1]),!0},n.prototype.onEnter=function(e,t){this.isDisabled(!0),this.isNewFolderDisabled(!0);var i={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove},n=new(this.managed(this._actionMap.MoveCopyAction))(i);return n.execute(t),t.stopPropagation(),!1},n.prototype._selectFolder=function(e){this.context().targetId=e.id,this.context().targetKey=e.key,this.isNewFolderDisabled(!1)},n.prototype._changeSelection=function(e){this.selectionModel.selectItem(e)},n.prototype._setFocus=function(){this.needsRefocus()&&(this.focusedItem().focused(!0),this.isNewFolderDisabled(!1),this.needsRefocus(!1))},n.prototype._updateItemSet=function(){this.focusedItem().isLoading(!0),this._showChildren(this.focusedItem())},n.prototype._showChildren=function(e){var t=this;if(e.retrievedChildren()&&!this.dataUpdated())e.isLoading(!1),e.isOpen(e.children().length>0?!0:!1),this._updateSelectionArray();else{var i={parentKey:e.key,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e.key),filters:this._getFilters()};this._itemProvider.getItem(i).then(function(i){if(t._itemSet(i),e.children(s.convertChildren(e,t._itemSet().content().items)),e.retrievedChildren(!0),e.isLoading(!1),e.isOpen(e.children().length>0?!0:!1),e.iconVisible(0===e.children().length?!1:!0),t.dataUpdated()){for(var n=0;n<e.children().length;n++)e.children()[n]().name===t.newFolderName()&&(t._changeSelection(e.children()[n]()),t._selectFolder(e.children()[n]()));t.isNewFolderDisabled(!1),t.dataUpdated(!1)}t._updateSelectionArray()})}},n.prototype._getFilters=function(){return this._itemProvider.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}},n.prototype._closeChildren=function(e){e.isOpen(!1);for(var t=0;t<e.children().length;t++)this._closeChildren(e.children()[t]())},n.prototype._fetchParentItem=function(e){var t=this,i=this._urlDataSource.getCurrentItemKey({}),n={parentKey:i,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(i),filters:this._getFilters()},o=this._itemProvider.getItem(n).then(function(e){t._itemSet(e)}),r=h.default.wrap();if(this.showSharedRoot){var s=null;if(e.parent){for(var a=e;a.parent&&!a.parent.isStub&&a.parent.parent;)a=a.parent;s=a}else s=e;n={parentKey:s.key,ownerId:s.ownerId},r=this._itemProvider.getItem(n).then(function(e){t._sharedItemSet(e)},function(){t.showSharedRoot=!1})}h.default.all([o,r]).done(this._createFolderItems.bind(this),this._createFolderItems.bind(this))},n.prototype._createFolderItems=function(){var e=null;if(this._sharedItemSet()){var t=this._getFolderItem(this._sharedItemSet());e=t,this.sharedFolderItem(t)}if(this._itemSet()){var i=this._getFolderItem(this._itemSet());i.isRoot=!0,e||(e=i),this.rootFolderItem(i),this._selectFolder(e),this._changeSelection(e),this._updateSelectionArray(),this.hasData(!0)}},n.prototype._getFolderItem=function(e){var t=s.convertItem(null,e.item());return t.children(s.convertChildren(t,e.content().items)),t.isOpen(!0),t.retrievedChildren(!0),t.focused(!0),0===t.children().length&&t.iconVisible(!1),t},n.prototype._updateSelectionArray=function(){var e=this._updateSelectionArrayHelper(this.rootFolderItem(),!0),t=this.sharedFolderItem()?this._updateSelectionArrayHelper(this.sharedFolderItem(),!0):[];this.itemArrayForSelection(t.concat(e))},n.prototype._updateSelectionArrayHelper=function(e,t){var i=[];if(t&&i.push(e),e.children().length>0)for(var n=0;n<e.children().length;n++)i=i.concat(this._updateSelectionArrayHelper(e.children()[n](),e.isOpen()));return i},n}(n);return b}),define("odsp-next/controls/folderTree/FolderTree.html",[],function(){return"<!--ko if: hasData--><div class=\"od-FolderTree-commandBar od--hasSelection\" data-bind=\"component: { name: 'ms-command-bar', params: {commandSet: commandSet, isActive: isActive } }\"></div><div class=\"od-FolderTree-contentContainer od-Panel-padding od-FolderTree-padding\"><div class=\"od-FolderTree-title ms-font-xl ms-fontWeight-semilight\" data-bind=\"text: title\"></div><!--ko if: showSharedRoot--><div class=od-FolderTree role=tree data-bind=\"template: { name: 'od-folder-tree-row', data: sharedFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: 'single', direction: 'vertical', key: sharedFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, isActive: isActive, selectionModel: selectionModel }\"></div><!--/ko--><div class=od-FolderTree role=tree data-bind=\"template: { name: 'od-folder-tree-row', data: rootFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: 'single', direction: 'vertical', key: rootFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, isActive: isActive, selectionModel: selectionModel }\"></div></div><!--/ko--><!--ko ifnot: hasData--><span class=ms-font-m data-bind=\"component: { name: 'ms-loadingSpinner', params: { loadingText: loadingText } }\"></span><!--/ko-->"}),define("odsp-next/controls/folderTree/FolderTreeRow.html",[],function(){return"<div class=od-FolderTree-row role=treeitem data-bind=\"css: {'is-selected': selected, 'is-focused': focused, 'icon-visible': iconVisible}, click: $component.onClick.bind($data, $component), attr: { tabindex: selected() || focused() ? 0 : -1, 'aria-expanded': isOpen(), 'aria-selected': selected(), 'aria-label': name}, hasFocus: focused\"><i class=\"ms-Icon ms-Icon--chevronDown\" data-bind=\"style: {display: !isLoading() && isOpen() ? 'inline' : 'none'}\"></i> <i class=\"ms-Icon ms-Icon--chevronRight\" data-bind=\"style: {display: !isLoading() && !isOpen() ? 'inline' : 'none'}\"></i> <img class=od-FolderTree-loadingGif data-bind=\"attr: { src: $component.loadingImageUrl}, style: {display: isLoading() ? 'inline' : 'none'}\"> <i class=\"ms-Icon ms-Icon--onedrive\" data-bind=\"style: {display: isRoot ? 'inline' : 'none'}\"></i> <span class=od-FolderTree-folderIcon data-bind=\"component: { name: 'ms-file-type-icon', params: { iconName: iconName, desiredSize: 16 } }, style: {display: isRoot ? 'none' : 'inline'}\"></span> <span class=\"od-FolderTree-folderName ms-font-m\" data-bind=\"text: name\"></span></div><div class=od-FolderTree-inlineFolderBuilder data-bind=\"visible: showNewFolderInput, component: { name: 'ms-inline-folder-builder', params: { newFolderName: $component.newFolderName, iconName: iconName, width: $component.getWidth($component, $data), itemKey: key, optionalParams: { dataUpdated: $component.dataUpdated, showNewFolderInput: showNewFolderInput, hasFocus: focusNewFolderInput, needsRefocus: $component.needsRefocus } } }\"></div><ul class=od-FolderTree-children role=group data-bind=\"template: { name: 'od-folder-tree-row', foreach: children }, style: { display: isOpen() ? 'block' : 'none' }\"></ul>"});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilderViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/ProviderResourceKeys","../folderBuilder/FolderBuilder.resx","../../resources/ControlResourceKeys","../../bindings/keyboard/KeyboardBinding"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){e.call(this,t),this.namePlaceholder=r.strings.FolderNamePlaceholder,this.nameLabel=r.strings.FolderNameLabel,this.createLabel=r.strings.CreateFolderLabel;
var n=57,l=32;this.iconName=t.iconName,this.width=(t.width-n).toString()+"px",this.inputWidth=(t.width-(n+l)).toString()+"px",this.newFolderName=t.newFolderName||i.observable(""),this.newFolderName(""),this.buttonText="Create",this.itemKey=t.itemKey,this.isActive=i.observable(!0);var c=t.optionalParams;this.optionalParams={dataUpdated:c&&c.dataUpdated?c.dataUpdated:i.observable(!1),showNewFolderInput:c&&c.showNewFolderInput?c.showNewFolderInput:i.observable(!0),hasError:c&&c.hasError?c.hasError:i.observable(!1),status:c&&c.status?c.status:i.observable(""),hasFocus:c&&c.hasFocus?c.hasFocus:i.observable(!0),isEnabled:c&&c.isEnabled?c.isEnabled:i.observable(!0),needsRefocus:c&&c.needsRefocus?c.needsRefocus:i.observable(!1)},this.addBindingHandlers({keyboard:a}),this._itemProvider=this.resources.consume(o.item),this._actionMap=this.resources.consume(s.actionMap)}return __extends(t,e),t.prototype.onClick=function(e,t){e.createNewFolder(t)},t.prototype.onEnter=function(e,t){return e.createNewFolder(t),!0},t.prototype.onEscape=function(e,t){return this.optionalParams.showNewFolderInput(!1),this.newFolderName(""),this.optionalParams.status(""),this.optionalParams.isEnabled(!0),this.optionalParams.needsRefocus(!0),t.stopPropagation(),!1},t.prototype.createNewFolder=function(e){var t=this,i={parentKey:this.itemKey};this._itemProvider.getItem(i).then(function(i){var n=i.item(),o=new(t.managed(t._actionMap.CreateNewFolderAction))({parentItem:n,newFolderName:t.newFolderName,optionalParams:t.optionalParams});o.execute(e)}),e.stopPropagation()},t}(n);return l}),define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.html",[],function(){return'<div class=od-InlineFolderBuilder data-bind="style: { width: width}, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter.bind($component), Esc: onEscape.bind($component) } }"><div><span class=od-InlineFolderBuilder-folderIcon data-bind="component: { name: \'ms-file-type-icon\', params: { iconName: iconName, desiredSize: 16 } }"></span> <input class="od-InlineFolderBuilder-textInput ms-TextField-field" type=text data-bind="value: newFolderName, textInput: newFolderName, hasFocus: optionalParams.hasFocus, style: { width: inputWidth }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': nameLabel }, automation: automationId, enable: optionalParams.isEnabled"></div><div class=od-InlineFolderBuilder-status aria-live=assertive data-bind="text: optionalParams.status, css: { \'od-InlineFolderBuilder-status--error\': optionalParams.hasError }"></div><div><button class="ms-Button ms-Button--primary od-InlineFolderBuilder-createButton" data-bind="visible: newFolderName() && optionalParams.isEnabled(), click: onClick.bind($component), attr: { \'aria-label\': createLabel }"><span class=ms-Button-label data-bind="text: buttonText"></span></button></div></div>'}),define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-InlineFolderBuilder{line-height:34px;overflow:visible;white-space:nowrap;word-wrap:break-word;margin:2px 0}html[dir=ltr] .od-InlineFolderBuilder{padding-left:57px}html[dir=rtl] .od-InlineFolderBuilder{padding-right:57px}.od-InlineFolderBuilder-textInput{display:inline-block}html[dir=ltr] .od-InlineFolderBuilder-textInput{margin-left:8px}html[dir=rtl] .od-InlineFolderBuilder-textInput{margin-right:8px}.od-InlineFolderBuilder-createButton{margin-top:2px}html[dir=ltr] .od-InlineFolderBuilder-createButton{float:right}html[dir=rtl] .od-InlineFolderBuilder-createButton{float:left}.od-InlineFolderBuilder-status{margin-top:2px;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:#094AB2;white-space:pre-wrap;word-wrap:break-word;line-height:15px}.od-InlineFolderBuilder-status--error{color:#a80000}")});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/CreateNewFolderAction",["require","exports","knockout","../base/BaseItemAction","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../controls/commands/Commands.resx"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){e.call(this,t),this.name="CreateNewFolder",this.parentItem=t.parentItem,this.newFolderName=t.newFolderName;var n=t.optionalParams;this.optionalParams={dataUpdated:n&&n.dataUpdated?n.dataUpdated:i.observable(!1),showNewFolderInput:n&&n.showNewFolderInput?n.showNewFolderInput:i.observable(!0),hasError:n&&n.hasError?n.hasError:i.observable(!1),status:n&&n.status?n.status:i.observable(""),hasFocus:n&&n.hasFocus?n.hasFocus:i.observable(!0),isEnabled:n&&n.isEnabled?n.isEnabled:i.observable(!0),needsRefocus:n&&n.needsRefocus?n.needsRefocus:i.observable(!1)},this._operatorProvider=this.resources.consume(o.operator)}return __extends(t,e),t.prototype.onExecute=function(){var e=this;return this.optionalParams.status(s.strings.Saving),this.optionalParams.hasError(!1),this.optionalParams.isEnabled(!1),this._operatorProvider.createFolder({parent:this.parentItem,folderName:this.newFolderName()}).then(function(){return e.optionalParams.dataUpdated(!0),e.optionalParams.showNewFolderInput(!1),e.optionalParams.isEnabled(!0),e.optionalParams.status(""),{resultType:r.ResultTypeEnum.Success}},function(t){e.optionalParams.hasError(!0),e.optionalParams.status(t.message),e.optionalParams.isEnabled(!0),e.optionalParams.hasFocus(!0)})},t}(n);return a}),define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder",["require","exports","./InlineFolderBuilderViewModel","odsp-shared/utilities/knockout/ComponentFactory","./InlineFolderBuilder.html","./InlineFolderBuilder.css","../fileTypeIcon/FileTypeIcon","../../actions/CreateNewFolderAction"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-inline-folder-builder",template:e("./InlineFolderBuilder.html"),viewModel:i});return o}),define("odsp-next/controls/folderTree/FolderTree.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles("html[dir=ltr] .od-FolderTree-contentContainer,html[dir=rtl] .od-FolderTree-contentContainer{left:0}.od-FolderTree-row{overflow:hidden;cursor:default;height:34px;line-height:34px;position:relative;margin:2px 0;min-width:220px;white-space:nowrap;text-overflow:ellipsis}.od-FolderTree-row.is-selected{background:#d7eaf9}@media screen and (-ms-high-contrast:active){.od-FolderTree-row.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderTree-row.is-selected{background:#00c0ff}}.od-FolderTree-row:focus{outline:transparent solid 1px}.od-FolderTree-row .ms-Icon--chevronDown,.od-FolderTree-row .ms-Icon--chevronRight{color:#212121;opacity:0;padding:10px;font-size:14px}.od-FolderTree-row.icon-visible .ms-Icon--chevronDown,.od-FolderTree-row.icon-visible .ms-Icon--chevronRight{opacity:1}.od-FolderTree-row .ms-Icon--onedrive{font-size:17px;padding:2px 0;width:20px;color:#094AB2}.od-FolderTree-row .od-FolderTree-loadingGif{vertical-align:bottom;padding:9px}.od-FolderTree-row>i{display:inline}.od--isNonMobile .od-FolderTree-row:hover{background:#e6f2fb}.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:#beddf4}.od-focus--enabled .od-FolderTree-row.is-focused{box-shadow:0 0 0 1px #767676 inset;outline:transparent solid 1px}.od-FolderTree-folderName{cursor:pointer}html[dir=ltr] .od-FolderTree-folderName{margin-left:8px}html[dir=rtl] .od-FolderTree-folderName{margin-right:8px}.od-FolderTree-children{margin:0}html[dir=ltr] .od-FolderTree-children{padding-left:20px}html[dir=rtl] .od-FolderTree-children{padding-right:20px}.od-FolderTree-title{margin-bottom:20px}.od-FolderTree-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:#e6f2fb}.lg .od-FolderTree-commandBar .CommandBar,.md .od-FolderTree-commandBar .CommandBar,.sm .od-FolderTree-commandBar .CommandBar{padding:0 16px}.lg .od-FolderTree-commandBar .CommandBar,.xlg .od-FolderTree-commandBar .CommandBar,.xxlg .od-FolderTree-commandBar .CommandBar,.xxxlg .od-FolderTree-commandBar .CommandBar{padding:0 32px}.xxlg .od-FolderTree-commandBar .CommandBar,.xxxlg .od-FolderTree-commandBar .CommandBar{padding:0 40px}.od-FolderTree-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0}html[dir=ltr] .od-FolderTree-contentContainer,html[dir=rtl] .od-FolderTree-contentContainer{right:0}.od-FolderTree-contentContainer.od-Panel-padding.od-FolderTree-padding{padding-top:22px}.lg .od-FolderTree-contentContainer.od-Panel-padding.od-FolderTree-padding,.md .od-FolderTree-contentContainer.od-Panel-padding.od-FolderTree-padding,.sm .od-FolderTree-contentContainer.od-Panel-padding.od-FolderTree-padding{padding-top:10px}")}),define("odsp-next/controls/folderTree/FolderTree",["require","exports","./FolderTreeViewModel","odsp-shared/utilities/knockout/ComponentFactory","./FolderTree.html","./FolderTreeRow.html","../inlineFolderBuilder/InlineFolderBuilder","../commandBar/CommandBar","./FolderTree.css","../fileTypeIcon/FileTypeIcon"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-folder-tree",template:e("./FolderTree.html"),viewModel:i,synchronous:!0});return n.registerTemplate("od-folder-tree-row",e("./FolderTreeRow.html")),o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/LaunchMoveCopyPanelAction",["require","exports","knockout","../base/BaseSelectionAction","../controls/commands/Commands.resx","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../controls/folderTree/FolderTree","../models/panel/PanelState","../resources/DataSourceResourceKeys"],function(e,t,i,n,o,r,s,a,l,c){var d=function(e){function t(t){e.call(this,t),this.name="LaunchMoveCopyPanel",this._urlDataSource=this.resources.consume(c.url),this._itemProvider=this.resources.consume(r.item),this._capabilities=this._itemProvider.getCapabilities(),this._panelProvider=this.resources.consume(r.panel),this.isMove=t.isMove}return __extends(t,e),t.prototype.onSelectionExecute=function(e){var t=o.strings,n=this.item(),r=i.observable({items:e,parentKey:n.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:n.isGroup?1:0,isAsync:!1,isMove:this.isMove}),c=this.isMove?t.moveItemDialogTitle:t.copyItemDialogTitle,d=this.isMove?t.moveItemsDialogTitle:t.copyItemsDialogTitle,u=1===e.length?c:d,p=this._panelProvider.requestPanel({hasCommandBar:!0,noTitle:!0,component:{name:a.tagName,params:{context:r,onComplete:function(){p.state(l.closed)},title:u,resources:this.resources}}});return p.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})},t.prototype.onSelectionIsAvailable=function(){return this._capabilities.supportsMoveCopy},t}(n);return d});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/LaunchMoveCopyPanelAction",["require","exports","../LaunchMoveCopyPanelAction","./PermissionMask"],function(e,t,i,n){var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(t,i){return e.prototype.onSelectionIsAvailable.call(this,t,i)&&n.hasItemPermission(i,n.EditListItems)},t}(i);return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/spo/commandSets/TopLevelCommandSet",["require","exports","knockout","odsp-shared/base/BaseModel","../../../../actions/SortActionMode","../../../../utilities/browser/WindowSize","../../../../utilities/icons/Icon","../../../../controls/list/layouts/LayoutType","../../../../dataSources/upload/UploadProcessorType","../../../../resources/UtilityResourceKeys","../../../../resources/ControlResourceKeys","../../../../actions/DocumentType","../../../../controls/commands/CommandViewModel","../../../../controls/commands/Commands.resx","../../../../controls/commands/SortMenuBuilder","odsp-next/controls/operation/commands/OperationCommandBuilder","../../../../actions/OpenRelation","../../../../utilities/newFeatureExperience/NewFeatureAnchorName","odsp-shared/utilities/string/StringHelper","../../../../utilities/features/Features","./CommandSetHelper","../../../../utilities/suiteExtensions/SuiteExtensionsHelper","../../../../utilities/icons/OfficeFileNameHelper","../../../../utilities/selection/SelectionHelper","../../../../actions/odb/CreateFolderAction","../../../../actions/odb/CreateDocumentAction","../../../../actions/odb/LaunchCreateShortcutPanel","../../../../actions/odb/DeleteAction","../../../../actions/odb/DownloadAction","../../../../actions/odb/ShareAction","../../../../actions/odb/SyncAction","../../../../actions/odb/EditAction","../../../../actions/odb/AlertAction","odsp-next/actions/odb/OpenShortcutAction","../../../../actions/odb/ContentTypeNavigationAction","../../../../actions/ShareByLinkAction","../../../../actions/ShowPropertiesAction","../../../../actions/ShowSelectionAction","../../../../actions/SortAction","../../../../actions/ToggleListLayoutAction","../../../../actions/odb/UploadAction","../../../../actions/odb/UndoCheckOutAction","../../../../actions/odb/CheckInAction","../../../../actions/odb/ShowVersionHistoryAction","../../../../actions/ClearSelectionAction","../../../../actions/odb/RenameAction","../../../../actions/OpenAction","../../../../actions/OpenInClientAction","../../../../actions/ShowKeyboardMapAction","../../../../actions/odb/LaunchMoveCopyPanelAction"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g,f,b,y,v,S,x,w,k){var _=function(e){function t(t){e.call(this,t),this.sourceNameEngagement=".TopMenu",this.actionMap=this.resources.consume(d.actionMap),this.commandSetHelper=new(this.managed(S)),this.buildCommands()}return __extends(t,e),t.prototype.buildCommands=function(){var e=this,t=this.resources.consume(c.responsiveUI),n=this.resources.consume(d.currentItemSet),S=this.resources.consume(d.itemsSelection),_=this.commandSetHelper,C=this.createComputed(function(){return w.getOfficeOnlineStringMap(k.default.getSelectedItemApp(S))||h.strings.Open}),L=this.createComputed(function(){return w.getOfficeStringMap(k.default.getSelectedItemApp(S))}),T=this.createComputed(function(){var e,t=k.default.getSelectedItemApp(S);return t&&(e=w.getOfficeIconMap(t)),e||s.document});this.labelsVisible=this.createPureComputed(function(){var e=t.formFactorSize();switch(e){case r.Small:case r.Medium:return!1;default:return!0}});var N=this.createPureComputed(function(){var t=S.selection().length;return e.labelsVisible()?y.format(h.strings.NumberSelected,t):t.toString()});this.selectionModeOn=this.createPureComputed(function(){return S.selection().length>0}),this.selectionModeOff=this.createPureComputed(function(){return 0===S.selection().length}),this.overflowHostCommand=new p({text:h.strings.OverflowCommandLabel,isLabelVisible:i.observable(!1),requiresChildren:!0,hidesMenuChevron:!0,collapseSingleChildCommands:!1,icon:s.ellipsis,tooltip:h.strings.OverflowCommandTooltip,engagementName:"Ellipsis"+this.sourceNameEngagement,hasIconOnly:!0,children:i.observableArray([new p({text:h.strings.ShowVersionHistory,action:new(this.managed(this.actionMap.ShowVersionHistoryAction)),engagementName:"Version"+this.sourceNameEngagement}),new p({text:h.strings.UndoCheckOut,action:new(this.managed(this.actionMap.UndoCheckOutAction)),engagementName:"Discard"+this.sourceNameEngagement}),new p({text:h.strings.CheckIn,action:new(this.managed(this.actionMap.CheckInAction)),engagementName:"CheckIn"+this.sourceNameEngagement})])});var F=n.peek().contentTypes.peek(),I=i.observableArray([]);if(_.isCustomContentTypesDisabled(F)){I=i.observableArray([new p({text:h.strings.CreateFolder,icon:s.folder,hasLineBreakAfter:!0,action:new(this.managed(this.actionMap.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement,keys:["ShiftF"]}),new p({text:h.strings.CreateWord,icon:s.word,action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:u.Word}),engagementName:"NewDOC"+this.sourceNameEngagement}),new p({text:h.strings.CreateExcel,icon:s.excel,action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:u.Excel}),engagementName:"NewXSL"+this.sourceNameEngagement}),new p({text:h.strings.CreatePowerPoint,icon:s.powerpoint,action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:u.PowerPoint}),engagementName:"NewPPT"+this.sourceNameEngagement}),new p({text:h.strings.CreateOneNote,icon:s.onenote,action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:u.OneNote}),engagementName:"NewONE"+this.sourceNameEngagement})]),v.default.isFeatureEnabled(v.default.ShortcutLink)&&I.push(new p({text:h.strings.CreateShortcut,icon:s.globe,action:new(this.managed(this.actionMap.LaunchCreateShortcutPanel)),engagementName:"NewURL"+this.sourceNameEngagement}));var P=n.peek().item.peek();P.properties.commandsSupported&&P.properties.commandsSupported.canShareLinkForNewDocument&&I.push(new p({text:h.strings.CreateExcelSurvey,icon:s.excel,action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:u.ExcelSurvey}),engagementName:"NewXSLSurvey"+this.sourceNameEngagement}))}else I.push(new p({text:h.strings.CreateFolder,icon:s.folder,hasLineBreakAfter:!0,action:new(this.managed(this.actionMap.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement,keys:["ShiftF"]})),I=_.generateAndAppendContentTypeContextMenu(I,F,this.sourceNameEngagement);this.newCommand=new p({newFeatureAnchorName:b.TopBarNew,text:h.strings.Create,tooltip:h.strings.CreateCommandTooltip,keys:["N"],icon:s.circlePlus,isLabelVisible:this.labelsVisible,isHidden:this.selectionModeOn,requiresChildren:!0,resources:this.resources,engagementName:"New"+this.sourceNameEngagement,children:I}),this.addDisposable(x.getInstance().updateCommand(this.newCommand,this.managed(p),this.managed(this.actionMap.CreateCustomDocumentAction))),this.uploadCommand=new p({text:h.strings.Upload,tooltip:h.strings.UploadCommandTooltip,icon:s.upload,isLabelVisible:this.labelsVisible,isHidden:this.selectionModeOn,requiresChildren:!0,keys:["U"],engagementName:"Upload"+this.sourceNameEngagement,children:i.observableArray([new p({text:h.strings.UploadFile,collapsedText:i.observable(h.strings.Upload),isFileUpload:!0,action:new(this.managed(this.actionMap.UploadAction))({uploadProcessorType:l.Html5file}),engagementName:"UploadFiles"+this.sourceNameEngagement}),new p({text:h.strings.UploadFolder,isFolderUpload:!0,action:new(this.managed(this.actionMap.UploadAction))({uploadProcessorType:l.Folder}),engagementName:"UploadFolder"+this.sourceNameEngagement})])}),this.openCommand=new p({text:h.strings.Open,tooltip:h.strings.Open,iconObservable:T,isLabelVisible:this.labelsVisible,requiresChildren:!0,keys:["O"],children:i.observableArray([new p({textObservable:C,isLabelVisible:this.labelsVisible,iconObservable:T,action:new(this.managed(this.actionMap.OpenAction)),engagementName:"OpenOnline"+this.sourceNameEngagement}),new p({textObservable:L,isLabelVisible:this.labelsVisible,iconObservable:T,action:new(this.managed(this.actionMap.OpenInClientAction)),engagementName:"OpenIn"+this.sourceNameEngagement})])}),this.syncCommand=new p({text:h.strings.Sync,tooltip:h.strings.SyncCommandTooltip,isLabelVisible:this.labelsVisible,isHidden:this.selectionModeOn,icon:s.refresh,action:new(this.managed(this.actionMap.SyncAction)),engagementName:"Sync"+this.sourceNameEngagement}),this.editCommand=new p({text:h.strings.Edit,tooltip:h.strings.EditCommandTooltip,isLabelVisible:this.labelsVisible,isHidden:this.selectionModeOn,icon:s.editBox,action:new(this.managed(this.actionMap.EditAction)),engagementName:"Edit"+this.sourceNameEngagement}),this.shareCommand=new p({text:h.strings.Share,tooltip:h.strings.ShareCommandTooltip,isLabelVisible:this.labelsVisible,icon:s.share,keys:["S"],action:v.default.isFeatureEnabled(v.default.SharingDialogRedux)?new(this.managed(this.actionMap.ShareByLinkAction)):new(this.managed(this.actionMap.ShareAction)),engagementName:v.default.isFeatureEnabled(v.default.SharingDialogRedux)?"ShareByLink"+this.sourceNameEngagement:"Share"+this.sourceNameEngagement}),this.downloadCommand=new p({text:h.strings.Download,isLabelVisible:this.labelsVisible,icon:s.download,action:new(this.managed(this.actionMap.DownloadAction)),engagementName:"Download"+this.sourceNameEngagement}),this.getLinkCommand=new p({text:h.strings.copyLink,isLabelVisible:this.labelsVisible,icon:s.link,action:new(this.managed(this.actionMap.GetLinkAction)),engagementName:"GetLink"+this.sourceNameEngagement}),this.deleteCommand=new p({text:h.strings.DeleteItem,isLabelVisible:this.labelsVisible,icon:s.trash,action:new(this.managed(this.actionMap.DeleteAction)),engagementName:"Delete"+this.sourceNameEngagement,keys:["MetaBackspace","Delete"]}),this.copyCommand=new p({text:h.strings.Copy,isLabelVisible:this.labelsVisible,icon:s.copy,action:new(this.managed(this.actionMap.LaunchMoveCopyPanelAction))({isMove:!1}),engagementName:"Copy"+this.sourceNameEngagement}),this.moveCommand=new p({text:h.strings.Move,isLabelVisible:this.labelsVisible,icon:s.folderMove,action:new(this.managed(this.actionMap.LaunchMoveCopyPanelAction))({isMove:!0}),engagementName:"Move"+this.sourceNameEngagement}),this.renameCommand=new p({text:h.strings.Rename,isLabelVisible:this.labelsVisible,icon:s.editBox,action:new(this.managed(this.actionMap.RenameAction)),engagementName:"Rename"+this.sourceNameEngagement,keys:["F2"]}),this.detailsCommand=new p({newFeatureAnchorName:b.TopBarLeftInfoPane,resources:this.resources,text:h.strings.Details,icon:s.circleInfo,isSideCommand:!1,isHidden:this.selectionModeOff,isLabelVisible:this.labelsVisible,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),engagementName:"Details"+this.sourceNameEngagement,keys:["I"]}),this.removeFromSharedListCommand=new p({text:h.strings.removeFromSharedList,icon:s.x,isLabelVisible:this.labelsVisible,action:new(this.managed(this.actionMap.RemoveFromSharedListAction))({}),engagementName:"RemoveFromSharedList"+this.sourceNameEngagement}),this.operationCommand=new(this.managed(g.default))({isLabelVisible:this.labelsVisible}).command,this.viewListCommand=new p({text:h.strings.ViewList,isLabelVisible:i.observable(!1),isHidden:this.selectionModeOn,icon:s.listBullets,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:a.Details}),engagementName:"ViewList"+this.sourceNameEngagement,keys:["V"]}),this.viewGridCommand=new p({text:h.strings.ViewGrid,isLabelVisible:i.observable(!1),isHidden:this.selectionModeOn,icon:s.tile,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:a.Grid}),engagementName:"ViewGrid"+this.sourceNameEngagement,keys:["V"]});var A=new p({text:h.strings.SortAscending,isToggleable:!0,action:new(this.managed(this.actionMap.SortAction))({mode:o.Order,ascending:!0}),engagementName:"SortAsc"+this.sourceNameEngagement}),E=new p({text:h.strings.SortDescending,isToggleable:!0,hasLineBreakAfter:!0,action:new(this.managed(this.actionMap.SortAction))({mode:o.Order,ascending:!1}),engagementName:"SortDesc"+this.sourceNameEngagement}),M=new(this.managed(m))({currentItemSet:n,itemsToAppend:[A,E]});this.sortCommand=new p({text:h.strings.Sort,isLabelVisible:this.labelsVisible,isHidden:this.selectionModeOn,icon:s.sortLines,isSideCommand:!0,requiresChildren:!0,children:M.sortItems,engagementName:"Sort"+this.sourceNameEngagement}),this.showSelectionCommand=new p({textObservable:N,tooltip:h.strings.showSelection,isLabelVisible:i.observable(!0),icon:s.x,isSideCommand:!0,positionIconRight:!0,action:new(this.managed(this.actionMap.ShowSelectionAction)),engagementName:"ShowSelection"+this.sourceNameEngagement,keys:["Esc"]}),this.propertiesCommand=new p({newFeatureAnchorName:b.TopBarRightInfoPane,resources:this.resources,text:h.strings.Details,icon:s.circleInfo,isSideCommand:!0,isHidden:this.selectionModeOn,hasIconOnly:!0,isLabelVisible:i.observable(!1),action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),engagementName:"DetailsSide"+this.sourceNameEngagement,keys:["I"]}),this.navigateUpCommand=new p({isHidden:!0,action:new(this.managed(this.actionMap.OpenAction))({openRelation:f.parent,preventWithSelection:!0}),keys:["Esc"]}),this.showKeyboardMapCommand=new p({isHidden:!0,action:new(this.managed(this.actionMap.ShowKeyboardMapAction)),keys:["Shift/"]}),this.searchCommand=new p({isHidden:!0,action:new(this.managed(this.actionMap.SetFocusAction))({selector:".od-SearchBox-input"}),keys:["/"]}),this.selectAllCommand=new p({isHidden:!0,action:new(this.managed(this.actionMap.SelectAllAction)),keys:["CtrlA","MetaA"]})},t}(n);return _});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/odb/commandSets/TopLevelCommandSet",["require","exports","knockout","../../spo/commandSets/TopLevelCommandSet"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.commands=i.observableArray([this.newCommand,this.uploadCommand,this.syncCommand,this.openCommand,this.shareCommand,this.downloadCommand,this.getLinkCommand,this.deleteCommand,this.copyCommand,this.moveCommand,this.renameCommand,this.detailsCommand,this.overflowHostCommand,this.operationCommand,this.sortCommand,this.viewListCommand,this.viewGridCommand,this.showSelectionCommand,this.propertiesCommand,this.navigateUpCommand,this.showKeyboardMapCommand,this.searchCommand,this.selectAllCommand,this.removeFromSharedListCommand])}return __extends(t,e),t}(n);return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/spo/commandSets/MobileCommandSet",["require","exports","knockout","odsp-shared/base/BaseModel","../../../../controls/commands/CommandViewModel","../../../../controls/commands/Commands.resx","odsp-next/controls/operation/commands/OperationCommandBuilder","../../../../utilities/icons/Icon","odsp-shared/utilities/string/StringHelper","../../../../actions/DocumentType","../../../../resources/ControlResourceKeys","../../../../resources/UtilityResourceKeys","../../../../controls/list/layouts/LayoutType","../../../../dataSources/upload/UploadProcessorType","../../../../utilities/browser/WindowSize","../../../../controls/commands/SortMenuBuilder","../../../../actions/SortActionMode","../../../../utilities/features/Features","./CommandSetHelper"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g,f,b,y){var v=function(e){function t(t){var n=this;e.call(this,t),this.sourceNameEngagement=".MobileTopMenu",this._actionMap=this.resources.consume(d.actionMap),this.commands=i.observableArray(),this._selectionModel=this.resources.consume(d.itemsSelection),this._hasSelection=this.createComputed(function(){return n._selectionModel.selection().length>0}),this._noSelection=this.createComputed(function(){return!n._hasSelection()}),this.commandSetHelper=new(this.managed(y)),this.buildCommands()}return __extends(t,e),t.prototype.buildCommands=function(){var e=this,t=this.resources.consume(d.currentItemSet),n=this.resources.consume(u.responsiveUI),y=this.commandSetHelper;this.labelsVisible=this.createPureComputed(function(){var e=n.formFactorSize();switch(e){case m.Small:case m.Medium:return!1;default:return!0}});var v=this.createPureComputed(function(){var t=e._selectionModel.selection().length;return e.labelsVisible()?l.format(r.strings.NumberSelected,t):t.toString()}),S=this.createPureComputed(function(){return e._selectionModel.selection().length>0}),x=t.peek().contentTypes.peek(),w=i.observableArray([]);if(y.isCustomContentTypesDisabled(x)){w=i.observableArray([new o({text:r.strings.CreateFolder,icon:a.folder,hasLineBreakAfter:!0,action:new(this.managed(this._actionMap.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement,keys:["ShiftF"]}),new o({text:r.strings.CreateWord,icon:a.word,action:new(this.managed(this._actionMap.CreateDocumentAction))({docType:c.Word}),engagementName:"NewDOC"+this.sourceNameEngagement}),new o({text:r.strings.CreateExcel,icon:a.excel,action:new(this.managed(this._actionMap.CreateDocumentAction))({docType:c.Excel}),engagementName:"NewXSL"+this.sourceNameEngagement}),new o({text:r.strings.CreatePowerPoint,icon:a.powerpoint,action:new(this.managed(this._actionMap.CreateDocumentAction))({docType:c.PowerPoint}),engagementName:"NewPPT"+this.sourceNameEngagement}),new o({text:r.strings.CreateOneNote,icon:a.onenote,action:new(this.managed(this._actionMap.CreateDocumentAction))({docType:c.OneNote}),engagementName:"NewONE"+this.sourceNameEngagement}),new o({text:r.strings.UploadFileCollapsed,icon:a.upload,hasLineBreakBefore:!0,collapsedText:i.observable(r.strings.Upload),isFileUpload:!0,action:new(this.managed(this._actionMap.UploadAction))({uploadProcessorType:h.Html5file}),engagementName:"UploadFiles"+this.sourceNameEngagement})]);var k=t.peek().item.peek();if(k.properties.commandsSupported&&k.properties.commandsSupported.canShareLinkForNewDocument){var _=w.pop();w.push(new o({text:r.strings.CreateExcelSurvey,icon:a.excel,hasLineBreakAfter:!0,action:new(this.managed(this._actionMap.CreateDocumentAction))({docType:c.ExcelSurvey}),engagementName:"NewXSLSurvey"+this.sourceNameEngagement})),w.push(_)}}else w.push(new o({text:r.strings.CreateFolder,icon:a.folder,hasLineBreakAfter:!0,action:new(this.managed(this._actionMap.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement,keys:["ShiftF"]})),w=y.generateAndAppendContentTypeContextMenu(w,x,this.sourceNameEngagement);this.newCommand=new o({text:r.strings.Create,tooltip:r.strings.CreateCommandTooltip,icon:a.circlePlus,isLabelVisible:this.labelsVisible,requiresChildren:!0,resources:this.resources,isHidden:this._hasSelection,engagementName:"New"+this.sourceNameEngagement,children:w}),this.shareCommand=new o({icon:a.share,text:r.strings.Share,isLabelVisible:this.labelsVisible,tooltip:r.strings.ShareCommandTooltip,action:b.default.isFeatureEnabled(b.default.SharingDialogRedux)?new(this.managed(this._actionMap.ShareByLinkAction)):new(this.managed(this._actionMap.ShareAction))}),this.deleteCommand=new o({text:r.strings.DeleteItem,isLabelVisible:this.labelsVisible,icon:a.trash,action:new(this.managed(this._actionMap.DeleteAction)),engagementName:"Delete"+this.sourceNameEngagement,keys:["MetaBackspace","Delete"]}),this.showSelectionCommand=new o({textObservable:v,tooltip:r.strings.showSelection,isLabelVisible:i.observable(!0),icon:a.x,isSideCommand:!0,positionIconRight:!0,action:new(this.managed(this._actionMap.ShowSelectionAction)),engagementName:"ShowSelection"+this.sourceNameEngagement,keys:["Esc"]}),this.operationCommand=new(this.managed(s.default))({isLabelVisible:this.labelsVisible}).command,this.showPropertiesCommand=new o({text:r.strings.Details,icon:a.circleInfo,isHidden:this._noSelection,isLabelVisible:this.labelsVisible,action:new(this.managed(this._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),engagementName:"Details"+this.sourceNameEngagement,keys:["I"]}),this.showPropertiesSideCommand=new o({text:r.strings.Details,icon:a.circleInfo,isHidden:S,isLabelVisible:this.labelsVisible,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(this._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),engagementName:"Details"+this.sourceNameEngagement,keys:["I"]});
var C=new o({text:r.strings.SortAscending,isToggleable:!0,action:new(this.managed(this._actionMap.SortAction))({mode:f.Order,ascending:!0}),engagementName:"SortAsc"+this.sourceNameEngagement}),L=new o({text:r.strings.SortDescending,isToggleable:!0,hasLineBreakAfter:!0,action:new(this.managed(this._actionMap.SortAction))({mode:f.Order,ascending:!1}),engagementName:"SortDesc"+this.sourceNameEngagement}),T=new(this.managed(g))({currentItemSet:t,itemsToAppend:[C,L]});this.sortMenuCommand=new o({text:r.strings.Sort,isLabelVisible:this.labelsVisible,icon:a.sortLines,isHidden:this._hasSelection,isSideCommand:!0,requiresChildren:!0,children:T.sortItems,engagementName:"Sort"+this.sourceNameEngagement}),this.viewDetailsCommand=new o({text:r.strings.ViewList,isLabelVisible:i.observable(!1),icon:a.listBullets,isHidden:this._hasSelection,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(this._actionMap.ToggleListLayoutAction))({layoutType:p.Details}),engagementName:"ViewList"+this.sourceNameEngagement,keys:["V"]}),this.viewGridCommand=new o({text:r.strings.ViewGrid,isLabelVisible:i.observable(!1),icon:a.tile,isHidden:this._hasSelection,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(this._actionMap.ToggleListLayoutAction))({layoutType:p.Grid}),engagementName:"ViewGrid"+this.sourceNameEngagement,keys:["V"]})},t}(n);return v});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/odb/commandSets/MobileCommandSet",["require","exports","knockout","../../spo/commandSets/MobileCommandSet"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.commands=i.observableArray([this.newCommand,this.shareCommand,this.deleteCommand,this.operationCommand,this.showPropertiesCommand,this.showSelectionCommand,this.sortMenuCommand,this.viewDetailsCommand,this.viewGridCommand,this.showPropertiesSideCommand])}return __extends(t,e),t}(n);return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/spo/commandSets/ContextMenuCommandSet",["require","exports","knockout","odsp-shared/base/BaseModel","../../../../controls/commands/CommandViewModel","../../../../dataSources/upload/UploadProcessorType","../../../../controls/commands/Commands.resx","../../../../utilities/icons/Icon","../../../../actions/DocumentType","../../../../resources/ControlResourceKeys","./CommandSetHelper"],function(e,t,i,n,o,r,s,a,l,c,d){var u=s.strings,p=function(e){function t(t){e.call(this,t),this.sourceNameEngagement=".OutListViewRight";var n=this.resources.consume(c.actionMap),s=this.resources.consume(c.currentItemSet);this.commandSetHelper=new(this.managed(d));var p=s.peek().contentTypes.peek(),h=i.observableArray([]);if(this.commandSetHelper.isCustomContentTypesDisabled(p)){h=i.observableArray([new o({text:u.CreateFolder,icon:a.folder,hasLineBreakAfter:!0,action:new(this.managed(n.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement}),new o({text:u.CreateWord,icon:a.word,action:new(this.managed(n.CreateDocumentAction))({docType:l.Word}),engagementName:"NewDOC"+this.sourceNameEngagement}),new o({text:u.CreateExcel,icon:a.excel,action:new(this.managed(n.CreateDocumentAction))({docType:l.Excel}),engagementName:"NewXSL"+this.sourceNameEngagement}),new o({text:u.CreatePowerPoint,icon:a.powerpoint,action:new(this.managed(n.CreateDocumentAction))({docType:l.PowerPoint}),engagementName:"NewPPT"+this.sourceNameEngagement}),new o({text:u.CreateOneNote,icon:a.onenote,action:new(this.managed(n.CreateDocumentAction))({docType:l.OneNote}),engagementName:"NewONE"+this.sourceNameEngagement})]);var m=s.peek().item.peek();m.properties.commandsSupported&&m.properties.commandsSupported.canShareLinkForNewDocument&&h.push(new o({text:u.CreateExcelSurvey,icon:a.excel,action:new(this.managed(n.CreateDocumentAction))({docType:l.ExcelSurvey}),engagementName:"NewXSLSurvey"+this.sourceNameEngagement}))}else h.push(new o({text:u.CreateFolder,icon:a.folder,hasLineBreakAfter:!0,action:new(this.managed(n.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement})),h=this.commandSetHelper.generateAndAppendContentTypeContextMenu(h,p,this.sourceNameEngagement);this.newCommand=new o({text:u.Create,requiresChildren:!0,engagementName:"New"+this.sourceNameEngagement,children:h}),this.uploadCommand=new o({text:u.Upload,requiresChildren:!0,engagementName:"Upload"+this.sourceNameEngagement,children:i.observableArray([new o({text:u.UploadFile,collapsedText:i.observable(u.Upload),isFileUpload:!0,action:new(this.managed(n.UploadAction))({uploadProcessorType:r.Html5file}),engagementName:"UploadFiles"+this.sourceNameEngagement}),new o({text:u.UploadFolder,isFolderUpload:!0,action:new(this.managed(n.UploadAction))({uploadProcessorType:r.Folder}),engagementName:"UploadFolder"+this.sourceNameEngagement})])}),this.detailsCommand=new o({text:u.Details,action:new(this.managed(n.ShowPropertiesAction))({useToggleBehavior:!0}),engagementName:"Details"+this.sourceNameEngagement})}return __extends(t,e),t}(n);return p});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/odb/commandSets/ContextMenuCommandSet",["require","exports","knockout","../../spo/commandSets/ContextMenuCommandSet"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.commands=i.observableArray([this.newCommand,this.uploadCommand,this.detailsCommand])}return __extends(t,e),t}(n);return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/removeFromSharedList/RemoveFromSharedListViewModel",["require","exports","odsp-shared/base/ViewModel","./RemoveFromSharedList.resx","../../models/item/ItemType"],function(e,t,i,n,o){var r=n.strings,s=function(e){function t(t){e.call(this,t),this.allowSpam=t.isSpam?!0:!1,this.isSpam=t.isSpam,this.status=t.status,this.hasError=t.hasError;var i=t.selection;this.subText=t.hasError()?"":t.removeAccess?i.length>1?r.itemsSubText:i[0].type===o.File?r.fileSubText:r.folderSubText:i.length>1?r.itemsSubTextWithAccess:i[0].type===o.File?r.fileSubTextWithAccess:r.folderSubTextWithAccess,this.spamText=i.length>1?r.itemsSpamText:i[0].type===o.File?r.fileSpamText:r.folderSpamText}return __extends(t,e),t}(i);return s}),define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.html",[],function(){return'<div class=od-RemoveFromSharedList><div class=od-RemoveFromSharedList-SubText data-bind="text: subText"></div><span data-bind="if: allowSpam"><input id=RemoveFromSharedList-isSpam type=checkbox name=isSpam class=od-isSpam data-bind="checked: isSpam"> <label for=RemoveFromSharedList-isSpam class=spamText data-bind="text: spamText"></label></span><div class=od-RemoveFromSharedList-Status data-bind="text: status, css: { \'od-RemoveFromSharedList-Status--error\': hasError }"></div></div>'}),define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:#a80000}")}),define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList",["require","exports","./RemoveFromSharedListViewModel","odsp-shared/utilities/knockout/ComponentFactory","./RemoveFromSharedList.html","./RemoveFromSharedList.css"],function(e,t,i,n){var o=n.registerComponent({tagName:"ms-remove-from-sharedlist",template:e("./RemoveFromSharedList.html"),viewModel:i,synchronous:!0});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/RemoveFromSharedListAction",["require","exports","../../base/BaseSelectionAction","odsp-utilities/async/Promise","../../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../../controls/removeFromSharedList/RemoveFromSharedList","../../controls/removeFromSharedList/RemoveFromSharedList.resx","odsp-shared/utilities/string/StringHelper","knockout","../../models/dialog/DialogState","../../models/item/ItemType","../../dataSources/url/QueryType","../../utilities/features/Features","../../utilities/icons/Icon","odsp-utilities/logging/events/Engagement.event"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g){var f=a.strings,b=function(e){function t(){e.apply(this,arguments),this.name="RemoveFromSharedList",this.MAX_ITEMS_ALLOWED=15}return __extends(t,e),t.prototype.onSelectionIsAvailable=function(e,t){return h.default.isFeatureEnabled(h.default.RemoveFromSharedList)&&t.queryType===p.SharedWithMeODB},t.prototype.onSelectionExecute=function(e){var t=this.resources.consume(o.item),i=this.resources.consume(o.dialog),a=c.observable(""),p=c.observable(!1),h=c.observable(!0),b=function(e){return p(!0),a(e),n.default.wrap(d.opened)};e.length>this.MAX_ITEMS_ALLOWED&&(b(l.format(f.errorTooManyItems,this.MAX_ITEMS_ALLOWED)),h(!1),g.Engagement.logData({name:"RemoveFromSharedList.TooManyItems",extraData:{itemCount:e.length}}));var y=i.requestDialog({title:e.length>1?f.itemsTitleWithAccess:e[0].type===u.File?f.fileTitleWithAccess:f.folderTitleWithAccess,component:{name:s.tagName,params:{isSpam:null,selection:e,removeAccess:!1,hasError:p,status:a}},actions:[{name:f.actionText,execute:function(){var i={items:e,markAsSpam:!1,parentKey:e[0].parentKey};return h(!1),t.removeFromSharedList(i).then(function(e){var t;return e&&e.forEach(function(e){e&&(t=e)}),t?b(t):n.default.wrap(d.completed)},function(){return b(f.errorText)})},isAvailable:h,isDefault:!0,icon:m.x,automationId:"removeFromSharedListConfirm"}]});return y.wait().then(function(){return{resultType:r.ResultTypeEnum.Success}})},t}(i);return b});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/odb/GetLinkAction",["require","exports","../../base/BaseSelectionAction","odsp-utilities/async/Promise","../../controls/tabbedSharing/SharingTab","odsp-utilities/async/RequireHelper","../../utilities/features/Features"],function(e,t,i,n,o,r,s){var a=function(t){function i(){t.apply(this,arguments),this.name="GetLink",this.isSingleSelectAction=!0}return __extends(i,t),i.prototype.onSelectionIsAvailable=function(){return s.default.isFeatureEnabled(s.default.CompanyWideSharingLinks)&&s.default.isFeatureEnabled(s.default.ODBNextCompanyWideSharingLinks)},i.prototype.onSelectionExecute=function(t,i){var a=this;return new n.default(function(){if(Boolean(t)&&Boolean(t[0]))if(s.default.isFeatureEnabled(s.default.SharingDialogRedux)){var n=r.promise(e,"../ShareByLinkAction");n.then(function(e){var t=new(a.resources.injected(e))({});t.execute(i)})}else{var n=r.promise(e,"../ShareAction");n.then(function(e){var t=new(a.resources.injected(e))({activeTab:o.links});t.execute(i)})}})},i}(i);return a});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/spo/commandSets/ListViewContextMenuCommandSet",["require","exports","odsp-shared/base/BaseModel","../../../../actions/odb/DownloadAction","../../../../actions/odb/ShareAction","../../../../actions/ShareByLinkAction","../../../../actions/OpenInClientAction","../../../../actions/OpenAction","../../../../actions/odb/RenameAction","../../../../actions/odb/DeleteAction","../../../../actions/odb/LaunchMoveCopyPanelAction","../../../../controls/commands/CommandViewModel","../../../../controls/commands/Commands.resx","../../../../resources/ControlResourceKeys","../../../../actions/odb/UndoCheckOutAction","../../../../actions/odb/CheckInAction","../../../../actions/odb/RemoveFromSharedListAction","../../../../actions/odb/ShowVersionHistoryAction","../../../../actions/ShowPropertiesAction","../../../../utilities/icons/OfficeFileNameHelper","../../../../utilities/selection/SelectionHelper","../../../../actions/odb/GetLinkAction","./CommandSetHelper","../../../../utilities/features/Features"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g,f,b,y,v,S,x,w,k){var _=p.strings,C=function(e){function t(t){e.call(this,t),this.sourceNameEngagement=".InListViewRight";var i=this.resources.consume(h.itemsSelection),p=this.createComputed(function(){return v.getOfficeOnlineStringMap(S.default.getSelectedItemApp(i))||_.Open}),C=this.createComputed(function(){return v.getOfficeStringMap(S.default.getSelectedItemApp(i))});this.commandSetHelper=new(this.managed(w)),this.downloadCommand=new u({text:_.Download,action:new(this.managed(n)),engagementName:"Download"+this.sourceNameEngagement}),this.openCommand=new u({textObservable:p,action:new(this.managed(a))({}),engagementName:"OpenOnline"+this.sourceNameEngagement}),this.openInClientCommand=new u({textObservable:C,action:new(this.managed(s))({}),engagementName:"OpenIn"+this.sourceNameEngagement}),this.shareCommand=new u({text:_.Share,hasLineBreakAfter:!0,action:k.default.isFeatureEnabled(k.default.SharingDialogRedux)?new(this.managed(r)):new(this.managed(o)),engagementName:k.default.isFeatureEnabled(k.default.SharingDialogRedux)?"ShareByLink"+this.sourceNameEngagement:"Share"+this.sourceNameEngagement}),this.getLinkCommand=new u({text:_.copyLink,action:new(this.managed(x))({}),engagementName:"GetLink"+this.sourceNameEngagement}),this.renameCommand=new u({text:_.Rename,action:new(this.managed(l))({}),engagementName:"Rename"+this.sourceNameEngagement}),this.deleteCommand=new u({text:_.DeleteItem,action:new(this.managed(c))({}),engagementName:"Delete"+this.sourceNameEngagement}),this.copyCommand=new u({text:_.Copy,action:new(this.managed(d))({isMove:!1}),engagementName:"Copy"+this.sourceNameEngagement}),this.moveCommand=new u({text:_.Move,action:new(this.managed(d))({isMove:!0}),engagementName:"Move"+this.sourceNameEngagement}),this.detailsCommand=new u({text:_.Details,hasLineBreakAfter:!0,action:new(this.managed(y))({useToggleBehavior:!0}),engagementName:"Details"+this.sourceNameEngagement}),this.removeFromSharedListCommand=new u({text:_.removeFromSharedList,action:new(this.managed(f))({}),engagementName:"RemoveFromSharedList"+this.sourceNameEngagement}),this.versionCommand=new u({text:_.ShowVersionHistory,action:new(this.managed(b))({}),engagementName:"Version"+this.sourceNameEngagement}),this.discardCommand=new u({text:_.UndoCheckOut,action:new(this.managed(m))({}),engagementName:"Discard"+this.sourceNameEngagement}),this.checkinCommand=new u({text:_.CheckIn,action:new(this.managed(g))({}),engagementName:"CheckIn"+this.sourceNameEngagement})}return __extends(t,e),t}(i);return C});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/odb/commandSets/ListViewContextMenuCommandSet",["require","exports","knockout","../../spo/commandSets/ListViewContextMenuCommandSet"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.commands=i.observableArray([this.downloadCommand,this.openCommand,this.openInClientCommand,this.shareCommand,this.getLinkCommand,this.renameCommand,this.deleteCommand,this.copyCommand,this.moveCommand,this.detailsCommand,this.versionCommand,this.discardCommand,this.checkinCommand,this.removeFromSharedListCommand])}return __extends(t,e),t}(n);return o}),define("odsp-next/utilities/groups/GroupsUtilities",["require","exports","../uri/Uri"],function(e,t,i){var n=function(){function e(){}return e.isNullOrUndefined=function(e){return null===e||void 0===e},e.getBaseUrl=function(){var e=new i(window.location.href),t=e.getScheme()+"://"+e.getHost();return"/"!==t[t.length-1]?t+"/":t},e.getWebServerRelativeUrl=function(){if(void 0!==window._spPageContextInfo){var e=window._spPageContextInfo.webServerRelativeUrl;return"/"!==e[e.length-1]?e+"/":e}return null},e.getWebServerAbsoluteUrl=function(){return i.concatenate(e.getBaseUrl(),e.getWebServerRelativeUrl())},e.getGroupNavigationActionParams=function(e,t,i){var n={resources:t,originalUrl:e.url,hasComponent:Boolean(e.component),appId:e.id,groupId:i};return n},e}();return n}),define("odsp-next/models/groups/MembersList",["require","exports"],function(){var e=function(){function e(){this.totalCount=0,this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e),this.totalCount++},e.prototype.removeUserFromList=function(e){for(var t=-1,i=0;i<this.members.length;i++)this.members[i].userId===e.userId&&(t=i);t>=0&&(this.members.splice(t,1),this.totalCount--)},e}();return e}),define("odsp-next/utilities/crossDomain/CrossDomainPromises",["require","exports"],function(){var e=function(){function e(){this._promises={}}return e.prototype.storePromiseInfo=function(e,t,i){this._promises[e]={onComplete:t,onError:i}},e.prototype.removePromiseInfo=function(e){delete this._promises[e]},e.prototype.getPromiseInfo=function(e){return this._promises[e]},e}();return e}),define("odsp-next/utilities/crossDomain/CrossDomainManager",["require","exports","./CrossDomainPromises","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/Promise","../uri/Uri","odsp-utilities/events/EventGroup"],function(e,t,i,n,o,r,s){var a=function(){function t(t,n,o){var a=this;this._iFrameIsReady=!1,this._requestIndex=0,this._crossDomainPromises=new i,this._eventGroup=new s(null),this.receivePostResponse=function(t){var i=new r(e.toUrl("")),n=i.getScheme()+"://"+i.getAuthority();if(t.data&&t.origin===n)if("IFrameReady"===t.data)a._iFrameIsReady=!0;else if("MissingOperationInfo"===t.data)alert("OperationInfo missing from request.");else try{var o=JSON.parse(t.data);if(o&&o.id){var s=a._crossDomainPromises.getPromiseInfo(o.id);a._crossDomainPromises.removePromiseInfo(o.id);var l={status:o.status.toString(),response:o.response};o.status>=200&&o.status<300?s.onComplete(l):s.onError(l)}else alert("Results from IFrame is missing ")}catch(c){alert("exception")}};var l="https://login.microsoftonline.com/common/oauth2/authorize?response_type=token&client_id="+n+"&resource="+t+"&redirect_uri="+o;this._iFrameElement=document.createElement("IFRAME"),this._iFrameElement.setAttribute("src",l),this._iFrameElement.setAttribute("style","display: none;"),document.body.appendChild(this._iFrameElement),this._eventGroup.on(window,"message",this.receivePostResponse,!1)}return t.prototype.sendPostMessageToIFrame=function(e,t){var i=this;return this._iFrameIsReady?n.Qos.instrumentPromise({name:"CrossDomainOperation"},function(){return new o.default(function(n,o){var r=i._generateRequestId();i._crossDomainPromises.storePromiseInfo(r,n,o);var s={id:r,operation:e,params:t},a=JSON.stringify(s);i._iFrameElement.contentWindow.postMessage(a,"*")})},function(t){return{resultType:n.ResultTypeEnum.Success,extraData:{operation:e,status:t.status}}},function(t){return"-1"===t.status?{resultType:n.ResultTypeEnum.Failure,resultCode:t.response,extraData:{operation:e}}:{resultType:n.ResultTypeEnum.Failure,resultCode:"StatusNotNeg1",extraData:{operation:e,status:t.status,response:t.response}}}):(alert("Iframe is not ready yet."),null)},t.prototype.isIFrameReady=function(){return this._iFrameIsReady},t.prototype._generateRequestId=function(){this._requestIndex++;var e="crossDomRequest"+this._requestIndex.toString();return e},t}();return a}),define("odsp-next/dataSources/groups/FBIDataSource",["require","exports","../../utilities/groups/GroupsUtilities","../../models/groups/MembersList","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","odsp-utilities/logging/events/Qos.event","../base/odb/ServerConnection","../base/odb/ServerData","odsp-shared/utilities/string/StringHelper","../../utilities/crossDomain/CrossDomainManager"],function(e,t,i,n,o,r,s,a,l,c,d){var u="0",p="https://graph.microsoft.com",h=function(){function t(){this.NUMBER_OF_RETRIES=3,this.crossDomMan=new d(p,u,e.toUrl("unifiedgroupshost.html"))}return t.prototype.getData=function(e,t,i,n,s,c,d,u){void 0===n&&(n="POST"),void 0===c&&(c=this._defaultGetDataRetriesExceededCallback),void 0===d&&(d=null),s||(s=0);var p=new a,h=0,m=function(i,o){var r,a,m;r=function(e){var n=e.getValue(l.DataValueKeys.ResponseText);!u||u(n)?(p=null,t&&(n=t(n)),i(n)):a(e)},a=function(e){s>h?(++h,m()):c(e,o,p,r)},(m=function(){p.getServerDataFromUrl(e,r,a,d,!0,n)})()},g=function(){Boolean(p)&&p.abort()};return r.Qos.instrumentPromise({url:e,name:"FBI"+i},function(){return new o.default(m,g)})},t.prototype._defaultGetDataRetriesExceededCallback=function(e,t){if(!e)return void t("No data returned");var i=e.getValue(l.DataValueKeys.ResponseText);try{var n=JSON.parse(i);t(n.error)}catch(o){t(i)}},t.prototype.getGroupBasicProperties=function(e){var i=this,n=this._getUrl(c.format(t.groupBasicPropertiesUrlTemplate,e),"SP.Directory.DirectorySession");return this.getData(n,function(t){var n=i._parseGroup(t);return i._calculateMissingGroupProperties(n,e),n},"GetBasicProperties","GET",this.NUMBER_OF_RETRIES)},t.prototype.getGroupMembership=function(e,i){var n=this,o=this._getUrl(c.format(t.groupMembershipUrlTemplate,e),"SP.Directory.DirectorySession");return this.getData(o,function(e){var t=n._parseMembership(e);return n._calculateMissingMembershipProperties(t,i),t},"GetMembership","GET",this.NUMBER_OF_RETRIES)},t.prototype.getUserGroups=function(e){var i=this,n=0,o=new r.Qos({name:"FBIDataSource.GetUserGroups"}),a=this._getUrl(c.format(t.getUserGroupsUrlTemplate,e.userId),"SP.Directory.DirectorySession"),l=function(n,r,a,l){var d=i._getCsomUrl("ProcessQuery"),u=c.format(t.CsomGetUserGroupsBodyTemplate,e.email);a.getServerDataFromUrl(d,l,function(e){o.end({resultType:s.ResultTypeEnum.Failure,resultCode:"CSOMFallbackFailed"}),i._defaultGetDataRetriesExceededCallback(e,r,a,l)},u,!0,"POST")},d=function(e){var t=JSON.parse(e);if(t.constructor===Array)try{var n=t[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});return o.end({resultType:s.ResultTypeEnum.ExpectedFailure}),n}catch(r){o.end({resultType:s.ResultTypeEnum.Failure,resultCode:"CSOMFallback",extraData:{"r-Value":t,callType:"CSOMFallback",exception:r}})}else try{var a=t.d.rankedMembership.results,n=a.map(function(e){var t={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl};return i._calculateMissingGroupProperties(t,t.id),t});return o.end({resultType:s.ResultTypeEnum.Success}),n}catch(r){o.end({resultType:s.ResultTypeEnum.Failure,resultCode:"RankedMembershipREST",extraData:{"r-Value":t,callType:"RankedMembershipREST",exception:r}})}return[]};return this.getData(a,d,"GetUserGroups","GET",n,l,null,function(e){try{var t=JSON.parse(e);if(t.constructor===Array&&5===t.length)return!0;if(t.d&&Object.keys(t.d).length>1&&t.d.rankedMembership.results.length>0)return!0}catch(i){}return!1})},t.prototype.getUserOwnedGroups=function(e){var i=this,n=this._getUrl(c.format(t.getUserOwnedGroupsUrlTemplate,e.userId),"SP.Directory.DirectorySession");return this.getData(n,function(e){return i._parseGroups(e)},"GetUserOwnedGroups","GET",this.NUMBER_OF_RETRIES)},t.prototype.getSiteLinks=function(){var e=this,n=i.getWebServerAbsoluteUrl()+c.format(t.siteLinksTemplate);return this.getData(n,function(t){return e._parseSiteLinks(t)},"getSiteLinks","GET",this.NUMBER_OF_RETRIES)},t.prototype.connectGroup=function(e){var n=i.getWebServerAbsoluteUrl()+c.format(t.connectGroupTemplate,e);return this.getData(n,null,"connectGroup","POST",this.NUMBER_OF_RETRIES)},t.prototype.disconnectGroup=function(e){var n=i.getWebServerAbsoluteUrl()+c.format(t.disconnectGroupTemplate,e);return this.getData(n,null,"disconnectGroup","POST",this.NUMBER_OF_RETRIES)},t.prototype.addGroupMember=function(e,i){var n=this._getUrl(c.format(t.addGroupMemberUrlTemplate,e,i),"SP.Directory.DirectorySession");return this.getData(n,null,"AddMember","POST",this.NUMBER_OF_RETRIES)},t.prototype.removeGroupMember=function(e,i){var n=this._getUrl(c.format(t.removeGroupMemberUrlTemplate,e,i),"SP.Directory.DirectorySession");return this.getData(n,null,"RemoveMember","POST",this.NUMBER_OF_RETRIES)},t.prototype.getUserInfo=function(e){var i=this,n=this._getUrl(c.format(t.getUserInfoUrlTemplate,e),"SP.Directory.DirectorySession");return this.getData(n,function(t){var n=i._parseUser(t);return n.email=e,n},"GetGraphUser","GET",this.NUMBER_OF_RETRIES)},t.prototype.getNotebookUrl=function(e){var n=i.getWebServerAbsoluteUrl()+c.format(t.getNotebookUrlTemplate,e);return this.getData(n,function(e){var t=JSON.parse(e);return t.d.Notebook},"GetNotebookUrl","GET",this.NUMBER_OF_RETRIES)},t.prototype.getSiteStatus=function(e){var n=this,o=i.getWebServerAbsoluteUrl()+c.format(t.getSiteStatusUrlTemplate,e);return this.getData(o,function(e){return n._parseGroupSiteInfoResponse(e,"GetSiteStatus")},"GetSiteStatus","GET",this.NUMBER_OF_RETRIES)},t.prototype.createSite=function(e){var n=this,o=i.getWebServerAbsoluteUrl()+c.format(t.createSiteUrlTemplate,e);return this.getData(o,function(e){return n._parseGroupSiteInfoResponse(e,"Create")},"CreateSite","POST",this.NUMBER_OF_RETRIES)},t.prototype.sendCreateGroupOperation=function(e,t,i){var n={displayName:e,mailNickname:t,isPublic:String(i)};return this.crossDomMan.sendPostMessageToIFrame("CreateGroup",n)},t.prototype.isCrossDomainManagerReady=function(){return this.crossDomMan.isIFrameReady()},t.prototype.getFallbackFilesUrl=function(e){return i.getWebServerAbsoluteUrl()+c.format(t.groupStatusPageTemplate,e,"documents")},t.prototype._parseGroupSiteInfoResponse=function(e,t){var i=JSON.parse(e),n=i.d[t],o={siteUrl:n.SiteUrl,errorMessage:n.ErrorMessage,siteStatus:n.SiteStatus,documentsUrl:n.DocumentsUrl};return o},t.prototype._getUrl=function(e,t){var n=i.getWebServerRelativeUrl();return n+"_vti_bin/client.svc/"+t+"/"+e},t.prototype._getCsomUrl=function(e){var t=i.getWebServerRelativeUrl();return t+"_vti_bin/client.svc/"+e},t.prototype._getProfileUrl=function(e){var n=i.getBaseUrl();return n+c.format(t.groupStatusPageTemplate,e,"profile")},t.prototype._getGroupStatusNotebookUrl=function(e){var n=i.getBaseUrl();return n+c.format(t.groupStatusPageTemplate,e,"notebook")},t.prototype._fixUserImages=function(e){i.isNullOrUndefined(e.image)&&!i.isNullOrUndefined(e.email)&&(e.image=i.getBaseUrl()+c.format(t.userImageUrlTemplate,e.email)),i.isNullOrUndefined(e.profilePage)&&!i.isNullOrUndefined(e.email)&&(e.profilePage=i.getBaseUrl()+c.format(t.userProfileUrlTemplate,e.email))},t.prototype._calculateMissingGroupProperties=function(e,t){i.isNullOrUndefined(e.creationTime)&&(e.creationTime=Date.now()),i.isNullOrUndefined(e.pictureUrl)||(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),i.isNullOrUndefined(e.profileUrl)&&(e.profileUrl=this._getProfileUrl(t)),i.isNullOrUndefined(e.notebookUrl)&&!i.isNullOrUndefined(t)&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t))},t.prototype._calculateMissingMembershipProperties=function(e,t){var i=e.membersList.members;e.isMember=!1,e.isOwner=!1;for(var n=0;n<i.length;n++)i[n].email===t&&(e.isMember=!0),this._fixUserImages(i[n]);var o=e.ownersList.members;for(n=0;n<o.length;n++)o[n].email===t&&(e.isOwner=!0),this._fixUserImages(i[n]);e.isMember&&(e.isJoinPending=!1)},t.prototype._parseSiteLinks=function(e){var t=JSON.parse(e);return t.d.GetSiteLinks.LinkedSites.results.map(function(e){return{name:e.DisplayName,pictureUrl:e.PictureUrl,siteId:e.SiteId.toLowerCase().replace(/[{}]/g,""),webId:e.WebId.toLowerCase().replace(/[{}]/g,""),url:e.Url,groupId:e.GroupId.toLowerCase().replace(/[{}]/g,"")}})},t.prototype._parseGroups=function(e){var t=JSON.parse(e);return t.d.ownership.results.map(function(e){return{filesUrl:e.documentsUrl,name:e.displayName,id:e.id}})},t.prototype._parseGroup=function(e){var t=JSON.parse(e),i=this._copyGroup(t.d);return i},t.prototype._parseMembership=function(e){var t=JSON.parse(e),i=this._copyMembership(t.d);return i},t.prototype._parseUser=function(e){var t=JSON.parse(e),i=this._copyMember(t.d);return i},t.prototype._copyGroup=function(e){var t={};return i.isNullOrUndefined(e.description)||(t.description=e.description),i.isNullOrUndefined(e.alias)||(t.alias=e.alias),i.isNullOrUndefined(e.displayName)||(t.name=e.displayName),i.isNullOrUndefined(e.principalName)||(t.principalName=e.principalName),i.isNullOrUndefined(e.creationTime)||(t.creationTime=e.creationTime),i.isNullOrUndefined(e.pictureUrl)||(t.pictureUrl=e.pictureUrl),i.isNullOrUndefined(e.inboxUrl)||(t.inboxUrl=e.inboxUrl),i.isNullOrUndefined(e.calendarUrl)||(t.calendarUrl=e.calendarUrl),i.isNullOrUndefined(e.documentsUrl)||(t.filesUrl=e.documentsUrl),i.isNullOrUndefined(e.siteUrl)||(t.sharePointUrl=e.siteUrl),i.isNullOrUndefined(e.editGroupUrl)||(t.editUrl=e.editGroupUrl),i.isNullOrUndefined(e.peopleUrl)||(t.membersUrl=e.peopleUrl),i.isNullOrUndefined(e.notebookUrl)||(t.notebookUrl=e.notebookUrl),i.isNullOrUndefined(e.isPublic)||(t.isPublic=e.isPublic),i.isNullOrUndefined(e.mail)||(t.mail=e.mail),i.isNullOrUndefined(e.Description)||(t.description=e.Description),i.isNullOrUndefined(e.Alias)||(t.alias=e.Alias),i.isNullOrUndefined(e.DisplayName)||(t.name=e.DisplayName),i.isNullOrUndefined(e.PrincipalName)||(t.principalName=e.PrincipalName),i.isNullOrUndefined(e.CreationTime)||(t.creationTime=e.CreationTime),i.isNullOrUndefined(e.PictureUrl)||(t.pictureUrl=e.PictureUrl),i.isNullOrUndefined(e.InboxUrl)||(t.inboxUrl=e.InboxUrl),i.isNullOrUndefined(e.CalendarUrl)||(t.calendarUrl=e.CalendarUrl),i.isNullOrUndefined(e.DocumentsUrl)||(t.filesUrl=e.DocumentsUrl),i.isNullOrUndefined(e.SiteUrl)||(t.sharePointUrl=e.SiteUrl),i.isNullOrUndefined(e.EditGroupUrl)||(t.editUrl=e.EditGroupUrl),i.isNullOrUndefined(e.PeopleUrl)||(t.membersUrl=e.PeopleUrl),i.isNullOrUndefined(e.NotebookUrl)||(t.notebookUrl=e.NotebookUrl),i.isNullOrUndefined(e.IsPublic)||(t.isPublic=e.IsPublic),i.isNullOrUndefined(e.Mail)||(t.mail=e.Mail),t.membership=this._copyMembership(e),t},t.prototype._copyMembership=function(e){var t={};if(!i.isNullOrUndefined(e.members)){var n=this._copyMembers(e.members.results);t.membersList=n}if(!i.isNullOrUndefined(e.owners)){var o=this._copyMembers(e.owners.results);t.ownersList=o}if(i.isNullOrUndefined(e.isMember)||(t.isMember=e.isMember),i.isNullOrUndefined(e.isOwner)||(t.isOwner=e.isOwner),i.isNullOrUndefined(e.isJoinPending)||(t.isJoinPending=e.isJoinPending),!i.isNullOrUndefined(e.Members)){var n=this._copyMembers(e.Members.results);t.membersList=n}if(!i.isNullOrUndefined(e.Owners)){var o=this._copyMembers(e.Owners.results);t.ownersList=o}return i.isNullOrUndefined(e.IsMember)||(t.isMember=e.IsMember),i.isNullOrUndefined(e.IsOwner)||(t.isOwner=e.IsOwner),i.isNullOrUndefined(e.isJoinPending)||(t.isJoinPending=e.isJoinPending),t},t.prototype._copyMembers=function(e){for(var t=new n,i=new Array,o=0;o<e.length;o++){var r=this._copyMember(e[o]);i.push(r)}return t.members=i,t.totalCount=i.length,t},t.prototype._copyMember=function(e){var t={};return i.isNullOrUndefined(e.alias)||(t.sip=e.alias),i.isNullOrUndefined(e.id)||(t.userId=e.id),i.isNullOrUndefined(e.principalName)||(t.email=e.principalName),i.isNullOrUndefined(e.displayName)||(t.name=e.displayName),i.isNullOrUndefined(e.title)||(t.job=e.title),i.isNullOrUndefined(e.pictureUrl)||(t.image=e.pictureUrl),i.isNullOrUndefined(e.profilePage)||(t.profilePage=e.profilePage),i.isNullOrUndefined(e.Alias)||(t.sip=e.Alias),i.isNullOrUndefined(e.Id)||(t.userId=e.Id),i.isNullOrUndefined(e.PrincipalName)||(t.email=e.PrincipalName),i.isNullOrUndefined(e.DisplayName)||(t.name=e.DisplayName),i.isNullOrUndefined(e.Title)||(t.job=e.Title),i.isNullOrUndefined(e.PictureUrl)||(t.image=e.PictureUrl),i.isNullOrUndefined(e.ProfilePage)||(t.profilePage=e.ProfilePage),t
},t.groupBasicPropertiesUrlTemplate="Group('{0}')?$select=PrincipalName,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime",t.getUserGroupsUrlTemplate="GetSharePointDataForUser('{0}')?$expand=RankedMembership&$select=PrincipalName,RankedMembership/DisplayName,RankedMembership/DocumentsUrl,RankedMembership/PictureUrl,RankedMembership/Id",t.getUserOwnedGroupsUrlTemplate="GetSharePointDataForUser('{0}')?$expand=Ownership",t.groupMembershipUrlTemplate="Group('{0}')?$expand=Members,Owners&$select=Members/PrincipalName,Members/Id,Members/DisplayName,Members/PictureUrl,Owners/PrincipalName,Owners/Id,Owners/DisplayName,Owners/PictureUrl",t.addGroupMemberUrlTemplate="Group('{0}')/Members/Add('{1}')",t.removeGroupMemberUrlTemplate="Group('{0}')/Members/Remove('{1}')",t.getUserInfoUrlTemplate="GetGraphUser('{0}')",t.userProfileUrlTemplate="_layouts/15/me.aspx?p={0}&v=profile",t.userImageUrlTemplate="_layouts/15/userphoto.aspx?size=S&accountname={0}",t.getNotebookUrlTemplate="_api/GroupSiteManager/Notebook?groupId='{0}'",t.getSiteStatusUrlTemplate="_api/GroupSiteManager/GetSiteStatus?groupId='{0}'",t.groupStatusPageTemplate="_layouts/15/groupstatus.aspx?id={0}&target={1}",t.createSiteUrlTemplate="_api/GroupSiteManager/Create?groupId='{0}'",t.CsomGetUserGroupsBodyTemplate='<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',t.siteLinksTemplate="_api/SiteLinkingManager/GetSiteLinks",t.connectGroupTemplate="_api/SiteLinkingManager/LinkGroup?groupId='{0}'",t.disconnectGroupTemplate="_api/SiteLinkingManager/UnlinkGroup?groupId='{0}'",t}();return h}),define("odsp-next/utilities/groups/GroupConstants",["require","exports"],function(){var e=function(){function e(){}return e.ViewParamKey={GroupId:"GroupId",AppId:"AppId"},e.AppId={Profile:"Profile",Files:"Files",SharedWithUs:"SharedWithUs",RecycleBin:"RecycleBin",Outlook:"Outlook",Calendar:"Calendar",Notebook:"Notebook",Members:"Members"},e}();return e}),define("odsp-next/models/groups/apps/ProfileApp",["require","exports","../../../utilities/groups/GroupConstants","./GroupApp.resx"],function(e,t,i,n){var o=function(){function e(e){this.id=i.AppId.Profile,this.displayName=n.strings.ProfileLabel,this.url="",this.url=e}return e}();return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/base/GroupViewModel",["require","exports","odsp-shared/base/ViewModel","../resources/ProviderResourceKeys","../resources/UtilityResourceKeys","../Groups.resx"],function(e,t,i,n,o,r){var s=function(e){function t(t){e.call(this,t),this.appStrings=r.strings,this.groupsProvider=this.resources.consume(n.groups)}return __extends(t,e),t.prototype.idle=function(){return this.resources.consume(o.idle)},t.prototype.redirect=function(e){document.location.href=e},t}(i);return s});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/groups/ActionMap",["require","exports","knockout","../BaseActionMap","../odb/ActionMap","../UnsupportedAction"],function(e,t,i,n,o,r){var s=function(e){function t(){e.call(this);var t=new o;i.utils.extend(this,t),this.AlertAction=r}return __extends(t,e),t}(n);return s});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/groups/groupFiles/GroupFilesViewModel",["require","exports","knockout","../../../base/GroupViewModel","../../../utilities/list/odb/ListResources","odsp-utilities/logging/events/Qos.event","odsp-utilities/logging/events/Qos.event","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../resources/SPOResourceKeys","../../../actions/groups/ActionMap","../../standaloneList/StandaloneList"],function(e,t,i,n,o,r,s,a,l,c,d){var u=function(e){function t(t){var n=this;e.call(this,t),this.isReadyToRender=i.observable(!1);var o=this.resources.consume(l.topCommandSet);this.group=this.createPureComputed(function(){return n.groupsProvider.group().source(),n.groupsProvider.group()}),this._filesUrl=this.createPureComputed(function(){return n.group().ensureFilesUrl(),n.group().filesUrl}),this._hasInitializedResources=!1,this._setupListResources(this._filesUrl()),this.subscribe(this._filesUrl,function(e){n._setupListResources(e)}),this.standaloneListParams={hideCommandBar:!0,hideOverlayHost:!0,hideDialogHost:!0,hidePanelHost:!0,hideDragAndDropComponent:!0,topCommandSet:o},this.resources.expose(a.actionMap,new d)}return __extends(t,e),t.prototype._setupListResources=function(e){if(e)if(this._hasInitializedResources){var t=this.resources.consume(c.listItems);t.updateContext(e)}else{this._qos=new r.Qos({name:"GroupFiles.ExposeListResources"});try{var i=window._spPageContextInfo;i.listShouldRenderFilesTitle=!0,o.default.exposeResources({resourceScope:this.resources,hostSettings:i,listFullUrl:e}),this._hasInitializedResources=!0,this._qos.end({resultType:s.ResultTypeEnum.Success}),this.isReadyToRender(!0)}catch(n){this._qos.end({resultType:s.ResultTypeEnum.Failure,error:n})}}},t}(n);return u}),define("odsp-next/controls/groups/groupFiles/GroupFiles.html",[],function(){return"<section class=GroupFiles><!--ko if: isReadyToRender()--><div class=Files-content data-bind=\"component: { name: 'ms-standalone-list', params: standaloneListParams }\"></div><!--/ko--></section>"}),define("odsp-next/controls/groups/groupFiles/GroupFiles.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".GroupFiles{display:block}.GroupFiles .Files-content{position:absolute;width:100%;height:100%}")}),define("odsp-next/controls/groups/groupFiles/GroupFiles",["require","exports","./GroupFilesViewModel","odsp-shared/utilities/knockout/ComponentFactory","odsp-utilities/domUtils/DomUtils","./GroupFiles.html","./GroupFiles.css"],function(e,t,i,n,o){o.loadStyles("GroupFiles.css");var r=n.registerComponent({tagName:"ms-group-files",template:e("./GroupFiles.html"),viewModel:i});return r}),define("odsp-next/models/groups/apps/FilesApp",["require","exports","../../../utilities/groups/GroupConstants","./GroupApp.resx","../../../controls/groups/groupFiles/GroupFiles"],function(e,t,i,n,o){var r=n.strings,s=function(){function e(e){this.id=i.AppId.Files,this.displayName=r.FilesLabel,this.component=o,this.url=e}return e}();return s}),define("odsp-next/models/groups/apps/OutlookApp",["require","exports","./GroupApp.resx"],function(e,t,i){var n=i.strings,o=function(){function e(e){this.id="Outlook",this.displayName=n.ConversationsLabel,this.url=e}return e}();return o}),define("odsp-next/models/groups/apps/CalendarApp",["require","exports","./GroupApp.resx"],function(e,t,i){var n=i.strings,o=function(){function e(e){this.id="Calendar",this.displayName=n.CalendarLabel,this.url=e}return e}();return o}),define("odsp-next/models/groups/apps/NotebookApp",["require","exports","./GroupApp.resx"],function(e,t,i){var n=i.strings,o=function(){function e(e){this.id="Notebook",this.displayName=n.NotebookLabel,this.url=e}return e}();return o}),define("odsp-next/models/groups/apps/MembersApp",["require","exports","./GroupApp.resx"],function(e,t,i){var n=i.strings,o=function(){function e(e){this.id="Members",this.displayName=n.MembersLabel,this.url=e}return e}();return o}),define("odsp-next/models/groups/apps/PlannerApp",["require","exports","./GroupApp.resx"],function(e,t,i){var n=i.strings;t.EDogPlannerHost="tasks.officeppe.com",t.DefaultPlannerHost="tasks.office.com",t.PlannerUrlFormatString="https://{0}/{1}/Home/Group/{2}?auth_pvr=OrgId&auth_upn={3}";var o=function(){function e(e){this.id="Planner",this.displayName=n.PlannerLabel,this.url=e}return e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}),define("odsp-next/models/groups/SourceType",["require","exports"],function(){var e;return function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None"}(e||(e={})),e}),define("odsp-next/models/groups/Membership",["require","exports","knockout","./MembersList","./SourceType","../../utilities/groups/GroupsUtilities","odsp-utilities/async/Promise"],function(e,t,i,n,o,r,s){var a=function(){function e(e,t,s){this.source=i.observable(o.None),this.isLoadingFromServer=!1,this.error=i.observable(""),this.lastLoadTimeStampFromServer=-1,this._membersToAdd=new Array,this._membersToRemove=new Array,r.isNullOrUndefined(t)||(this._groupsProvider=t),r.isNullOrUndefined(s)||(this._parent=s),e&&this.extend(e),r.isNullOrUndefined(this.membersList)&&(this.membersList=new n),r.isNullOrUndefined(this.ownersList)&&(this.ownersList=new n)}return e.prototype.load=function(){var e=this;if(!r.isNullOrUndefined(this._groupsProvider)&&!r.isNullOrUndefined(this._parent.id)){if(this.source()===o.None){var t=this._groupsProvider.loadGroupInfoFromCache(this._parent.id);!r.isNullOrUndefined(t)&&!r.isNullOrUndefined(t.membership)&&t.membership.lastLoadTimeStampFromServer>0&&(this.extend(t.membership),this.source(o.Cache))}if(this._shouldLoadNewData()){this._startLoadingFromServer();var i=this._groupsProvider.loadMembershipContainerFromServer(this._parent.id);i.then(function(t){e.extend(t),e._finishLoadingFromServer(),e._groupsProvider.saveGroupToCache(e._parent)},function(t){e._errorLoading(t)})}}},e.prototype.save=function(){var e=this;if(!(r.isNullOrUndefined(this._groupsProvider)||r.isNullOrUndefined(this.membersList)||r.isNullOrUndefined(this._parent))){var t=this._groupsProvider.getCurrentUser();t.then(function(t){var i,n=[];for(i=0;i<e._membersToAdd.length;i++)n.push(e._groupsProvider.addUserToGroupMembership(e._parent.id,e._membersToAdd[i].userId));for(i=0;i<e._membersToRemove.length;i++)n.push(e._groupsProvider.removeUserFromGroupMembership(e._parent.id,e._membersToRemove[i].userId));var r=s.default.all(n).then(function(){for(i=0;i<e._membersToAdd.length;i++)e._addMember(e._membersToAdd[i],t);for(i=0;i<e._membersToRemove.length;i++)e._removeMember(e._membersToRemove[i],t);e._membersToAdd=new Array,e._membersToRemove=new Array,e.source(o.Cache),e.source(o.Server),e._groupsProvider.saveGroupToCache(e._parent)});return r})}},e.prototype.add=function(e){this._membersToAdd.push(e)},e.prototype.remove=function(e){this._membersToRemove.push(e)},e.prototype.extend=function(e){i.utils.extend(this,e),this._parent.membership=this},e.prototype._addMember=function(e,t){t.email===e.email?(this._parent.isPublic?this.isMember=!0:this.isJoinPending=!0,this.membersList.addUserToList(e)):(this._parent.isPublic||!this._parent.isPublic&&this.isOwner)&&this.membersList.addUserToList(e)},e.prototype._removeMember=function(e,t){t.email===e.email?(this.isMember=!1,this.membersList.removeUserFromList(e)):this.isOwner&&this.membersList.removeUserFromList(e)},e.prototype._shouldLoadNewData=function(){return!this.isLoadingFromServer&&this.source()!==o.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>12e4)},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.lastLoadTimeStampFromServer=Date.now(),this.source(o.Server)},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this.error(e)},e}();return a}),define("odsp-next/models/groups/GroupSiteStatus",["require","exports"],function(){var e;return function(e){e[e.NotFound=0]="NotFound",e[e.Provisioning=1]="Provisioning",e[e.Ready=2]="Ready",e[e.Error=3]="Error"}(e||(e={})),e}),define("odsp-next/models/groups/GroupSiteInfo",["require","exports","knockout","./GroupSiteStatus","./SourceType","../../utilities/groups/GroupsUtilities","odsp-utilities/async/Promise"],function(e,t,i,n,o,r,s){var a=function(){function e(e,t,s){this.source=i.observable(o.None),this.isLoadingFromServer=!1,this.error=i.observable(""),this.lastLoadTimeStampFromServer=-1,r.isNullOrUndefined(t)||(this._groupsProvider=t),r.isNullOrUndefined(s)||(this._parent=s),e&&this.extend(e),r.isNullOrUndefined(this.siteStatus)&&(this.siteStatus=n.NotFound)}return e.prototype.load=function(){var e=this;if(!r.isNullOrUndefined(this._groupsProvider)&&!r.isNullOrUndefined(this._parent.id)&&this._shouldLoadNewData()){this._startLoadingFromServer();var t=this._groupsProvider.getGroupSiteStatus(this._parent.id);t.then(function(t){e.extend(t),e._finishLoadingFromServer()},function(t){e._errorLoading(t)})}},e.prototype.save=function(){return s.default.wrap(null)},e.prototype.extend=function(e){i.utils.extend(this,e),this._parent.siteInfo=this},e.prototype._shouldLoadNewData=function(){return!this.isLoadingFromServer&&(this.source()!==o.Server||!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>6e4)},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.lastLoadTimeStampFromServer=Date.now(),this.source(o.Server)},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this.error(e)},e}();return a}),define("odsp-next/models/groups/Group",["require","exports","knockout","./apps/ProfileApp","./apps/FilesApp","./apps/OutlookApp","./apps/CalendarApp","./apps/NotebookApp","./apps/MembersApp","./apps/PlannerApp","./SourceType","./Membership","./GroupSiteInfo","../../utilities/groups/GroupsUtilities","odsp-utilities/async/Promise","odsp-shared/utilities/string/StringHelper"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,m,g){var f=function(){function e(e,t,n){this.source=i.observable(d.None),this.isLoadingFromServer=!1,this.error=i.observable(""),this.lastLoadTimeStampFromServer=-1,h.isNullOrUndefined(t)||(this._groupsProvider=t,h.isNullOrUndefined(e)&&(e=this._groupsProvider.loadGroupInfoFromCache(n))),n&&(this.id=n),h.isNullOrUndefined(e)||i.utils.extend(this,e),this.membership=new u(void 0,this._groupsProvider,this),this.siteInfo=new p(void 0,this._groupsProvider,this),this.createApps()}return e.prototype.load=function(){var e=this;if(!h.isNullOrUndefined(this._groupsProvider)&&!h.isNullOrUndefined(this.id)){if(this.source()===d.None){var t=this._groupsProvider.loadGroupInfoFromCache(this.id);!h.isNullOrUndefined(t)&&t.lastLoadTimeStampFromServer>0&&(this.extend(t),this.source(d.Cache))}if(this._shouldLoadNewData()){this._startLoadingFromServer();var i=this._groupsProvider.loadGroupInfoContainerFromServer(this.id);i.then(function(t){e.extend(t),e._finishLoadingFromServer(),e._groupsProvider.saveGroupToCache(e)},function(t){e._errorLoading(t)})}}},e.prototype.ensureFilesUrl=function(){var e=this;if(h.isNullOrUndefined(this.filesUrl)||""===this.filesUrl){var t=this._groupsProvider.getGroupSiteStatus(this.id);t.then(function(t){h.isNullOrUndefined(t.documentsUrl)||(e.filesUrl=t.documentsUrl,e.sharePointUrl=t.siteUrl),e._finishLoadingFromServer(),e._groupsProvider.saveGroupToCache(e)})}},e.prototype.save=function(){return h.isNullOrUndefined(this._groupsProvider)?void 0:(this._groupsProvider.saveGroupToCache(this),m.default.wrap(null))},e.prototype.extend=function(e){var t=this.membership,n=this.siteInfo;i.utils.extend(this,e),this.membership=t,this.siteInfo=n,this.createApps()},e.prototype.getAppById=function(e){for(var t=0;t<this.appsList.length;t++){var i=this.appsList[t];if(i.id===e)return i}return null},e.prototype.getFilesNavUrl=function(){return h.isNullOrUndefined(this.filesUrl)?this._groupsProvider.getFallbackFilesUrl(this.id):this.filesUrl},e.prototype.createApps=function(){if(this.appsList=[],this.appsList.push(new n(this.profileUrl)),this.appsList.push(new o(this.filesUrl)),this.appsList.push(new r(this.inboxUrl)),this.appsList.push(new s(this.calendarUrl)),this.appsList.push(new a(this.notebookUrl)),this.appsList.push(new l(this.membersUrl)),null!=this._groupsProvider&&this._groupsProvider.hostSettings){var e="EDog"===this._groupsProvider.hostSettings.env?c.EDogPlannerHost:c.DefaultPlannerHost,t=this._groupsProvider.hostSettings.currentUICultureName,i=this._groupsProvider.hostSettings.userLoginName,d=g.format(c.PlannerUrlFormatString,e,t,this.id,i);this.appsList.push(new c.default(d))}},e.prototype._shouldLoadNewData=function(){return!this.isLoadingFromServer&&this.source()!==d.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>6e4)},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.lastLoadTimeStampFromServer=Date.now(),this.source()===d.Server&&this.source(d.Cache),this.source(d.Server)},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this.error(e)},e}();return f}),define("odsp-next/providers/groups/GroupsProvider",["require","exports","knockout","../../resources/SPOResourceKeys","odsp-utilities/models/store/DataStoreCachingType","../../resources/ModelResourceKeys","../../resources/DataSourceResourceKeys","../../models/groups/Group","../../models/groups/SourceType","../../utilities/groups/GroupsUtilities","odsp-utilities/async/Promise"],function(e,t,i,n,o,r,s,a,l,c,d){var u=function(){function e(e){this._groups=new Array,this._dataSource=this.resources.consume(s.groups),this._dataStore=this.resources.consume(r.dataStore),this.currentUser=i.observable(null),this.group=i.observable(null),this.userGroups=i.observableArray(null),this.userOwnedGroups=i.observableArray(null),this.userOwnedGroupsLoaded=i.observable(!1);try{var t=this.resources.consume(n.hostSettings);this.hostSettings=t,null!=t&&(this._userLoginName=t.userLoginName)}catch(o){}c.isNullOrUndefined(e)||this.switchCurrentGroup(e)}return e.prototype.loadGroupInfoFromCache=function(e){if(!c.isNullOrUndefined(this._dataStore)&&!c.isNullOrUndefined(e)){var t=this._dataStore.getValue(e,o.local);return t}},e.prototype.saveGroupToCache=function(e){c.isNullOrUndefined(this._dataStore)||c.isNullOrUndefined(e)||this._dataStore.setValue(e.id,e,o.local)},e.prototype.loadGroupInfoContainerFromServer=function(e){return c.isNullOrUndefined(e)?void 0:this._dataSource.getGroupBasicProperties(e)},e.prototype.loadMembershipContainerFromServer=function(e){return c.isNullOrUndefined(e)||c.isNullOrUndefined(this._userLoginName)?void 0:this._dataSource.getGroupMembership(e,this._userLoginName)},e.prototype.loadUserGroups=function(){var e=this;this.getCurrentUser().then(function(t){e.loadUserGroupsFromCache();var i=e._dataSource.getUserGroups(t);i.then(function(i){e._dataStore.setValue("UserGroups"+t.userId,i,o.local),e._setUsersGroups(i,l.Server)})})},e.prototype.loadUserGroupsFromCache=function(){var e=this;this.getCurrentUser().then(function(t){var i=e._dataStore.getValue("UserGroups"+t.userId,o.local);null!=i&&e._setUsersGroups(i,l.Cache)})},e.prototype.loadUserOwnedGroups=function(){var e=this;this.getCurrentUser().then(function(t){var i=e._dataSource.getUserOwnedGroups(t);i.then(function(t){var i=t.map(function(t){var i=e.getCachedGroup(t.id);return i.extend(t),i});e.userOwnedGroups(i),e.userOwnedGroupsLoaded(!0)})})},e.prototype.getCurrentUser=function(){var e=this;return c.isNullOrUndefined(this._userLoginName)?d.default.wrapError("Missing user login name information in getCurrentUser"):c.isNullOrUndefined(this.currentUser())?this._dataSource.getUserInfo(this._userLoginName).then(function(t){return e.currentUser(t),t}):d.default.wrap(this.currentUser())},e.prototype.addUserToGroupMembership=function(e,t){return c.isNullOrUndefined(e)||c.isNullOrUndefined(t)?void 0:this._dataSource.addGroupMember(e,t)},e.prototype.removeUserFromGroupMembership=function(e,t){return c.isNullOrUndefined(e)||c.isNullOrUndefined(t)?void 0:this._dataSource.removeGroupMember(e,t)},e.prototype.checkSiteAndAliasAvailability=function(e){return"abc"===e?!0:!1},e.prototype.createGroup=function(e,t,i){return this._dataSource.sendCreateGroupOperation(e,t,i)},e.prototype.getNotebookUrl=function(e){return c.isNullOrUndefined(e)?void 0:this._dataSource.getNotebookUrl(e)},e.prototype.getGroupSiteStatus=function(e){return c.isNullOrUndefined(e)?void 0:this._dataSource.getSiteStatus(e)},e.prototype.createGroupSite=function(e){return c.isNullOrUndefined(e)?void 0:this._dataSource.createSite(e)},e.prototype.switchCurrentGroup=function(e){var t=c.isNullOrUndefined(this.group())?null:this.group().id;if(!c.isNullOrUndefined(e)&&e!==t){var i=this.getCachedGroup(e);i.load(),this.group(i)}},e.prototype.isCrossDomainManagerReady=function(){return this._dataSource.isCrossDomainManagerReady()},e.prototype.getFallbackFilesUrl=function(e){return this._dataSource.getFallbackFilesUrl(e)},e.prototype.getCachedGroup=function(e){var t=this._groups[e];return c.isNullOrUndefined(t)&&(t=new a(null,this,e),this._groups[e]=t),t},e.prototype._setUsersGroups=function(e,t){var i=this;this.userGroups(e.map(function(e){var n=i.getCachedGroup(e.id);return(t===l.Server||n.source()!==l.Server)&&n.extend(e),c.isNullOrUndefined(n.pictureUrl)&&n.load(),n}))},e}();return u});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/CreateGroupAction",["require","exports","../base/BaseAction","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../controls/groups/groupCreate/GroupCreate.resx","../utilities/groups/GroupsUtilities"],function(e,t,i,n,o,r,s){var a=function(e){function t(t){e.call(this,t),this.name="CreateGroup",this.groupName=t.groupName,this.groupAlias=t.groupAlias,this.privacySelected=t.privacySelected}return __extends(t,e),t.prototype.onExecute=function(){var e=this,t=this.privacySelected()===r.strings.privacyDropdownPublicOption,i=this.resources.consume(n.groups);return o.Qos.instrumentPromise({name:"CreateGroupAction.CreateGroup"},function(){return i.createGroup(e.groupName(),e.groupAlias(),t).then(function(e){if("201"===e.status.toString()){var t=JSON.parse(e.response),i=t.objectId;return document.location.href=s.getBaseUrl()+"_layouts/15/groupstatus.aspx?id="+i,{resultType:o.ResultTypeEnum.Success}}return{resultType:o.ResultTypeEnum.Failure}},function(){return{resultType:o.ResultTypeEnum.Failure}})},function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})},t.prototype.onIsAvailable=function(){return!0},t}(i);return a});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/groups/groupCreate/GroupCreatePanelCommandSet",["require","exports","knockout","../../../actions/CreateGroupAction","odsp-shared/base/BaseModel","../../commands/CommandViewModel","../../commands/Commands.resx","../../../utilities/icons/Icon"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){e.call(this,t),this.commands=i.observableArray(),this.isDisabled=i.observable(!1),this.isLabelVisible=i.observable(!0);var o={groupName:t.commandViewModel.groupName,groupAlias:t.commandViewModel.groupAlias,privacySelected:t.commandViewModel.privacySelectedValue};this.commands=i.observableArray([new r({text:s.strings.CreateGroup,isLabelVisible:this.isLabelVisible,isDisabled:this.isDisabled,icon:a.circlePlus,action:new(this.managed(n))(o),engagementName:"CreateGroup.CreateGroupPanelCommandTop"})])}return __extends(t,e),t}(o);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/textFormField/TextFormFieldViewModel",["require","exports","odsp-shared/base/ViewModel","knockout"],function(e,t,i,n){var o=function(e){function t(t){e.call(this,t),this.label=t.label,this.value=t.value,this.isDisabled=n.observable(!1),this.multiline=n.observable(!1),t.isDisabled&&(this.isDisabled=t.isDisabled),t.multiline&&(this.multiline=t.multiline)}return __extends(t,e),t}(i);return o}),define("odsp-next/controls/textFormField/TextFormField.html",[],function(){return'<label class=ms-TextField data-bind="css: { \'ms-TextFormField--multiline\': multiline }"><span class=ms-Label data-bind="text: label"></span><!--ko ifnot: multiline--><input class=ms-TextField-field data-bind="textInput: value, disable: isDisabled"><!--/ko--><!--ko if: multiline--><textarea class=ms-TextField-field data-bind="value: value, disable: isDisabled"></textarea><!--/ko--></label>'}),define("odsp-next/controls/textFormField/TextFormField",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./TextFormFieldViewModel","./TextFormField.html"],function(e,t,i,n){var o=i.registerComponent({tagName:"ms-textformfield",template:e("./TextFormField.html"),viewModel:n});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/dropdownFormField/DropdownFormFieldViewModel",["require","exports","odsp-shared/base/ViewModel"],function(e,t,i){var n=function(e){function t(t){e.call(this,t),this.label=t.label,this.options=t.options,this.selectedOption=t.selectedOption}return __extends(t,e),t}(i);return n}),define("odsp-next/controls/dropdownFormField/DropdownFormField.html",[],function(){return'<label><!--ko if: label--><span class=ms-Label data-bind="text: label"></span><!--/ko--><select class=od-DropdownFormField-select data-bind="options: options, value: selectedOption"></select></label>'}),define("odsp-next/controls/dropdownFormField/DropdownFormField.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-DropdownFormField-select{width:100%;margin-bottom:10px}")}),define("odsp-next/controls/dropdownFormField/DropdownFormField",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./DropdownFormFieldViewModel","./DropdownFormField.html","./DropdownFormField.css"],function(e,t,i,n){var o=i.registerComponent({tagName:"ms-dropdownformfield",template:e("./DropdownFormField.html"),viewModel:n});return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/groups/groupCreate/GroupCreateViewModel",["require","exports","knockout","./GroupCreatePanelCommandSet","../../../base/GroupViewModel","./GroupCreate.resx","../../textFormField/TextFormField","../../dropdownFormField/DropdownFormField","../../../resources/UtilityResourceKeys"],function(e,t,i,n,o,r,s,a,l){var c=function(e){function t(t){e.call(this,t),this.textFormTag=s.tagName,this.dropdownFormTag=a.tagName,this.groupName=i.observable(""),this.nameTextFieldParams={value:this.groupName,label:i.observable(r.strings.nameTextboxLabel)},this.groupCustomAlias=i.observable(""),this.useCustomAlias=i.observable(!1),this.isAliasTextboxDisabled=i.observable(!0),this.groupAlias=i.pureComputed({read:function(){return this.useCustomAlias()?this.groupCustomAlias():this._generateAliasFromGroupName()},write:function(e){this.groupCustomAlias(e)},owner:this}),this.addDisposable(this.groupAlias),this.aliasTextFieldParams={value:this.groupAlias,label:i.observable(r.strings.aliasTextboxLabel),isDisabled:this.isAliasTextboxDisabled},this.privacySelectedValue=i.observable(r.strings.privacyDropdownPublicOption),this.privacyDropdownFieldParams={options:i.observableArray([r.strings.privacyDropdownPublicOption,r.strings.privacyDropdownPrivateOption]),selectedOption:this.privacySelectedValue,label:i.observable(r.strings.privacyDropdownLabel)},this.groupIdStatusColour=i.observable(!0),this.isEditVisible=i.observable(!0),this.groupIdStatusValue=this.createComputed(this._checkAliasSiteAvailability,this).extend({rateLimit:500}),this._platform=this.resources.consume(l.platformDetection),this.isActive=i.observable(!0),this.isMobile=this._platform.isMobile,this.commandSet=new(this.managed(n))({commandViewModel:this}),this.commandBarParams={commandSet:this.commandSet,isMobile:this.isMobile,isActive:this.isActive}}return __extends(t,e),t._isValidFirstChar=function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||e>="0"&&"9">=e||"-"===e},t._isValidChar=function(e){return this._isValidFirstChar(e)||"_"===e},t.prototype.enableAliasTextbox=function(){this.useCustomAlias(!0),this.groupCustomAlias(this._generateAliasFromGroupName()),this.isAliasTextboxDisabled(!1),this.isEditVisible(!1)},t.prototype._generateAliasFromGroupName=function(){return this._generateAlias(this.groupName())},t.prototype._generateAlias=function(e){var i="";if("string"==typeof e)for(var n=0;n<e.length;n++){var o=e.charAt(n);(0!==i.length&&t._isValidChar(o)||t._isValidFirstChar(o))&&(i+=o)}return i},t.prototype._checkAliasSiteAvailability=function(){if(!this.useCustomAlias()&&""===this.groupName())return"";if(this.useCustomAlias()){if(this.groupAlias()!==this._generateAlias(this.groupAlias()))return this.groupIdStatusColour(!1),r.strings.aliasErrorMessageNoSymbols;if(""===this.groupAlias())return this.groupIdStatusColour(!1),r.strings.aliasErrorMessageEmptyString}return this.groupsProvider.checkSiteAndAliasAvailability(this.groupAlias())?(this.groupIdStatusColour(!0),r.strings.aliasMessageAvailable):(this.groupIdStatusColour(!1),r.strings.aliasMessageNotAvailable)},t}(o);return c}),define("odsp-next/controls/groups/groupCreate/GroupCreate.html",[],function(){return'<div class=od-GroupCreate><div class="od-GroupCreate-commandBar od--hasSelection" data-bind="component: { name: \'ms-command-bar\', params: commandBarParams }"></div><div data-bind="component: { name: textFormTag, params: nameTextFieldParams }"></div><div data-bind="css: { \'od-GroupCreate-customAlias--inactive\': isEditVisible, \'od-GroupCreate-customAlias--active\': !isEditVisible() }"><div class=od-GroupCreate-aliastextField data-bind="component: { name: textFormTag, params: aliasTextFieldParams}"></div><span class=od-GroupCreate-editAlias data-bind="visible: isEditVisible"><i class="ms-Icon ms-Icon--pencil" data-bind="click: enableAliasTextbox"></i></span></div><span class=ms-font-xs data-bind="text: groupIdStatusValue, css: { \'ms-fontColor-green\': groupIdStatusColour, \'ms-fontColor-red\': !groupIdStatusColour() }"></span><div data-bind="component: { name: dropdownFormTag, params: privacyDropdownFieldParams }"></div><!--<div class="GroupCreate-peoplePicker" data-bind="component: {name: peoplePickerTagName, params: peoplePickerParams}"></div>--></div>'}),define("odsp-next/controls/groups/groupCreate/GroupCreate.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-GroupCreate-aliastextField{display:inline-block;width:100%}html[dir=ltr] .od-GroupCreate-customAlias--active{padding-right:0}html[dir=rtl] .od-GroupCreate-customAlias--active{padding-left:0}html[dir=ltr] .od-GroupCreate-customAlias--inactive{padding-right:27px}html[dir=rtl] .od-GroupCreate-customAlias--inactive{padding-left:27px}.od-GroupCreate-editAlias{display:inline-block;position:absolute;padding-top:34px}html[dir=ltr] .od-GroupCreate-editAlias{float:right;padding-left:10px}html[dir=rtl] .od-GroupCreate-editAlias{float:left;padding-right:10px}.od-GroupCreate-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:#beddf4}")
}),define("odsp-next/controls/groups/groupCreate/GroupCreate",["require","exports","knockout","./GroupCreateViewModel","odsp-shared/utilities/knockout/ViewModelFactory","./GroupCreate.html","./GroupCreate.css"],function(e,t,i,n,o){var r={tagName:"ms-group-create",template:e("./GroupCreate.html"),viewModel:o.createViewModelHelper(n)};return i.components.isRegistered(r.tagName)||i.components.register(r.tagName,r),r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/actions/LaunchCreateGroupPanelAction",["require","exports","../base/BaseAction","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../controls/groups/groupCreate/GroupCreate","../utilities/features/Features","./NavigationAction"],function(e,t,i,n,o,r,s,a){var l=function(e){function t(t){e.call(this,t),this.name="CreateGroupPanel",this._exchangeCreateUrl=t.exchangeCreateGroupUrl}return __extends(t,e),t.prototype.onExecute=function(e){var t=this.resources.consume(n.groups),i=!0;if(s.default.isFeatureEnabled(s.default.CrossDomainGroupCreate)&&t.isCrossDomainManagerReady()&&(i=!1),i){var l=new(this.managed(a))({url:this._exchangeCreateUrl,target:"_blank"});return l.execute(e)}var c=this.resources.consume(n.panel),d=c.requestPanel({hasCommandBar:!0,noTitle:!0,component:{name:r.tagName,params:{}}});return d.wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})},t.prototype.onIsAvailable=function(){return!0},t}(i);return l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/providers/groups/GroupsLeftNavProvider",["require","exports","knockout","../../resources/ProviderResourceKeys","../../controls/leftNav/LeftNavRenderStyle","../../utilities/icons/Icon","./GroupsLeftNav.resx","odsp-shared/base/BaseModel","../../actions/LaunchCreateGroupPanelAction","odsp-shared/utilities/string/StringHelper","../../utilities/uri/Uri"],function(e,t,i,n,o,r,s,a,l,c,d){var u=5,p=function(e){function t(t){e.call(this,t),this._plusIconProperties=i.observable(null),this._exchangeUrl=null,this._LOADING_STATE={text:s.strings.loading,isFocused:i.observable(!1),isActive:this.createPureComputed(function(){return!1}),renderAs:o.Load,icon:r.plus}}return __extends(t,e),t.prototype.getGroupLinkGroup=function(){var e=this;if(null==this.groupLinks){this.groupLinks=i.observableArray();var t=this.resources.consume(n.groups),a=t.userGroups;this._leftNavItems=this.createComputed(function(){a().length>0?e.groupLinks(a().map(function(n){return n.source(),{text:n.name,url:n.getFilesNavUrl(),isActive:e.createPureComputed(function(){return null!=t.group()?t.group().id===n.id:void 0}),isFocused:i.observable(!1),icon:r.group,iconOverlayImageUrl:n.pictureUrl,renderAs:o.GroupLink,engagementName:"Group"}})):e._exchangeUrl&&e.groupLinks([{text:s.strings.emptyGroupIntroText,isActive:e.createPureComputed(function(){return!1}),isFocused:i.observable(!1),renderAs:o.Text},{text:s.strings.browseGroups,url:e._constructExchangeBrowseUrl(e._exchangeUrl),isFocused:i.observable(!1),isActive:e.createPureComputed(function(){return!1}),icon:r.arrowRight,openInNewTab:e.createPureComputed(function(){return!0}),engagementName:"EmptyBrowseGroup"},{text:s.strings.createGroups,url:"javascript:;",isFocused:i.observable(!1),isActive:e.createPureComputed(function(){return!1}),icon:r.plus,action:new(e.managed(l))({exchangeCreateGroupUrl:e._constructExchangeCreateUrl(e._exchangeUrl)}),engagementName:"EmptyCreateGroup"}])}).extend({rateLimit:200}),this._getExchangeUrl(),t.loadUserGroups()}return{text:s.strings.groupsNavCategory,url:"#",isExpanded:i.observable(!0),isActive:this.createComputed(function(){return!1}),isFocused:i.observable(!1),links:this.groupLinks,plusIconProperties:this._plusIconProperties,hideLinksAfterFoldAfter:u,engagementName:"Groups"}},t.prototype.getLinkGroups=function(){return i.observableArray([this.getGroupLinkGroup()])},t.prototype._getExchangeUrl=function(){var e=this;if(!this._plusIconProperties||!this._plusIconProperties()){var t=this.resources.consume(n.suiteNav);if(t){var i=t.getMailUrl();i.then(function(t){if(t){var i=new d(t);e._exchangeUrl=i.getStringWithoutQueryAndFragment(),e._plusIconProperties({text:s.strings.createGroups,action:new(e.managed(l))({exchangeCreateGroupUrl:e._constructExchangeCreateUrl(e._exchangeUrl)}),engagementName:"CreateGroupFloatingPlus"}),0===e.groupLinks().length&&e.groupLinks([e._LOADING_STATE])}})}}},t.prototype._constructExchangeCreateUrl=function(e){return c.format("{0}#path=/mail/action/createmoderngroup",e)},t.prototype._constructExchangeBrowseUrl=function(e){return c.format("{0}#path=/people/browsegroups",e)},t}(a);return p});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/files/odb/GroupsLeftNavInit",["require","exports","../../../dataSources/groups/FBIDataSource","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","../../../providers/groups/GroupsProvider","../../../providers/groups/GroupsLeftNavProvider","odsp-shared/base/BaseModel","odsp-utilities/models/store/BaseDataStore","../../../resources/ModelResourceKeys"],function(e,t,i,n,o,r,s,a,l,c){var d=function(e){function t(){e.call(this);var t=this.resources;t.expose(c.dataStore,new l("GroupsNext")),t.expose(n.groups,new(t.injected(i))),t.expose(o.groups,new(t.injected(r))(null)),t.expose(o.groupsLeftNav,new(t.injected(s)));var a=t.consume(o.groupsLeftNav),d=t.consume(n.leftNav);if(d.isPersonalOneDrive()){var u=d.linkGroups();u.push(a.getGroupLinkGroup()),d.linkGroups(u)}}return __extends(t,e),t}(a);return d});
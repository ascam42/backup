var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-shared/models/store/KnockoutDataStore",["require","exports","odsp-utilities/models/store/DataStoreCachingType","odsp-utilities/models/store/BaseDataStore","../../base/BaseModel"],function(e,t,i,s,n){var a=function(e){function t(t,n){void 0===n&&(n=i.none),e.call(this),this.dataStore=new s(t,n)}return __extends(t,e),t.prototype.persistBoolean=function(e,t){var i=this,s=this.getValue(t);void 0!==s&&e("true"===s),this.subscribe(e,function(e){return i.setValue(t,String(e))})},t.prototype.persistNumber=function(e,t){var i=this,s=this.getValue(t);void 0!==s&&e(Number(s)),this.subscribe(e,function(e){return i.setValue(t,String(e))})},t.prototype.persistString=function(e,t){var i=this,s=this.getValue(t);void 0!==s&&e(s),this.subscribe(e,function(e){return i.setValue(t,e)})},t.prototype.setValue=function(e,t,i){this.dataStore.setValue(e,t,i)},t.prototype.getValue=function(e,t){return this.dataStore.getValue(e,t)},t.prototype.remove=function(e,t){this.dataStore.remove(e,t)},t}(n);Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}),define("odsp-next/utilities/flash/FlashHelper",["require","exports","odsp-utilities/domUtils/DomUtils","odsp-utilities/logging/ErrorHelper"],function(e,t,i,s){var n,a=function(){function e(){}return e.checkFlashSupport=function(t,i){n?i(e._isVersionAcceptable(t)):e._evaluateFlash(t,i)},e._evaluateFlash=function(t,a){function o(){var i;try{i=l.GetVariable("$version")}catch(s){}i?(n=e._parseVersionString(i),r(e._isVersionAcceptable(t))):d>0?(d--,setTimeout(o,10)):(u.removeChild(l),n=[],r(!1))}function r(e){try{a(e)}catch(t){s.log(t)}}var l,d=10,u=document.body;if(window.ActiveXObject)try{var h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");n=h?e._parseVersionString(h.Getletiable("$version")):[]}catch(c){n=[]}finally{r(e._isVersionAcceptable(t))}else l=i.ce("OBJECT"),l.style.position="absolute",l.style.left="99999px",l.setAttribute("type","application/x-shockwave-flash"),u.appendChild(l),o()},e._parseVersionString=function(e){var t=(e||"").split(" "),i=t.length>1?t[1].split(","):"";return i.length>2?[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]:[]},e._isVersionAcceptable=function(e){return!(!e||3!==e.length||3!==n.length||!(n[0]>e[0]||n[0]===e[0]&&n[1]>e[1]||n[0]===e[0]&&n[1]===e[1]&&n[2]>=e[2]))},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}),define("odsp-next/controls/video/item/canvas/VideoCanvasType",["require","exports"],function(e,t){var i=function(){function e(){}return e.flash="flash",e.html="html",e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}),define("odsp-next/controls/video/item/VideoPlaybackType",["require","exports"],function(e,t){var i;!function(e){e[e.none=0]="none",e[e.flashDash=1]="flashDash",e[e.flashMp4=2]="flashMp4",e[e.htmlMp4=3]="htmlMp4",e[e.htmlDashling=4]="htmlDashling",e[e.htmlHls=5]="htmlHls"}(i||(i={})),Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}),define("odsp-next/controls/video/item/VideoErrorType",["require","exports"],function(e,t){var i;!function(e){e[e.none=0]="none",e[e.unknown=1]="unknown",e[e.unsupportedFormat=2]="unsupportedFormat",e[e.unsupportedBrowser=3]="unsupportedBrowser",e[e.getDownloadUrlFailure=4]="getDownloadUrlFailure",e[e.htmlElementDecode=5]="htmlElementDecode",e[e.htmlElementNetwork=6]="htmlElementNetwork",e[e.htmlElementAborted=7]="htmlElementAborted",e[e.htmlDashling=8]="htmlDashling",e[e.htmlOther=9]="htmlOther",e[e.flashOther=10]="flashOther"}(i||(i={})),Object.defineProperty(t,"__esModule",{value:!0}),t.default=i});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/PlaybackMonitor",["require","exports","odsp-shared/base/BaseModel","odsp-utilities/logging/events/Qos.event","./logging/Video.event","./logging/VideoPlayback.event","./VideoPlaybackType","./VideoErrorType"],function(e,t,i,s,n,a,o,r){var l=5e3,d=.9,u=function(e){function t(t){e.call(this,t);var i=this._context=t.context;this.subscribe(i.itemKey,this._onItemKeyChanged),this.subscribe(i.isPlaying,this._onIsPlayingChanged),this.subscribe(i.position,this._onPositionChanged),this.subscribe(i.videoStatus,this._onVideoStatusChanged),this._shouldMonitorPlayback=this.createPureComputed(this._computeShouldMonitorPlayback),this.subscribe(this._shouldMonitorPlayback,this._onShouldMonitorPlaybackChanged),this.subscribe(i.isLoading,this._onIsLoadingChanged),this._onItemKeyChanged(i.itemKey())}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._reportLoadEnd(!1,{disposed:!0})},t.prototype._onItemKeyChanged=function(e){var t=!0;e&&t&&(this._loadStartTime=(new Date).getTime(),this._isMonitoringLoad=!0,this._reportLoadStart())},t.prototype._onIsPlayingChanged=function(e){this._isMonitoringLoad&&e&&(this._loadStartTime=(new Date).getTime())},t.prototype._onPositionChanged=function(e){if(this._isMonitoringLoad){var t=this._context,i=t.isLoading(),s=t.canPlay(),n=t.isPlaying(),a=t.videoStatus().isVisible;!i&&s&&n&&!a&&e>0&&this._reportLoadEnd(!0)}},t.prototype._onVideoStatusChanged=function(e){this._isMonitoringLoad&&e.isVisible&&this._reportLoadEnd(!1,e.errorDetails,e.errorType)},t.prototype._computeShouldMonitorPlayback=function(){var e=this._context,t=e.isPlaying(),i=e.canPlay(),s=e.isSeeking(),n=e.duration(),a=i&&t&&!s&&n>0;return a},t.prototype._onShouldMonitorPlaybackChanged=function(e){e?this._checkPlaybackProgress(!0):this.async.clearTimeout(this._monitorPlaybackTimerId)},t.prototype._onIsLoadingChanged=function(e){e||!this._shouldMonitorPlayback()||this._isMonitoringPlayback||this._checkPlaybackProgress(!0)},t.prototype._checkPlaybackProgress=function(e){var t=this._context.position();if(this._isMonitoringPlayback=!1,!e){var i=this._lastPlaybackProgressPosition+l*d/1e3;this._reportPlaybackProgress(i>t?!1:!0)}this._lastPlaybackProgressTime=(new Date).getTime(),this._lastPlaybackProgressPosition=t;var s=this._context.duration(),n=s-l/1e3;n>t&&(this._isMonitoringPlayback=!0,this._monitorPlaybackTimerId=this.async.setTimeout(this._checkPlaybackProgress,l))},t.prototype._reportLoadStart=function(){this._loadEvent=new n.default({name:"Load",playbackType:o.default[this._context.playbackType()]})},t.prototype._reportLoadEnd=function(e,t,i){if(this._isMonitoringLoad){this._isMonitoringLoad=!1;var n=i&&r.default[i];this._loadEvent.end({resultType:e?s.ResultTypeEnum.Success:s.ResultTypeEnum.Failure,resultCode:n,extraData:t})}},t.prototype._reportPlaybackProgress=function(e){a.default.logData({name:"Progress",playbackType:o.default[this._context.playbackType()],resultType:e?s.ResultTypeEnum.Success:s.ResultTypeEnum.Failure})},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/VideoContext",["require","exports","knockout","odsp-shared/base/BaseModel","../../../resources/DataSourceResourceKeys","odsp-shared/utilities/string/StringHelper","./ItemVideoPlayer.resx","odsp-shared/models/store/KnockoutDataStore","odsp-utilities/models/store/DataStoreCachingType","odsp-utilities/browser/PlatformDetection","../../../utilities/flash/FlashHelper","odsp-utilities/async/Promise","./canvas/VideoCanvasType","./VideoPlaybackType","./VideoErrorType","./PlaybackMonitor","../../../utilities/features/Features"],function(e,t,i,s,n,a,o,r,l,d,u,h,c,p,m,g,f){function _(){"use strict";var e=document.createElement("video");if(e&&e.canPlayType)try{var t;t=e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),k=""!==t&&"no"!==t.toLowerCase(),t=e.canPlayType('audio/wav; codecs="1"'),A=t&&"no"!==t.toLowerCase(),t=e.canPlayType("application/vnd.apple.mpegURL"),M=""!==t&&"no"!==t.toLowerCase()&&(I.isMac||I.isIOS),D=!(!k||!window.MediaSource&&!window.WebKitMediaSource),I.isWindows&&I.isChrome&&I.browserMajor<=34&&(D=!1),I.isSafari&&(D=!1),f.default.isFeatureEnabled(f.default.MinimalVideoSupport)&&(D=!1,w=y.unsupported)}catch(i){}}var y,v=o.strings,b=!1,x="",S="PCM",P="H264",E=[10,0,0];!function(e){e[e.unknown=0]="unknown",e[e.evaluating=1]="evaluating",e[e.supported=2]="supported",e[e.unsupported=3]="unsupported"}(y||(y={}));var k=!1,A=!1,M=!1,D=!1,w=y.unknown,I=new d;_();var T=function(e){function t(t){e.call(this,t),this._itemDataSource=this.resources.consume(n.items),this._item=t.item,this._dataStore=this.addDisposable(new r.default("ItemVideoPlayer",l.local)),this.itemKey=this.createPureComputed(this._computeItemKey),this.shouldAutoPlay=this._computeShouldAutoPlay(),this.shouldUseNativeControls=this._computeShouldUseNativeControls(),this.playbackType=i.observable(p.default.htmlDashling),this.url=i.observable(null),this.coverImageUrl=i.observable(""),this.isLoading=i.observable(!1),this.canPlay=i.observable(!1),this.isPlaying=i.observable(this.shouldAutoPlay),this.isAdjustingVolume=i.observable(!1),this.position=i.observable(0),this.seekPercentage=i.observable(0),this.isSeeking=i.observable(!1),this.isScrubbing=i.observable(!1),this.duration=i.observable(0),this.bufferedRanges=i.observableArray(),this.isMaximized=i.observable(!1),this.videoStatus=i.observable(null),this.playingQuality=i.observable(480),this.maxQuality=i.observable(720),this.dashling=i.observable(),this.canShowDiagnostics=!0,this.isMuted=i.observable(!1),this._dataStore.persistBoolean(this.isMuted,"isMuted"),this.volume=i.observable(1),this._dataStore.persistNumber(this.volume,"volume"),this.desiredQuality=i.observable(480),this._dataStore.persistNumber(this.desiredQuality,"desiredQuality"),this.isABREnabled=i.observable(!0),this._dataStore.persistBoolean(this.isABREnabled,"isABREnabled"),this.isDiagnosticsEnabled=i.observable(!1),this._dataStore.persistBoolean(this.isDiagnosticsEnabled,"isDiagnosticsEnabled"),this.hasError=this.createPureComputed(this._computeHasError),this.canvasType=this.createPureComputed(this._computeCanvasType),this.canAdjustQuality=this.createPureComputed(this._computeCanAdjustQuality),this.subscribe(this._item,this._onItemChanged),this.subscribe(this.isAdjustingVolume,this._onIsAdjustingVolumeChanged),this.subscribe(this.isPlaying,this._onIsPlayingChanged),this._onItemChanged(this._item.peek()),this._playbackMonitor=new(this.managed(g.default))({context:this})}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._cancelGetDownload()},t.prototype.setVideoStatus=function(e){var t=e.displayMessage,i=e.errorType,s=void 0===i?m.default.none:i,n=e.errorDetails,a=void 0===n?null:n,o=e.isRetriable,r=void 0===o?!0:o;this.isLoading(!1),this.isPlaying(!1),this.canPlay(!1),this.videoStatus({isVisible:!0,statusMessage:t,errorType:s,errorDetails:a,isRetriable:r}),r&&!this.isSeeking.peek()&&this.duration.peek()&&(this.seekPercentage(this.position.peek()/this.duration.peek()),this.isSeeking(!0))},t.prototype._cancelGetDownload=function(){this._pendingGetDownloadPromise&&(this._pendingGetDownloadPromise.cancel(),this._pendingGetDownloadPromise=null)},t.prototype._onIsPlayingChanged=function(e){if(e&&this.videoStatus().isVisible){var t=this.url();this.url(null),this._reset(t,!0)}},t.prototype._computeItemKey=function(){var e=this._item();return e?e.key:null},t.prototype._computeHasError=function(){return this.videoStatus().isVisible},t.prototype._computeCanAdjustQuality=function(){return this.playbackType()===p.default.htmlDashling},t.prototype._computeShouldAutoPlay=function(){return!I.isMobile},t.prototype._computeShouldUseNativeControls=function(){return I.isMobile&&!I.isIE},t.prototype._computeCanvasType=function(){var e=this.playbackType();switch(e){case p.default.flashDash:case p.default.flashMp4:return c.default.flash;default:return c.default.html}},t.prototype._onItemChanged=function(e){e&&this._lastItemKey!==e.key&&(this._lastItemKey=e.key,this._reset(null),this._evaluateItemPlayability())},t.prototype._reset=function(e,t){var i=this._item(),s=i&&i.thumbnails&&i.thumbnails.length?i.thumbnails[0]:null,n=null;s&&(n=a.format(s.url,s.width,s.height)),this._cancelGetDownload(),this.coverImageUrl(n),this.videoStatus({isVisible:!1}),this.isLoading(!0),this.canPlay(!1),t||(this.isSeeking(!1),this.seekPercentage(0),this.position(0),this.duration(0)),this.url(e),this.shouldAutoPlay&&this.isPlaying(!0)},t.prototype._onIsAdjustingVolumeChanged=function(e){e?(this.isMuted(!1),this._originalVolume=this.volume()):0===this.volume()&&(this.isMuted(!0),this.volume(this._originalVolume))},t.prototype._buildVideoUrl=function(e){I.isAndroid&&I.browserMajor<4&&0===e.toLowerCase().indexOf("https:")&&(e="http"+e.substr(5)),e+="?";var t=this.playbackType();return(t===p.default.htmlDashling||t===p.default.flashDash)&&(e+="&videoformat=dash&part=index",b&&(e+="&cacheDisable=1")),t===p.default.htmlDashling?(e+="&pretranscode=0",e+="&transcodeahead=0"):t===p.default.flashDash?(e+="&pretranscode=0",e+="&.ism/manifest(format=mpd-time-csf)"):t===p.default.htmlHls&&(e+="&videoformat=hls&part=index",b&&(e+="&cacheDisable=1")),e},t.prototype._evaluateItemPlayability=function(){var e=this,t=this._item(),i=!(!t||t.did||!t.video),s=null,n=this.videoStatus();if(n.isVisible&&!n.isRetriable)return void this.playbackType(p.default.none);if(!i)return void(t&&!t.isPlaceholder&&this.setVideoStatus({displayMessage:v.errorUnsupportedFormat,errorType:m.default.unsupportedFormat,isRetriable:!1}));if(x)s=p.default[x];else if(D)s=p.default.htmlDashling;else if(M)s=p.default.htmlHls;else{if(w===y.unknown)return void this._evaluateFlashSupport();if(w===y.evaluating)return;w===y.supported?s=p.default.flashDash:this._canPlayAsNativeMp4(t)&&(s=p.default.htmlMp4)}s?(this.playbackType(s),this._pendingGetDownloadPromise=this._itemDataSource.getDownloadUrl(t),this._pendingGetDownloadPromise.then(function(t){e._reset(e._buildVideoUrl(t))},function(t){if(!h.default.isCanceled(t)){var i={statusCode:t.status,message:t.message};e.setVideoStatus({displayMessage:v.errorLoading,errorType:m.default.getDownloadUrlFailure,errorDetails:i,isRetriable:!1})}})):this.setVideoStatus({displayMessage:v.errorUnsupportedBrowser,errorType:m.default.unsupportedBrowser,errorDetails:{fileType:t.extension,flashSupport:w,mseSupport:D,mp4support:k,hlsSupport:M,pcmSupport:A,fourCC:t&&t.video&&t.video.fourCC,audioFormat:t&&t.video&&t.video.audioFormat},isRetriable:!1})},t.prototype._evaluateFlashSupport=function(){var e=this;u.default.checkFlashSupport(E,function(t){e.isDisposed||(w=t?y.supported:y.unsupported,e._evaluateItemPlayability())})},t.prototype._canPlayAsNativeMp4=function(e){var t=e?e.video:null;return t&&t.fourCC===P&&k&&(t.audioFormat!==S||A)},t}(s);Object.defineProperty(t,"__esModule",{value:!0}),t.default=T});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/bindings/fullScreen/FullScreenBinding",["require","exports","knockout","../BaseBinding","../../utilities/ui/FullScreen"],function(e,t,i,s,n){var a=function(e){function t(t){e.call(this,t),this._isMaximized=t.valueAccessor()||i.observable(!1),this.events.on(document,"fullscreenchange, webkitfullscreenchange, mozfullscreenchange, MSFullscreenChange",this._onFullScreenChanged),this.subscribe(this._isMaximized,this._onIsMaximizedChanged)}return __extends(t,e),t.prototype._onIsMaximizedChanged=function(e){e?n.enterFullScreen():n.exitFullScreen()},t.prototype._onFullScreenChanged=function(){this._isMaximized(n.isFullScreen())},t}(s);Object.defineProperty(t,"__esModule",{value:!0}),t.default=a});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/ItemVideoPlayerViewModel",["require","exports","odsp-shared/base/ViewModel","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../../../resources/ControlResourceKeys","./resources/ItemVideoResourceKeys","./VideoContext","./VideoErrorType","../../../bindings/fullScreen/FullScreenBinding","knockout"],function(e,t,i,s,n,a,o,r,l,d,u){var h=function(e){function t(t){e.call(this,t),this.addBindingHandlers({fullScreen:d.default}),this.item=t.item,this._isInteractive=this.resources.consume(a.isInteractive),this._isLoaded=t.isLoaded||u.observable(!1),this._isPlaying=t.isPlaying||u.observable(!1),this.useNewVideoPlayer=n.default.isFeatureEnabled(n.default.NewVideoPlayer),this._urlDataSource=this.resources.consume(s.url),this.useExternalControls=!!t.useExternalControls,this.useNewVideoPlayer?(this.context=this.resources.expose(o.context,new(this.managed(r.default))({item:this.item})),this.useExternalControls&&(this.playbackPanelProvider=this.resources.consume(o.playbackPanelProvider)),this._isLoaded(!0),this.createComputed(this._computeSetIsInteractiveFromIsMaximized),this.createComputed(this._computeUpdateIsPlaying)):this.playerUrl=this.createPureComputed(this._computePlayerUrl)}return __extends(t,e),t.prototype.dispose=function(){this._isPlaying(!1),this._isLoaded(!1),e.prototype.dispose.call(this)},t.prototype.onFrameLoad=function(){this._isLoaded(!0)},t.prototype.onStatusClicked=function(e,t){return this.context.videoStatus().isRetriable&&(this.context.isPlaying(!0),t.stopPropagation(),t.preventDefault()),!0},t.prototype.toggleIsMaximized=function(){return this.context.shouldUseNativeControls?!0:(this.context.isMaximized(!this.context.isMaximized.peek()),!1)},t.prototype.getErrorType=function(e){return l.default[e||l.default.unknown]},t.prototype.getErrorDetails=function(e){return e&&JSON.stringify(e)||""},t.prototype._computeUpdateIsPlaying=function(){var e=this.context.isPlaying();this._isPlaying(e)},t.prototype._computePlayerUrl=function(){var e=this.item(),t=null;return e&&e.video&&(t=this._urlDataSource.getVideoPlayerUrl(e)),t},t.prototype._computeSetIsInteractiveFromIsMaximized=function(){this._isInteractive(this.context.isMaximized())},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=h}),define("odsp-next/controls/video/item/ItemVideoPlayer.html",[],function(){return'<!--ko if: !useNewVideoPlayer--><iframe class=od-ItemVideoPlayer-frame data-bind="attr: {src: playerUrl}, event: {load: onFrameLoad}"></iframe><!--/ko--><!--ko if: useNewVideoPlayer--><div class=od-ItemVideoPlayer data-bind="fullScreen: context.isMaximized, css: { \'od-ItemVideoPlayer--isFullScreen\': context.isMaximized, \'od-ItemVideoPlayer--hasControls\': !useExternalControls && !context.shouldUseNativeControls, \'od-ItemVideoPlayer--hasStatus\': context.videoStatus().isVisible }"><div class="od-ItemVideoPlayer-canvas needsclick" data-bind="event: { dblclick: toggleIsMaximized }, component: { name: \'od-videocanvas\' }"></div><div class=od-ItemVideoPlayer-status data-bind="click: onStatusClicked"><div class=od-ItemVideoPlayer-statusContent><!--ko if: context.videoStatus().isRetriable--><button class="od-ItemVideoPlayer-statusButton ms-Icon" data-bind="css: { \'ms-Icon--refresh\': context.hasError(), \'ms-Icon--play\': !context.hasError() && !context.isPlaying(), \'ms-Icon--pause\': !context.hasError() && context.isPlaying() }"></button><!--/ko--><div class=od-ItemVideoPlayer-statusText data-bind="text: context.videoStatus().statusMessage"></div><!--ko if: context.canShowDiagnostics--><div class=od-ItemVideoPlayer-debugText><strong data-bind="text: $component.getErrorType(context.videoStatus().errorType)"></strong> <span data-bind="text: $component.getErrorDetails(context.videoStatus().errorDetails)"></span></div><!--/ko--></div></div><!--ko if: !context.shouldUseNativeControls--><!--ko if: useExternalControls--><!--ko component: {\r\n name: \'od-transclusion-content\',\r\n params: {\r\n provider: playbackPanelProvider\r\n }\r\n }--><!--ko component: { name: \'od-playback-panel\' }--><!--/ko--><!--/ko--><!--/ko--><!--ko ifnot: useExternalControls--><div class=od-ItemVideoPlayer-controls data-bind="component: { name: \'od-playback-panel\' }"></div><!--/ko--><!--/ko--></div><!--/ko-->'}),define("odsp-next/controls/video/item/ItemVideoPlayer.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-ItemVideoPlayer--isFullScreen{position:fixed;left:0;top:0;width:100%;height:100%;background:#000}.od-ItemVideoPlayer-frame{border:none;height:100%;width:100%}.od-ItemVideoPlayer-canvas,.od-ItemVideoPlayer-status{position:absolute;top:0;left:0;right:0;bottom:0}.od-ItemVideoPlayer-status{background-color:rgba(0,0,0,.8);color:#fff;text-align:center;display:none}.od-ItemVideoPlayer-statusContent{position:absolute;top:50%;left:50%;right:-50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);padding:20px}.od-ItemVideoPlayer--hasStatus .od-ItemVideoPlayer-status{display:block}.od-ItemVideoPlayer-debugText{color:#a6a6a6;font-size:11px;padding:20px 0}.od-ItemVideoPlayer-statusButton{width:100px;height:100px;line-height:100px;vertical-align:middle;padding:.04em 0 0;margin:20px;border:2px solid #fff;border-radius:50%;box-sizing:border-box;font-size:75px;color:#fff;background-color:rgba(0,0,0,.5);cursor:pointer}.od-ItemVideoPlayer-statusButton:hover{background-color:#767676}.od-ItemVideoPlayer-statusButton:active{background-color:#fff;border-color:#000;color:#000}.od-ItemVideoPlayer .od-VideoCanvas-video{position:absolute;left:0;top:0;width:100%;height:100%}.od-ItemVideoPlayer-controls{position:absolute;top:0;right:0;bottom:0;background-color:rgba(0,0,0,.5)}")}),define("dashling/Settings",["require","exports"],function(e,t){var i=function(){function e(){this.manifest=null,this.startTime=0,this.isABREnabled=!0,this.isRBREnabled=!1,this.targetQuality={audio:2,video:2},this.shouldAutoPlay=!0,this.logToConsole=!1,this.safeBufferSeconds=12,this.maxBufferSeconds=119.5,this.maxConcurrentRequests={audio:4,video:6},this.maxSegmentLeadCount={audio:1,video:5},this.defaultBandwidth=520,this.requestTimeout=3e4,this.maxRetries=3,this.delaysBetweenRetries=[200,1500,3e3],this.requestCacheThreshold=80,this.baseUrlOverride=null}return e}();t.default=i}),define("dashling/EventGroup",["require","exports"],function(e,t){var i=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,i,s,n){var a;if(e._isElement(t)){if(document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent(i,n,!0),o.args=s,a=t.dispatchEvent(o)}else if(document.createEventObject){var r=document.createEventObject(s);t.fireEvent("on"+i,r)}}else for(;t&&a!==!1;){var l=t.__events__?t.__events__[i]:null;for(var d in l)for(var u=l[d],h=0;a!==!1&&h<u.length;h++){var c=u[h];a=c.callback.call(c.parent,s)}t=n?t.parent:null}return a},e.isObserved=function(e,t){return!!(e&&e.__events__&&e.__events__[t])},e.isDeclared=function(e,t){return!!(e&&e.__declaredEvents&&e.__declaredEvents[t])},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(e instanceof HTMLElement||e.dispatchEvent&&e.addEventListener)},e.prototype.dispose=function(){this.off(),this._parent=null},e.prototype.onAll=function(e,t,i){for(var s in t)this.on(e,s,t[s],i)},e.prototype.on=function(t,i,s,n){function a(){try{var e=s.apply(l,arguments);if(e===!1&&arguments[0]&&arguments[0].preventDefault){var t=arguments[0];t.preventDefault(),t.cancelBubble=!0}}catch(t){}return e}if(i.indexOf(",")>-1)for(var o=i.split(/[ ,]+/),r=0;r<o.length;r++)this.on(t,o[r],s,n);else{var l=this._parent,d={target:t,eventName:i,parent:l,callback:s,elementCallback:null,useCapture:n};t.__events__=t.__events__||{},t.__events__[i]=t.__events__[i]||{count:0},t.__events__[i][this._id]=t.__events__[i][this._id]||[],t.__events__[i][this._id].push(d),t.__events__[i].count++,e._isElement(t)&&(d.elementCallback=a,t.addEventListener?t.addEventListener(i,a,n):t.attachEvent&&t.attachEvent("on"+i,a)),this._eventRecords.push(d)}},e.prototype.off=function(e,t,i,s){for(var n=0;n<this._eventRecords.length;n++){var a=this._eventRecords[n];if(!(e&&e!==a.target||t&&t!==a.eventName||i&&i!==a.callback||"boolean"==typeof s&&s!==a.useCapture)){var o=a.target.__events__[a.eventName],r=o?o[this._id]:null;r&&(1!==r.length&&i?(o.count--,r.splice(r.indexOf(a),1)):(o.count-=r.length,delete a.target.__events__[a.eventName][this._id]),o.count||delete a.target.__events__[a.eventName]),a.elementCallback&&(a.target.removeEventListener?a.target.removeEventListener(a.eventName,a.elementCallback,a.useCapture):a.target.detachEvent&&a.target.detachEvent("on"+a.eventName,a.elementCallback)),this._eventRecords.splice(n--,1)}}},e.prototype.raise=function(t,i,s){return e.raise(this._parent,t,i,s)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var i=0;i<e.length;i++)t[e[i]]=!0},e._uniqueId=0,e}();t.default=i}),define("dashling/Async",["require","exports"],function(e,t){var i=function(){function e(e){this._parent=e,this._throttleIds={},this._timeoutIds={}}return e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.clearAllThrottles(),this.clearAllTimeouts())},e.prototype.setTimeout=function(e,t){var i,s=this;return i=setTimeout(function(){delete s._timeoutIds[i],i=0,e.apply(s._parent)},t),i&&(this._timeoutIds[i]=!0),i},e.prototype.clearTimeout=function(e){clearTimeout(e),delete this._timeoutIds[e]},e.prototype.clearAllTimeouts=function(){for(var e in this._timeoutIds)clearTimeout(e);this._timeoutIds={}},e.prototype.throttle=function(e,t,i,s,n){var a=this;s&&this.clearThrottle(t),this._throttleIds[t]||(this._throttleIds[t]=setTimeout(function(){n||e.apply(a._parent),delete a._throttleIds[t]},i),n&&(n=!1,e.apply(this._parent)))},e.prototype.clearThrottle=function(e){this._throttleIds&&(clearTimeout(this._throttleIds[e]),delete this._throttleIds[e])},e.prototype.clearAllThrottles=function(){if(this._throttleIds){for(var e in this._throttleIds)clearTimeout(this._throttleIds[e]);this._throttleIds=null}},e}();t.default=i}),define("dashling/MetricSet",["require","exports"],function(e,t){var i=function(){function e(e){this.metricValues=[],this.average=0,this._max=e}return e.prototype.addMetric=function(e){for(this.average=this.average+(e-this.average)/(this.metricValues.length+1),this.metricValues.push(e);this.metricValues.length>this._max;)this._removeFirstMetric();this.min=Math.min(e,this.min),this.max=Math.max(e,this.max)},e.prototype.reset=function(){this.metricValues=[],this.average=this.min=this.max=0},e.prototype._removeFirstMetric=function(){{var e=this.metricValues.shift();this.average}this.average=this.average+(this.average-e)/this.metricValues.length},e}();t.default=i}),define("dashling/DashlingEnums",["require","exports"],function(e,t){t.DashlingEvent={sessionStateChange:"sessionstatechange",download:"download"},t.DashlingError={mediaSourceInit:"mediaSourceInit",manifestDownload:"manifestDownload",initSegmentDownload:"initSegmentDownload",mediaSegmentDownload:"mediaSegmentDownload",manifestParse:"manifestParse",videoElementError:"videoElementError",sourceBufferInit:"sourceBufferInit",sourceBufferAppendException:"sourceBufferAppendException",sourceBufferAppendMissing:"sourceBufferAppendMissing"},function(e){e[e.error=-1]="error",e[e.idle=0]="idle",e[e.initializing=1]="initializing",e[e.buffering=2]="buffering",e[e.playing=4]="playing",e[e.paused=5]="paused"}(t.DashlingSessionState||(t.DashlingSessionState={}));t.DashlingSessionState;!function(e){e[e.error=-1]="error",e[e.idle=0]="idle",e[e.downloading=1]="downloading",e[e.downloaded=2]="downloaded",e[e.appending=3]="appending",e[e.appended=4]="appended",e[e.aborted=5]="aborted"}(t.DashlingRequestState||(t.DashlingRequestState={}));t.DashlingRequestState;!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED",e[e.MS_MEDIA_ERR_ENCRYPTED=5]="MS_MEDIA_ERR_ENCRYPTED"}(t.VideoElementError||(t.VideoElementError={}));t.VideoElementError}),define("dashling/Request",["require","exports","./DashlingEnums","./EventGroup"],function(e,t,i,s){var n=function(){function e(e,t){this._options=e,this._settings=t,this.state=i.DashlingRequestState.idle,this.data=null,this.timeAtFirstByte=-1,this.timeAtLastByte=-1,this.statusCode="",this.progressEvents=[],this.bytesLoaded=0,this.bytesPerMillisecond=0,this.requestType=e.requestType,this.fragmentIndex=e.fragmentIndex,this.qualityIndex=e.qualityIndex,this.qualityId=e.qualityId,this.clearDataAfterAppend=e.clearDataAfterAppend,this._events=new s.default(this),this.isAborted=!1,this._requestAttempt=0,this._xhrType=XMLHttpRequest}return e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._xhr&&(this.state===i.DashlingRequestState.downloading&&(this.state=i.DashlingRequestState.aborted,this.isAborted=!0,this._xhr.abort(),this._options.onError&&this._options.onError(this),this._events.raise(e.CompleteEvent,this)),this._xhr=null),this._retryTimeoutId&&(clearTimeout(this._retryTimeoutId),this._retryTimeoutId=null),this._events.dispose(),this._events=null)},e.prototype.start=function(){var e=this,t=this._options,s=t.url,n=t.isArrayBuffer,a=this._xhr=new this._xhrType,o=this.startTime=(new Date).getTime();this._requestAttempt++,a.open("GET",s,!0),n&&(a.responseType="arraybuffer"),a.timeout=this._settings.requestTimeout,a.onreadystatechange=function(){!e._isDisposed&&a.readyState>0&&e.timeAtFirstByte<0&&(e.timeAtFirstByte=(new Date).getTime()-o)},a.onprogress=function(t){e._isDisposed||(e.progressEvents.push({timeFromStart:(new Date).getTime()-o,bytesLoaded:t.lengthComputable?t.loaded:-1}),e._postProgress())},a.onloadend=function(){e._isDisposed||e._processResult()},this.state=i.DashlingRequestState.downloading,a.send()},e.prototype._processResult=function(){var t=this._xhr,s=this.progressEvents,n=this._options.isArrayBuffer;if(this._xhr=null,this.timeAtLastByte=(new Date).getTime()-this.startTime,t.status>=200&&t.status<=299){if(this.bytesLoaded=n?t.response.byteLength:t.responseText?t.responseText.length:0,t.onreadystatechange(null),this._postProgress(!0),s.length>2){var a=s[s.length-1],o=s[0],r=a.timeFromStart-o.timeFromStart,l=a.bytesLoaded-o.bytesLoaded;this.bytesPerMillisecond=l/r,this.timeAtFirstByte=this.timeAtLastByte-this.bytesLoaded/this.bytesPerMillisecond}this.data=n?new Uint8Array(t.response):t.responseText,this.statusCode=String(t.status),this.state=i.DashlingRequestState.downloaded,this._events.raise(e.CompleteEvent,this),this._options.onSuccess&&this._options.onSuccess(this)}else this._processError(t)},e.prototype._processError=function(t){var s=this,n=0===t.status&&this.timeAtLastByte>=this._settings.requestTimeout,a=!this.isAborted&&404!==t.status&&this._requestAttempt<this._settings.maxRetries,o=this._settings.delaysBetweenRetries;if(a){var r=o[this._requestAttempt-1]||o[o.length-1];this._retryTimeoutId=setTimeout(function(){s.start()},r)}else this.state=i.DashlingRequestState.error,this.statusCode=this.isAborted?"aborted":n?"timeout":String(t.status),this._events.raise(e.CompleteEvent,this),this._options.onError&&this._options.onError(this)},e.prototype._postProgress=function(){var t=this.progressEvents;if(t.length>2){var i=t[t.length-1],s=t[0],n=i.bytesLoaded-s.bytesLoaded;if(n>1e4){var a=i.timeFromStart-s.timeFromStart;a>5&&this._events.raise(e.BandwidthUpdateEvent,1e3*n/a)}}},e.BandwidthUpdateEvent="bandwidthupdate",e.CompleteEvent="complete",e}();
t.default=n}),define("dashling/RequestManager",["require","exports","./MetricSet","./Request","./DashlingEnums","./EventGroup"],function(e,t,i,s,n,a){var o=0,r=function(){function e(e){this._settings=e,this._events=new a.default(this),this._activeRequests={},this.waitTimes=new i.default(20),this.receiveTimes=new i.default(20),this.bytesPerSeconds=new i.default(20),this._activeRequestCount=0}return e.prototype.dispose=function(){this.abortAll(),this._events.dispose()},e.prototype.getActiveRequestCount=function(){return this._activeRequestCount},e.prototype.abortAll=function(){for(var e in this._activeRequests)this._activeRequests[e].dispose();this._events.off(),this._activeRequests={}},e.prototype.start=function(e){var t=this;this._activeRequests[o++]=e,this._activeRequestCount++,this._events.on(e,s.default.BandwidthUpdateEvent,function(e){t.bytesPerSeconds.addMetric(e)}),this._events.on(e,s.default.CompleteEvent,function(){if(t._activeRequestCount--,t._events.off(e),e.state===n.DashlingRequestState.downloaded){var i=e.timeAtLastByte>t._settings.requestCacheThreshold;i||(t.waitTimes.addMetric(e.timeAtFirstByte),t.receiveTimes.addMetric(e.timeAtLastByte)),t._events.raise(n.DashlingEvent.download,e)}}),e.start()},e.prototype.getAverageWait=function(){return this.waitTimes.average||0},e.prototype.getAverageReceive=function(){return this.receiveTimes.average||0},e.prototype.getAverageBytesPerSecond=function(){return this.bytesPerSeconds.average||0},e}();t.default=r}),define("dashling/Utilities",["require","exports"],function(e,t){var i;!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(i||(i={}));var s=function(){function e(){}return e.bind=function(e,t){return function(){return t.apply(e,arguments)}},e.log=function(e,t){(!t||t.logToConsole)&&console.log(e)},e.getXmlNodeValue=function(e,t,i){var s=e.getElementsByTagName(t)[0],n=s?s.childNodes[0]:null;return n?n.nodeValue:i},e.getVideoBufferString=function(e){var t="";e=e||document.querySelector("video");for(var i=0;e&&i<e.buffered.length;i++)t+="["+e.buffered.start(i)+"-"+e.buffered.end(i)+"] ";return t},e.fromISOToSeconds=function(e){var t=0,i=e.substring(2),s=i.indexOf("H");return s>-1&&(t+=60*Number(i.substring(0,s))*60,i=i.substring(s+1)),s=i.indexOf("M"),s>-1&&(t+=60*Number(i.substring(0,s)),i=i.substring(s+1)),s=i.indexOf("S"),s>-1&&(t+=Number(i.substring(0,s))),t},e.getVideoError=function(e){var t=e.error;return t?i[t.code]||String(t.code):null},e}();t.default=s}),define("dashling/Storage",["require","exports"],function(e,t){var i=function(){function e(e,t){this._prefix=e||"",this._useSessionStorage=!!t}return e.prototype.getItem=function(e,t){var i=t;e=this._prefix+e;try{i=this._useSessionStorage?window.sessionStorage.getItem(e):window.localStorage.getItem(e)}catch(s){}return i},e.prototype.setItem=function(e,t){e=this._prefix+e;try{this._useSessionStorage?window.sessionStorage.setItem(e,t):window.localStorage.setItem(e,t)}catch(i){}},e}();t.default=i}),define("dashling/Stream",["require","exports","./RequestManager","./Request","./EventGroup","./Utilities","./Async","./MetricSet","./Storage","./DashlingEnums"],function(e,t,i,s,n,a,o,r,l,d){var u="Dashling.Stream.",h="bytesPerSecond",c=function(){function e(e,t,s,a){var h=this,c=a.manifest.streams[e],p=c.timeline.length;h._events=new n.default(h),h._async=new o.default(h),h._storage=new l.default(u),h.fragments=[],h.streamType=e,h.qualityIndex=Math.max(0,Math.min(c.qualities.length-1,a.targetQuality[e])),h.bufferRate=new r.default(5),h._startTime=(new Date).getTime(),h._appendLength=0,h._appendTimeoutId=0,h._initializedQualityIndex=-1,h._initRequestManager=new i.default(a),h.requestManager=new i.default(a),h._mediaSource=t,h._videoElement=s,h._settings=a,h._manifest=a.manifest,h._streamInfo=c,h._buffer=null,h._hasInitializedBuffer=!1,h._initSegments=[];for(var m=0;p>m;m++)h.fragments.push({state:d.DashlingRequestState.idle,qualityIndex:-1,qualityId:"",requestType:"media",fragmentIndex:m,time:c.timeline[m],activeRequest:null,requests:[]});var g=function(e){h._events.raise(d.DashlingEvent.download,e)};h._events.on(h.requestManager,d.DashlingEvent.download,g),h._events.on(h._initRequestManager,d.DashlingEvent.download,g)}return e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._events.dispose(),this._async.dispose(),this.requestManager.dispose(),this._initRequestManager.dispose())},e.prototype.initialize=function(){var e=this._streamInfo.mimeType+";codecs="+this._streamInfo.codecs;if(!this._buffer)try{a.default.log("Creating "+e+" buffer",this._settings),this._buffer=this._mediaSource.addSourceBuffer(e)}catch(t){this._events.raise(d.DashlingEvent.sessionStateChange,{state:d.DashlingSessionState.error,errorType:d.DashlingError.sourceBufferInit,errorMessage:"type="+e+" error="+t})}},e.prototype.abortAll=function(){this._initRequestManager.abortAll(),this.requestManager.abortAll()},e.prototype.clearBuffer=function(){clearTimeout(this._appendTimeoutId),this._isAppending=!1,this.abortAll();try{this._buffer.remove(0,this._videoElement.duration)}catch(e){}for(var t=0,i=this.fragments;t<i.length;t++){var s=i[t];s.state!==d.DashlingRequestState.downloaded&&(s.state=d.DashlingRequestState.idle)}},e.prototype.canAppend=function(e){var t=this.fragments[e],i=t?this._initSegments[t.qualityIndex]:null,s=this._initSegments[this._streamInfo.qualities.length-1];return t&&t.state==d.DashlingRequestState.downloaded&&i&&i.state>=d.DashlingRequestState.downloaded&&s&&s.state>=d.DashlingRequestState.downloaded},e.prototype.append=function(e,t){function i(){if(!o._isDisposed)if(o._buffer.updating)o._appendTimeoutId=setTimeout(i,10);else{var l=u[0];if(u.length){h.addEventListener("update",s);try{a.default.log("Append started: "+o.streamType+" "+l.qualityId+" "+l.requestType+" "+(void 0!==l.fragmentIndex?"index "+l.fragmentIndex:""),o._settings),h.appendBuffer(l.data)}catch(c){n(d.DashlingError.sourceBufferAppendException,c)}}else o._appendTimeoutId=setTimeout(function(){if(!o._isDisposed)if(r.state=d.DashlingRequestState.appended,o._isAppending=!1,o.isMissing(e,o._videoElement.currentTime))n(d.DashlingError.sourceBufferAppendMissing,"Buffer missing appended fragment");else{var i=((new Date).getTime()-o._startTime)/1e3;o._appendLength+=r.time.lengthSeconds,o.bufferRate.addMetric(o._appendLength/i),t(r)}},30)}}function s(){if(!o._isDisposed){var e=u[0];h.removeEventListener("update",s),e.timeAtAppended=(new Date).getTime()-e.startTime,e.state=d.DashlingRequestState.appended,e.clearDataAfterAppend&&(e.data=null),"init"===e.requestType&&(o._initializedQualityIndex=e.qualityIndex),a.default.log("Append complete: "+o.streamType+" "+e.qualityId+" "+e.requestType+" "+(void 0!==e.fragmentIndex?"index "+e.fragmentIndex:""),o._settings),u.shift(),i()}}function n(e,t){t=t||"";var i="error="+t+" (quality="+r.qualityId+(void 0!==r.fragmentIndex?" index="+r.fragmentIndex:"")+")";r.state=d.DashlingRequestState.error,o._isAppending=!1,a.default.log("Append exception: "+i),o._events.raise(d.DashlingEvent.sessionStateChange,{state:d.DashlingSessionState.error,errorType:e,errorMessage:i})}var o=this,r=o.fragments[e],l=o._streamInfo.qualities.length-1,u=[],h=o._buffer;!o._isAppending&&r&&r.state===d.DashlingRequestState.downloaded&&(o._isAppending=!0,r.state=d.DashlingRequestState.appending,this._hasInitializedBuffer||(this._hasInitializedBuffer=!0,l>r.qualityIndex&&u.push(o._initSegments[l])),u.push(o._initSegments[r.qualityIndex]),u.push(r.activeRequest),i())},e.prototype.getBufferRate=function(){return this.bufferRate.average||0},e.prototype.getActiveRequestCount=function(){return this.requestManager.getActiveRequestCount()},e.prototype.getRequestStaggerTime=function(){return Math.round(1400*this._estimateDownloadSeconds(this.qualityIndex))},e.prototype.isMissing=function(e,t){var i=this.fragments[e];return i.state==d.DashlingRequestState.appended&&!this.isBuffered(e,t)},e.prototype.isBuffered=function(e,t){var i=this.fragments[e],s=!1;if(i){var n=this._buffer.buffered,a=i.time,o=a.startSeconds<.3,r=a.startSeconds+a.lengthSeconds+.3>=this._manifest.mediaDuration,l=Math.max(t,a.startSeconds+(o?.8:.15)),d=a.startSeconds+a.lengthSeconds-(r?.8:.15);try{for(var u=0;u<n.length;u++)if(n.start(u)<=l&&n.end(u)>=d){s=!0;break}}catch(h){s=!0}}return s},e.prototype.canLoad=function(e){return this.fragments[e].state<=d.DashlingRequestState.idle},e.prototype.load=function(e,t){function i(e){if(!r._isDisposed){l.state=d.DashlingRequestState.downloaded;var i=Math.round(e.timeAtLastByte-e.timeAtFirstByte),s=e.timeAtLastByte-i;a.default.log("Download complete: "+e.qualityId+" "+e.requestType+" index: "+e.fragmentIndex+" waiting: "+s+"ms receiving: "+i,r._settings),t()}}function n(e){r._isDisposed||(e.isAborted?(l.state=d.DashlingRequestState.idle,l.activeRequest=null,l.requests=[]):(l.state=d.DashlingRequestState.error,r._events.raise(d.DashlingEvent.sessionStateChange,{state:d.DashlingSessionState.error,errorType:d.DashlingError.mediaSegmentDownload,errorMessage:e.statusCode})))}var o,r=this,l=this.fragments[e],u="media";l&&l.state<=d.DashlingRequestState.idle&&(l.state=d.DashlingRequestState.downloading,l.qualityIndex=r.qualityIndex,l.qualityId=this._streamInfo.qualities[l.qualityIndex].id,r._loadInitSegment(this.qualityIndex,t),o=new s.default({url:r._getUrl(e,l),fragmentIndex:e,requestType:u,qualityIndex:l.qualityIndex,qualityId:l.qualityId,clearDataAfterAppend:!0,isArrayBuffer:!0,onSuccess:i,onError:n},this._settings),l.activeRequest=o,l.requests.push(o),a.default.log("Download started: "+l.qualityId+" "+u+" index="+e+" time="+((new Date).getTime()-r._startTime)+"ms stagger="+r.getRequestStaggerTime()+"ms",r._settings),r.requestManager.start(o))},e.prototype.assessQuality=function(){var e=this,t=e._settings,i=e.requestManager.getAverageBytesPerSecond(),s=e._streamInfo.qualities.length-1;if(i?"video"===this.streamType&&this._storage.setItem(h,String(i)):i=parseFloat(this._storage.getItem(h)),t.isABREnabled&&i)if(t.isRBREnabled)e.qualityIndex=Math.round(Math.random()*s);else{for(var n=0,o="Quality check "+e.streamType+": bps="+Math.round(i),r=e._streamInfo.timeline[0].lengthSeconds,l=.4*r,d=0;s>=d;d++){var u=e._estimateDownloadSeconds(d,0);o+=" "+d+"="+u.toFixed(2)+"s",r>u+l&&(n=d)}e._async.throttle(function(){a.default.log(o,e._settings)},"assess",1e3,!1,!1),e.qualityIndex=n}else e.qualityIndex=Math.min(e._streamInfo.qualities.length-1,t.targetQuality[e.streamType])},e.prototype._estimateDownloadSeconds=function(e,t){var i=this,s=i._streamInfo.qualities[e],n=i._streamInfo.timeline[t||0].lengthSeconds,a=s.bandwidth/8,o=a*n,r=i.requestManager.getAverageBytesPerSecond();r?"video"===this.streamType&&this._storage.setItem(h,String(r)):r=parseFloat(this._storage.getItem(h));var l=r||i._settings.defaultBandwidth;return o/l},e.prototype._loadInitSegment=function(e,t){function i(){r._isDisposed||(o.state=d.DashlingRequestState.downloaded,a.default.log("Download complete: "+r.streamType+" "+u+" "+h,r._settings),t(o))}function n(){r._isDisposed||(o.state=d.DashlingRequestState.error,r._events.raise(d.DashlingEvent.sessionStateChange,{state:d.DashlingSessionState.error,errorType:d.DashlingError.initSegmentDownload,errorMessage:o.statusCode}))}var o,r=this,l=this._streamInfo.qualities.length-1,u=this._streamInfo.qualities[e].id,h="init";e!=l&&r._loadInitSegment(l,t),r._initSegments[e]||(o=r._initSegments[e]=new s.default({url:this._getInitUrl(e),state:d.DashlingRequestState.downloading,timeAtDownloadStarted:(new Date).getTime(),requestType:h,qualityIndex:e,qualityId:u,isArrayBuffer:!0,onSuccess:i,onError:n},this._settings),a.default.log("Download started: "+r.streamType+" "+u+" "+h,r._settings),r._initRequestManager.start(o))},e.prototype._getInitUrl=function(e){var t=this._streamInfo.initUrlFormat.replace("$RepresentationID$",this._streamInfo.qualities[e].id);return this._manifest.baseUrl+t},e.prototype._getUrl=function(e,t){var i=this._streamInfo.fragUrlFormat.replace("$RepresentationID$",t.qualityId).replace("$Time$",t.time.start);return this._manifest.baseUrl+i},e}();t.default=c}),define("dashling/StreamController",["require","exports","./EventGroup","./Async","./Stream","./MetricSet","./Utilities","./DashlingEnums"],function(e,t,i,s,n,a,o,r){var l,d=.06,u=.5;!function(e){e[e.closed=0]="closed",e[e.open=1]="open",e[e.ended=2]="ended"}(l||(l={}));var h=function(){function e(e,t,n){if(this._events=new i.default(this),this._async=new s.default(this),this._mediaSource=t,this._settings=n,this._bufferRate=new a.default(3),this._appendedSeconds=0,this._requestTimerIds=[0,0],this.streams=[],this._appendIndex=0,this._nextStreamIndex=0,this._appendIndex=0,this._audioDownloadIndex=0,this._videoDownloadIndex=0,this._simultaneousDownloadsPerStream=2,this._maxSegmentsAhead=2,this._nextRequestTimerId=0,this._seekingTimerId=0,this.stalls=0,this._lastCurrentTime=0,this._lastTimeBeforeSeek=0,this._startTime=0,this._videoElement=e,this._playbackMonitorId=0,this._canPlay=!0,this._timeAtStall=0,this._intializeVideoElement(),this._initializeStreams(e,t,n),this.streams.length&&n&&n.startTime){var o=this.streams[0],r=o.fragments[0].time.lengthSeconds;this._appendIndex=Math.max(0,Math.min(o.fragments.length-1,Math.floor((n.startTime-u)/r)))}}return e.prototype.dispose=function(){var e=this;if(!e._isDisposed){e._isDisposed=!0,e._adjustPlaybackMonitor(!1),e._events.dispose(),e._async.dispose();for(var t=0;e.streams&&t<e.streams.length;t++)e.streams[t].dispose();e._videoElement=null,e._mediaSource=null}},e.prototype.start=function(){this._startTime=(new Date).getTime(),this._setCanPlay(!1),this._loadNextFragment(),this._adjustPlaybackMonitor(!0)},e.prototype.getPlayingQuality=function(e){var t=0;if(!this._isDisposed)for(var i=0;i<this.streams.length;i++){var s=this.streams[i];if(s.streamType==e){var n=this._videoElement.currentTime,a=Math.min(s.fragments.length-1,Math.floor(n/s.fragments[0].time.lengthSeconds));t=s.fragments[a].qualityIndex,t=t>=0?t:s.qualityIndex;break}}return t},e.prototype.getBufferingQuality=function(e){var t=0;if(!this._isDisposed)for(var i=0,s=this.streams;i<s.length;i++){var n=s[i];if(n.streamType==e){t=n.qualityIndex;break}}return t},e.prototype.getBufferRate=function(){return this._bufferRate.average},e.prototype.getRemainingBuffer=function(e){var t=this,i=0;if(!t._isDisposed){var s=(t._settings.startTime||t._videoElement.currentTime)+(e||0),n=t._videoElement.buffered;!s&&n.length>0&&n.start(0)<1&&(s=n.start(0));for(var a=0;a<n.length;a++)if(s>=n.start(a)&&s<=n.end(a)){for(var o=n.end(a);++a<n.length&&n.start(a)-o<d;)o=n.end(a);i=o-s;break}}return i},e.prototype.getTimeUntilUnderrun=function(e){var t=Number.MAX_VALUE,i=this;if(!i._isDisposed){var s=i._settings.startTime||Math.max(.5,i._videoElement.currentTime),n=i._settings.manifest.mediaDuration-s-.5,a=this.getRemainingBuffer(e),o=this.getBufferRate(),r=a/this._settings.safeBufferSeconds;if(r=Math.min(1,Math.max(0,r)),n>a){var l=a*o;t=a+r*l,(t>n||t>.5*i._settings.maxBufferSeconds)&&(t=Number.MAX_VALUE)}}return t},e.prototype.reset=function(){this._onThrottledSeek(!0)},e.prototype._intializeVideoElement=function(){var e=this,t=this._videoElement;t&&this._events.onAll(t,{seeking:e._onVideoSeeking,error:e._onVideoError,play:e._onPauseStateChange,pause:e._onPauseStateChange,ended:e._onVideoEnded,ratechange:e._onVideoRateChange})},e.prototype._initializeStreams=function(e,t,i){function s(e){o._events.raise(r.DashlingEvent.download,e)}function a(e){o._events.raise(r.DashlingEvent.sessionStateChange,e)}var o=this,l=i&&i.manifest&&i.manifest.streams?i.manifest.streams:null;o.streams=[],l&&(l.audio&&o.streams.push(new n.default("audio",t,e,i)),l.video&&o.streams.push(new n.default("video",t,e,i)));for(var d=0,u=o.streams;d<u.length;d++){var h=u[d];o._events.on(h,r.DashlingEvent.download,s),o._events.on(h,r.DashlingEvent.sessionStateChange,a),h.initialize()}},e.prototype._loadNextFragment=function(){function e(e,i){t._isDisposed||(t._requestTimerIds[e]&&t._async.clearTimeout(t._requestTimerIds[e]),t._requestTimerIds[e]=t._async.setTimeout(function(){t._requestTimerIds[e]=0,t._loadNextFragment()},i))}var t=this;if(!t._isDisposed){for(var i=t._getDownloadCandidates(),s=0;s<i.downloads.length;s++)for(var n=i.downloads[s],a=t.streams[s],o=0;o<n.length;o++){var l=n[o],d=(a.fragments[l],a.fragments[l-1]),u=d&&d.activeRequest&&d.activeRequest.state==r.DashlingRequestState.downloading?d.activeRequest:null,h=a.getRequestStaggerTime(),c=u?(new Date).getTime()-u.startTime:0;if(u&&!(c>=h)){e(s,h-c);break}a.load(l,function(){t._appendNextFragment()})}i.isAtMax&&e(0,300)}},e.prototype._appendNextFragment=function(){var e,t,i=this,s=this.streams;if(!i._isDisposed){var n=i._settings.startTime||i._videoElement.currentTime;if(s&&s.length&&i._mediaSource&&!i._isMediaSourceReadyState(i._mediaSource.readyState,l.closed)){for(;i._appendIndex<s[0].fragments.length;){var a=!0,o=!0;for(t=0;t<s.length;t++)e=s[t],a=a&&e.canAppend(i._appendIndex),o=o&&e.fragments[i._appendIndex].state===r.DashlingRequestState.appended&&!e.isMissing(i._appendIndex,n);if(a)for(o=!1,t=0;t<s.length;t++)e=s[t],e.append(i._appendIndex,function(){i._appendNextFragment()}),o=o&&e.fragments[i._appendIndex].state===r.DashlingRequestState.appended;if(!o)break;var d=i.streams[0].fragments[i._appendIndex];if(!d.activeRequest._hasUpdatedBufferRate){d.activeRequest._hasUpdatedBufferRate=!0,i._appendedSeconds+=d.time.lengthSeconds;var u=(new Date).getTime(),h=(u-this._startTime)/1e3;i._bufferRate.addMetric(i._appendedSeconds/(h||.1))}if(i._appendIndex++,i._settings.startTime)try{i._videoElement.currentTime=i._settings.startTime,i._settings.startTime=0}catch(c){}i._checkCanPlay()}i._appendIndex==s[0].fragments.length&&i._isMediaSourceReadyState(i._mediaSource.readyState,l.open)&&i._mediaSource.endOfStream(),i._loadNextFragment()}}},e.prototype._adjustPlaybackMonitor=function(e){var t=this;!e&&t._playbackMonitorId?(clearInterval(t._playbackMonitorId),t._playbackMonitorId=0):e&&!t._playbackMonitorId&&(t._playbackMonitorId=setInterval(function(){t._checkCanPlay()},200))},e.prototype._checkCanPlay=function(){var e=this,t=e.getTimeUntilUnderrun(),i=.5;if(this._lastCurrentTime=e._videoElement.currentTime,e._canPlay&&.1>t&&!e._timeAtStall&&(e._timeAtStall=this._lastCurrentTime,e._async.setTimeout(function(){var t=e._timeAtStall;e._timeAtStall=0,e._isDisposed||e._videoElement.currentTime!=t||(e.stalls++,e._setCanPlay(!1))},200)),!e._canPlay){var s=e.streams[0],n=s.fragments[0].time.lengthSeconds;t>n&&e.getBufferRate()>1||t>e._settings.safeBufferSeconds?this._setCanPlay(!0):e.getTimeUntilUnderrun(i)>e._settings.safeBufferSeconds&&(e._videoElement.currentTime=Math.min(e._videoElement.currentTime+i,e._videoElement.duration),this._setCanPlay(!0))}this._events.raise(r.DashlingEvent.sessionStateChange,{state:this._canPlay?this._videoElement.paused?r.DashlingSessionState.paused:r.DashlingSessionState.playing:r.DashlingSessionState.buffering})},e.prototype._allStreamsAppended=function(e,t){for(var i=!1,s=0;s<e.length;s++){var n=e[s];i=i&&n.fragments[t]==r.DashlingRequestState.appended}return i},e.prototype._getDownloadCandidates=function(){var e=this,t=e._getCurrentFragmentRange(),i={downloads:[],isAtMax:!1},s=0;if(t.start>-1){e._ensureStreamsUpdated(t);var n=e._getMissingFragmentIndex(t);if(n>=0){t.start=Math.max(t.start,n);for(var a=0;a<e.streams.length;a++){var o=e.streams[a];i.downloads.push(e._getDownloadableIndexes(o,t)),s+=i.downloads[i.downloads.length-1].length}}}return i.isAtMax=!s&&t.end>=0&&t.end<e.streams[0].fragments.length-1,i},e.prototype._getCurrentFragmentRange=function(){var e=this,t=e._videoElement,i=e._settings.manifest.mediaDuration,s={start:-1,end:-1};if(i>0){var n=e._settings.startTime||t.currentTime,a=n+.005>=i,o=e.streams[0],r=o.fragments.length,l=o.fragments[0].time.lengthSeconds;a||(n>u&&(n-=u),s.start=Math.max(0,Math.min(r-1,Math.floor(n/l))),s.end=Math.max(0,Math.min(r-1,Math.ceil((n+e._settings.maxBufferSeconds)/l))))}return s},e.prototype._ensureStreamsUpdated=function(e){for(var t=this,i=t._videoElement.currentTime,s=0;s<t.streams.length;s++){var n=t.streams[s];n.assessQuality();for(var a=e.start;a<=e.end;a++)if(n.isMissing(a,i)){var l=n.fragments[a];o.default.log("Missing fragment reset: stream="+n.streamType+" index="+a+" ["+l.time.startSeconds+"]",t._settings),n.fragments[a].state=r.DashlingRequestState.idle}}},e.prototype._getMissingFragmentIndex=function(e){for(var t=this,i=e.start;i<=e.end;i++)for(var s=0;s<t.streams.length;s++){var n=t.streams[s].fragments[i];if(n.state<=r.DashlingRequestState.idle)return i}return-1},e.prototype._getDownloadableIndexes=function(e,t){for(var i=this,s=[],n=Math.min(t.end,t.start+i._settings.maxSegmentLeadCount[e.streamType]),a=i._settings.maxConcurrentRequests[e.streamType]-e.getActiveRequestCount(),o=t.start;s.length<a&&n>=o;o++)e.fragments[o].state<=r.DashlingRequestState.idle&&s.push(o);return s},e.prototype._setCanPlay=function(e){this._canPlay!==e&&(this._canPlay=e,this._onVideoRateChange())},e.prototype._onVideoSeeking=function(){this._lastTimeBeforeSeek||(this._lastTimeBeforeSeek=this._lastCurrentTime),this._seekingTimerId&&clearTimeout(this._seekingTimerId),this._setCanPlay(!1),this._settings.startTime=0,this._seekingTimerId=this._async.setTimeout(this._onThrottledSeek,300)},e.prototype._onThrottledSeek=function(e){var t=this;if(!t._isDisposed){var i=t._videoElement.currentTime,s=(this._lastTimeBeforeSeek,Math.floor(Math.max(0,i-u)/t.streams[0].fragments[0].time.lengthSeconds)),n=1==t._videoElement.buffered.length&&t._videoElement.buffered.start(0)<=Math.max(0,i-2)&&t._videoElement.buffered.end(0)>i;o.default.log("Throttled seek: "+t._videoElement.currentTime,t._settings),t._seekingTimerId=0,t._lastTimeBeforeSeek=0,clearTimeout(t._nextRequestTimerId),t._nextRequestTimerId=0;var a=e||t._appendIndex<s,r=e||t._settings.manifest.mediaDuration>t._settings.maxBufferSeconds&&!n;t._appendIndex=s,o.default.log("Clearing buffer",this._settings);for(var l=0,d=this.streams;l<d.length;l++){var h=d[l];a&&h.abortAll(),r&&h.clearBuffer()}this._appendNextFragment()}},e.prototype._onVideoError=function(){this._events.raise(r.DashlingEvent.sessionStateChange,{state:r.DashlingSessionState.error,errorType:r.DashlingError.videoElementError,errorMessage:o.default.getVideoError(this._videoElement)})},e.prototype._onPauseStateChange=function(){this._adjustPlaybackMonitor(!this._videoElement.paused),this._checkCanPlay()},e.prototype._onVideoEnded=function(){this._events.raise(r.DashlingEvent.sessionStateChange,{state:r.DashlingSessionState.paused})},e.prototype._onVideoRateChange=function(){var e=this._canPlay?1:0;this._videoElement.playbackRate!=e&&(this._videoElement.playbackRate=this._videoElement.defaultPlaybackRate=e)},e.prototype._isMediaSourceReadyState=function(e,t){return e===t||e===l[t]},e}();t.default=h}),define("dashling/Manifest",["require","exports","./Utilities"],function(e,t,i){var s=function(){function e(e){this._settings=e}return e.prototype.parseFromRequest=function(e){this.request=e,this.parse(e.data)},e.prototype.parse=function(e){var t,s=new DOMParser,n=s.parseFromString(e,"text/xml");this.baseUrl=this._settings.baseUrlOverride||i.default.getXmlNodeValue(n,"BaseURL",""),this.mediaDuration=i.default.fromISOToSeconds(n.documentElement.getAttribute("mediaPresentationDuration")),this.streams={};for(var a=n.querySelectorAll("AdaptationSet"),o=0;o<a.length;o++){var r=a[o];if(r){var l=r.getAttribute("contentType"),d=r.querySelectorAll("Representation"),u=r.querySelector("SegmentTemplate"),h=r.querySelectorAll("S"),c=this.streams[l]={streamType:l,mimeType:r.getAttribute("mimeType"),codecs:r.getAttribute("codecs"),initUrlFormat:u.getAttribute("initialization"),fragUrlFormat:u.getAttribute("media"),qualities:[],timeline:[]},p=Number(u.getAttribute("timescale"));if(!h||!h.length)throw"Missing timeline";for(var m=0;m<d.length;m++){var g=d[m],f={id:g.getAttribute("id"),bandwidth:g.getAttribute("bandwidth"),width:0,height:0};g.getAttribute("height")&&(f.width=Number(g.getAttribute("width")),f.height=Number(g.getAttribute("height"))),c.qualities.push(f)}for(var _=0,y=0;y<h.length;y++){var v=h[y],b=Number(v.getAttribute("r"))||0,x=Number(v.getAttribute("d"));for(t=0;b>=t;t++)c.timeline.push({start:_,startSeconds:_/p,length:x,lengthSeconds:x/p}),_+=x}}}},e}();t.default=s}),define("dashling/ManifestParser",["require","exports","./RequestManager","./Request","./EventGroup","./DashlingEnums","./Manifest"],function(e,t,i,s,n,a,o){var r=function(){function e(t){var s=this;this._events=new n.default(this),this._parseIndex=0,this._settings=t,this._requestManager=new i.default(t),this._events.on(this._requestManager,a.DashlingEvent.download,function(){s._events.raise(e.DownloadEvent)})}return e.prototype.dispose=function(){this._requestManager&&(this._requestManager.dispose(),this._requestManager=null)},e.prototype.parse=function(e,t,i){var n,r=this,l=++this._parseIndex,d=function(e){if(r._parseIndex===l){var s=new o.default(r._settings);try{s.parseFromRequest(e),t(s)}catch(n){i(a.DashlingError.manifestParse,n)}}},u=function(){r._parseIndex===l&&i(a.DashlingError.manifestDownload,n.statusCode)};n=new s.default({url:e,requestType:"manifest",onSuccess:d,onError:u},this._settings),this._requestManager.start(n)},e.DownloadEvent="download",e}();t.default=r}),define("dashling/Dashling",["require","exports","./Settings","./StreamController","./DashlingEnums","./ManifestParser","./EventGroup"],function(e,t,i,s,n,a,o){var r=0,l=function(){function e(e){this.Event=n.DashlingEvent,this.SessionState=n.DashlingSessionState,this.RequestState=n.DashlingRequestState,this.isDisposed=!1,this._events=new o.default(this),this.settings=e||new i.default,this.reset()}return e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._events.dispose(),this.reset())},e.prototype.addEventListener=function(e,t){this._events.on(this,e,t)},e.prototype.removeEventListener=function(e,t){this._events.off(this,e,t)},e.prototype.load=function(e,t){this.reset(),this._sessionIndex=++r,this.startTime=(new Date).getTime(),this._setState(n.DashlingSessionState.initializing),this.videoElement=e,this._initializeMediaSource(e),this._initializeManifest(t)},e.prototype.reset=function(){if(this.timeAtFirstCanPlay=null,this.startTime=null,this.lastError=null,this.streamController&&(this.streamController.dispose(),this.streamController=null),this._parser&&(this._parser.dispose(),this._parser=null),this.videoElement){this.settings.manifest=null;try{this.videoElement.pause()}catch(e){}this.videoElement=null}this._mediaSource=null,this._setState(n.DashlingSessionState.idle)},e.prototype.resetStreams=function(){this.streamController&&this.streamController.reset(!0,!0)},e.prototype.getRemainingBuffer=function(){return this.streamController?this.streamController.getRemainingBuffer():0},e.prototype.getBufferRate=function(){return this.streamController?this.streamController.getBufferRate():0},e.prototype.getPlayingQuality=function(e){return this.streamController?this.streamController.getPlayingQuality(e):this.settings.targetQuality[e]},e.prototype.getBufferingQuality=function(e){return this.streamController?this.streamController.getBufferingQuality(e):this.settings.targetQuality[e]},e.prototype.getMaxQuality=function(e){var t=this.settings.manifest?this.settings.manifest.streams[e]:null;return t?t.qualities.length-1:0},e.prototype._setState=function(e,t,i){if(!this.isDisposed&&this.state!==e&&(this.state=e,this.lastErrorType=t,this.lastErrorMessage=i,this.lastError=t?t+" "+(i?"("+i+")":""):null,e===n.DashlingSessionState.error&&this.streamController&&this.streamController.dispose(),this.timeAtFirstCanPlay||e!=n.DashlingSessionState.playing&&e!=n.DashlingSessionState.paused||(this.timeAtFirstCanPlay=(new Date).getTime()-this.startTime),this._events.raise(n.DashlingEvent.sessionStateChange,{state:e,errorType:t,errorMessage:i}),this.videoElement))switch(e){case n.DashlingSessionState.initializing:case n.DashlingSessionState.buffering:o.default.raise(this.videoElement,"waiting",null);break;case n.DashlingSessionState.playing:o.default.raise(this.videoElement,"playing",null);break;case n.DashlingSessionState.error:o.default.raise(this.videoElement,"error",null)}},e.prototype._initializeMediaSource=function(e){function t(){i.removeEventListener("sourceopen",t),s._sessionIndex===a&&(s._mediaSource=i,s._tryStart())}var i,s=this,a=s._sessionIndex;try{i=new MediaSource}catch(o){s._setState(n.DashlingSessionState.error,n.DashlingError.mediaSourceInit)}i&&(i.addEventListener("sourceopen",t,!1),e.src=URL.createObjectURL(i))},e.prototype._initializeManifest=function(e){var t=this,i=this._sessionIndex,s=function(e){t._sessionIndex===i&&t.state!==n.DashlingSessionState.error&&(t.settings.manifest=e,t._tryStart())},o=function(e,s){t._sessionIndex===i&&t._setState(n.DashlingSessionState.error,e,s)};if(this.settings.manifest)s(this.settings.manifest);else{var r=this._parser=new a.default(this.settings);r.parse(e,s,o)}},e.prototype._tryStart=function(){var e=this;this.state!==n.DashlingSessionState.error&&this._mediaSource&&this.settings.manifest&&(this._mediaSource.duration=this.settings.manifest.mediaDuration,this.streamController=new s.default(this.videoElement,this._mediaSource,this.settings),this._events.on(this.streamController,n.DashlingEvent.sessionStateChange,function(t){e._setState(t.state,t.errorType,t.errorMessage)}),this.streamController.start())},e}();t.default=l});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/canvas/HtmlVideoContextBinding",["require","exports","knockout","../../../../bindings/BaseBinding","../ItemVideoPlayer.resx","../../../../../dashling/Dashling","../../../../../dashling/DashlingEnums","../VideoPlaybackType","../VideoErrorType"],function(e,t,i,s,n,a,o,r,l){var d,u=n.strings,h=100,c=100,p="video",m=.4,g=400;!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(d||(d={}));var f=function(e){function t(t){e.call(this,t),this.controlsDescendantBindings=!0;var i=this._context=this.valueAccessor();this.subscribe(i.url,this._onUrlChanged),this.createComputed(this._computeVolume),this.createComputed(this._computeIsMuted),this.subscribe(i.seekPercentage,this.async.debounce(this._onSeekPercentageChanged,h)),this.subscribe(i.isScrubbing,this._onIsScrubbingChanged),this.subscribe(i.desiredQuality,this._onDesiredQualityChanged),this.subscribe(i.isABREnabled,this._onIsABREnabledChanged),this.subscribe(i.isPlaying,this._onIsPlayingChanged),this._onUrlChanged(i.url()),this._onIsPlayingChanged(i.isPlaying.peek())}return __extends(t,e),t.prototype.dispose=function(){this._disposeVideo(),e.prototype.dispose.call(this)},t.prototype._disposeVideo=function(){if(this._dashling&&(this._context.dashling(null),this._dashling.dispose(),this._dashling=null),this._videoElement){this.events.off(this._videoElement);try{this._videoElement.pause(),this.element.removeChild(this._videoElement)}catch(e){}this._videoElement=null}},t.prototype._onUrlChanged=function(e){var t=this;if(this._disposeVideo(),this._videoElement&&(this.events.off(this._videoElement),this._videoElement=null),e){var i=this._videoElement=document.createElement("video");this.events.onAll(this._videoElement,{loadstart:this._handleLoadStart,canplay:this._handleCanPlay,error:this._handleVideoElementError,ended:this._handleEnded,volumechange:this._handleVolumeChanged,play:this._handlePlay,pause:this._handlePause,waiting:this._handleWaiting,playing:this._handlePlaying}),i.className="od-VideoCanvas-video",this._context.shouldUseNativeControls?(i.setAttribute("controls",""),i.setAttribute("poster",this._context.coverImageUrl.peek()||""),i.setAttribute("preload","metadata")):i.setAttribute("autoplay","autoplay"),this._context.playbackType()===r.default.htmlDashling?this.async.setTimeout(function(){t._initializeDashling()
},0):i.setAttribute("src",e),this._computeVolume(),this._computeIsMuted(),this.element.appendChild(i),this._checkPlayState(!0)}},t.prototype._convertDesiredQualityToVideoIndex=function(e){switch(e){case 1080:return 4;case 720:return 3;case 480:return 2;case 360:return 1;default:return 0}},t.prototype._initializeDashling=function(){var e=this._dashling=new a.default;e.settings.isABREnabled=this._context.isABREnabled(),e.settings.targetQuality.audio=1,e.settings.targetQuality.video=this._convertDesiredQualityToVideoIndex(this._context.desiredQuality()),this._manifestQualityMap=null,this._context.isSeeking()&&this._context.duration()&&(e.settings.startTime=this._context.duration()*this._context.seekPercentage()),e.load(this._videoElement,this._context.url()),this._context.dashling(e)},t.prototype._onIsPlayingChanged=function(e){this._checkPlayState(),e?this._updatePlaybackStateId||(this._updatePlaybackStateId=this.async.setInterval(this._updatePlaybackState,c)):(this.async.clearInterval(this._updatePlaybackStateId),delete this._updatePlaybackStateId)},t.prototype._onDesiredQualityChanged=function(e){var t=this._getManifestVideoQualities();t&&(this._dashling.settings.targetQuality[p]=t.indexOf(e),this._dashling.settings.isABREnabled=!1,this._dashling.resetStreams())},t.prototype._onIsABREnabledChanged=function(e){this._dashling&&(this._dashling.settings.isABREnabled=e)},t.prototype._computeVolume=function(){var e=this._context.volume();this._videoElement&&(this._videoElement.volume=e)},t.prototype._computeIsMuted=function(){var e=this._context.isMuted();this._videoElement&&(this._videoElement.muted=e)},t.prototype._onSeekPercentageChanged=function(e){this._videoElement.duration&&!this._context.videoStatus().isVisible&&(this._videoElement.currentTime=e*this._videoElement.duration,this._context.isSeeking(!0))},t.prototype._onIsScrubbingChanged=function(e){this._onSeekPercentageChanged(this._context.seekPercentage()),e||this._context.position(this._videoElement.currentTime)},t.prototype._handleLoadStart=function(){this._context.isLoading(!0)},t.prototype._handleCanPlay=function(){this._context.canPlay(!0)},t.prototype._findErrorFromCode=function(e){var t;return t=d[e]?d[e]:String(e)},t.prototype._handleVideoElementError=function(){var e=u.errorLoading,t={},s=!0,n=l.default.htmlOther;if(this._videoElement&&this._videoElement.error){var a=this._videoElement.error.code;switch(i.utils.extend(t,{elementError:this._findErrorFromCode(a)}),a){case d.MEDIA_ERR_DECODE:n=l.default.htmlElementDecode,e=u.errorDecode,s=!1;break;case d.MEDIA_ERR_NETWORK:n=l.default.htmlElementNetwork,e=u.errorNetwork;break;case d.MEDIA_ERR_ABORTED:return void(n=l.default.htmlElementAborted)}}else this._dashling&&this._dashling.state===o.DashlingSessionState.error&&(n=l.default.htmlDashling,i.utils.extend(t,{dashlingError:this._dashling.lastErrorType}));this._context.setVideoStatus({displayMessage:e,errorType:n,errorDetails:t,isRetriable:s})},t.prototype._checkPlayState=function(e){var t=this,i=this._videoElement,s=!1,n=this._context;e=e||!n.canPlay(),e||(this._stalePlayStateId=0),i&&(n.isPlaying()&&!n.isScrubbing()&&i.paused?e?s=!0:(Math.abs(n.position()-n.duration())<.5&&(i.currentTime=0),i.play()):n.isPlaying()&&!n.isScrubbing()||i.paused||(e?s=!0:i.pause()),s&&!this._stalePlayStateId&&(this._stalePlayStateId=this.async.setTimeout(function(){t._stalePlayStateId=0,t._checkPlayState()},300)))},t.prototype._checkEndState=function(e){var t=this._videoElement,i=this._context;e||(this._staleEndStateId=0),t&&(!e||i.isPlaying())&&t.duration-t.currentTime<=m&&(e?this._staleEndStateId||(this._staleEndStateId=this.async.setTimeout(this._checkEndState,g)):(i.position(i.duration()),this._handleEnded(null)))},t.prototype._updatePlaybackState=function(){var e=this._videoElement;if(e){var t=e.buffered,s=e.duration,n=this._context.bufferedRanges;if(this._checkPlayState(!0),this._checkEndState(!0),this._context.position(e.currentTime),this._context.duration(e.duration),s&&t){for(;n().length>t.length;)n.pop();for(var a=0;t&&a<t.length;a++){var o=n()[a],r=t.start(a),l=t.end(a)-r,d=100*r/s+"%",u=100*l/s+"%";o?(o.left(d),o.width(u)):n.push({left:i.observable(d),width:i.observable(u)})}}this._dashling&&this._updateDashlingState()}},t.prototype._getManifestVideoQualities=function(){if(!this._manifestQualityMap){var e=this._dashling,t=e?e.settings:null,i=t?t.manifest:null,s=i&&i.streams&&i.streams[p]&&i.streams[p].qualities;s&&(this._manifestQualityMap=e.settings.manifest.streams[p].qualities.map(function(e){var t=e.id.substr(e.id.indexOf("-")+1);return Number(t.substr(0,t.length-1))}))}return this._manifestQualityMap},t.prototype._updateDashlingState=function(){var e=this._dashling,t=this._context;e.settings.isABREnabled=t.isABREnabled();var i=this._getManifestVideoQualities();i?(t.maxQuality(i[e.getMaxQuality(p)]),t.playingQuality(e.settings.isABREnabled?i[e.getPlayingQuality(p)]:i[e.getBufferingQuality(p)])):t.maxQuality(0)},t.prototype._handleEnded=function(){this._context.isPlaying(!1)},t.prototype._handleVolumeChanged=function(){this._context.volume(this._videoElement.volume)},t.prototype._handlePlay=function(){this._context.isPlaying(!0)},t.prototype._handlePause=function(){this._context.isScrubbing()||this._context.isPlaying(!1)},t.prototype._handleWaiting=function(){this._context.isLoading(!0)},t.prototype._handlePlaying=function(){this._context.isLoading(!1),this._context.isSeeking(!1)},t}(s);Object.defineProperty(t,"__esModule",{value:!0}),t.default=f});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/canvas/FlashVideoContextBinding",["require","exports","knockout","../../../../bindings/BaseBinding","odsp-utilities/browser/PlatformDetection","../ItemVideoPlayer.resx","../VideoErrorType"],function(e,t,i,s,n,a,o){var r,l=a.strings,d=window.FilesConfig?window.FilesConfig.imgBaseUrl:"",u=d+"flash/v1/strobe.swf",h=d+"flash/v1/osmf.swf";!function(e){e[e.ready=4]="ready"}(r||(r={}));var c="readystatechange",p=0,m=new n,g={},f=function(e){function t(t){e.call(this,t),this.controlsDescendantBindings=!0,this._context=this.valueAccessor(),this._isPlayerReady=i.observable(!1),this.subscribe(this._context.url,this._onUrlChanged),this.createComputed(this._computeVolume),this.createComputed(this._computeIsMuted),this.subscribe(this._context.seekPercentage,this.async.debounce(this._onSeekPercentageChanged,100)),this.subscribe(this._context.isScrubbing,this._onIsScrubbingChanged),this.subscribe(this._context.isPlaying,this._onIsPlayingChanged),this._onUrlChanged()}return __extends(t,e),t.prototype.dispose=function(){this._removeFlashPlayer(),e.prototype.dispose.call(this)},t.prototype.handlePlaybackEvent=function(e,t){var s=this._playerElement;if(s||(s=this._playerElement=document.getElementById(this._playerId)),this._isPlayerReady(!0),s)switch(e){case"onJavaScriptBridgeCreated":break;case"loadstart":this._context.isLoading(!0);break;case"error":this._context.setVideoStatus({displayMessage:l.errorLoading,errorType:o.default.flashOther,errorDetails:{args:t}});break;case"emptied":this._context.canPlay(!0);break;case"durationchange":break;case"play":break;case"pause":break;case"loadedmetadata":this._context.canPlay(!0);break;case"seeking":this._context.isSeeking(!0);break;case"seeked":this._context.isSeeking(!1),this._context.isLoading(!1);break;case"timeupdate":this._context.position(t.currentTime),this._context.duration(t.duration);break;case"progress":var n=this._context.bufferedRanges,a=this._context.duration();if(a&&n){for(;n().length>t.buffered.length;)n.pop();for(var r=0;t.buffered&&r<t.buffered.length;r++){var d=n()[r],u=t.buffered._start[r],h=t.buffered._end[r]-u,c=100*u/a+"%",p=100*h/a+"%";d?(d.left(c),d.width(p)):n.push({left:i.observable(c),width:i.observable(p)})}}break;case"volumechange":break;case"complete":this._context.isPlaying(!1)}},t.prototype._onUrlChanged=function(){this._removeFlashPlayer(),this._createFlashPlayer()},t.prototype._computeVolume=function(){var e=this._context.volume();if(this._isPlayerReady()&&this._playerElement)try{this._playerElement.setVolume(e)}catch(t){}},t.prototype._computeIsMuted=function(){var e=this._context.isMuted();if(this._isPlayerReady()&&this._playerElement)try{this._playerElement.setMuted(e)}catch(t){}},t.prototype._onSeekPercentageChanged=function(e){var t=this._context.duration();if(this._isPlayerReady()&&this._playerElement&&t&&!this._context.videoStatus().isVisible){try{this._playerElement.seek(e*t)}catch(i){}this._context.isSeeking(!0)}},t.prototype._onIsScrubbingChanged=function(){this._onSeekPercentageChanged(this._context.seekPercentage())},t.prototype._onIsPlayingChanged=function(e){if(this._isPlayerReady()&&this._playerElement)try{e?this._playerElement.play2():this._playerElement.pause()}catch(t){}},t.prototype._createFlashPlayer=function(){if(this._context.url.peek()){var e="",t=this._context;this._playerId="player-"+ ++p;var i=this._playerId;g[i]=this;var s="javascriptCallbackFunction=flashVideoCallback&autoPlay="+!!this._context.shouldAutoPlay+"&loop=false&controlBarMode=none&enableStageVideo=true&controlBarAutoHide=false&playButtonOverlay=false&id="+i+"&useHTML5=false&bufferingOverlay=false&src="+encodeURIComponent(t.url())+("&plugin_AdaptiveStreamingPlugin="+encodeURIComponent(h));e=m.isIE&&m.browserMajor<9?""+('<object id="'+i+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">')+('<param name="movie" value="'+u+'" />'):""+('<object id="'+i+'" name="'+i+'" type="application/x-shockwave-flash" data="'+u+'">'),e+='<param name="allowfullscreen" value="false" /><param name="wmode" value="transparent" /><param name="bgcolor" value="000000"/><param name="allowscriptaccess" value="always"/>'+('<param name="flashvars" value="'+s+'" />')+"</object>",this.element.innerHTML=e,this._playerElement=document.getElementById(i)}},t.prototype._removeFlashPlayer=function(){if(this._playerId){delete g[this._playerId],delete this._playerId,this._isPlayerReady(!1);var e=this._playerElement;if(this._playerElement=null,e)if(m.isIE)e.style.display="none",e.readyState===r.ready?this._removeFlashPlayerIE(e):this.events.on(e,c,this._onIEFlashPlayerReadyStateChange);else try{e.parentNode&&e.parentNode.removeChild(e)}catch(t){}}},t.prototype._removeFlashPlayerIE=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=null);e.parentNode&&e.parentNode.removeChild(e)},t.prototype._onIEFlashPlayerReadyStateChange=function(e){var t=e.target;t.readyState===r.ready&&(this._removeFlashPlayerIE(t),this.events.off(t,c,this._onIEFlashPlayerReadyStateChange))},t}(s);Object.defineProperty(t,"__esModule",{value:!0}),t.default=f,window.flashVideoCallback=function(e,t,i){"use strict";g[e]&&g[e].handlePlaybackEvent(t,i)}}),define("dashling/DashlingMonitor",["require","exports","./DashlingEnums"],function(e,t,i){function s(e,t){return t=t||document,t.querySelector(e)}function n(e,t,i,s){var n=document.createElement(e);return t&&(n.className=t),i&&(n.textContent=i),s&&s.appendChild(n),n}function a(e,t){for(var i in t)if(t[i]===e)return i;return""}function o(e,t,i){var s=String(parseFloat(e.toFixed(t)));if(i)for(s=""+s,-1==s.indexOf(".")&&(s+=".");s.indexOf(".")!=s.length-3;)s+="0";return s}function r(e){var t=1e3,i=t*t,s=8*e;return t>s?s+" bps":i>s?o(s/t,2,2)+" kbps":o(s/i,2,2)+" mbps"}function l(e,t,i){var s,n=e.className.trim().split(" "),a={},o="";for(s=0;s<n.length;s++)n[s]&&(a[n[s]]=!0);i=void 0===i?!a[t]:i,i?a[t]=!0:delete a[t];for(var r in a)o+=r+" ";e.className=o.trim()}function d(e,t){return function(){return t.apply(e,arguments)}}var u=0,h=function(){function e(){this.id="DashMonitorView-"+u++,this._rowElements={},this._updateSeekBar=d(this,this._updateSeekBar),this._onSessionChanged=d(this,this._onSessionChanged),this.isActive=!1,this.isVisible=!0,this._dataContext=null,this.element=null,this.qualityContainer=null,this._metricCount=0,this._videoElement=null,this.reset()}return e.prototype.dispose=function(){var e=this;e._interval&&(clearInterval(e._interval),e._interval=null),e._videoElement&&(e._videoElement.removeEventListener("timeupdate",e._updateSeekBar),e._videoElement.removeEventListener("seeking",e._updateSeekBar),e._videoElement=null),e._dashling&&(e._dashling.removeEventListener(e._dashling.Event.sessionStateChange,e._onSessionChanged),e._dashling=null)},e.prototype.attachTo=function(e){var t=n("div");t.innerHTML=this.renderHtml(),this.element?e.replaceChild(t.firstChild,this.element):e.appendChild(t.firstChild),this.activate()},e.prototype.observe=function(e,t){var i=this;i.dispose(),t&&(i._videoElement=t,t.addEventListener("timeupdate",i._updateSeekBar),t.addEventListener("seeking",i._updateSeekBar)),e&&(i._dashling=e,e.addEventListener(e.Event.sessionStateChange,i._onSessionChanged),i._onSessionChanged())},e.prototype._onSessionChanged=function(){var e=this,t=e._dashling,s=t.state;s==i.DashlingSessionState.error||s==i.DashlingSessionState.idle?(clearInterval(e._interval),e._interval=0,e.setDataContext(e._getStats(t))):t.state>i.DashlingSessionState.idle&&!e._interval&&(e._interval=setInterval(function(){e.isVisible&&e.setDataContext(e._getStats(t))},100))},e.prototype.reset=function(){this._dataContext=this._createContext(),this.element&&this.attachTo(this.element.parentElement)},e.prototype.setVisibility=function(e){e!=this.isVisible&&(this.isVisible=e,this.isActive&&this._update())},e.prototype.setDataContext=function(e){this._dataContext=e,this._update()},e.prototype.renderHtml=function(){var e='<div id="'+this.id+'" class="c-DashMonitor"><ul class="streamMetrics"></ul><div class="audio streamData"><span class="streamTitle">Audio</span><ul class="streamMetrics"></ul><div class="traffic"><div class="qualities"></div><div class="seekContainer"><div class="seekBar"></div></div></div></div><div class="video streamData"><span class="streamTitle">Video</span><ul class="streamMetrics"></ul><div class="traffic"><div class="qualities"></div><div class="seekContainer"><div class="seekBar"></div></div></div></div><div class="key"><div class="keyItem"><div class="keyBox waiting"></div><span>Waiting for response</span></div><div class="keyItem"><div class="keyBox downloading"></div><span>Receiving bytes</span></div><div class="keyItem"><div class="keyBox downloaded"></div><span>Downloaded</span></div><div class="keyItem"><div class="keyBox appending"></div><span>Appending</span></div><div class="keyItem"><div class="keyBox appended"></div><span>Appended</span></div><div class="keyItem"><div class="keyBox error"></div><span>Error</span></div></div>';return e},e.prototype.activate=function(){var e=this.element=s("#"+this.id);this.subElements={metrics:s(".streamMetrics",e),audioElement:s(".audio"),audioMetrics:s(".audio .streamMetrics",e),audioQualities:s(".audio .qualities",e),audioSeekBar:s(".audio .seekBar",e),videoElement:s(".video"),videoMetrics:s(".video .streamMetrics",e),videoQualities:s(".video .qualities",e),videoSeekBar:s(".video .seekBar",e),key:s(".key")},this.isActive=!0,this._update()},e.prototype.deactivate=function(){this.subElements=null,this.isActive=!1},e.prototype._updateSeekBar=function(){var e=this,t=e._videoElement;if(t){var i=100*t.currentTime/t.duration+"%";e.subElements.audioSeekBar.style.left=i,e.subElements.videoSeekBar.style.left=i}},e.prototype._update=function(){var e=this._dataContext,t=void 0!==e.state&&this._dashling&&e.state!==i.DashlingSessionState.idle;if(this.isActive){var s=this.subElements;l(this.element,"isVisible",t&&this.isVisible),this._updateMetrics(s.metrics,e.metrics);var n=e&&e.streams&&e.streams.audio||{},a=e&&e.streams&&e.streams.video||{};l(s.audioElement,"isVisible",!(!n.metrics&&!n.qualities)),l(s.videoElement,"isVisible",!(!a.metrics&&!a.qualities)),l(s.key,"isVisible",!(!n.qualities&&!a.qualities)),this._updateMetrics(s.audioMetrics,n.metrics),this._updateQualities(s.audioQualities,n.qualities),this._updateMetrics(s.videoMetrics,a.metrics),this._updateQualities(s.videoQualities,a.qualities)}},e.prototype._updateMetrics=function(e,t){if(l(e,"isVisible",!!t),t)for(var i=e._metricLookup=e._metricLookup||{},a=0;a<t.length;a++){var o=t[a],r=i[o.title];r||(r=n("li"),r.innerHTML='<span class="metricTitle">'+o.title+'</span><span class="metricValue"></span>',s(".metricTitle",r).textContent=o.title,e.appendChild(r),r=i[o.title]=s(".metricValue",r)),r.parentNode.className=void 0!==o.value&&null!==o.value&&""!==o.value?"hasValue":"",r.textContent=o.value}},e.prototype._updateQualities=function(e,t){if(l(e,"isVisible",!!t),t)for(var i=e._qualityRowLookup=e._qualityRowLookup||{},a=0;a<t.length;a++){var o=t[a];if(o){var r=i[a];if(!r){r=i[a]=n("div","row"),n("div","rowHeader",o.title,r),n("div","rowFragments",null,r),r.qualityIndex=o.index;for(var d=0;d<e.childNodes.length;d++)if(o.index>Number(e.childNodes[d].qualityIndex)){e.insertBefore(r,e.childNodes[d]);break}r.parentNode||e.appendChild(r)}this._updateFragments(s(".rowFragments",r),o.fragments)}}},e.prototype._updateFragments=function(e,t){if(l(e,"isVisible",!!t),t){for(var i=e._fragmentListLookup=e._fragmentListLookup||{},s={},a=this._dataContext.duration,o=0;o<t.length;o++){var r=t[o],d=i[r.index];d?delete i[r.index]:(d=n("div","rowRequest",null,e),d.style.left=100*r.start/a+"%",d.style.width=100*r.length/a+"%"),s[r.index]=d,d.className="rowRequest "+r.state}e._fragmentListLookup=s;for(var u in i)e.removeChild(i[u])}},e.prototype._createContext=function(){return{state:i.DashlingSessionState.idle,metrics:[],streams:{audio:null,video:null},duration:0}},e.prototype._getStats=function(e){var t=this._createContext(),s=e.streamController,n=e.settings.manifest;if(t.state=e.state,t.metrics.push({title:"State",value:i.DashlingSessionState[e.state]}),t.metrics.push({title:"Last error",value:e.lastError}),t.metrics.push({title:"Load",value:(e.timeAtFirstCanPlay?e.timeAtFirstCanPlay:(new Date).getTime()-e.startTime)+" ms"}),n&&s){for(var l=[],d=0;d<s.streams.length;d++)l.push(s.streams[d].fragments);t.duration=n.mediaDuration,t.metrics.push({title:"Manifest",value:e.settings.manifest&&e.settings.manifest.request&&e.settings.manifest.request.timeAtLastByte?e.settings.manifest.request.timeAtLastByte+" ms":""}),t.metrics.push({title:"Stalls",value:String(s.stalls)||""}),t.metrics.push({title:"Recovery time",value:""}),t.metrics.push({title:"Stall chance",value:""}),t.metrics.push({title:"Buffer rate",value:o(e.getBufferRate(),2,2)+" s/s"}),t.metrics.push({title:"Buffer left",value:o(e.getRemainingBuffer(),2,2)+" s"});var u=s?s.getTimeUntilUnderrun():0;t.metrics.push({title:"Time until stall",value:u<Number.MAX_VALUE?o(u,2,2)+" s":""});for(var d=0;d<s.streams.length;d++){var h=s.streams[d],c={metrics:[],qualities:[]};t.streams[h.streamType]=c,c.metrics.push({title:"Quality",value:String(h.qualityIndex)});var p=h.requestManager.getAverageWait();c.metrics.push({title:"Avg wait",value:p?o(p,2)+" ms":null}),p=h.requestManager.getAverageReceive(),c.metrics.push({title:"Avg receive",value:p?o(p,2)+" ms":null}),p=h.requestManager.getAverageBytesPerSecond(),c.metrics.push({title:"Avg bandwidth",value:p?r(p):null});for(var m=0;m<h.fragments.length;m++){var g=h.fragments[m];if(g.activeRequest){var f=c.qualities[g.qualityIndex];f||(f=c.qualities[g.qualityIndex]={title:g.qualityId,index:g.qualityIndex,fragments:[]});var _=a(g.state,this._dashling.RequestState);g.state==this._dashling.RequestState.downloading&&-1==g.activeRequest.timeAtFirstByte&&(_="waiting"),f.fragments.push({index:m,state:_,start:g.time.startSeconds,length:g.time.lengthSeconds})}}}}return t},e}();t.default=h}),define("odsp-next/controls/video/item/canvas/DashlingMonitor.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".c-DashMonitor{background:rgba(44,44,44,.7);position:absolute;top:-10px;left:0;right:0;min-height:15px;display:block;opacity:0;color:#AAA}.c-DashMonitor.isVisible{transition:opacity .2s linear,top .25s ease-out;top:0;opacity:1}.c-DashMonitor .key,.c-DashMonitor .streamData{display:none}.c-DashMonitor .isVisible{display:block}.c-DashMonitor .streamMetrics{list-style-type:none;padding:5px 5px 0;margin:0}.c-DashMonitor .streamMetrics li{margin-right:5px;margin-bottom:5px;border:1px solid rgba(255,255,255,.5);background:#313131;overflow:hidden;vertical-align:top;font-size:11px;display:none}.c-DashMonitor .streamMetrics li.hasValue{display:inline-block}.c-DashMonitor .streamTitle{font-size:15px;display:inline-block;width:80px;text-align:right;float:left;margin-right:5px;line-height:30px}.c-DashMonitor .metricTitle{padding:3px 5px;display:inline-block;font-weight:700}.c-DashMonitor .metricValue{display:inline-block;padding:3px 5px;white-space:nowrap;background:#5f5f5f;color:#fff}.c-DashMonitor .row{line-height:15px;height:15px;padding-bottom:1px;position:relative;border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(255,255,255,.1);margin-top:-1px;font-weight:700;font-size:9px;background:#222}.c-DashMonitor .traffic{position:relative}.c-DashMonitor .seekContainer{margin-left:3px}.c-DashMonitor .seekBar{position:absolute;top:0;left:0;width:2px;margin-left:-2px;background:rgba(255,255,255,.7);height:100%}.c-DashMonitor .rowHeader{position:absolute;width:80px;text-align:right}.c-DashMonitor .rowFragments,.c-DashMonitor .seekContainer{position:absolute;top:0;left:85px;right:0;bottom:0}.c-DashMonitor .rowRequest{position:absolute;top:2px;bottom:2px;border-radius:4px;box-shadow:inset -4px 0 7px 0 rgba(0,0,0,.6);min-width:5px}.c-DashMonitor .key{box-shadow:inset 0 8px 15px -10px rgba(0,0,0,.2);font-size:11px;padding:10px}.c-DashMonitor .keyItem{display:inline-block;margin-right:10px}.c-DashMonitor .keyBox{display:inline-block;position:relative;top:-1px;width:10px;height:10px;margin:0 5px;border:1px solid #888;vertical-align:middle}.c-DashMonitor .waiting{background:url(data:image/gif;base64,R0lGODlhBAAEAIAAANLS0paWliH/C05FVFNDQVBFMi4wAwEAAAAh+QQEBQAAACwAAAAABAAEAAACBkwAl2h5BQAh+QQEBQAAACwAAAAABAAEAAACBURiaLBZACH5BAQFAAAALAAAAAAEAAQAAAIGBBKXaHkFACH5BAQFAAAALAAAAAAEAAQAAAIFDGBosVkAOw==) #adadad}.c-DashMonitor .downloading{background:url(data:image/gif;base64,R0lGODlhBAAEAIAAADZn96m++yH/C05FVFNDQVBFMi4wAwEAAAAh+QQEBQAAACwAAAAABAAEAAACBgQSl2h5BQAh+QQEBQAAACwAAAAABAAEAAACBQxgaLFZACH5BAQFAAAALAAAAAAEAAQAAAIGTACXaHkFACH5BAQFAAAALAAAAAAEAAQAAAIFRGJosFkAOw==) #727272}.c-DashMonitor .downloaded{background:#3747ff}.c-DashMonitor .appending{background:#85b98f}.c-DashMonitor .appended{background:#00bd24}.c-DashMonitor .error{background:#df4242}")});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/canvas/VideoMonitorBinding",["require","exports","../../../../bindings/BaseBinding","../../../../../dashling/DashlingMonitor","./DashlingMonitor.css"],function(e,t,i,s){var n=function(e){function t(t){e.call(this,t),this.controlsDescendantBindings=!0,this._videoContext=this.valueAccessor(),this.createComputed(this._computeDashlingMonitor)}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeMonitor()},t.prototype._disposeMonitor=function(){this._dashlingMonitor&&(this._dashlingMonitor.dispose(),this._dashlingMonitor=null,this.element.innerHTML="")},t.prototype._computeDashlingMonitor=function(){var e=this._videoContext,t=e.dashling();this._disposeMonitor(),t&&(this._dashlingMonitor=new s.default,this._dashlingMonitor.attachTo(this.element),this._dashlingMonitor.observe(t,t.videoElement))},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/canvas/VideoCanvasViewModel",["require","exports","odsp-shared/base/ViewModel","./HtmlVideoContextBinding","./FlashVideoContextBinding","./VideoMonitorBinding","../resources/ItemVideoResourceKeys"],function(e,t,i,s,n,a,o){var r=function(e){function t(t){e.call(this,t),this.context=this.resources.consume(o.context),this.addBindingHandlers({htmlVideoContext:s.default,flashVideoContext:n.default,videoMonitor:a.default})}return __extends(t,e),t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}),define("odsp-next/controls/video/item/canvas/VideoCanvas.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-VideoCanvas object,.od_videoCanvas video{position:absolute;left:0;top:0;width:100%;height:100%}")}),define("odsp-next/controls/video/item/canvas/VideoCanvas.html",[],function(){return'<div class=od-VideoCanvas><!--ko if: context.canvasType() === \'html\'--><div data-bind="htmlVideoContext: context"></div><!--/ko--><!--ko if: context.canvasType() === \'flash\'--><div data-bind="flashVideoContext: context"></div><!--/ko--><!--ko if: context.isDiagnosticsEnabled--><div data-bind="videoMonitor: context"></div><!--/ko--></div>'}),define("odsp-next/controls/video/item/canvas/VideoCanvas",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./VideoCanvasViewModel","./VideoCanvas.css","./VideoCanvas.html"],function(e,t,i,s){var n=i.registerComponent({tagName:"od-videocanvas",template:e("./VideoCanvas.html"),viewModel:s.default,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/playbackPanel/ScrubBinding",["require","exports","knockout","../../../../bindings/BaseBinding"],function(e,t,i,s){var n=function(e){function t(t){e.call(this,t);var s=t.valueAccessor();this._min=s.min||0,this._max=s.max||1,this._isScrubbing=s.isScrubbing||i.observable(!1),this._isHovering=s.isHovering||i.observable(!1),this._value=s.value||i.observable(this._min),this._hoverValue=s.hoverValue||i.observable(this._min),this._clientX=s.clientX||i.observable(0),this._edgeMargins=s.edgeMargins||0,this.events.onAll(this.element,{mouseenter:this._onMouseEnter,mousedown:this._onMouseDown,click:this._onMouseClick})}return __extends(t,e),t.prototype._updateContainerRect=function(){var e=this.element.getBoundingClientRect();this._containerRect={left:e.left+this._edgeMargins,top:e.top,width:e.width-2*this._edgeMargins,height:e.height}},t.prototype._onMouseEnter=function(e){this._updateContainerRect(),this.events.on(this.element,"mouseleave",this._onMouseLeave),this.events.on(window,"mousemove",this._onMouseMove),this._onMouseMove(e),this._isHovering(!0)},t.prototype._onMouseLeave=function(){this._isHovering(!1),this.events.off(window,"mouseleave"),this._isScrubbing()||this.events.off(window,"mousemove")},t.prototype._onMouseDown=function(e){return this._updateContainerRect(),this.events.on(window,"mouseup",this._onMouseUp),this._isScrubbing(!0),this._onMouseMove(e,!0),!1},t.prototype._onMouseMove=function(e,t){var i=Math.min(1,Math.max(0,(e.clientX-this._containerRect.left)/this._containerRect.width)),s=i*(this._max-this._min)+this._min;return this._hoverValue(s),this._clientX(e.clientX),(t||this._isScrubbing())&&this._value(s),!1},t.prototype._onMouseUp=function(){return this.events.off(window,"mouseup"),this._isScrubbing(!1),this._isHovering()||this.events.off(window,"mousemove"),!1},t.prototype._onMouseClick=function(e){return this._onMouseDown(e),this._onMouseUp(),!1},t}(s);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/actions/SetVideoQualityAction",["require","exports","../../../../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ItemVideoResourceKeys"],function(e,t,i,s,n,a){var o=function(e){function t(t){e.call(this,t),this.name="SetVideoQuality",this._context=this.resources.consume(a.context),this._quality=t.quality}return __extends(t,e),t.prototype.onExecute=function(){return this._context.desiredQuality(this._quality),this._context.isABREnabled(!1),s.default.wrap({resultType:n.ResultTypeEnum.Success})},t.prototype.onIsAvailable=function(){var e=this._context.maxQuality();return this._quality<=e},t.prototype.onIsToggled=function(){var e=this._context;return this._quality===(e.isABREnabled()?e.playingQuality():e.desiredQuality())},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/actions/ToggleVideoABRAction",["require","exports","../../../../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ItemVideoResourceKeys"],function(e,t,i,s,n,a){var o=function(e){function t(){e.call(this,null),this.name="ToggleVideoABR",this._context=this.resources.consume(a.context)}return __extends(t,e),t.prototype.onExecute=function(){var e=this._context.isABREnabled();return e&&this._context.desiredQuality(this._context.playingQuality()),this._context.isABREnabled(!e),s.default.wrap({resultType:n.ResultTypeEnum.Success})},t.prototype.onIsToggled=function(){return this._context.isABREnabled()},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/actions/ToggleVideoDiagnosticsAction",["require","exports","../../../../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ItemVideoResourceKeys"],function(e,t,i,s,n,a){var o=function(e){function t(){e.call(this,null),this.name="ToggleVideoDiagnostics",this._context=this.resources.consume(a.context)}return __extends(t,e),t.prototype.onExecute=function(){return this._context.isDiagnosticsEnabled(!this._context.isDiagnosticsEnabled()),s.default.wrap({resultType:n.ResultTypeEnum.Success})},t.prototype.onIsToggled=function(){return this._context.isDiagnosticsEnabled()},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/video/item/playbackPanel/PlaybackPanelViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../../../bindings/css/ClassesBinding","../../../../bindings/keyboard/KeyboardBinding","../../../commands/CommandViewModel","../../../../bindings/contextMenu/ContextMenuAlignment","../ItemVideoPlayer.resx","./ScrubBinding","../../../../bindings/dismiss/DismissBinding","../actions/SetVideoQualityAction","../actions/ToggleVideoABRAction","../actions/ToggleVideoDiagnosticsAction","odsp-shared/utilities/string/TimeFormatter","../resources/ItemVideoResourceKeys"],function(e,t,i,s,n,a,o,r,l,d,u,h,c,p,m,g){var f=l.strings,_=1e3,y=function(e){function t(t){e.call(this,t),this.context=this.resources.consume(g.context),this.addBindingHandlers({classes:n,dismiss:u,scrub:d.default,keyboard:a}),this.isFullScreen=i.observable(!1),this.isMuted=i.observable(!1),this.currentTime=this.createPureComputed(this._computeCurrentTime),this.totalTime=this.createPureComputed(this._computeTotalTime),this.percentPlayed=this.createPureComputed(this._computePercentPlayed),this.percentVolume=this.createPureComputed(this._computePercentVolume),this.seekTooltipPercentage=i.observable(0),this.isSeekTooltipVisible=i.observable(!1),this.seekTooltipTime=this.createPureComputed(this._computeSeekTooltipTime),this.seekTooltipLeft=i.observable(0),this.showContextMenu=i.observable(!1),this.contextualMenuParams=null
}return __extends(t,e),t.prototype.onPlayToggleClicked=function(){return this.context.isPlaying(!this.context.isPlaying.peek()),!1},t.prototype.onGearClicked=function(e,t){if(!this.contextualMenuParams){var s=[new o({text:f.qualityMenu1080,isToggleable:!0,action:new(this.managed(h.default))({quality:1080})}),new o({text:f.qualityMenu720,isToggleable:!0,action:new(this.managed(h.default))({quality:720})}),new o({text:f.qualityMenu480,isToggleable:!0,action:new(this.managed(h.default))({quality:480})}),new o({text:f.qualityMenu360,isToggleable:!0,action:new(this.managed(h.default))({quality:360})}),new o({text:f.qualityMenu240,isToggleable:!0,action:new(this.managed(h.default))({quality:240})}),new o({text:f.qualityMenuAuto,isToggleable:!0,hasLineBreakBefore:!0,action:new(this.managed(c.default))})];this.context.canShowDiagnostics&&s.push(new o({text:"Show diagnostics",isToggleable:!0,action:new(this.managed(p.default))})),this.contextualMenuParams={items:i.observableArray(s),alignment:r.BottomCenter,allowHorizontalMenuNudging:!0,isOpen:this.showContextMenu,isBeakVisible:i.observable(!0),target:t.target}}return this.showContextMenu(!this.showContextMenu.peek()),!1},t.prototype.onMuteToggleClicked=function(){return this.context.isMuted(!this.context.isMuted.peek()),!1},t.prototype.onMaximizedToggleClicked=function(){return this.context.isMaximized(!this.context.isMaximized.peek()),!1},t.prototype.getMuteButtonClass=function(){var e,t=this.context.volume(),i=this.context.isMuted();return e=i||0===t?"Off":.3>=t?"Lo":.6>=t?"Med":"Hi"},t.prototype._computeCurrentTime=function(){return m.formatTime(this.context.position()*_)},t.prototype._computeTotalTime=function(){return m.formatTime(this.context.duration()*_)},t.prototype._computePercentPlayed=function(){var e;return e=this.context.isSeeking()||this.context.isScrubbing()?100*this.context.seekPercentage():100*this.context.position()/this.context.duration(),e+"%"},t.prototype._computePercentVolume=function(){return this.context.isMuted()?"0":Math.round(100*this.context.volume())+"%"},t.prototype._computeSeekTooltipTime=function(){return m.formatTime(this.context.duration()*_*this.seekTooltipPercentage())},t}(s);Object.defineProperty(t,"__esModule",{value:!0}),t.default=y}),define("odsp-next/controls/video/item/playbackPanel/PlaybackPanel.html",[],function(){return'<div class=od-PlaybackPanel data-bind="css: { \'od-PlaybackPanel--isLoading\': context.isPlaying() && context.isLoading() }"><div class=od-PlaybackPanel-nearArea><button class="od-PlaybackPanel-button ms-Icon" data-bind="click: onPlayToggleClicked, keyboard: { target: document, mappings: { Space: onPlayToggleClicked } }, css: { \'ms-Icon--play\': !context.isPlaying(), \'ms-Icon--pause\': context.isPlaying() }"></button><div class=od-PlaybackPanel-time data-bind="css: { \'od-PlaybackPanel--hasDuration\': context.duration() > 0 }"><span class=od-PlaybackPanel-timePlayed data-bind="text: currentTime"></span> <span class=od-PlaybackPanel-timeSeparator>/</span> <span class=od-PlaybackPanel-totalTime data-bind="text: totalTime"></span></div></div><div class=od-PlaybackPanel-farArea><div class=od-PlaybackPanel-gear data-bind="dismiss: { isOpen: showContextMenu }"><button class="od-PlaybackPanel-button ms-Icon ms-Icon--gear" data-bind="visible: context.canAdjustQuality, click: onGearClicked"></button><!--ko if: showContextMenu--><div class=od-PlaybackPanel-gearMenu data-bind="component: { name: \'ms-contextual-menu\', params: contextualMenuParams }"></div><!--/ko--></div><button class="od-PlaybackPanel-button ms-Icon" data-bind="click: onMuteToggleClicked, css: \'ms-Icon--volume\' + getMuteButtonClass()"></button><div class="od-PlaybackPanel-scrubBar od-PlaybackPanel-volume" data-bind="scrub: { edgeMargins: 5, value: context.volume, isScrubbing: context.isAdjustingVolume }"><div class=od-PlaybackPanel-scrubFill></div><div class=od-PlaybackPanel-scrubArea><div class=od-PlaybackPanel-scrubThumb data-bind="style: { width: percentVolume }"></div></div></div><button class="od-PlaybackPanel-button ms-Icon" data-bind="click: onMaximizedToggleClicked, keyboard: { target: document, mappings: { AltEnter: onMaximizedToggleClicked } }, css: { \'ms-Icon--fullscreen\': !context.isMaximized(), \'ms-Icon--conflict\': context.isMaximized() }"></button></div><div class=od-PlaybackPanel-middleArea><div data-bind="component: { name: \'ms-progressSpinnerFlat\' }"></div><div class="od-PlaybackPanel-scrubBar needsclick" data-bind="scrub: { edgeMargins: 5, value: context.seekPercentage, hoverValue: seekTooltipPercentage, isScrubbing: context.isScrubbing, isHovering: isSeekTooltipVisible, clientX: seekTooltipLeft }"><div class=od-PlaybackPanel-scrubFill data-bind="foreach: context.bufferedRanges"><div class=od-PlaybackPanel-scrubBuffered data-bind="style: { left: left, width: width }"></div></div><div class=od-PlaybackPanel-scrubArea><div class=od-PlaybackPanel-scrubThumb data-bind="style: { width: percentPlayed }"></div></div></div></div><div class=od-PlaybackPanel-tooltip data-bind="css: { \'od-PlaybackPanel--isScrubbing\': isSeekTooltipVisible }, text: seekTooltipTime, style: { left: seekTooltipLeft() + \'px\' }"></div></div>'}),define("odsp-next/controls/video/item/playbackPanel/PlaybackPanel.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-VideoPanel{width:600px;height:400px;background:#000;position:relative}.od-PlaybackPanel{height:50px;white-space:nowrap;padding:0 16px}.od-PlaybackPanel .ProgressSpinnerFlat{display:none}.od-PlaybackPanel.od-PlaybackPanel--isLoading .ProgressSpinnerFlat{display:block;color:#fff;position:absolute;left:0;right:0;top:30px}.od-PlaybackPanel-nearArea{float:left}.od-PlaybackPanel-middleArea{overflow:hidden;position:relative}.od-PlaybackPanel-button{width:30px;height:30px;padding:0;margin:10px 2px;border:2px solid #fff;border-radius:50%;box-sizing:border-box;vertical-align:top;font-size:14px;color:#fff;background-color:rgba(0,0,0,.5);cursor:pointer}.od-PlaybackPanel-time,.od-PlaybackPanel-volume{width:80px;display:inline-block}.od-PlaybackPanel-button:hover{background-color:#767676}.od-PlaybackPanel-button:active{background-color:#fff;color:#000;border-color:#000}.od-PlaybackPanel-time{vertical-align:top;text-align:center;height:50px;opacity:0;line-height:50px;font-size:12px;color:#a6a6a6}html[dir=ltr] .od-PlaybackPanel-time{padding-left:4px}html[dir=rtl] .od-PlaybackPanel-time{padding-right:4px}.od-PlaybackPanel--hasDuration{opacity:1}.od-PlaybackPanel-timePlayed{color:#fff}.od-PlaybackPanel-farArea{float:right;height:50px}.od-PlaybackPanel-scrubBar{height:30px;margin:10px;position:relative;cursor:pointer}.od-PlaybackPanel-scrubArea{height:100%;margin-right:10px;position:relative}.od-PlaybackPanel-scrubThumb{background-color:#3a96dd;height:10px;position:absolute;top:10px;left:0;border-radius:5px 0 0 5px;padding-left:5px}.od-PlaybackPanel-scrubThumb::after{content:'';position:absolute;top:0;right:-5px;width:10px;height:10px;background-color:#fff;border-radius:5px}.od-PlaybackPanel-scrubFill{top:10px;width:100%;height:10px;position:absolute;background-color:#212121;border-radius:5px;box-shadow:0 0 1px rgba(255,255,255,.5);overflow:hidden;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}.od-PlaybackPanel-scrubBar:hover .od-PlaybackPanel-scrubFill::after{content:'';position:absolute;left:0;top:0;height:10px;right:0;background:rgba(255,255,255,.1);border-radius:5px}.od-PlaybackPanel-scrubBuffered{position:absolute;left:0;top:0;height:10px;background-color:#a6a6a6}.od-PlaybackPanel-tooltip{position:absolute;min-width:30px;height:25px;line-height:25px;background:#fff;color:#000;top:-23px;box-shadow:0 0 10px -3px;border-radius:1px;padding:0 8px;font-size:12px;text-align:center;-webkit-transform:translate(-50%,50%);-ms-transform:translate(-50%,50%);transform:translate(-50%,50%);opacity:0}.od-PlaybackPanel-tooltip.od-PlaybackPanel--isScrubbing{transition:opacity .2s linear,-webkit-transform .2s ease-out;transition:transform .2s ease-out,opacity .2s linear;transition:transform .2s ease-out,opacity .2s linear,-webkit-transform .2s ease-out;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0);opacity:1}.od-PlaybackPanel-tooltip:before{content:'';position:absolute;width:10px;height:10px;background:#fff;bottom:-5px;left:50%;margin-left:-5px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.od-PlaybackPanel-gear{position:relative;display:inline}.od-PlaybackPanel-gearMenu{position:absolute;left:50%;bottom:100%;margin-bottom:31px;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%)}.od-PlaybackPanel .ms-ContextualMenu{position:static}.md .od-PlaybackPanel-time,.sm .od-PlaybackPanel-time{width:40px}.md .od-PlaybackPanel-timeSeparator,.md .od-PlaybackPanel-totalTime,.md .od-PlaybackPanel-volume,.sm .od-PlaybackPanel-timeSeparator,.sm .od-PlaybackPanel-totalTime,.sm .od-PlaybackPanel-volume{display:none}")}),define("odsp-next/controls/video/item/playbackPanel/PlaybackPanel",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./PlaybackPanelViewModel","./PlaybackPanel.html","./PlaybackPanel.css","../../../progressSpinnerFlat/ProgressSpinnerFlat","../../../contextualMenu/ContextualMenu"],function(e,t,i,s){var n=i.registerComponent({tagName:"od-playback-panel",template:e("./PlaybackPanel.html"),viewModel:s.default,synchronous:!0});return n}),define("odsp-next/controls/video/item/ItemVideoPlayer",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./ItemVideoPlayerViewModel","./ItemVideoPlayer.html","./ItemVideoPlayer.css","./canvas/VideoCanvas","./playbackPanel/PlaybackPanel","../../transclusion/content/TransclusionContent"],function(e,t,i,s){var n=i.registerComponent({tagName:"ms-item-videoplayer",template:e("./ItemVideoPlayer.html"),viewModel:s.default,synchronous:!0});return n});
var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/filePicker/spo/commandSets/FilePickerCommandSet",["require","exports","../../../../controls/commands/BaseCommandSet","../../../../resources/ControlResourceKeys","../../../../controls/commands/CommandViewModel","../../../../controls/commands/Commands.resx","../../../../utilities/icons/Icon","../../../../controls/list/layouts/LayoutType","knockout"],function(e,t,i,o,n,s,a,r,c){var d=function(e){function t(){e.call(this);var t=this.resources.consume(o.actionMap);this.commands.push(new(this.managed(n))({text:s.strings.ViewList,isLabelVisible:c.observable(!1),icon:a.listBullets,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(t.ToggleListLayoutAction))({layoutType:r.Details}),keys:["V"],automationId:"switchLayout"}),new(this.managed(n))({text:s.strings.ViewGrid,isLabelVisible:c.observable(!1),icon:a.tile,isSideCommand:!0,hasIconOnly:!0,action:new(this.managed(t.ToggleListLayoutAction))({layoutType:r.Grid}),keys:["V"],automationId:"switchLayout"}))}return __extends(t,e),t}(i.default);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d}),define("odsp-next/utilities/images/ImagePromise",["require","exports","odsp-utilities/async/Signal"],function(e,t,i){var o=function(){function e(){}return e.request=function(e){var t=new i,o=document.createElement("img");return o.onload=function(){t.complete()},o.onerror=function(){t.error()},o.src=e,t.getPromise()},e}();return o});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/pages/filePicker/spo/FilePickerViewModel",["require","exports","../../../utilities/list/odb/ListResources","odsp-shared/base/ViewModel","./commandSets/FilePickerCommandSet","odsp-utilities/async/Promise","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","../../../resources/UtilityResourceKeys","../../../utilities/navigation/NavigationHelper","../../../utilities/images/ImagePromise","../../../dataSources/itemPicker/ItemPickerConstants"],function(e,t,i,o,n,s,a,r,c,d,l,m){var u="item-id",p="error",h="state",f="access_denied",k="name.FileSystemItemId",P="aad_picker",x="root",g="https://onedrive.live.com/picker/setsuggestedtenant?",b="tenant",v=function(e){function t(t){e.call(this,t);var o=this.resources.consume(a.url),v=o.getItemPickerBehavior();i.default.exposeResources({resourceScope:this.resources,hostSettings:window._spPageContextInfo,selectionOptions:{mode:m.SELECTION_MODE_MAPPING[v.selectionMode],maximumSelectedCount:m.SELECTION_MAX_ITEMS,canSelectItem:m.VIEW_TYPE_MAPPINGS[v.viewType]}});var y=this.resources.consume(r.hostSettings);y&&(y.removeCalloutInvoker=!0);var _=this.resources.consume(c.navigation);this.filePickerCommandSet=new(this.managed(n.default));var I={};I[b]=window.location.protocol+"//"+window.location.host,l.request(g+d.serializeQuery(I)).done(function(){},function(){});var w=function(e){var t=e.map(function(e){return e.isRootFolder?x:e.properties[k]}).filter(function(e){return!!e}),i=t.join(","),o=[v.returnUrl,"#",u,"=",i,"&",h,"=",P].join("");return _.navigateTo(o),s.default.wrap()},B=function(){var e=[v.returnUrl,"#",p,"=",f,"&",h,"=",P].join("");return _.navigateTo(e),s.default.wrap()},C=function(){return s.default.wrap(null)};this.standaloneListParams={hideOverlayHost:!0,hideDialogHost:!0,hidePanelHost:!0,hideCommandBar:!0,hideContextMenus:!0},this.itemPickerParams={behavior:v,showNavigation:!0,showActions:!0,agent:{complete:w.bind(this),cancel:B.bind(this),getApplication:C.bind(this)}}}return __extends(t,e),t}(o);return v}),define("odsp-next/pages/filePicker/spo/FilePicker.html",[],function(){return"<!--ko component: {\n name: 'od-item-picker',\n params: itemPickerParams\n}--><div class=FilePicker><div class=FilePicker-commandBar data-bind=\"component: { name: 'ms-command-bar', params: { commandSet: filePickerCommandSet } }\"></div><div data-bind=\"component: { name: 'ms-standalone-list', params: standaloneListParams }\"></div></div><!--/ko-->"}),define("odsp-next/pages/filePicker/spo/FilePicker.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles("html[dir=ltr] .FilePicker-content,html[dir=rtl] .FilePicker-content{right:0}.FilePicker-title,.xlg .FilePicker-title,.xxlg .FilePicker-title,.xxxlg .FilePicker-title{color:#333;font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-weight:400}.FilePicker{position:absolute;top:0;bottom:0;left:0;right:0;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;z-index:280;height:100%}.FilePicker-content{overflow-y:hidden;position:absolute;bottom:0;top:50px}html[dir=ltr] .FilePicker-content,html[dir=rtl] .FilePicker-content{left:0}.FilePicker .FilePicker-content{overflow-y:scroll;-webkit-overflow-scrolling:touch}.Files-innerContent{position:relative;min-height:100%}.FilePicker-infoBar{height:50px;white-space:nowrap;overflow:hidden;box-sizing:border-box;padding:4px}html[dir=ltr] .lg .FilePicker-infoBar,html[dir=ltr] .xlg .FilePicker-infoBar,html[dir=ltr] .xxlg .FilePicker-infoBar,html[dir=ltr] .xxxlg .FilePicker-infoBar{padding-left:32px}html[dir=rtl] .lg .FilePicker-infoBar,html[dir=rtl] .xlg .FilePicker-infoBar,html[dir=rtl] .xxlg .FilePicker-infoBar,html[dir=rtl] .xxxlg .FilePicker-infoBar{padding-right:32px}html[dir=ltr] .FilePicker-infoBar .FilePicker-layoutToggle{float:right}html[dir=rtl] .FilePicker-infoBar .FilePicker-layoutToggle{float:left}.FilePicker-title{max-width:60%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;cursor:default;display:inline-block;font-size:21px}html[dir=ltr] .FilePicker-title{margin-right:15px}html[dir=rtl] .FilePicker-title{margin-left:15px}.lg .FilePicker-title,.md .FilePicker-title,.sm .FilePicker-title{margin-top:10px}.xlg .FilePicker-title,.xxlg .FilePicker-title,.xxxlg .FilePicker-title{font-size:28px}.FilePicker-loadingDiv{position:absolute;width:100%;background:linear-gradient(to bottom,rgba(255,255,255,.9),rgba(255,255,255,0))}.FilePicker-loadingBar{opacity:1}.FilePicker-empty,.FilePicker-error,.FilePicker-listView{display:block;position:relative;padding-bottom:32px}.xlg .FilePicker-empty,.xlg .FilePicker-error,.xlg .FilePicker-listView,.xxlg .FilePicker-empty,.xxlg .FilePicker-error,.xxlg .FilePicker-listView,.xxxlg .FilePicker-empty,.xxxlg .FilePicker-error,.xxxlg .FilePicker-listView{margin-top:12px}.lg .FilePicker-empty,.lg .FilePicker-error,.lg .FilePicker-listView,.md .FilePicker-empty,.md .FilePicker-error,.md .FilePicker-listView,.sm .FilePicker-empty,.sm .FilePicker-error,.sm .FilePicker-listView{padding-bottom:70px}")}),define("odsp-next/controls/emptyFolder/EmptyFolder",["require","exports","./EmptyFolderViewModel","odsp-shared/utilities/knockout/ComponentFactory","./EmptyFolder.html","./EmptyFolder.css"],function(e,t,i,o){var n=o.registerComponent({tagName:"ms-empty-folder",template:e("./EmptyFolder.html"),viewModel:i});return n}),define("odsp-next/controls/itemPicker/resources/ItemPickerResourceKeys",["require","exports","odsp-shared/utilities/resources/ResourceKey"],function(e,t,i){var o;!function(e){"use strict";e.actionMap=i("actionMap"),e.agent=i("agent"),e.behavior=i("behavior"),e.status=i("status")}(o||(o={})),Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}),define("odsp-next/models/itemPicker/IItemPickerStatus",["require","exports"],function(e,t){!function(e){e[e.initialized=0]="initialized",e[e.activated=1]="activated",e[e.blocked=2]="blocked",e[e.completed=3]="completed",e[e.canceled=4]="canceled"}(t.ItemPickerState||(t.ItemPickerState={}));t.ItemPickerState});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/commands/ItemPickerStatusCommandBuilder",["require","exports","odsp-shared/base/BaseModel","../../commands/CommandViewModel","../resources/ItemPickerResourceKeys","../../../models/itemPicker/ItemPickerSelectionMode","../../../models/itemPicker/ItemPickerAccessLevel","../../../models/itemPicker/ItemPickerViewType","../../../models/itemPicker/ItemPickerLinkType","../../../models/itemPicker/IItemPickerStatus","../ItemPicker.resx","odsp-shared/utilities/string/StringHelper","../../../resources/ControlResourceKeys","../../commands/CommandState","odsp-utilities/object/ObjectUtil","odsp-utilities/async/Promise","knockout"],function(e,t,i,o,n,s,a,r,c,d,l,m,u,p,h,f,k){var P=function(e){function t(t){var i=this;e.call(this,t);var s=this.resources.consume(n.default.agent);this._application=k.observable(),this._error=k.observable(),this._behavior=this.resources.consume(n.default.behavior),this._itemPickerStatus=this.resources.consume(n.default.status),this._itemsSelection=this.resources.consume(u.itemsSelection),this._commandStatus=this.createPureComputed(this._computeCommandStatus),this._commandStatus.equalityComparer=h.deepCompare,this._label=this.createPureComputed(this._computeLabel),this.command=new(this.managed(o))({isDisabled:k.observable(!0),textObservable:this._label,isSideCommand:t.isSideCommand,isHidden:this.createPureComputed(function(){return!i._label()}),state:this.createPureComputed(this._computeState)}),s&&s.getApplication().then(function(e){i._application(e)},function(e){return i._error(e),f.default.wrapError(e)})}return __extends(t,e),t.prototype._computeLabel=function(){var e=this._commandStatus();return e&&e.text},t.prototype._computeState=function(){var e=this._commandStatus();return e&&e.state||p.default.initialized},t.prototype._computeCommandStatus=function(){var e,t=this._itemPickerStatus();if(t.state===d.ItemPickerState.activated)t=null;else if(t.error){var i=this._itemsSelection.selectedCount(),o=this._behavior.viewType;e=o===r.default.folders?{text:m.format(m.pluralSelect(i,l.strings.shareSingleFolderErrorText,l.strings.shareMultipleFolderErrorText)),state:p.default.failed}:{text:m.format(m.pluralSelect(i,l.strings.shareSingleFileErrorText,l.strings.shareMultipleFileErrorText)),state:p.default.failed}}else if(this._itemsSelection.maximumSelectedCount&&this._itemsSelection.selectedCount()>=this._itemsSelection.maximumSelectedCount){var o=this._behavior.viewType;e=o===r.default.folders?{text:m.format(l.strings.selectionMaxFoldersErrorFormat,this._itemsSelection.maximumSelectedCount),state:p.default.failed}:{text:m.format(l.strings.selectionMaxFilesErrorFormat,this._itemsSelection.maximumSelectedCount),state:p.default.failed}}else e=this._computeConsentCommandStatus();return e},t.prototype._computeConsentCommandStatus=function(){var e,t=this._application();if(t){var i=this._behavior.viewType,o=this._behavior.linkType,n=this._behavior.selectionMode,d=this._behavior.accessLevel;e=i===r.default.folders&&d===a.default.readWrite?{text:m.format(l.strings.saveSingleConsentFormat,t.name)}:o!==c.default.download&&d===a.default.readOnly?n===s.default.single?{text:m.format(l.strings.shareSingleConsentFormat,t.name)}:{text:m.format(l.strings.shareMultipleConsentFormat,t.name)}:n===s.default.single?{text:m.format(l.strings.openSingleConsentFormat,t.name)}:{text:m.format(l.strings.openMultipleConsentFormat,t.name)}}else e=this._error()?{text:l.strings.unknownApplicationErrorText,state:p.default.failed}:null;return e},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=P});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/commandSets/ItemPickerCommandSet",["require","exports","../../commands/BaseCommandSet","../../commands/CommandViewModel","../resources/ItemPickerResourceKeys","../commands/ItemPickerStatusCommandBuilder","../../../models/itemPicker/ItemPickerViewType","../../../models/itemPicker/ItemPickerAccessLevel","../ItemPicker.resx","../../../resources/DataSourceResourceKeys","../../../models/itemPicker/IItemPickerStatus","../../loadingSpinner/LoadingSpinner.resx","knockout"],function(e,t,i,o,n,s,a,r,c,d,l,m,u){var p=function(t){function i(){t.call(this);var i=this.resources.consume(n.default.behavior),p=this.resources.consume(n.default.actionMap),h=e.toUrl(this.resources.consume(d.settings).mediaBaseUrl+"/images/loading/loadingspinner.gif"),f=this.resources.consume(n.default.status);this.commands.push(new(this.managed(s.default))({isSideCommand:!0}).command,new(this.managed(o))({isSideCommand:!0,iconUrl:h,isDisabled:u.observable(!0),isHidden:this.createPureComputed(function(){return f().state!==l.ItemPickerState.activated}),text:m.strings.LoadingText,isLabelVisible:u.observable(!1)}),new(this.managed(o))({text:i.viewType===a.default.folders&&i.accessLevel===r.default.readWrite?c.strings.completeReadWriteFoldersActionText:c.strings.completeReadFilesActionText,action:new(this.managed(p.ItemPickerCompleteAction)),isPermanent:!0}),new(this.managed(o))({text:c.strings.cancelActionText,action:new(this.managed(p.ItemPickerCancelAction)),isPermanent:!0}))}return __extends(i,t),i}(i.default);Object.defineProperty(t,"__esModule",{value:!0}),t.default=p});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/actions/ItemPickerCompleteAction",["require","exports","../../../base/BaseSelectionAction","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/Promise","../../../models/item/ItemType","../resources/ItemPickerResourceKeys","../../../models/itemPicker/ItemPickerViewType","../../../models/itemPicker/IItemPickerStatus"],function(e,t,i,o,n,s,a,r,c){var d=function(e){function t(t){e.call(this,t),this.name="ItemPicker.Complete",this.canFallbackToParent=!0,this._itemPickerAgent=this.resources.consume(a.default.agent),this._itemPickerBehavior=this.resources.consume(a.default.behavior),this._itemPickerStatus=this.resources.consume(a.default.status)}return __extends(t,e),t.prototype.onIsAvailable=function(){var t=this._itemPickerStatus().state;return(t===c.ItemPickerState.initialized||t===c.ItemPickerState.blocked)&&!!this._itemPickerAgent&&e.prototype.onIsAvailable.call(this)},t.prototype.onSelectionIsAvailable=function(e,t){var i=this._itemPickerBehavior.viewType||r.default.all;return e>0&&!t.isPlaceholder&&(i===r.default.all||i===r.default.files&&t.type!==s.Folder||i===r.default.folders&&t.type===s.Folder)},t.prototype.onSelectionExecute=function(e){var t=this;return this._itemPickerStatus({state:c.ItemPickerState.activated}),this._itemPickerAgent.complete(e).then(function(){return t._itemPickerStatus({state:c.ItemPickerState.completed}),{resultType:o.ResultTypeEnum.Success}},function(e){return t._itemPickerStatus({state:c.ItemPickerState.blocked,error:e}),n.default.wrapError(e)})},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/actions/ItemPickerCancelAction",["require","exports","../../../base/BaseAction","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/Promise","../resources/ItemPickerResourceKeys","../../../models/itemPicker/IItemPickerStatus"],function(e,t,i,o,n,s,a){var r=function(e){function t(t){e.call(this,t),this.name="ItemPicker.Cancel",this._itemPickerAgent=this.resources.consume(s.default.agent),this._itemPickerStatus=this.resources.consume(s.default.status)}return __extends(t,e),t.prototype.onIsAvailable=function(){var t=this._itemPickerStatus().state;return(t===a.ItemPickerState.initialized||t===a.ItemPickerState.blocked)&&!!this._itemPickerAgent&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(){var e=this;return this._itemPickerStatus({state:a.ItemPickerState.activated}),this._itemPickerAgent.cancel().then(function(){return e._itemPickerStatus({state:a.ItemPickerState.canceled}),{resultType:o.ResultTypeEnum.Success}},function(t){return e._itemPickerStatus({state:a.ItemPickerState.blocked,error:t}),n.default.wrapError(t)})},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=r});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/actions/ItemPickerSwitchAccountAction",["require","exports","../../../base/BaseAction","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/Promise","../resources/ItemPickerResourceKeys","../../../resources/ControlResourceKeys","../../../utilities/navigation/NavigationHelper","../../../models/itemPicker/ItemPickerViewType","../../../models/itemPicker/ItemPickerLinkType","../../../models/itemPicker/ItemPickerAccessLevel","../../../models/itemPicker/ItemPickerSelectionMode","../../../dataSources/itemPicker/ItemPickerConstants"],function(e,t,i,o,n,s,a,r,c,d,l,m,u){var p="https://onedrive.live.com/picker/accountchooser",h=(g={},g[c.default.files]="file",g[c.default.folders]="folder",g),f=(b={},b[d.default.webView]="webViewLink",b[d.default.web]="webLink",b[d.default.download]="downloadLink",b),k=(v={},v[m.default.multiple]="multi",v[m.default.single]="single",v),P=(y={},y[l.default.readWrite]="readwrite",y[l.default.readOnly]="read",y),x=function(e){function t(t){e.call(this,t),this.name="ItemPicker.SwitchAccount",this._behavior=this.resources.consume(s.default.behavior);var i=this.resources.consume(a.actionMap);this._navigationAction=new(this.managed(i.NavigationAction))({url:this._getAccountChooserUrl()})}return __extends(t,e),t.prototype.onExecute=function(e){return this._navigationAction.execute(e).then(function(){return n.default.wrap({resultType:o.ResultTypeEnum.Success})})},t.prototype._getAccountChooserUrl=function(){var e=this._behavior,t=(i={},i[u.MSA_CLIENT_ID_PARAM]=e.msaClientId,i[u.AAD_CLIENT_ID_PARAM]=e.aadClientId,i[u.RETURN_URL_PARAM]=e.returnUrl,i[u.VIEW_TYPE_PARAM]=h[e.viewType],i[u.SELECTION_MODE_PARAM]=k[e.selectionMode],i[u.LINK_TYPE_PARAM]=f[e.linkType],i[u.ACCESS_LEVEL_PARAM]=P[e.accessLevel],i[u.PROMPT_PARAM]=u.PROMPT_SELECT_ACCUNT_VALUE,i);return p+"?"+r.serializeQuery(t,null,!0);var i},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=x;var g,b,v,y}),define("odsp-next/controls/itemPicker/actions/ItemPickerActionMap",["require","exports","./ItemPickerCompleteAction","./ItemPickerCancelAction","./ItemPickerSwitchAccountAction"],function(e,t,i,o,n){var s=function(){function e(){this.ItemPickerCompleteAction=i.default,this.ItemPickerCancelAction=o.default,this.ItemPickerSwitchAccountAction=n.default}return e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=s});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/ItemPickerViewModel",["require","exports","odsp-shared/base/ViewModel","../../bindings/host/HostBinding","./commandSets/ItemPickerCommandSet","../../bindings/css/ClassesBinding","./actions/ItemPickerActionMap","./resources/ItemPickerResourceKeys","../../models/itemPicker/IItemPickerStatus","../../resources/ControlResourceKeys","knockout"],function(e,t,i,o,n,s,a,r,c,d,l){var m=function(e){function t(t,i){e.call(this,t),this.addBindingHandlers({host:o,classes:s}),this.resources.expose(r.default.actionMap,new(this.managed(a.default))),this.resources.expose(r.default.agent,t.agent),this._status=this.resources.expose(r.default.status,l.observable({state:c.ItemPickerState.initialized}));var m=t.behavior||{};this.resources.expose(r.default.behavior,m),this.commandSet=i&&i.commandSet||new(this.managed(n.default)),this.showNavigation=void 0===t.showNavigation?!0:t.showNavigation,this.showActions=void 0===t.showActions?!0:t.showActions,this._itemsSelection=this.resources.consume(d.itemsSelection),this.subscribe(this._itemsSelection.selection,this._onSelectionChanged)}return __extends(t,e),t.prototype._onSelectionChanged=function(){this._status({state:c.ItemPickerState.initialized})},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=m}),define("odsp-next/controls/itemPicker/ItemPicker.html",[],function(){return"<div class=od-ItemPicker data-bind=\"classes: { mappings: { 'od-ItemPicker--hasNavigation': showNavigation, 'od-ItemPicker--hasActions': showActions } }\"><!--ko if: showNavigation--><div class=od-ItemPicker-navigation data-bind=\"component: { name: 'od-item-picker-header', params: {} }\"></div><!--/ko--><div class=od-ItemPicker-selector data-bind=\"host: {}\"></div><!--ko if: showActions--><div class=od-ItemPicker-actions data-bind=\"component: { name: 'od-button-bar', params: { commandSet: commandSet } }\"></div><!--/ko--></div>"}),define("odsp-next/controls/itemPicker/ItemPicker.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-ItemPicker,.od-ItemPicker-actions,.od-ItemPicker-navigation,.od-ItemPicker-selector{position:absolute;left:0;right:0}.od-ItemPicker{top:0;bottom:0}.od-ItemPicker-navigation{top:0;height:50px;z-index:3}.od-ItemPicker-selector{top:0;bottom:0;z-index:1}.od-ItemPicker--hasNavigation .od-ItemPicker-selector{top:50px}.od-ItemPicker--hasActions .od-ItemPicker-selector{bottom:50px}.od-ItemPicker-actions{bottom:0;height:50px;box-sizing:border-box;padding:10px 0;z-index:1}html[dir=ltr] .od-ItemPicker-actions{text-align:right}html[dir=rtl] .od-ItemPicker-actions{text-align:left}.od-ItemPicker-actions .ms-Button--primary:enabled,.od-ItemPicker-actions .ms-Button:active{color:#fff}.od-ItemPicker-actions .od-ButtonBarCommand--text{font-size:12px}.od-ItemPicker .DetailsRow,.od-ItemPicker .ItemTile{opacity:.3}.od-ItemPicker .DetailsRow.can-select,.od-ItemPicker .DetailsRow.od-DetailsRow--isInvokable,.od-ItemPicker .DetailsRow.od-ItemTile--isInvokable,.od-ItemPicker .ItemTile.can-select,.od-ItemPicker .ItemTile.od-DetailsRow--isInvokable,.od-ItemPicker .ItemTile.od-ItemTile--isInvokable{opacity:1}")}),define("odsp-next/controls/buttonBar/ButtonBar.html",[],function(){return"<span class=od-ButtonBar tabindex=0 role=menubar data-bind=\"keyboard: keyboardOptions, selection: { data: selectableCommands, mode: 'single', direction: 'horizontal', focused: focusedCommand }, event: { mousedown: onMousedown }, element: topTab\"><span class=od-ButtonBar-main data-bind=\"foreach: mainCommands\"><!--ko component: {\n name: 'od-button-bar-command',\n params: {\n command: $data,\n index: $index\n }\n }--><!--/ko--></span> <span class=od-ButtonBar-side data-bind=\"foreach: sideCommands\"><!--ko component: {\n name: 'od-button-bar-command',\n params: {\n command: $data,\n index: $index\n }\n }--><!--/ko--></span></span>"}),define("odsp-next/controls/buttonBar/ButtonBar.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-ButtonBar,.od-ButtonBar-main{display:block;height:30px}.od-ButtonBarCommand,html[dir=rtl] .od-ButtonBarCommand{padding:4px 20px 6px}html[dir=ltr] .od-ButtonBar .ms-Button{margin-right:10px}html[dir=rtl] .od-ButtonBar .ms-Button{margin-left:10px}html[dir=ltr] .od-ButtonBar .ms-Button:last-child{margin-right:20px}html[dir=rtl] .od-ButtonBar .ms-Button:last-child{margin-left:20px}.od-ButtonBar-main{white-space:nowrap}.od-ButtonBarCommand,.od-ButtonBarCommand-icon{display:inline-block}html[dir=ltr] .od-ButtonBar-main{float:right}html[dir=rtl] .od-ButtonBar-main{float:left}.od-ButtonBarCommand{color:#333;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;margin:0;box-shadow:none;box-sizing:border-box;border:1px solid transparent;height:30px}.od-ButtonBarCommand-icon .ms-Icon{vertical-align:top}.od-ButtonBarCommand--failed{color:#a80000}")}),define("odsp-next/controls/buttonBar/command/templates/ButtonBarCommandTemplates",["require","exports"],function(e,t){t.BUTTON="od-button-bar-command-button",t.TEXT="od-button-bar-command-text"});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/buttonBar/command/ButtonBarCommandViewModel",["require","exports","odsp-shared/base/ViewModel","./templates/ButtonBarCommandTemplates","../../../bindings/css/ClassesBinding","../../commands/CommandState","knockout"],function(e,t,i,o,n,s,a){var r=function(e){function t(t){e.call(this,t),this.addBindingHandlers({classes:n}),this._index=t.index,this.command=t.command,this.focused=a.observable(!1),this.selected=a.observable(!1),this.templateName=this.createPureComputed(this._computeTemplateName),this.isPrimary=this.createPureComputed(this._computeIsPrimary),this.state=this.createPureComputed(this._computeState)}return __extends(t,e),t.prototype._computeTemplateName=function(){var e;return e=!this.command.action||!this.command.isPermanent&&this.command.isDisabled()?o.TEXT:o.BUTTON},t.prototype._computeIsPrimary=function(){return 0===this._index()},t.prototype._computeState=function(){return s.default[this.command.state()||s.default.initialized]},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}),define("odsp-next/controls/buttonBar/command/ButtonBarCommand.html",[],function(){return"<!--ko template: templateName--><!--/ko-->"}),define("odsp-next/controls/buttonBar/command/templates/ButtonBarCommandButton.html",[],function(){return'<button class="ms-Button od-ButtonBarCommand od-ButtonBarCommand--button" data-bind="attr: { title: command.tooltip }, css: { \'is-disabled\': command.isDisabled, \'is-focused\': command.focused, \'ms-Button--primary\': isPrimary }, hasFocus: command.isActive, disable: command.isDisabled, click: command.onClick.bind(command)"><!--ko if: command.icon--><span class="ms-Button-icon od-ButtonBarCommand-icon" data-bind="component: { name: \'od-icon-glyph\', params: { icon: command.icon, badge: command.iconBadge } }"></span><!--/ko--><!--ko if: command.iconUrl--><span class="ms-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="style: { backgroundImage: \'url(\\\'\' + command.iconUrl() + \'\\\')\' }"></i></span><!--/ko--><!--ko if: command.isLabelVisible--><span class="ms-Button-label od-ButtonBarCommand-label" data-bind="text: command.label"></span><!--/ko--></button>'}),define("odsp-next/controls/buttonBar/command/templates/ButtonBarCommandText.html",[],function(){return'<span class="od-ButtonBarCommand od-ButtonBarCommand--text" data-bind="classes: { base: \'od-ButtonBarCommand--\' + state() }"><!--ko if: command.icon--><span class=od-ButtonBarCommand-icon data-bind="component: { name: \'od-icon-glyph\', params: { icon: command.icon, badge: command.iconBadge } }"></span><!--/ko--><!--ko if: command.iconUrl--><span class="ms-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="style: { backgroundImage: \'url(\\\'\' + command.iconUrl() + \'\\\')\' }"></i></span><!--/ko--><!--ko if: command.isLabelVisible--><span class=od-ButtonBarCommand-label data-bind="text: command.label"></span><!--/ko--></span>'}),define("odsp-next/controls/buttonBar/command/ButtonBarCommand",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./ButtonBarCommandViewModel","./templates/ButtonBarCommandTemplates","./ButtonBarCommand.html","./templates/ButtonBarCommandButton.html","./templates/ButtonBarCommandText.html"],function(e,t,i,o,n){var s=i.registerComponent({tagName:"od-button-bar-command",template:e("./ButtonBarCommand.html"),viewModel:o.default,synchronous:!0});i.registerTemplate(n.BUTTON,e("./templates/ButtonBarCommandButton.html")),i.registerTemplate(n.TEXT,e("./templates/ButtonBarCommandText.html")),Object.defineProperty(t,"__esModule",{value:!0}),t.default=s}),define("odsp-next/controls/buttonBar/ButtonBar",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","../commandBar/CommandBarViewModel","./ButtonBar.html","./ButtonBar.css","./command/ButtonBarCommand"],function(e,t,i,o){var n=i.registerComponent({tagName:"od-button-bar",template:e("./ButtonBar.html"),viewModel:o,synchronous:!0});Object.defineProperty(t,"__esModule",{value:!0}),t.default=n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/notificationHost/NotificationHostViewModel",["require","exports","knockout","../../bindings/clientRect/ClientRectBinding","../../bindings/dismiss/DismissBinding","./NotificationHost.resx","../../resources/ProviderResourceKeys","odsp-shared/base/ViewModel"],function(e,t,i,o,n,s,a,r){var c=function(e){function t(t){var r=this;e.call(this,t),this.notification=this.resources.consume(a.notification).currentNotification,this._textContainerMaxWidth=700,this._tempBuffer=300,this.addBindingHandlers({clientRect:o.default,textClientRect:o.default,dismiss:n}),this._textWidth=0,this.textMaxWidth=i.observable("auto"),this.closeText=s.strings.Close,this.expandText=s.strings.Expand,this.clientRect=i.observable({width:0,height:0}),this.textClientRect=i.observable({width:0,height:0}),this._isNotificationVisible=t&&t.isNotificationVisible||i.observable(!1),this.subscribe(this.clientRect,this._onResize),this.subscribe(this.textClientRect,this._onTextResize),this.isExpanded=i.observable(!1),this.hasOverflow=i.observable(!1),this.createComputed(function(){r._isNotificationVisible(!!r.notification())})}return __extends(t,e),t.prototype.dismiss=function(){var e=this.notification.peek();return e&&e.canImplicitDismiss?(e.dismiss(),this._textWidth=0,!1):!0},t.prototype.close=function(){var e=this.notification.peek();return e&&e.showCloseButton?(e.complete(),this._textWidth=0,!1):!0},t.prototype.onButtonClick=function(e,t){e&&e.action&&(e.action.execute(t),e.dismiss(),this._textWidth=0)},t.prototype.onExpandClick=function(){this.isExpanded(!this.isExpanded.peek())},t.prototype._onTextResize=function(){0===this._textWidth&&(this._textWidth=this.textClientRect.peek().width,this._onResize())},t.prototype._onResize=function(){if(this._textWidth>0){var e=this.clientRect.peek().width;e-this._tempBuffer>this._textWidth&&this._textWidth<this._textContainerMaxWidth?(this.hasOverflow(!1),this.textMaxWidth("auto")):(this.hasOverflow(!0),this.textMaxWidth(Math.min(e-this._tempBuffer,this._textContainerMaxWidth)+"px")),this.isExpanded(this.isExpanded.peek()&&this.hasOverflow.peek())}},t}(r);return c}),define("odsp-next/controls/notificationHost/NotificationHost.html",[],function(){return'<div class=NotificationHost data-bind="clientRect: { size: clientRect }, css: { \'is-active\': notification, \'is-expanded\': isExpanded }"><!--ko with: notification--><div class=od-Notification role=alert data-bind="dismiss: { isAutomatic: !!timeout, timeout: timeout, isOpen: isOpen, close: $component.dismiss.bind($component) }"><div class=od-Notification-content><div class=od-Notification-text><div class=od-Notification-clipper data-bind="style: { width: $component.textMaxWidth }"><span data-bind="text: text, clientRect: { size: $component.textClientRect }"></span></div><button class=od-Notification-expand data-bind="attr: { \'aria-label\': $parent.expandText, title: $parent.expandText }, click: $component.onExpandClick.bind($component), visible: $parent.hasOverflow"><i class=ms-Icon data-bind="css: { \'ms-Icon--chevronsDown\': !$parent.isExpanded(), \'ms-Icon--chevronsUp\': $parent.isExpanded() }"></i></button></div><!--ko if: action--><div class=od-Notification-action><button class="ms-Button ms-Button--primary" data-bind="click: $component.onButtonClick.bind($component)"><span class=ms-Button-label data-bind="text: actionText"></span></button></div><!--/ko--></div><!--ko if: showCloseButton--><button class=od-Notification-close data-bind="attr: { \'aria-label\': $parent.closeText, title: $parent.closeText }, click: $component.close.bind($component)"><i class="ms-Icon ms-Icon--x"></i></button><!--/ko--></div><!--/ko--></div>'
}),define("odsp-next/controls/notificationHost/NotificationHost.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-Notification,.od-Notification-clipper,.od-Notification-text{overflow:hidden;display:inline-block}.NotificationHost{height:0;background-color:#e6f2fb;font-size:12px;position:relative}.NotificationHost.is-active{border-bottom:1px solid #767676;height:52px}.od-Notification-close,.od-Notification-expand{height:52px;width:40px;cursor:pointer;border:none;background-color:transparent}.od-Notification-close{position:absolute;top:0}html[dir=ltr] .od-Notification-close{right:0}html[dir=rtl] .od-Notification-close{left:0}.od-Notification{background-color:#e6f2fb;width:100%;height:52px;box-sizing:border-box;padding:0 40px}html[dir=ltr] .od-Notification{text-align:left}html[dir=rtl] .od-Notification{text-align:right}.od-Notification-text{line-height:52px;max-width:770px}.od-Notification-expand{line-height:normal;vertical-align:top}.od-Notification-action{display:inline-block;vertical-align:top;line-height:52px;margin-left:10px}.NotificationHost.is-expanded .od-Notification-text,.od-Notification-action .ms-Button{line-height:normal}.od-Notification-clipper{white-space:nowrap;text-overflow:ellipsis;vertical-align:top}.NotificationHost.is-expanded .od-Notification{height:auto;box-shadow:0 0 16px 0 rgba(0,0,0,.4)}.NotificationHost.is-expanded .od-Notification-clipper{white-space:normal;vertical-align:middle;padding:6px 0;margin-top:12px;margin-bottom:12px}")}),define("odsp-next/controls/notificationHost/NotificationHost",["require","exports","./NotificationHostViewModel","odsp-shared/utilities/knockout/ComponentFactory","./NotificationHost.html","./NotificationHost.css"],function(e,t,i,o){var n=o.registerComponent({tagName:"od-notification-host",template:e("./NotificationHost.html"),viewModel:i});return n});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};define("odsp-next/controls/itemPicker/header/ItemPickerHeaderViewModel",["require","exports","odsp-shared/base/ViewModel","../../../resources/ProviderResourceKeys","../../../bindings/dismiss/DismissBinding","../../../bindings/imageLoader/ImageLoaderBinding","../../commands/CommandViewModel","../../../bindings/contextMenu/ContextMenuAlignment","../../../utilities/locale/Locale","../resources/ItemPickerResourceKeys","../../../resources/DataSourceResourceKeys","../ItemPicker.resx","knockout"],function(e,t,i,o,n,s,a,r,c,d,l,m,u){var p=function(t){function i(i){t.call(this,i),this.addBindingHandlers({dismiss:n,imageLoader:s}),this._identityProvider=this.resources.consume(o.identity),this.applicationText=m.strings.applicationName;var p=this.resources.consume(d.default.actionMap),h=this._identityProvider.getIdentity();this.accountCommand=new(this.managed(a))({text:h.email?h.email:h.loginName,collapseSingleChildCommands:!1,requiresChildren:!0}),this.accountCommand.children.push(new(this.managed(a))({text:m.strings.switchAccountActionText,action:new(this.managed(p.ItemPickerSwitchAccountAction))})),this.accountMenuParams={items:this.accountCommand.children,isOpen:this.accountCommand.isOpen,alignment:u.observable(c.isRightToLeft?r.Left:r.Right),left:u.observable(c.isRightToLeft?"0":"100%"),hasExplicitAlignment:!0};var f=this.resources.consume(l.settings),k=f.mediaBaseUrl;this.applicationLogoUrl=e.toUrl(k+"/images/filepicker/onedrivelogolight.png"),this.isLogoLoaded=u.observable(!1)}return __extends(i,t),i}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=p}),define("odsp-next/controls/itemPicker/header/ItemPickerHeader.html",[],function(){return'<div class=od-ItemPickerHeader><div class=od-ItemPickerHeader-application data-bind="css: { \'od-ItemPickerHeader-application--hasLogo\': isLogoLoaded }"><span class=od-ItemPickerHeader-applicationLogo><img data-bind="imageLoader: { src: applicationLogoUrl, isLoaded: isLogoLoaded }"></span> <span class=od-ItemPickerHeader-applicationTitle data-bind="text: applicationText"></span></div><div class=od-ItemPickerHeader-account data-bind="dismiss: { isOpen: accountCommand.isOpen }"><span class=od-ItemPickerHeader-accountDropdown data-bind="css: { \'od-ItemPickerHeader-accountDropdown--isOpen\': accountCommand.isOpen }, click: accountCommand.onClick.bind(accountCommand)"><span class=od-ItemPickerHeader-accountDropdownLabel data-bind="text: accountCommand.label"></span> <i class="ms-Icon ms-Icon--chevronDown"></i></span><!--ko if: accountCommand.isOpen--><div class=od-ItemPickerHeader-accountMenu data-bind="component: { name: \'ms-contextual-menu\', params: accountMenuParams }"></div><!--/ko--></div></div>'}),define("odsp-next/controls/itemPicker/header/ItemPickerHeader.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-ItemPickerHeader-account,.od-ItemPickerHeader-application{position:absolute;line-height:50px;height:100%}html[dir=ltr] .od-ItemPickerHeader-account,html[dir=rtl] .od-ItemPickerHeader-application{right:16px}html[dir=ltr] .od-ItemPickerHeader-application,html[dir=rtl] .od-ItemPickerHeader-account{left:16px}.od-ItemPickerHeader-accountDropdown,.od-ItemPickerHeader-applicationTitle{font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif}.od-ItemPickerHeader{height:50px;background-color:#000;color:#fff}.od-ItemPickerHeader-applicationTitle{font-size:21px}.od-ItemPickerHeader-applicationLogo{display:none}.od-ItemPickerHeader-accountDropdown{padding:0 4px;height:100%;display:inline-block;cursor:pointer;font-size:12px}.od-ItemPickerHeader-accountDropdown .ms-Icon{font-size:17px;vertical-align:middle}.od-ItemPickerHeader-accountDropdown:hover{background-color:rgba(255,255,255,.28)}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationLogo{display:inline-block;padding-top:5px}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationTitle{display:inline-block;width:0;height:0;overflow:hidden}")}),define("odsp-next/controls/itemPicker/header/ItemPickerHeader",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./ItemPickerHeaderViewModel","../../contextualMenu/ContextualMenu","./ItemPickerHeader.html","./ItemPickerHeader.css"],function(e,t,i,o){var n=i.registerComponent({tagName:"od-item-picker-header",template:e("./ItemPickerHeader.html"),viewModel:o.default,synchronous:!0});Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/controls/itemPicker/ItemPicker",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./ItemPickerViewModel","./ItemPicker.html","./ItemPicker.css","../buttonBar/ButtonBar","../notificationHost/NotificationHost","./header/ItemPickerHeader"],function(e,t,i,o){var n=i.registerComponent({tagName:"od-item-picker",template:e("./ItemPicker.html"),viewModel:o.default,synchronous:!0});Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/pages/filePicker/odb/FilePicker",["require","exports","../spo/FilePickerViewModel","odsp-shared/utilities/knockout/ComponentFactory","../spo/FilePicker.html","../spo/FilePicker.css","odsp-utilities/async/Promise","../../../controls/breadcrumbBar/BreadcrumbBar","../../../controls/list/DetailsList","../../../controls/list/GridList","../../../controls/emptyFolder/EmptyFolder","../../../controls/progressSpinnerFlat/ProgressSpinnerFlat","../../../controls/itemPicker/ItemPicker"],function(e,t,i,o){var n=o.registerComponent({tagName:"od-filepicker",template:e("../spo/FilePicker.html"),viewModel:i,synchronous:!0});return n});
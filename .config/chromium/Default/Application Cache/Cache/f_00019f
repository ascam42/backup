define("odsp-next/resources/PagesResourceKeys",["require","exports","odsp-shared/utilities/resources/ResourceKey"],function(e,t,o){var i=function(){function e(){}return e.sortManager=o("sortManager"),e.dataManager=o("dataManager"),e.listViewContextMenuCommandSet=o("listViewContextMenuCommandSet"),e.topCommandSet=o("topCommandSet"),e.listViewContextMenuHelper=o("listViewContextMenuHelper"),e.files={isInfoPaneExpanded:o("files.isInfoPaneExpanded"),layoutType:o("files.layoutType"),isLeftNavUserExpanded:o("files.isLeftNavUserExpanded"),resx:o("files.resx"),isWebimOpened:o("files.isWebimOpened"),isArrangeControlVisible:o("files.isArrangeControlVisible")},e.photos={layoutType:o("photos.layoutType")},e.storageInfo={layoutType:o("storageInfo.layoutType")},e}();return i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/scrollContainer/ScrollContainerBinding",["require","exports","../BaseBinding","knockout"],function(e,t,o,i){t.SCROLL_CONTAINER_KEY="ScrollContainerBinding_scrollContainer";var n=function(e){function o(o){e.call(this,o),i.utils.domData.set(this.element,t.SCROLL_CONTAINER_KEY,!0)}return __extends(o,e),o}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/models/selection/ItemSetSelectionModel",["require","exports","./BaseSelectionModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","odsp-utilities/async/Signal","odsp-utilities/logging/events/Qos.event","knockout"],function(e,t,o,i,n,a,r,s){function l(e){"use strict";var t=e&&e.peek&&e.peek();return t&&t.key||null}var d=5,c=1e3,u=4,m=function(e){function t(t){var o=this,a={getItemKey:l};s.utils.extend(a,t||{}),e.call(this,a),this.itemSet=this.resources.consume(i.currentItemSet),this.itemProvider=this.resources.consume(n.item),this._currentItems=this.createPureComputed(function(){return o.itemSet().content().items}),this.createComputed(function(){o._onItemSetChanged(o._currentItems())})}return __extends(t,e),t.prototype.resolveSelection=function(){var e={resolveAttempt:0,itemSet:this.itemSet(),missingRanges:null,pendingRanges:0,signal:new a,getItemPromises:[]};return this.validateResolvedSelection(e),e.signal.getPromise()},t.prototype.validateResolvedSelection=function(e){if(e.resolveAttempt++,e.resolveAttempt>u)e.signal.error({resultType:r.ResultTypeEnum.Failure,resultCode:"TooManyAttempts"});else{var t=this._getMissingRanges();if(e.getItemPromises=[],e.missingRanges=t,e.pendingCount=t.length,0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection()));else for(var o=0;d>o;o++)this.resolveNextRange(e)}},t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var o=e.missingRanges.pop(),i=s.utils.extend({},e.itemSet.context);i.avoidSeamSnapping=!0,i.startIndex=o.start,i.endIndex=o.end,i.pageSize=o.end-o.start+1,e.getItemPromises.push(this.itemProvider.getItem(i).then(function(){e.pendingCount--,e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(o){t.cancelResolve(e,o)}))}},t.prototype.cancelResolve=function(e,t){for(var o=0;o<e.getItemPromises.length;o++)e.getItemPromises[o].cancel();t?e.signal.error(t):e.signal.cancel()},t.prototype._onItemSetChanged=function(e){var t=this.itemSet.peek().item.peek(),o=this._item,i=o&&t.key!==o.key;if(this.setItems(e,i),i){var n=o.parent;this.clear(),n&&t.key===n.key&&this.setItemFocus(e[this._keyToIndex[o.key]])}this._item=t},t.prototype._unwrapSelection=function(e){return e.map(function(e){return s.utils.unwrapObservable(e)})},t.prototype._getMissingRanges=function(){var e=[],t=-1,o=-1,i=this.getMissingIndicies();if(i.length)for(t=i[0],o=i[i.length-1];t>-1;){var n=Math.min(o,t+c-1),a={start:t,end:n};e.push(a),t=n===o?-1:n+1}return e},t}(o.default);return m});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/UnsupportedAction",["require","exports","../base/BaseAction"],function(e,t,o){var i=function(e){function t(){e.apply(this,arguments),this.name="Unsupported"}return __extends(t,e),t.prototype.onIsAvailable=function(){return!1},t}(o);return i}),define("odsp-next/actions/BaseActionMap",["require","exports","./UnsupportedAction"],function(e,t,o){var i=function(){function e(){this.AddCoverPhotoAction=o,this.AddPhotosToAlbumAction=o,this.AddTagAction=o,this.AddToAlbumAction=o,this.AddToBundleAction=o,this.AddToSharedListAction=o,this.AlertAction=o,this.AutoExecuteAction=o,this.AvailabilityAction=o,this.ChangeFolderTypeAction=o,this.CheckInAction=o,this.CheckOutAction=o,this.ClearFilterAction=o,this.ClearSelectionAction=o,this.ContentTypeNavigationAction=o,this.CopyAction=o,this.CreateDocumentAction=o,this.CreateFolderAction=o,this.CreateMountPointAction=o,this.DefaultClickAction=o,this.DeleteAction=o,this.DownloadAction=o,this.EditItemAction=o,this.EditTagsAction=o,this.EmbedAction=o,this.EmptyRecycleBinAction=o,this.FeedbackAction=o,this.FilterAction=o,this.FilterSearchAction=o,this.GetLinkAction=o,this.GroupAction=o,this.LanguagePickerAction=o,this.LaunchMoveCopyPanelAction=o,this.MergeFaceGroupsAction=o,this.MoveAction=o,this.MoveCopyAction=o,this.NavigationAction=o,this.OpenAction=o,this.OpenInClientAction=o,this.OpenInOfficeClientAction=o,this.OpenInOfficeOnlineAction=o,this.OrderPrintsAction=o,this.PlayAudioAction=o,this.PlaySlideShowAction=o,this.PolicyTipAction=o,this.RemoveCoverPhotoAction=o,this.RemoveFromBundleAction=o,this.RemoveFromRecentAction=o,this.RemoveFromSharedListAction=o,this.RemoveMountPointAction=o,this.RemoveTagAction=o,this.RemoveTagFromItemAction=o,this.RenameAction=o,this.ReportAbuseAction=o,this.RequestReviewAction=o,this.RestoreAction=o,this.RestoreAllAction=o,this.RotateAction=o,this.SaveSortOrderAction=o,this.SetAlbumCoverPhotoAction=o,this.SetAlbumCoverPhotoAction=o,this.SetFocusAction=o,this.ShareAction=o,this.ShareByLinkAction=o,this.ShowKeyboardMapAction=o,this.ShowOperationsAction=o,this.ShowPropertiesAction=o,this.ShowSelectionAction=o,this.ShowVersionHistoryAction=o,this.SignOutAction=o,this.SortAction=o,this.StopSlideShowAction=o,this.SurveyAction=o,this.SwitchSharingLinkAction=o,this.SwitchViewAction=o,this.SyncAction=o,this.EditAction=o,this.ToggleAction=o,this.ToggleDebugWindowAction=o,this.ToggleListLayoutAction=o,this.UndoCheckOutAction=o,this.UpdateCaptionAction=o,this.UpdatePermissionsAction=o,this.UploadAction=o,this.ViewInFolderAction=o,this.ViewOriginalAction=o,this.ToggleSelectionModeAction=o,this.RedeemCodeAction=o}return e}();return i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/base/BaseItemAction",["require","exports","./BaseAction","../resources/ControlResourceKeys"],function(e,t,o,i){var n=function(e){function t(t){e.call(this,t),this.isItemSpecified=!!t&&!!t.item,this.item=t&&t.item||this.resources.consume(i.currentItem)}return __extends(t,e),t.prototype.onIsAvailable=function(){return!!this.item()},t}(o);return n}),define("odsp-next/actions/OpenRelation",["require","exports"],function(){var e;return function(e){e[e.selection=0]="selection",e[e.current=1]="current",e[e.specified=2]="specified",e[e.parent=3]="parent"}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/DefaultClickAction",["require","exports","../base/BaseItemAction","odsp-utilities/logging/events/Qos.event","../resources/ControlResourceKeys","./OpenRelation","odsp-next/models/item/ItemType","../resources/DataSourceResourceKeys","../resources/ProviderResourceKeys","odsp-utilities/async/Promise","knockout","../dataSources/url/QueryType","../dataSources/url/PageType","odsp-shared/utilities/object/EqualityComparers","odsp-next/utilities/features/Features","odsp-utilities/logging/events/Engagement.event"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g){var f=function(e){function t(t){e.call(this,t),this.name="DefaultClick",this.isQosLogged=!1;var o=t.itemSet,i=t.openLocal,r=void 0===i?!1:i,d=t.openRelation,c=void 0===d?a.current:d,u=t.userInvokedItem,m=void 0===u?!1:u,h=t.sourceEngagement;this._specifiedItemSet=o,this.openLocal=r,this.sourceEngagement=h,this._openRelation=c,this._userInvokedItem=m,this.actionMap=this.resources.consume(n.actionMap),this.urlDataSource=this.resources.consume(s.url),this.viewParams=this.resources.consume(n.viewParams),this._isFilePicker=this.createComputed(this._computeIsFilePicker,{deferEvaluation:!0,pure:!0}),this._action=this.createComputed(this._computeAction,{deferEvaluation:!0,pure:!0}),this._action.equalityComparer=p.objectStrictEquality,this._userInvokedItem&&(this._instrumentationProvider=this.resources.consume(l.instrumentation))}return __extends(t,e),t.prototype.onIsAvailable=function(){return this._action()&&this._action().isAvailable()},t.prototype.onExecute=function(e){var t=c.utils.unwrapObservable(this.item);return this.sourceEngagement&&(this.item.peek().type===r.File?g.Engagement.logData({name:"FileOpen."+this.sourceEngagement,extraData:{action:e.type}}):this.item.peek().type===r.Folder&&g.Engagement.logData({name:"FolderOpen."+this.sourceEngagement,extraData:{action:e.type}})),this._userInvokedItem&&this.urlDataSource.getQueryType()===u.Search&&this._instrumentationProvider&&t&&this._instrumentationProvider.userClickItem(t),this._action()&&this._action().execute(e)||d.default.wrap({resultType:i.ResultTypeEnum.ExpectedFailure})},t.prototype.onComputeAction=function(){var e=void 0;return e=h.default.isFeatureEnabled(h.default.ShortcutLink)&&this._isShortcutFile(this.item())?new(this.managed(this.actionMap.OpenShortcutAction))({item:this.isItemSpecified&&this.item||null}):new(this.managed(this.actionMap.OpenAction))({openRelation:this._openRelation,item:this.isItemSpecified&&this.item||null,itemSet:this._specifiedItemSet,openLocal:this.openLocal})},t.prototype._computeAction=function(){var e=this._isFilePicker();this._lastAction&&(this._lastAction.dispose(),this._lastAction=null);var t;return t=e&&this.item().type!==r.Folder?null:this.onComputeAction(),this._lastAction=t,t},t.prototype._computeIsFilePicker=function(){return this.viewParams(),this.urlDataSource.getPageType()===m.FilePicker},t.prototype._isShortcutFile=function(e){return".url"===e.extension||".website"===e.extension||".lnk"===e.extension},t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=f});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/DeferredAction",["require","exports","knockout","../base/BaseAction","odsp-utilities/async/RequireHelper","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/Promise"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){var i=this;e.call(this,t),this.isQosLogged=!1,this.name="Deferred"+this.modulePath,this.name=this.name.replace(/Action|\u002E|\u002F/g,""),this._actionParams=t,this._actionLoaded=o.observable(!1),this._deferredExecutionQueue=[],this._loadActionPromise=n.promise(this.sourceRequire,this.modulePath),this._loadActionPromise.then(function(e){i._action=new(i.managed(e))(i._actionParams),i._actionLoaded(!0);for(var t=0;t<i._deferredExecutionQueue.length;t++)i._action.execute(i._deferredExecutionQueue[t])})}return __extends(t,e),t.create=function(e,o){return n.deferred(t,e,o)},t.prototype.onIsAvailable=function(){return this._actionLoaded()?this._action.isAvailable():!1},t.prototype.onIsToggled=function(){return this._actionLoaded()?this._action.isToggled():!1},t.prototype.onExecute=function(e){return this._actionLoaded()?this._action.execute(e):(this._deferredExecutionQueue.push(e),r.default.wrap({resultType:a.ResultTypeEnum.Success}))},t.prototype.onInputChange=function(e){this._actionLoaded()&&this._action.onInputChange&&this._action.onInputChange(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._loadActionPromise&&(this._loadActionPromise.cancel(),this._loadActionPromise=null)},t}(i);return s}),define("odsp-next/utilities/selection/SelectionHelper",["require","exports","knockout","../../models/dialog/DialogState","../../controls/textContainer/TextContainer","odsp-utilities/async/Promise","../../controls/commands/Commands.resx","./SelectionHelper.resx","../../utilities/icons/Icon"],function(e,t,o,i,n,a,r,s,l){var d=s.strings,c=r.strings,u=function(){function e(){}return e.resolveSelection=function(t){var n,r,s=t.options&&void 0!==t.options.shouldShowDialog?t.options.shouldShowDialog:!0,l=o.observable(d.resolveDescription),c=o.observable(!0),u=o.observable(!1),m=t.selectionModel,p=t.dialogProvider,h=t.options&&t.options.promiseTracker;return m?(r=m.resolveSelection().then(function(e){return s=!1,n&&n.state(i.completed),e},function(e){return n&&(l(d.resolveError),c(!1),u(!0)),a.default.wrapError(e)}),s&&(n=e._createDialog(p,l,c,u),n.wait().then(null,function(){r.cancel()})),h&&h.registerPromise(r)):r=a.default.wrap([]),r},e.getSelectedItemApp=function(e){var t,i=e.selection();if(1===i.length){var n=o.utils.unwrapObservable(i[0]);Boolean(n.appMap)&&(t=n.appMap)}return t},e._createDialog=function(e,t,o,r){return e.requestDialog({title:d.resolveTitle,isDismissable:!1,component:{name:n.tagName,params:{text:t}},actions:[{name:c.cancelActionText,execute:function(){return a.default.wrap(i.dismissed)},isVisible:o,icon:l.x,isDefault:!0},{name:c.ok,execute:function(){return a.default.wrap(i.dismissed)},isVisible:r,icon:l.x,isDefault:!0}]})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=u});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/base/BaseSelectionAction",["require","exports","./BaseItemAction","../resources/ControlResourceKeys","../resources/ProviderResourceKeys","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../utilities/selection/SelectionHelper","knockout"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t){e.call(this,t),this.canFallbackToParent=!1,this.isSingleSelectAction=!1,t&&void 0!==t.item||(this.selectionModel=this.resources.consume(i.itemsSelection))}return __extends(t,e),t.prototype.getCurrentSelection=function(){var e=this.selectionModel,t=e?e.selection():[];return 0===t.length&&(this.canFallbackToParent||this.isItemSpecified)&&(t=[this.item]),t},t.prototype.onIsAvailable=function(){var t=this.getCurrentSelection(),o=e.prototype.onIsAvailable.call(this)&&((this.isSingleSelectAction&&1===t.length||!this.isSingleSelectAction&&t.length>0)&&this._getIsAvailableFromSelection(t)||!t.length&&(this.canFallbackToParent||this.isItemSpecified)&&this.onSelectionIsAvailable(1,this.item()));return o},t.prototype.onSelectionIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t,o,i){var r,l=this;if(this.selectionModel){var d=this.resources.consume(n.dialog);if(o){var c=this.selectionModel.selection.peek();r=a.default.wrap(c.map(function(e){return e.peek()}))}else r=s.default.resolveSelection({selectionModel:this.selectionModel,dialogProvider:d,options:i})}else r=a.default.wrap([]);return r.then(function(o){return o?(0===o.length&&(l.canFallbackToParent||l.isItemSpecified)&&(o=[l.item.peek()]),l.onSelectionExecute(o,e,t)):void 0})},t.prototype.onSelectionExecute=function(){return a.default.wrap({resultType:r.ResultTypeEnum.Failure})},t.prototype._getIsAvailableFromSelection=function(e){for(var t=!0,o=0;o<e.length;o++){var i=e[o],n=l.unwrap(i);if(!n)break;if(t=this.onSelectionIsAvailable(e.length,n),!t)break}return t},t}(o);return d});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/NavigationAction",["require","exports","../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/UtilityResourceKeys","odsp-next/resources/ControlResourceKeys","odsp-next/utilities/navigation/NavigationHelper","knockout"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t){e.call(this,t),this.name="Navigation";var o=t.url,i=t.target,n=void 0===i?"_top":i,s=t.forceNavigation,d=void 0===s?!1:s,c=t.ignoreHistory,u=t.beforeNavigation;this._navigation=this.resources.consume(a.navigation),this._viewParams=this.resources.consume(r.viewParams),this._url=l.isObservable(o)?o:l.observable(o),this._target=l.isObservable(n)?n:l.observable(n),this._forceNavigation=d,this._ignoreHistory=c,this._beforeNavigation=u}return __extends(t,e),t.prototype.onExecute=function(){var e=this._url.peek(),t=this._beforeNavigation;return t&&t(),(this._forceNavigation||e&&"#"!==e)&&this._navigation.navigateTo({url:e,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory}),i.default.wrap({resultType:n.ResultTypeEnum.Success})},t.prototype.onIsAvailable=function(){if(!this._forceNavigation){var e=this._viewParams(),t="#"+s.serializeQuery(e),o=this._url();return!!o&&"#"!==o&&o!==t}return!0},t}(o);return d});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/OpenAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ControlResourceKeys","../resources/UtilityResourceKeys","../resources/DataSourceResourceKeys","./OpenRelation","../dataSources/url/QueryType","../models/item/ItemType","./NavigationAction","knockout"],function(e,t,o,i,n,a,r,s,l,d,c,u,m){var p=function(e){function t(t){void 0===t&&(t={}),e.call(this,t),this.name="Open",this.isSingleSelectAction=!0,this.canFallbackToParent=!0;var o=t.openRelation,i=void 0===o?l.selection:o,n=t.ignoreHistory,d=void 0===n?!1:n,c=t.preferCurrentView,p=void 0===c?!1:c,h=t.skipItemValidation,g=void 0===h?!1:h,f=t.preventWithSelection,b=void 0===f?!1:f,v=t.itemSet,x=void 0===v?this.resources.consume(a.currentItemSet):v,y=t.openLocal,C=void 0===y?!1:y,S=t.focusUrl,k=void 0===S?!1:S,I=t.preserveAction,_=void 0===I?!1:I;this.openRelation=i,this._ignoreHistory=d,this._preferCurrentView=p,this._skipItemValidation=g,this._preventWithSelection=b,this.itemSet=x,this._openLocal=C,this._focusUrl=m.isObservable(k)?k:m.observable(k),this._preserveAction=_,this._navigation=this.resources.consume(r.navigation),this._urlDataSource=this.resources.consume(s.url),this._viewParams=this.resources.consume(a.viewParams),this.openItem=this.createComputed(this._computeOpenItem,{deferEvaluation:!0,pure:!0}),this._url=this.createComputed(this._computeUrl,{deferEvaluation:!0,pure:!0}),this._target=this.createComputed(this._computeTarget,{deferEvaluation:!0,pure:!0}),this._navigationAction=new(this.managed(u))({url:this._url,ignoreHistory:this._ignoreHistory,target:this._target})}return __extends(t,e),t.prototype.onIsAvailable=function(){var t=this.openItem(),o=this.openRelation!==l.selection||e.prototype.onIsAvailable.call(this);return this._preventWithSelection&&(o=o&&0===this.selectionModel.selection().length),o&&!!t&&t.queryType!==d.RecycleBin&&this._navigationAction.isAvailable()},t.prototype.onExecute=function(e){var t=this.openItem.peek();return this._navigationAction.execute(e).then(function(){var e={fileType:c[t.type],extension:t.extension||""};return i.default.wrap({resultType:n.ResultTypeEnum.Success,extraData:e})})},t.prototype._computeOpenItem=function(){var e;switch(this.openRelation){case l.parent:e=this.item().parent;break;case l.current:e=this.item();break;case l.specified:e=this.isItemSpecified&&this.item()||null;break;default:var t=this.getCurrentSelection();e=1===t.length?this.getCurrentSelection()[0]():null}return e},t.prototype._computeUrl=function(){var e=this.openItem(),t=this.itemSet(),o=this._focusUrl();this._viewParams();var i=e&&this._urlDataSource.getDefaultClickUrl(e,{focusUrl:o,preserveAction:this._preserveAction,preferCurrentView:this._preferCurrentView,itemSet:t})||"";return i},t.prototype._computeTarget=function(){var e=this._openLocal;if(!e){var t=this._url();if(t&&0!==t.indexOf("#"))return"_blank"}return"_top"},t}(o);return p});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/SetFocusAction",["require","exports","../base/BaseItemAction","odsp-utilities/async/Promise","odsp-utilities/domUtils/DomUtils","odsp-utilities/logging/events/Qos.event"],function(e,t,o,i,n,a){var r=function(e){function t(t){e.call(this,t),this.name="SetFocus",this._selector=t.selector,this._shouldClick=t.shouldClick}return __extends(t,e),t.prototype.onExecute=function(){var e=document.querySelector(this._selector);return e&&(e.focus(),this._shouldClick&&n.clickElement(e)),i.default.wrap({resultType:a.ResultTypeEnum.Success})},t}(o);return r});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/SelectAllAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","../resources/ControlResourceKeys","../models/selection/BaseSelectionModel"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){e.call(this,t),this.name="SelectAll",this._selectionModel=this.resources.consume(a.itemsSelection)}return __extends(t,e),t.prototype.onIsAvailable=function(){return this._selectionModel.mode===r.SelectionMode.multiple},t.prototype.onExecute=function(){return this._selectionModel.selectAll(),i.default.wrap({resultType:n.ResultTypeEnum.Success})},t}(o);return s});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/odb/CreateCustomDocumentAction",["require","exports","../../base/BaseItemAction","../../resources/UtilityResourceKeys","../../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","odsp-utilities/async/Promise","../../dataSources/url/QueryType"],function(e,t,o,i,n,a,r,s){var l=function(e){function t(t){e.call(this,t),this.name="CreateCustomDocument",this.openInNewTab=!0,this.fileCreationMenu=t.fileCreationMenu,this.entryIndex=t.entryIndex,this.navigation=this.resources.consume(i.navigation),this.itemProvider=this.resources.consume(n.item)}return __extends(t,e),t.prototype.onIsAvailable=function(){return this.item.peek().queryType===s.Files},t.prototype.onExecute=function(){var e=this.item.peek();return this._createCustomDocument(e)},t.prototype._createCustomDocument=function(e,t){var o=this,i=null,n=this.fileCreationMenu.createNewFileControl(this.entryIndex),s=n.get_fileExtension(),l=this.itemProvider.createCustomDocument(e.key,s,t).then(function(e){return e?(i=e,r.default.wrap({resultType:a.ResultTypeEnum.Success})):r.default.wrap({resultType:a.ResultTypeEnum.Failure})});return l.done(function(){if(i&&null!=n){n.set_itemUrl(i),n.set_httpRoot(window._spPageContextInfo.webAbsoluteUrl);var e=n.getRedirectUrl();null!=e&&o.async.setImmediate(function(){return o.navigation.navigateTo({url:e,frameId:o.openInNewTab?"_blank":null})})}}),l},t}(o);return l});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/ToggleSelectionModeAction",["require","exports","../base/BaseSelectionAction","odsp-utilities/async/Promise","../resources/UtilityResourceKeys","odsp-utilities/logging/events/Qos.event","../utilities/features/Features"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){e.call(this,t),this.name="ToggleSelectionModeAction"}return __extends(t,e),t.prototype.onSelectionExecute=function(){var e=this.resources.consume(n.mobile).showItemCheck;return e(!e()),i.default.wrap({resultType:a.ResultTypeEnum.Success})},t.prototype.onIsAvailable=function(){var e=this.getCurrentSelection();return this.platformDetection.isMobile&&0===e.length&&r.default.isFeatureEnabled(r.default.UseNewMobileListViewUX)},t.prototype.onIsToggled=function(){return this.resources.consume(n.mobile).showItemCheck()},t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/odb/ActionMap",["require","exports","../BaseActionMap","../DefaultClickAction","../DeferredAction","../OpenAction","../SetFocusAction","../SelectAllAction","./CreateCustomDocumentAction","../ToggleSelectionModeAction"],function(e,t,o,i,n,a,r,s,l,d){var c=function(t){function o(){t.call(this),this.CheckInAction=n.create(e,"./CheckInAction"),this.CheckOutAction=n.create(e,"./CheckOutAction"),this.ClearFilterAction=n.create(e,"../ClearFilterAction"),this.ClearSelectionAction=n.create(e,"../ClearSelectionAction"),this.CreateDocumentAction=n.create(e,"./CreateDocumentAction"),this.CreateCustomDocumentAction=l,this.CreateFolderAction=n.create(e,"./CreateFolderAction"),this.LaunchCreateShortcutPanel=n.create(e,"./LaunchCreateShortcutPanel"),this.CreateNewFolderAction=n.create(e,"../CreateNewFolderAction"),this.DeleteAction=n.create(e,"./DeleteAction"),this.DefaultClickAction=i.default,this.DownloadAction=n.create(e,"./DownloadAction"),this.FilterAction=n.create(e,"../FilterAction"),this.GetLinkAction=n.create(e,"./GetLinkAction"),this.LaunchMoveCopyPanelAction=n.create(e,"./LaunchMoveCopyPanelAction"),this.MoveCopyAction=n.create(e,"../MoveCopyAction"),this.NavigationAction=n.create(e,"../NavigationAction"),this.OpenAction=a,this.OpenShortcutAction=n.create(e,"odsp-next/actions/odb/OpenShortcutAction"),this.ContentTypeNavigationAction=n.create(e,"./ContentTypeNavigationAction"),this.OpenInClientAction=n.create(e,"../OpenInClientAction"),this.PolicyTipAction=n.create(e,"../PolicyTipAction"),this.RenameAction=n.create(e,"./RenameAction"),this.SetFocusAction=r,this.ShareAction=n.create(e,"./ShareAction"),this.ShareByLinkAction=n.create(e,"../ShareByLinkAction"),this.ShowOperationsAction=n.create(e,"../ShowOperationsAction"),this.ShowPropertiesAction=n.create(e,"../ShowPropertiesAction"),this.ShowSelectionAction=n.create(e,"../ShowSelectionAction"),this.ShowVersionHistoryAction=n.create(e,"./ShowVersionHistoryAction"),this.SortAction=n.create(e,"../SortAction"),this.SyncAction=n.create(e,"./SyncAction"),this.EditAction=n.create(e,"./EditAction"),this.AlertAction=n.create(e,"./AlertAction"),this.ToggleListLayoutAction=n.create(e,"../ToggleListLayoutAction"),this.UndoCheckOutAction=n.create(e,"./UndoCheckOutAction"),this.UpdatePermissionsAction=n.create(e,"../UpdatePermissionsAction"),this.UploadAction=n.create(e,"./UploadAction"),this.AddTagAction=n.create(e,"../AddTagAction"),this.RemoveTagAction=n.create(e,"../RemoveTagAction"),this.ShowKeyboardMapAction=n.create(e,"../ShowKeyboardMapAction"),this.SelectAllAction=s,this.RemoveFromSharedListAction=n.create(e,"./RemoveFromSharedListAction"),this.ToggleSelectionModeAction=d.default}return __extends(o,t),o}(o);return c});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/pages/files/spo/SortManager",["require","exports","odsp-shared/base/BaseModel","../../../resources/UtilityResourceKeys"],function(e,t,o,i){var n="sortField",a="isAscending",r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.updateSort=function(e,t){var o=this.resources.consume(i.navigation),r=(s={},s[n]=e,s[a]=t,s);o.updateViewParams(r);var s},t}(o);return r}),define("odsp-next/controls/list/layouts/LayoutType",["require","exports"],function(){var e=function(){function e(){}return e.Albums="ms-albums-list",e.AllPhotos="ms-all-photos-list",e.CustomGridList="ms-grid-customlist",e.CustomList="ms-details-customlist",e.Details="ms-details-list",e.Grid="ms-grid-list",e.SingleAlbum="ms-single-album-list",e.TagGrid="od-tag-grid",e.TagsList="od-tags-list",e.Path=(t={},t[e.Albums]="AlbumsList",t[e.AllPhotos]="AllPhotosList",t[e.CustomGridList]="CustomGridList",t[e.CustomList]="CustomList",t[e.Details]="DetailsList",t[e.Grid]="GridList",t[e.SingleAlbum]="SingleAlbumList",t[e.TagGrid]="TagGrid",t[e.TagsList]="TagsList",t),e;var t}();return e}),define("odsp-next/dataSources/item/GroupingType",["require","exports"],function(){var e;return function(e){e[e.Default=0]="Default",e[e.FoldersFilesPhotos=1]="FoldersFilesPhotos"}(e||(e={})),e}),define("odsp-next/models/clientForm/IClientForm",["require","exports"],function(e,t){!function(e){e[e.editItem=0]="editItem",e[e.newItem=1]="newItem"}(t.ClientFormType||(t.ClientFormType={}));t.ClientFormType;!function(e){e[e.edit=0]="edit",e[e.display=1]="display"}(t.ClientFormMode||(t.ClientFormMode={}));t.ClientFormMode});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/dragAndDrop/DropHelper",["require","exports","./DragType","../../resources/ProviderResourceKeys","odsp-utilities/async/Promise","../../utilities/selection/SelectionHelper","odsp-shared/base/BaseModel","../../models/item/ItemType","odsp-utilities/logging/events/Qos.event","../../dataSources/url/PageType","../../dataSources/url/QueryType","odsp-shared/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../resources/ModelResourceKeys","odsp-utilities/logging/ErrorHelper","../../models/clientForm/IClientForm","knockout"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f){var b=function(e){function t(){e.call(this),this._operatorProvider=this.resources.consume(i.operator),this._itemProvider=this.resources.consume(i.item),this._dialogProvider=this.resources.consume(i.dialog),this._urlDataSource=this.resources.consume(m.url)}return __extends(t,e),t.updateMetadata=function(e,t,o,i,n){for(var a=t.group.name,r=t.group.field,s=i.consume(m.clientForm),l=i.consume(p.itemsStore),d=e.length,c=0,u=0;u<e.length;u++){var h=e[u],b=[{data:f.observable(a),serverData:null,mode:f.observable(g.ClientFormMode.edit),hasException:f.observable(!1),errorMessage:f.observable(""),schema:{Name:r}}],v={item:f.observable(h),fields:b};s.updateItem({clientForm:v,newDocumentUpdate:!1,checkInComment:null}).then(function(){return c++,c===d&&(o&&o(),n&&l.invalidateItem(n.key)),!0})}},t.prototype.processDrop=function(e,i){var n=this;if(!i||!i.isDropEnabled||i===e.item)return!1;if(e.type===o.FileUpload)return this._operatorProvider.upload({files:e.files,parentItem:i,wasDragAndDropped:!0,type:e.uploadType,metadata:e.metadata}).done(null,function(e){return h.log(e)
}),!0;if(e.type===o.OneDriveItem){var a=Boolean(e.metadata)&&Boolean(e.metadata.group);return a?(this._resolveSelection(e).then(function(o){var a=new u.Action({name:"DragChangeGroup",pageType:d[n._urlDataSource.getPageType()],queryType:c[n._urlDataSource.getQueryType()]});t.updateMetadata(o,e.metadata,null,n.resources,i);var r={},m={count:o.length};1===o.length&&(r.fileType=s[o[0].type],r.extension=o[0].extension||""),a.end({resultType:l.ResultTypeEnum.Success,extraData:r,extraMetrics:m})}).done(null,function(e){return h.log(e)}),!0):e.selectionModel.itemSet.peek().item.peek().key===i.key?!1:(this._resolveSelection(e).then(function(t){t=t.filter(function(e){return e!==i});var o=new u.Action({name:"DragMove",pageType:d[n._urlDataSource.getPageType()],queryType:c[n._urlDataSource.getQueryType()]});return n._itemProvider.copyItems({items:t,parentKey:e.item.parentKey,targetId:i.id,targetKey:i.key,cid:n._urlDataSource.getOwnerId(),group:i.isGroup?1:0,isAsync:!1,isMove:!0}).then(function(){var e={},i={count:t.length};1===t.length&&(e.fileType=s[t[0].type],e.extension=t[0].extension||""),o.end({resultType:l.ResultTypeEnum.Success,extraData:e,extraMetrics:i})},function(){o.end({resultType:l.ResultTypeEnum.Failure})})}).done(null,function(e){return h.log(e)}),!0)}},t.prototype._resolveSelection=function(e){return e.selectionModel?a.default.resolveSelection({selectionModel:e.selectionModel,dialogProvider:this._dialogProvider}).then(function(t){return t&&0!==t.length||(t=[e.item]),t}):n.default.wrap([e.item])},t}(r);return b});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/dragAndDrop/DragAndDropBinding",["require","exports","knockout","../BaseBinding"],function(e,t,o,i){var n=function(e){function t(t){var i=this;e.call(this,t);var n=this.valueAccessor();this._isDragging=n.isDragging,this._mayReceiveDrop=n.mayReceiveDrop,this._receiveDrop=n.receiveDrop,this._dragOutWindow=n.dragOutWindow,this._state=o.observable({isWithinElement:!1,data:void 0}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}),this._isDragging&&this.createComputed(function(){i._isDragging.call(i.bindingContext.$data,i._state().isWithinElement,i._state().data)}),this.events.on(this.element,"od-dragEnter",this._onDragEnter),this.events.on(this.element,"od-dragLeave",this._onDragLeave),this.events.on(this.element,"od-processDrop",this._onProcessDrop),this.events.on(this.element,"od-dragOutWindow",this._onDragOutWindow)}return __extends(t,e),t.prototype._onDragEnter=function(e){var t=e.args;return this._state({isWithinElement:!0,data:{dragData:t.dragData,dropTargetData:t.dropTargetData}}),!t.dropTargetData&&this._mayReceiveDrop&&(t.dropTargetData=this._mayReceiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)),!0},t.prototype._onDragLeave=function(){return this._state({isWithinElement:!1,data:void 0}),!0},t.prototype._onProcessDrop=function(e){var t=e.args;return!t.isHandled&&this._receiveDrop&&this._receiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)?(t.isHandled=!0,!1):(this._state({isWithinElement:!1,data:void 0}),!0)},t.prototype._onDragOutWindow=function(){return this._state({isWithinElement:!1,data:void 0}),!0},t}(i);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/listGroupHeader/ListGroupHeaderViewModel",["require","exports","knockout","./ListGroupHeader.resx","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../dragAndDrop/DragType","../dragAndDrop/DropHelper","odsp-shared/utilities/string/StringHelper","../../bindings/dragAndDrop/DragAndDropBinding"],function(e,t,o,i,n,a,r,s,l,d,c){var u=function(e){function t(t){var n=this;e.call(this,t),this._group=t.group,this.headerText=d.format(i.strings.GroupHeaderText,this._group.name,this._group.count),this.seeAllText=i.strings.SeeAllText,this.showSeeAll=t.cellsInGroup<this._group.count,this.isCollapsed=this.createComputed(function(){return n._group.state?n._group.state().isCollapsed:!1}),this.isDroppingTarget=o.observable(!1),this.isDroppable=o.observable(!0),this._dropHelper=new(this.managed(l));var a=this.resources.consume(r.dataManager);this._parentItem=a.item,this.addBindingHandlers({dragAndDrop:c.default}),this.showCheckbox=!Boolean(t.isGrid)}return __extends(t,e),t.prototype.onToggleCollapse=function(e){if(e._group.state){var t=e._group.state.peek().isCollapsed;e._group.state({isCollapsed:!t})}},t.prototype.onSeeAll=function(e,t){var o=e.resources.consume(a.actionMap),i=new(e.managed(o.FilterAction))({field:e._group.field,value:e._group.name,isFilterOn:!0});return i.execute(t),t.stopPropagation(),t.preventDefault(),!1},t.prototype.onReceiveDrop=function(e){return e.metadata={group:this._group},this._dropHelper.processDrop(e,this._parentItem.peek())},t.prototype.onMayReceiveDrop=function(e){var t=null;return(e.type===s.OneDriveItem||e.type===s.FileUpload)&&(t={targetName:this._group.field+": "+this._group.name}),t},t.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)},t}(n);return u}),define("odsp-next/controls/listGroupHeader/ListGroupHeader.html",[],function(){return'<div class=od-ListGroupHeader data-bind="css: { \'dropping\': isDroppingTarget, \'is-collapsed\': isCollapsed, \'showCheckbox\': showCheckbox }, click: onToggleCollapse, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"><i class="od-ListGroupExpandButton ms-Icon ms-Icon--chevronDown"></i> <span class=od-ListGroupHeader-title data-bind="text: headerText"></span> <a class=od-ListGroupHeader-seeAllLink href=# data-bind="visible: showSeeAll, click: onSeeAll, text: seeAllText"></a></div>'}),define("odsp-next/controls/listGroupHeader/ListGroupHeader.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-ListGroupHeader{background-color:rgba(255,255,255,.9);height:32px;line-height:32px;margin-top:20px;font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;color:#666;position:relative;padding:4px 0}.od-ListGroupHeader:hover{background-color:#e6f2fb}html[dir=ltr] .od-ListGroupHeader.showCheckbox{padding-left:40px}html[dir=rtl] .od-ListGroupHeader.showCheckbox{padding-right:40px}.od-ListGroupHeader.dropping{box-shadow:inset 0 0 0 3px #c8c8c8}.od-ListGroupHeader-title{display:inline-block}html[dir=ltr] .od-ListGroupHeader-title{padding-left:14px;margin-left:-6px}html[dir=rtl] .od-ListGroupHeader-title{padding-right:14px;margin-right:-6px}.od-ListGroupHeader-seeAllLink{padding:0 20px}.od-ListGroupExpandButton.ms-Icon{height:32px;line-height:32px;text-align:center;-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;width:32px;vertical-align:top;padding:4px 0;margin-top:-4px}.od-ListGroupExpandButton.ms-Icon:hover{background-color:#beddf4}.od-ListGroupHeader.is-collapsed .od-ListGroupExpandButton{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0)}")}),define("odsp-next/controls/listGroupHeader/ListGroupHeader",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./ListGroupHeaderViewModel","./ListGroupHeader.html","./ListGroupHeader.css"],function(e,t,o,i){var n=o.registerComponent({tagName:"ms-listGroup-header",template:e("./ListGroupHeader.html"),viewModel:i,synchronous:!0});return n}),define("odsp-next/controls/list/layouts/CustomListHelper",["require","exports","../../listGroupHeader/ListGroupHeader"],function(e,t,o){var i=60,n="SPListGroup",a=function(){function e(){}return e.getGroup=function(e,t){var o,i=t;if(e&&e.length&&e[0].itemGroups){var n=e[0].itemGroups;if(i&&i.groups)for(var a=n[0].field,r=i.groups[a],s=0;s<n.length;s++){var l=n[s];if(l&&l.groupingId===r){o=l;break}}}return o},e.getHeaderDetails=function(e,t,a,r){var s="",l=null,d=20,c="";return e&&e.groupingType===n&&(s=o.tagName,l={group:e,cellsInGroup:t,resources:a,isGrid:r},d=i,c=e.groupingId+"_"+e.count),{viewType:s,viewData:l,headerHeight:d,key:c}},e}();return a}),define("odsp-next/pages/files/spo/GroupItemLimitProjection",["require","exports","../../../controls/list/layouts/CustomListHelper"],function(e,t,o){var i=function(){function e(){this.key="GroupItemLimit"}return e.prototype.projectItemSet=function(e,t,i){if(e){var n=t.content.peek().groupings,a=t.content.peek().items,r=n&&n.length&&n[0].itemGroups;if(r){var s=t.content.peek().items;a=[];for(var l=null,d=0,c=0;c<s.length;c++){var u=s[c];if(!u){a.length+=s.length-c;break}var m=o.getGroup(n,u.peek()),p=m!==l;p&&(d=0,l=m);var h=!p&&d>=i;h||(a.push(u),d++)}}e.sortField=t.sortField,e.isAscending=t.isAscending,e.schema=t.schema,e.contentTypes=t.contentTypes,e.content({items:a,groupings:n}),e.isPlaceholder=t.isPlaceholder,e.isExpired=t.isExpired,e.version=t.version}},e}();return i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/pages/files/spo/DataManager",["require","exports","knockout","./SPOFiles.resx","odsp-shared/base/BaseModel","../../../controls/list/layouts/LayoutType","../../../dataSources/item/GroupingType","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../dataSources/url/odb/UrlQueryKeys","../../../models/item/OneDriveItem","../../../models/itemSet/ItemSet","../../../resources/ModelResourceKeys","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/UtilityResourceKeys","odsp-utilities/async/Promise","odsp-utilities/async/RequireHelper","odsp-utilities/logging/events/Engagement.event","odsp-shared/utilities/object/EqualityComparers","odsp-utilities/object/ObjectUtil","../../../utilities/performance/PerformanceCollection","odsp-shared/utilities/string/StringHelper","../../../utilities/logging/rumone/PageTransitionType","../../../utilities/logging/rumone/ControlPerformanceData","../../../utilities/logging/rumone/RUMOneLogger","../../../utilities/list/ListFilterHelper","../../../utilities/navigation/NavigationHelper","odsp-utilities/models/store/DataStoreCachingType","./GroupItemLimitProjection","../../../controls/leftPane/LeftPane.resx"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b,v,x,y,C,S,k,I,_,B,w,L,T,A,N,P){var D="SPO.Files.FilesQueryType",F=function(t){function n(e){var i=this;t.call(this,e),this._layoutTypeSaved=null,this._inNewFolderDataFetch=!1,this._firstDataFetchComplete=!1,this._viewParamsCurrent=null,this._resetLayoutOnDataFetch=!1,this._policyTipRequested=!1,this._viewParams=this.resources.consume(p.viewParams),this._responsiveUI=this.resources.consume(b.responsiveUI),this._isLeftNavUserExpanded=this.resources.consume(g.files.isLeftNavUserExpanded);var n=new c,a=new u;a.item=o.observable(n),this.item=this.resources.expose(p.currentItem,a.item),this.item.equalityComparer=C.objectStrictEquality,this.itemSet=this.resources.expose(p.currentItemSet,o.observable(a)),this.itemSet.equalityComparer=C.objectStrictEquality,this._dataStore=this.resources.consume(m.itemsStore),this._children=o.observableArray([]),this._children.equalityComparer=C.objectStrictEquality,this.isEmptyView=o.observable(!1),this.showErrorPage=o.observable(!1),this.error=o.observable(null),this.createComputed(function(){i._children(i.itemSet().content().items),i.isEmptyView(!i.showErrorPage()&&0===i._children().length)}),this.createComputed(function(){i.item(i.itemSet().item())}),this._setupContextualQueryType(),this._options=this.createComputed(this._computeOptions,{deferEvaluation:!0}),this._itemProvider=this.resources.consume(f.item),this._itemLimitProjection=new N,this._itemProvider.registerProjection(this._itemLimitProjection.key,this._itemLimitProjection),this._urlDataSource=this.resources.consume(h.url),this.queryType=this.createComputed(this._computeQueryType,{deferEvaluation:!0}),this._getItemContext=this.createComputed(this._computeGetItemContext,{deferEvaluation:!0}),this._getItemContext.equalityComparer=S.deepCompare,this.requiredRange=o.observable({start:0,end:0}).extend({throttle:500}),this.itemsPerGroup=o.observable(-1),this.isRetrievingData=o.observable(!0),this.layoutType=o.observable(this.getDefaultLayoutForView()),this.title=this.createComputed(this._computeTitle,{deferEvaluation:!0}),this.focusItem=o.observable(),this.isOneUp=this.createComputed(this._computeIsOneUp),this.createComputed(this._computeItemSet).extend({throttle:1})}return __extends(n,t),n.prototype.computeIsOneUp=function(){return this._viewParams(),Boolean(this._urlDataSource)&&!!this._urlDataSource.getFocusItemKey()},n.prototype.setLayoutIteration=function(t){var o=this;this._layoutIteration=t;var i=this._layoutIteration.subscribe(function(){if(o._firstDataFetchComplete){var t=o.queryType(),n=s[s.Files]+"-"+(l[t]||"Default");o.async.setTimeout(function(){var t=(new Date).getTime();k.plt(n),o.events.raise("pageLoadComplete"),x.promise(e,"odsp-utilities/logging/odb/Beacon").then(function(e){e.addToLoggingManagerForBeaconCache()}),o.LogRUMOneForPageRender(n,t,w)},0),i.dispose()}},this)},n.prototype.signalContentLoadComplete=function(){this.events.raise("pageLoadComplete")},n.prototype.updateSort=function(){},n.prototype.getCrumbs=function(e){for(var t=[],i=!1,n=T.serializeQuery(this._viewParams()),a=L.getFilterList(n),r=a.length-1;r>=0;r--){var s=a[r],l={key:e.key,url:"#"+L.clearFilterInfo(n,r+1),name:s.values.join(", "),showNextChevron:i,isDroppingTarget:o.observable(!1),isOverflow:!1,isNavItem:i,isStaticItem:!i};t.push(l),i=!0}for(;e;){var d=i,c=!i;e.isStub&&(d=!1,c=!0);var u={key:e.key,url:"#"+e.key,name:e.name||P.strings.Files,showNextChevron:i,isDroppingTarget:o.observable(!1),isOverflow:!1,isNavItem:d,isStaticItem:c};t.push(u),i=!0,e=e.parent}return t},n.prototype.getDefaultLayoutForView=function(){var e=a.Details,t=this.item.peek(),o=this._urlDataSource.getQueryType();return t&&t.displayType===l.Photos&&(o=l.Photos),this._contextualQueryTypes[l[o]]?e=this._contextualQueryTypes[l[o]]:(this._responsiveUI.formFactorSize()<=this._responsiveUI.windowSize.Medium||Boolean(t)&&(t.queryType===l.Recent||t.displayType===l.Photos))&&(e=a.Grid),e},n.prototype.cacheLayoutContext=function(){var e=this.item.peek();if(!this._inNewFolderDataFetch&&e&&!e.isPlaceholder){var t=this._urlDataSource.getQueryType();e&&e.displayType===l.Photos&&(t=l.Photos),this._contextualQueryTypes[l[t]]=this.layoutType()===a.Grid?a.Grid:a.Details,this._dataStore.setValue(this._getSetViewLocalStorageKey(),this._contextualQueryTypes,A.local)}},n.prototype.LogRUMOneForPageRender=function(e,t,o){var i=o.getRUMOneLogger();if(Boolean(i)){i.writeScenarioId("ODBNext."+e,!0),i.addExpectedControl("ODBNextPage"),i.writePageTransitionType(_.fullPageLoad,!0),i.writeAppCache(k.summary.appCacheHit),i.writePreRenderTime(k.summary.preRender),i.writeDataFetchTime(k.summary.dataFetch),i.writePostRenderTime(k.summary.postRender),i.writeRenderTime(k.summary.render),i.collectW3CPerfTimings(),i.collectW3cResourceTimings();var n=new B("ODBNextPage",0,t,this.ComputePageRenderTime,this.CheckPageRenderTimeRequiredDataAvailable);i.writeControlPerformanceData(n)}},n.prototype.CheckPageRenderTimeRequiredDataAvailable=function(e,t){if(Boolean(e)&&Boolean(t)){var o=e.getPerformanceDataPropertyValue("W3cNavigationStart");return Boolean(o)&&Boolean(t.endTime)}return!1},n.prototype.ComputePageRenderTime=function(e,t){if(Boolean(e)&&Boolean(t)){var o=e.getPerformanceDataPropertyValue("W3cNavigationStart");return t.endTime-o}return 0},n.prototype._computeOptions=function(){var e=this._viewParams(),t=o.utils.extend({},e);return delete t.id,t},n.prototype._computeItemSet=function(){var e=this;this._resetLayoutOnDataFetch&&this.isRetrievingData(!0);var t=S.deepCopy(this._getItemContext());this.itemSet(this._itemProvider.getItemSync(t));var o,i=this.queryType(),n=this._itemProvider;o=i===l.SharedWithMeODB?n.getSharedWithMe(t):i===l.Recent?n.getRecent(t):i===l.RecycleBin?n.getRecycledItems(t):i===l.Search?n.getSearchItems(t):i===l.DocsInCommon?n.getDocsInCommon(t):n.getItem(t),this._getItemPromise=o,this.showErrorPage(!1),this.error(null),this.trackPromise(o.then(function(i){if(o===e._getItemPromise&&(e._getItemPromise=null,e.isRetrievingData(!1),i.item&&e._inNewFolderDataFetch&&(e._inNewFolderDataFetch=!1,e._setLayoutType(i.item.peek()),e._resetLayoutOnDataFetch=!1,e._firstDataFetchComplete=!0,!e._policyTipRequested&&t.queryType===l.Files))){var n=e._viewParams.peek()[d.default.policyTipKey];n||(n=e._viewParams.peek()[d.default.policyTipKey.toLowerCase()]),n&&(e._policyTipRequested=!0,e._showPolicyTip(n,i))}},function(t){v.default.isCanceled(t)||(e.error(t),e.showErrorPage(!0))}))},n.prototype._setupContextualQueryType=function(){this._contextualQueryTypes={},this._contextualQueryTypes[l[l.Files]]=this._contextualQueryTypes[l[l.Recent]]="",this._contextualQueryTypes[l[l.SharedWithMe]]=this._contextualQueryTypes[l[l.Photos]]="",o.utils.extend(this._contextualQueryTypes,this._dataStore.getValue(this._getSetViewLocalStorageKey(),A.local)||{})},n.prototype._getSetViewLocalStorageKey=function(){return window._spPageContextInfo?D+"."+window._spPageContextInfo.webAbsoluteUrl:D},n.prototype._computeGetItemContext=function(){var e=this.requiredRange(),t=this.itemsPerGroup(),o=this._options(),i={parentKey:this._urlDataSource.getCurrentItemKey(),sortField:o[d.default.sortFieldKey],isAscending:"false"!==o[d.default.isAscendingKey],useDefaultAscending:void 0===o[d.default.isAscendingKey],startIndex:e.start,endIndex:e.end,query:this._urlDataSource.getQueryParamValue(),queryType:this._urlDataSource.getQueryType(),ownerId:this._urlDataSource.getOwnerId(),groupingType:r.Default,isTokenBasedApi:!0,viewId:o[d.default.viewIdKey],groupBy:o[d.default.groupByKey],mergeGroupings:!0};-1!==t&&(i.itemSetProjections||(i.itemSetProjections={}),i.itemSetProjections[this._itemLimitProjection.key]=t);for(var n in o)0===n.indexOf("Filter")&&(i.filters||(i.filters={}),i.filters[n]=o[n]);var a=this._itemProvider.getItemSync(i);return i.revision=a.item().revision||0,i.needSchema=!a.schema().length,i},n.prototype._isSameFolderOrViewQuery=function(e,t){return Boolean(e)&&Boolean(t)&&t[d.default.idParamKey]===e[d.default.idParamKey]&&t[d.default.queryTypeParamKey]===e[d.default.queryTypeParamKey]?!0:!1},n.prototype._handleLayoutUpdates=function(){var e=this._viewParams.peek();this._layoutTypeSaved=this._isSameFolderOrViewQuery(this._viewParamsCurrent,e)?this.layoutType.peek():null,this._layoutTypeSaved!==a.Grid&&this._layoutTypeSaved!==a.Details&&(this._layoutTypeSaved=null),this._viewParamsCurrent=S.deepCopy(this._viewParams.peek()),this._resetLayoutOnDataFetch=!0,this._inNewFolderDataFetch=!0},n.prototype._computeQueryType=function(){return this._viewParams(),this._handleLayoutUpdates(),this._isLeftNavUserExpanded(!1),this.layoutType(this.getDefaultLayoutForView()),this._urlDataSource.getQueryType()},n.prototype._computeTitle=function(){var e=o.utils.unwrapObservable(this.focusItem())||this.item(),t="";return e&&(t=e.name),document.title=t?I.format(i.strings.pageTitleFormat,t):i.strings.pageTitleDefault,t},n.prototype._setLayoutType=function(){var e=this._layoutTypeSaved;this._layoutTypeSaved=null,Boolean(e)||(e=this.getDefaultLayoutForView()),this.layoutType(e)},n.prototype._computeIsOneUp=function(){this._viewParams();var e=this._urlDataSource.getFocusItemKey(),t=this._children();if(t&&e){var i=o.utils.arrayFirst(t,function(t){var o=t.peek();return o&&o.key===e});this.focusItem(i?i:null)}else this.focusItem(null);return!!e},n.prototype._showPolicyTip=function(t,o){var i,n=this,a=o.content.peek().items,r=a.filter(function(e){return e.peek().properties.ID===t});if(r[0])y.Engagement.logData({name:"PolicyTip.LaunchFromEmail.ItemInView"}),i={item:r[0]};else{y.Engagement.logData({name:"PolicyTip.LaunchFromEmail.ItemOutsideView"});var s=S.deepCopy(this._getItemContext.peek());s.singleItemId=t,i={getItemContext:s}}var l=function(){var e=n._viewParams.peek();delete e[d.default.policyTipKey];var t=n.resources.consume(b.navigation);t.updateViewParams(e,{ignoreHistory:!0})},c=x.promise(e,"../../../actions/PolicyTipAction");c.then(function(e){var t=new(n.resources.injected(e))(i);t.execute(null).done(l,l)})},n}(n);return F}),define("odsp-next/utilities/list/odb/ListResources",["require","exports","knockout","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","../../../resources/UtilityResourceKeys","../../../resources/ModelResourceKeys","../../../resources/PagesResourceKeys","../../../resources/SPOResourceKeys","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider","../../../providers/panel/PanelProvider","../../../providers/transclusion/TransclusionProvider","../../../providers/sharing/SharingProvider","../../../providers/upload/UploadProvider","../../../providers/operation/OperationProvider","../../../providers/peoplePicker/PeoplePickerProvider","../../../providers/versionControl/VersionControlProvider","../../../providers/operator/OperatorProvider","../../../dataSources/base/odb/DataSource","../../../dataSources/url/odb/UrlDataSource","../../../dataSources/item/odb/ListDataSource","../../../dataSources/settings/odb/SettingsDataSource","../../../dataSources/download/odb/DownloadDataSource","../../../dataSources/sharing/odb/SharingDataSource","../../../dataSources/peoplePicker/odb/PeoplePickerDataSource","../../../dataSources/versionControl/odb/VersionControlDataSource","../../navigation/Navigation","odsp-utilities/browser/PlatformDetection","../../browser/ResponsiveUI","../../mobile/Mobile","../../../models/store/ItemsStore","../../../models/selection/ItemSetSelectionModel","../../../actions/odb/ActionMap","../../../controls/infoPane/sections/BaseInfoPaneSectionsMap","../../../pages/files/spo/SortManager","../../../pages/files/spo/DataManager","../../../pages/files/spo/SPOFiles.resx"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b,v,x,y,C,S,k,I,_,B,w,L,T,A,N,P,D,F,M,R,E,O){var U=function(){function e(){}return e.exposeIfNeeded=function(e,t,o){return e.isExposed(t)?e.consume(t):e.expose(t,o())},e.exposeResources=function(t){var U=t.resourceScope,H=t.hostSettings;e.exposeIfNeeded(U,d.hostSettings,function(){return H}),e.exposeIfNeeded(U,d.context,function(){return y.getContext(H)}),e.exposeIfNeeded(U,s.itemsStore,function(){return new P}),e.exposeIfNeeded(U,r.navigation,function(){return new L}),e.exposeIfNeeded(U,i.settings,function(){return new k}),e.exposeIfNeeded(U,d.hostSettings,function(){return H}),e.exposeIfNeeded(U,i.url,function(){return new(U.injected(C))});var V=e.exposeIfNeeded(U,i.items,function(){return new(U.injected(S.default))({itemsStore:U.consume(s.itemsStore),hostSettings:H,listRootFolderWebRelativeUrl:t.listRootFolderWebRelativeUrl,listFullUrl:t.listFullUrl,listId:t.listId,viewId:t.viewId})});e.exposeIfNeeded(U,d.listItems,function(){return V}),e.exposeIfNeeded(U,i.list,function(){return null}),e.exposeIfNeeded(U,i.searchItems,function(){return null}),e.exposeIfNeeded(U,i.recent,function(){return null}),e.exposeIfNeeded(U,i.docsInCommon,function(){return null}),e.exposeIfNeeded(U,i.recycleBin,function(){return null}),e.exposeIfNeeded(U,i.sharedWithMe,function(){return null}),e.exposeIfNeeded(U,i.popular,function(){return null}),e.exposeIfNeeded(U,i.recentUnpopular,function(){return null}),e.exposeIfNeeded(U,i.people,function(){return new(U.injected(B))(H)}),e.exposeIfNeeded(U,n.people,function(){return new(U.injected(b))}),e.exposeIfNeeded(U,i.sharing,function(){return new(U.injected(_))(H)}),e.exposeIfNeeded(U,i.download,function(){return new(U.injected(I))(H)}),e.exposeIfNeeded(U,i.versionControl,function(){return new(U.injected(w))(H)}),e.exposeIfNeeded(U,a.infoPaneSectionsMap,function(){return new(U.injected(M))}),e.exposeIfNeeded(U,r.responsiveUI,function(){return new A}),e.exposeIfNeeded(U,a.viewParams,function(){return o.observable({})}),e.exposeIfNeeded(U,n.infoPane,function(){return new(U.injected(p.default))({type:void 0})}),e.exposeIfNeeded(U,n.overlay,function(){return new(U.injected(p.default))({type:void 0})}),e.exposeIfNeeded(U,n.panel,function(){return new(U.injected(m))}),e.exposeIfNeeded(U,n.dialog,function(){return new(U.injected(u))}),e.exposeIfNeeded(U,n.operation,function(){return new(U.injected(f))}),e.exposeIfNeeded(U,r.platformDetection,function(){return new T}),e.exposeIfNeeded(U,r.mobile,function(){return new N}),e.exposeIfNeeded(U,n.item,function(){return new(U.injected(c))}),e.exposeIfNeeded(U,n.list,function(){return null}),e.exposeIfNeeded(U,n.sharing,function(){return new(U.injected(h))}),e.exposeIfNeeded(U,n.upload,function(){return new(U.injected(g))}),e.exposeIfNeeded(U,n.versionControl,function(){return new(U.injected(v))}),e.exposeIfNeeded(U,n.operator,function(){return new(U.injected(x.default))}),e.exposeIfNeeded(U,l.sortManager,function(){return new(U.injected(R))}),e.exposeIfNeeded(U,l.files.isLeftNavUserExpanded,function(){return o.observable(!1)});var z=e.exposeIfNeeded(U,l.dataManager,function(){return new(U.injected(E))({})});e.exposeIfNeeded(U,a.currentItem,function(){return z.item}),e.exposeIfNeeded(U,l.files.layoutType,function(){return z.layoutType}),e.exposeIfNeeded(U,a.currentItemSet,function(){return z.itemSet}),e.exposeIfNeeded(U,a.itemsSelection,function(){return new(U.injected(D))(t&&t.selectionOptions&&{mode:t.selectionOptions.mode,maximumSelectedCount:t.selectionOptions.maximumSelectedCount,canSelectItem:t.selectionOptions.canSelectItem})}),e.exposeIfNeeded(U,l.files.isInfoPaneExpanded,function(){return o.observable(!1)}),e.exposeIfNeeded(U,a.actionMap,function(){return new F}),e.exposeIfNeeded(U,l.files.resx,function(){return O.strings}),e.exposeIfNeeded(U,a.canUserSelect,function(){return o.observable(!0)}),e.exposeIfNeeded(U,i.footer,function(){return null}),e.exposeIfNeeded(U,r.newFeatureExperienceEnabler,function(){return null})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=U}),define("odsp-next/controls/leftNav/LeftNavRenderStyle",["require","exports"],function(){var e;return function(e){e[e.Link=0]="Link",e[e.Text=1]="Text",e[e.Load=2]="Load",e[e.GroupLink=3]="GroupLink",e[e._More=4]="_More",e[e.Notification=5]="Notification",e[e.IndentedLink=6]="IndentedLink",e[e.BasicLink=7]="BasicLink"}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/recycleBinViewer/RecycleBinViewerViewModel",["require","exports","odsp-shared/base/ViewModel","knockout"],function(e,t,o,i){var n=function(e){function t(o){e.call(this,o),this.isLoading=i.observable(!0),this.url=o.url,this.showInDialog=o.showInDialog,this.showInDialog&&-1===this.url.indexOf(t._showInDlgQueryString)&&(this.url+=t._showInDlgQueryString),this.iframeLoaderParams={url:this.url,showLoadingLabel:!0,onload:this.iframeOnLoad.bind(this),isLoading:this.isLoading}}return __extends(t,e),t.prototype.iframeOnLoad=function(e){var t=this,o=e.target;if(o&&o.contentWindow){var i=o.contentWindow.document,n=i.getElementById("s4-workspace"),a=i.getElementById("contentBox");this.async.setTimeout(function(){t.showInDialog&&t._updateIframeDocument(i),o.style.height&&"0px"!==o.style.height||(t.isLoading(!1),o.style.height=Math.min(a.clientHeight,.85*document.body.clientHeight)+"px"),!n||n.style.height&&"0px"!==n.style.height||(n.style.height=o.style.height)},10)}},t.prototype._updateIframeDocument=function(e){var o=e.getElementById("usrpage"),i=e.getElementById("s4-ribbonrow"),n=e.getElementById("DeltaPlaceHolderMain"),a=e.getElementById("onetidUserRptrTable");if(i&&(i.style.height="0px"),o&&o.action&&-1===o.action.indexOf(t._showInDlgQueryString)&&(o.action+=t._showInDlgQueryString),n)for(var r=0;r<n.children.length;r++){var s=n.children[r];if("DIV"===s.tagName&&s.children&&s.children.length>0&&"A"===s.children[0].tagName){var l=s.children[0];l.href&&-1===l.href.indexOf(t._showInDlgQueryString)&&(l.href+=t._showInDlgQueryString)}}if(a)for(var d=a.getElementsByTagName("td"),c=0;c<d.length;c++)for(var u=d[c],m=u.getElementsByTagName("a"),p=0;p<m.length;p++){var h=m[p];if(h.href&&-1===h.href.indexOf("javascript:")&&h.text){var g=document.createTextNode(h.text);h.parentElement.replaceChild(g,h)}}},t._showInDlgQueryString="&IsDlg=1",t}(o);return n}),define("odsp-next/controls/recycleBinViewer/RecycleBinViewer.html",[],function(){return"<div class=od-RecycleBinViewer><!--ko component: { name: 'ms-iframe-loader', params: iframeLoaderParams }--><!--/ko--></div>"}),define("odsp-next/controls/recycleBinViewer/RecycleBinViewer.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-RecycleBinViewer iframe{border:none;width:100%}")});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/iframeLoader/IframeLoaderViewModel",["require","exports","odsp-shared/base/ViewModel","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","./IframeLoader.resx","../../bindings/element/ElementBinding"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){var o=this;e.call(this),this.loadingLabel=a.strings.IframeLoadingLabel;var s=t.url,l=t.title||"";this.url="string"==typeof s?i.observable(s):s,this.title="string"==typeof l?i.observable(l):l,this.isExcludeFromScreenReader=t.isExcludeFromScreenReader||!1,this.isLoading=t.isLoading?t.isLoading:i.observable(!0),this.progressSpinnerFlatTagName=n.tagName,this.showLoadingLabel=t.showLoadingLabel,this.iframeElement=t.iframeElement||i.observable(null),this.tabindex=this.isExcludeFromScreenReader?"-1":null,this.role=this.isExcludeFromScreenReader?"presentation":null,this.isVisible=this.createComputed(this._computeIsVisible),this.isTitleVisible=this.createComputed(this._computeIsTitleVisible),this.addBindingHandlers({element:r}),this.iframeOnLoad=function(e,i){t.onload&&t.onload(i),o.isLoading(!1)}}return __extends(t,e),t.prototype._computeIsVisible=function(){return Boolean(this.url())},t.prototype._computeIsTitleVisible=function(){return Boolean(this.title())},t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s}),define("odsp-next/controls/iframeLoader/IframeLoader.html",[],function(){return'<div class=ms-IframeLoader data-bind="css:{ \'ms-IframeLoader--visible\': isVisible }"><div class=ms-IframeLoader-title data-bind="css:{ \'ms-IframeLoader-title--visible\': isTitleVisible }, text: title()"></div><iframe class=ms-IframeLoader-iframe data-bind="attr: { src: url(), role: role, tabindex: tabindex }, event: { load: iframeOnLoad }, css: { \'ms-IframeLoader-iframe--visible\': !isLoading() }, element: iframeElement"></iframe><!--ko if: showLoadingLabel--><span class=ms-IframeLoader-loadingLabel data-bind="text: loadingLabel, css: { \'ms-IframeLoader-loadingLabel--visible\': isLoading }"></span><!--/ko--><div class=ms-IframeLoader-progressContainer data-bind="css: { \'ms-IframeLoader-progressContainer--visible\': isLoading }"><div class=ms-IframeLoader-progress data-bind="component: { name: progressSpinnerFlatTagName }"></div></div></div>'}),define("odsp-next/controls/iframeLoader/IframeLoader.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".ms-IframeLoader,.ms-IframeLoader-iframe{width:100%;height:100%;display:none}.ms-IframeLoader-loadingLabel{padding-bottom:15px;padding-top:8px;font-size:12px;margin:0 0 20px;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;color:#333;display:none}.ms-IframeLoader-loadingLabel.ms-Dialog-subText--s{font-size:12px}.ms-IframeLoader-loadingLabel.ms-Dialog-subText--m{font-size:14px}.ms-IframeLoader-loadingLabel.ms-Dialog-subText--l{font-size:17px}.ms-IframeLoader-title{font-size:17px;display:none}.ms-IframeLoader-iframe{border:none}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframe--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}")
}),define("odsp-next/controls/iframeLoader/IframeLoader",["require","exports","./IframeLoaderViewModel","odsp-shared/utilities/knockout/ComponentFactory","./IframeLoader.html","./IframeLoader.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-iframe-loader",template:e("./IframeLoader.html"),viewModel:o.default,synchronous:!0});Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/controls/recycleBinViewer/RecycleBinViewer",["require","exports","./RecycleBinViewerViewModel","odsp-shared/utilities/knockout/ComponentFactory","./RecycleBinViewer.html","./RecycleBinViewer.css","../iframeLoader/IframeLoader"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-recycle-bin-viewer",template:e("./RecycleBinViewer.html"),viewModel:o});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/odb/OpenRecycleBinAction",["require","exports","../../base/BaseAction","odsp-utilities/logging/events/Qos.event","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../controls/recycleBinViewer/RecycleBinViewer","../../utilities/browser/WindowSize","../../resources/ControlResourceKeys","../../controls/leftPane/LeftPane.resx"],function(e,t,o,i,n,a,r,s,l,d){var c=function(e){function t(){e.apply(this,arguments),this.name="OpenRecycleBin"}return __extends(t,e),t.prototype.onExecute=function(){var e=this,t=this.resources.consume(n.dialog),o=this.resources.consume(a.url),c=t.requestDialog({title:d.strings.RecycleBin,component:{name:r.tagName,params:{url:o.getRecycleBinQueryUrl(),showInDialog:!0}},size:s.XLarge});return c.wait().then(function(){return{resultType:i.ResultTypeEnum.Success}},function(){try{var t=e.resources.consume(n.item),o=e.resources.consume(l.currentItem);return t.invalidateItem(o().key,null,!0),{resultType:i.ResultTypeEnum.Success}}catch(a){return{resultType:i.ResultTypeEnum.Failure}}})},t}(o);return c}),function(e,t){"use strict";var o=function(e){if("object"!=typeof e.document)throw Error("Cookies.js requires a `window` with a `document` object");var o=function(e,t,i){return 1===arguments.length?o.get(e):o.set(e,t,i)};return o._document=e.document,o._cacheKeyPrefix="cookey.",o._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),o.defaults={path:"/",secure:!1},o.get=function(e){return o._cachedDocumentCookie!==o._document.cookie&&o._renewCache(),o._cache[o._cacheKeyPrefix+e]},o.set=function(e,i,n){return n=o._getExtendedOptions(n),n.expires=o._getExpiresDate(i===t?-1:n.expires),o._document.cookie=o._generateCookieString(e,i,n),o},o.expire=function(e,i){return o.set(e,t,i)},o._getExtendedOptions=function(e){return{path:e&&e.path||o.defaults.path,domain:e&&e.domain||o.defaults.domain,expires:e&&e.expires||o.defaults.expires,secure:e&&e.secure!==t?e.secure:o.defaults.secure}},o._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},o._getExpiresDate=function(e,t){if(t=t||new Date,"number"==typeof e?e=1/0===e?o._maxExpireDate:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!o._isValidDate(e))throw Error("`expires` parameter cannot be converted to a valid Date instance");return e},o._generateCookieString=function(e,t,o){return e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),o=o||{},e=e+"="+t+(o.path?";path="+o.path:""),e+=o.domain?";domain="+o.domain:"",e+=o.expires?";expires="+o.expires.toUTCString():"",e+=o.secure?";secure":""},o._getCacheFromString=function(e){var i={};e=e?e.split("; "):[];for(var n=0;n<e.length;n++){var a=o._getKeyValuePairFromCookieString(e[n]);i[o._cacheKeyPrefix+a.key]===t&&(i[o._cacheKeyPrefix+a.key]=a.value)}return i},o._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("="),t=0>t?e.length:t;return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},o._renewCache=function(){o._cache=o._getCacheFromString(o._document.cookie),o._cachedDocumentCookie=o._document.cookie},o._areEnabled=function(){var e="1"===o.set("cookies.js",1).get("cookies.js");return o.expire("cookies.js"),e},o.enabled=o._areEnabled(),o},i="object"==typeof e.document?o(e):o;"function"==typeof define&&define.amd?define("cookies",[],function(){return i}):"object"==typeof exports?("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=i),exports.Cookies=i):e.Cookies=i}("undefined"==typeof window?this:window);var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/odb/BackToClassicAction",["require","exports","../../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","odsp-utilities/logging/events/Engagement.event","../../resources/UtilityResourceKeys","cookies","../../resources/SPOResourceKeys"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t){e.call(this,t),this.name="BackToclassic",this._params=t}return __extends(t,e),t.prototype.onExecute=function(){var e=this,t=this._params.url,o="function"==typeof t?t():t;if(!o){var d=this.resources.consume(l.listContext);o=d.listUrl}return o?(this.async.setTimeout(function(){a.Engagement.logData({name:"BackToClassic.LeftNav.Click"}),e._params.cookieName&&s.set(e._params.cookieName,"0"),e.resources.consume(r.navigation).navigateTo(o)},0),i.default.wrap({resultType:n.ResultTypeEnum.Success})):i.default.wrap({resultType:n.ResultTypeEnum.Failure})},t}(o);return d});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/dataSources/appCache/odb/AppCacheDataSource",["require","exports","../../base/odb/DataSource"],function(e,t,o){var i=function(e){function t(t,o){e.call(this,t),this.url=o}return __extends(t,e),t.prototype.getDataSourceName=function(){return"AppCacheDataSource"},t.prototype.getManifest=function(){var e=this;return this.getData(function(){return e._context.webServerRelativeUrl+e.url},function(e){return e},"GetManifest")},t}(o);return i}),define("odsp-next/utilities/browser/ApplicationCache",["require","exports","odsp-utilities/logging/events/Qos.event","../../dataSources/appCache/odb/AppCacheDataSource"],function(e,t,o,i){var n,a=5;return function(t){"use strict";function n(e){p.push(e),e(h)}function r(e){try{l()&&(window.localStorage.removeItem(u),window.localStorage.removeItem(m))}catch(t){}e.end({resultType:o.ResultTypeEnum.Success}),window.location.reload(!0)}function s(e){if(h!==e){h=e;for(var t=0,o=p.length;o>t;t++)p[t](h)}}function l(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}function d(t){var i=new o.Qos({name:"AppCache.AppCacheCheck"});if("string"!=typeof t)i.end({resultType:o.ResultTypeEnum.Failure,extraData:{error:"Invalid manifest."}});else{var n=l()?window.localStorage:null,d=-1!==t.indexOf(e.toUrl(""));if(d)n&&n.removeItem(u),i.end({resultType:o.ResultTypeEnum.Success});else if(n){var c=n.getItem(u);if(c)try{c=Number(c)+1,c>=a?r(i):(n.setItem(u,c),s(!0),i.end({resultType:o.ResultTypeEnum.ExpectedFailure,extraData:{error:"Limit not reached.",count:c}}))}catch(m){i.end({resultType:o.ResultTypeEnum.Failure,error:m,extraData:{error:"Failed to update refresh count."}})}else n.setItem(u,"1"),i.end({resultType:o.ResultTypeEnum.Success,extraData:{}})}else s(!0),i.end({resultType:o.ResultTypeEnum.ExpectedFailure,extraData:{error:"No local store."}})}}function c(){d("")}var u="applicationCacheNeedsRefresh",m="applicationCacheMaifest",p=[],h=!1,g=window.applicationCache;t.onUpdateReadyChanged=n,t.reload=r;var f=new o.Qos({name:"AppCache.On"});if(g){var b=window.location.href;if("string"==typeof b&&-1!==b.indexOf("?"))f.end({resultType:o.ResultTypeEnum.ExpectedFailure,extraData:{error:"Query string."}});else{f.end(g.status!==g.UNCACHED?{resultType:o.ResultTypeEnum.Success,extraData:{Status:g.status}}:{resultType:o.ResultTypeEnum.Failure}),f=new o.Qos({name:"AppCache.InitAppCacheCheck"});try{var v=document.body.parentElement.getAttribute("manifest"),x=l()?window.localStorage:null;if(x&&("string"!=typeof v?v=x.getItem(m):x.setItem(m,v)),"string"==typeof v){var y=new i(window._spPageContextInfo,v);y.getManifest().then(d,c),f.end({resultType:o.ResultTypeEnum.Success,extraData:{Status:g.status}})}else f.end({resultType:o.ResultTypeEnum.ExpectedFailure,extraData:{error:"No manifest URL."}})}catch(C){f.end({resultType:o.ResultTypeEnum.Failure,extraData:{error:C}})}}}else f.end({resultType:o.ResultTypeEnum.ExpectedFailure,extraData:{error:"App cache not available."}})}(n||(n={})),n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/odb/AppReloadAction",["require","exports","../../base/BaseAction","odsp-utilities/async/Promise","odsp-utilities/logging/events/Qos.event","odsp-utilities/logging/events/Qos.event","../../utilities/browser/ApplicationCache"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){e.call(this,t),this.name="AppReload"}return __extends(t,e),t.prototype.onExecute=function(){return this.async.setTimeout(function(){r.reload(new n.Qos({name:"AppCache.Manualrefresh"}))},0),i.default.wrap({resultType:a.ResultTypeEnum.Success})},t}(o);return s});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/dataSources/leftNav/odb/LeftNavDataSource",["require","exports","odsp-shared/base/BaseModel","../../../controls/leftPane/LeftPane.resx","../../../controls/leftNav/LeftNav.resx","../../../controls/leftNav/LeftNavRenderStyle","../../../dataSources/url/QueryType","knockout","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","../../../actions/odb/OpenRecycleBinAction","../../../actions/odb/BackToClassicAction","../../../actions/odb/AppReloadAction","../../../utilities/features/Features","../../../utilities/browser/ApplicationCache"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h){var g=function(e){function t(t){var o=this;e.call(this,t),this._hostSettings=this.resources.consume(d.hostSettings),this._notificationLinks=s.observableArray([]),this._urlDataSource=this.resources.consume(l.url),this._notificationLinks.push({text:i.strings.GetOneDriveApps,url:this._urlDataSource.getOneDriveAppsUrl(),isActive:this.createComputed(function(){return!1}),isFocused:s.observable(!1),openInNewTab:this.createComputed(function(){return!0}),engagementName:"GetOneDriveApps",renderAs:a.Notification}),p.default.isFeatureEnabled(p.default.SwitchBackToClassic)&&this._notificationLinks.push({text:i.strings.SwitchBack,url:"#",action:new(this.managed(u))({resources:this.resources,url:null,cookieName:"odbnu"}),isActive:this.createComputed(function(){return!1}),isFocused:s.observable(!1),engagementName:"BackToClassic",renderAs:a.Notification}),h.onUpdateReadyChanged(function(e){e?(o._appReloadLeftNavItem||(o._appReloadLeftNavItem={text:i.strings.UpdateReady,url:"#",action:new(o.managed(m))({}),isActive:o.createComputed(function(){return!0}),isFocused:s.observable(!1),engagementName:"AppUpdateReload",renderAs:a.Notification}),o._notificationLinks.push(o._appReloadLeftNavItem)):o._appReloadLeftNavItem&&o._notificationLinks.remove(o._appReloadLeftNavItem)})}return __extends(t,e),t.prototype.getLinkToManageStorage=function(){return null},t.prototype.getLinkGroups=function(e){var t=this;return this._urlDataSource=this.resources.consume(l.url),this.linkGroups=s.observableArray([{text:this._hostSettings.isSiteAdmin?this._hostSettings.userDisplayName:this._hostSettings.webTitle,url:this._urlDataSource.getQueryUrl(this._urlDataSource.getPageType(),r.Files),isExpanded:s.observable(!0),isActive:this.createComputed(function(){return e(),t._urlDataSource.isCurrentQuery(r.Files)}),isFocused:s.observable(!1),links:this._getLeftNavLinks(e),engagementName:"UserName"}])},t.prototype.getQuotaPaneLinks=function(){var e=[];return e},t.prototype.getAccounts=function(){return[]},t.prototype.getNotificationLinks=function(){return this._notificationLinks},t.prototype.isPersonalOneDrive=function(){return this._hostSettings.isSiteAdmin&&"21"===this._hostSettings.webTemplate},t.prototype._getLeftNavLinks=function(e){var t=this,o=[{text:i.strings.Files,url:this._urlDataSource.getQueryUrl(this._urlDataSource.getPageType(),r.Files),isActive:this.createComputed(function(){return e(),t._urlDataSource.isCurrentQuery(r.Files)}),isFocused:s.observable(!1),engagementName:"Files",altText:n.strings.filesAlt}];return this.isPersonalOneDrive()?(o.push({text:i.strings.Recent,url:this._urlDataSource.getQueryUrl(this._urlDataSource.getPageType(),r.Recent),isActive:this.createComputed(function(){return e(),t._urlDataSource.isCurrentQuery(r.Recent)}),isFocused:s.observable(!1),engagementName:"Recent",altText:n.strings.recentAlt}),o.push({text:i.strings.SharedWithMe,url:this._urlDataSource.getQueryUrl(this._urlDataSource.getPageType(),r.SharedWithMeODB),isActive:this.createComputed(function(){return e(),t._urlDataSource.isCurrentQuery(r.SharedWithMeODB)}),isFocused:s.observable(!1),engagementName:"SharedWithMe",altText:n.strings.sharedAltOdb}),o.push({text:i.strings.RecycleBin,url:this._urlDataSource.getRecycleBinQueryUrl(),isActive:this.createComputed(function(){return!1}),action:new(this.managed(c))({}),isFocused:s.observable(!1),engagementName:"RecycleBin",altText:n.strings.recycleBinAlt})):o.push({text:i.strings.DocsInCommon,url:this._urlDataSource.getQueryUrl(this._urlDataSource.getPageType(),r.DocsInCommon),isActive:this.createComputed(function(){return e(),t._urlDataSource.isCurrentQuery(r.DocsInCommon)}),isFocused:s.observable(!1),engagementName:"DocsInCommon"}),s.observableArray(o)},t}(o);return g});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/pages/files/odb/FilesViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/PagesResourceKeys","../../../resources/SPOResourceKeys","../../../resources/UtilityResourceKeys","../../../resources/DataSourceResourceKeys","../../../utilities/browser/WindowSize","odsp-utilities/async/RequireHelper","../../../utilities/suiteExtensions/SuiteExtensionsHelper","../../../utilities/require/RequireConfigInjector","../../../providers/transclusion/TransclusionProvider","../../../bindings/scrollContainer/ScrollContainerBinding","../../../utilities/list/odb/ListResources","../../../utilities/features/Features","./ODBFiles.resx","../../../controls/search/Search.resx","odsp-utilities/models/store/BaseDataStore","odsp-utilities/models/store/DataStoreCachingType","../../../dataSources/leftNav/odb/LeftNavDataSource"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b,v,x,y,C,S){var k=function(t){function i(e){var i=this;t.call(this,e),this.topLevelCommandSet=o.observable(null);var u=this;f.default.exposeResources({resourceScope:this.resources,hostSettings:window._spPageContextInfo}),this.isLeftNavUserExpanded=this.resources.expose(r.files.isLeftNavUserExpanded,o.observable(!1)),this.isLeftNavClosing=o.observable(!1),this.resources.expose(d.leftNav,new(this.resources.injected(S))),this.navigationRegionLabel=v.strings.navigationRegionLabel,this.h1PageTitle=v.strings.pageTitleDefault,this.h2NavigationHeader=v.strings.navigationRegionLabel,this.h2CommandBarHeader=v.strings.commandBarRegionLabel,this.h2ContentHeader=v.strings.listRegionLabel,this._dataManager=this.resources.consume(r.dataManager),this.isActive=this.createComputed(this._computeIsActive),this.platform=this.resources.consume(l.platformDetection),this.responsiveUI=this.resources.consume(l.responsiveUI),this._isFooterVisible=!!this.resources.consume(d.footer),this._context=this.resources.consume(s.context),this._store=new y("FilesViewModel",C.local),this.isSearchCollapsed=this.createComputed(function(){var e=u.responsiveUI.formFactorSize();switch(e){case c.Small:case c.Medium:case c.Large:return!0;case c.XLarge:case c.XXLarge:case c.XXXLarge:return!1}}),this.searchHasBack=this.createComputed(function(){var e=u.responsiveUI.formFactorSize();switch(e){case c.Small:return!0;case c.Medium:case c.Large:case c.XLarge:case c.XXLarge:case c.XXXLarge:return!1}}),this.searchParams={isCollapsed:this.isSearchCollapsed,hasBack:this.searchHasBack},b.default.isFeatureEnabled(b.default.EnablePersonalSearchSuggestions)&&(this.searchParams.searchPlaceholder=x.strings.SearchOneDrivePlaceholder);var m=this.resources.consume(n.itemsSelection);this.hasSelection=this.createComputed(function(){return m.selection().length>0});var p=this.resources.consume(a.suiteNav);this.isO365FlexPaneVisible=o.observable(!1),p.getO365Shell().done(function(e){e.OnHasMember("FlexPane",function(){e.FlexPane.OnFlexPaneVisibilityChanged(function(e){i.isO365FlexPaneVisible(e),o.utils.triggerEvent(document.body,"resize")})})}),this._supportHamburgerInSuiteNav=o.observable(!!this._store.getValue("ShellResponsive")),p.loadData().done(function(e){var t=!(!e||!e.FlightName||-1===e.FlightName.indexOf("ShellResponsive"));i._store.setValue("ShellResponsive",t),i._supportHamburgerInSuiteNav(t)}),this.hamburgerCallback=this.createPureComputed(function(){return i._supportHamburgerInSuiteNav()?i.toggleIsLeftNavUserExpanded.bind(i):null}),this._setUpResponsiveUI(),this._setUpInfoPaneHost(),this.standaloneListParams={topCommandSet:this.topLevelCommandSet,hideCommandBar:!0,hideOverlayHost:!0,hideDialogHost:!0,hidePanelHost:!0,hideDragAndDropComponent:!0,skipNavigation:!0,isActive:this.isActive},this.events.on(this._dataManager,"pageLoadComplete",function(){i._initializeDeferredComponents(),i.events.off(i._dataManager,"pageLoadComplete")}),this.addBindingHandlers({scrollContainer:g.default})}return __extends(i,t),i.prototype.toggleIsLeftNavUserExpanded=function(){return this.isLeftNavUserExpanded(!this.isLeftNavUserExpanded()),this.isLeftNavVisible()||(this.isLeftNavClosing(!0),this.async.setTimeout(function(){this.isLeftNavClosing(!1)},367)),!1},i.prototype._computeIsLeftNavVisible=function(){var e=this.isLeftNavUserExpanded(),t=this.responsiveUI.formFactorSize();return e||t>this.responsiveUI.windowSize.Large},i.prototype._computeIsTopBarHamburgerVisible=function(){return this.responsiveUI.isHamburgerVisible()&&!this._supportHamburgerInSuiteNav()},i.prototype._computeIsSuiteNavHamburgerVisible=function(){return this.responsiveUI.isHamburgerVisible()&&this._supportHamburgerInSuiteNav()},i.prototype._setUpResponsiveUI=function(){this.isLeftNavVisible=this.createComputed(this._computeIsLeftNavVisible),this.isTopBarHamburgerVisible=this.createComputed(this._computeIsTopBarHamburgerVisible),this.isSuiteNavHamburgerVisible=this.createComputed(this._computeIsSuiteNavHamburgerVisible)},i.prototype._setUpInfoPaneHost=function(){var e=this.resources.expose(a.infoPane,new(this.managed(h.default))({type:void 0}));this.infoPaneTransclusionHostParams={provider:e},this.isInfoPanePopulated=this.createPureComputed(function(){return e.contexts().length>0})},i.prototype._computeIsActive=function(){var e=this.resources.consume(a.dialog),t=this._dataManager.isOneUp(),o=!!e.currentDialog();return!t&&!o},i.prototype._initializeDeferredComponents=function(){var t=this;if(b.default.isFeatureEnabled(b.default.GroupsInLeftNav)){var o=u.promise(e,"./GroupsLeftNavInit");o.then(function(e){new(t.managed(e))({})})}if(b.default.isFeatureEnabled(b.default.ODBNextFileHandler)||b.default.isFeatureEnabled(b.default.ODBNextFileCreation)){p.addPaths({SuiteExtensions:this._context.webUrl+"/"+this._context.layoutsUrl+"/online/scripts/SuiteExtensions"});var i=u.promise(e,"SuiteExtensions");i.then(function(){m.getInstance().initializeSuiteExtensions(t._context)})}},i}(i);return k}),define("odsp-next/pages/files/odb/Files.html",[],function(){return"<div class=Files data-bind=\"css: { 'has-O365-flex-pane': isO365FlexPaneVisible, 'has-footer': _isFooterVisible, 'Files-has-leftNav': isLeftNavVisible, 'Files-leftNavClosing': isLeftNavClosing, 'has-info-pane': isInfoPanePopulated, 'is-active': isActive }\"><!--ko component: { name: \"ms-suite-nav\", params: { hamburgerCallback: hamburgerCallback } }--><!--/ko--><h1 class=ms-accessible data-bind=\"text: h1PageTitle\"></h1><div class=Files-belowHeader><div class=Files-leftNavOverlay data-bind=\"visible: isLeftNavVisible() && responsiveUI.isHamburgerVisible(), click: toggleIsLeftNavUserExpanded\"></div><h2 class=ms-accessible data-bind=\"text: h2NavigationHeader\"></h2><div class=Files-leftNav role=navigation data-bind=\"component: { name: 'ms-left-pane', params: { isLeftNavVisible: isLeftNavVisible } }, attr: { 'aria-label': navigationRegionLabel }, css: { 'od-Files-offsetTop': !isSuiteNavHamburgerVisible() }\"></div><h2 class=ms-accessible data-bind=\"text: h2CommandBarHeader\"></h2><div class=od-Files-TopBar data-bind=\"css:{ 'od--hasSelection': hasSelection, 'od--hasLeftNavExpander': isTopBarHamburgerVisible }, attr:{ 'data-showLeftNavLauncher': isTopBarHamburgerVisible() }\"><div class=Files-leftNavExpander data-bind=\"visible: isTopBarHamburgerVisible(), click: toggleIsLeftNavUserExpanded\"><i class=\"ms-Icon ms-Icon--menu\"></i></div><!--ko component: { name: \"ms-search\", params: searchParams }--><!--/ko--><!--ko component: { name: \"ms-command-bar\",\n params: {commandSet: topLevelCommandSet, isMobile: false, isActive: isActive } }--><!--/ko--></div><h2 class=ms-accessible data-bind=\"text: h2ContentHeader\"></h2><div class=\"Files-content od-Files-offsetTop\" data-bind=\"component: { name: 'ms-standalone-list', params: standaloneListParams }\"></div><div class=\"Files-infoPane od-Files-offsetTop\" data-bind=\"scrollContainer: {}, component: { name: 'od-transclusion-host', params: infoPaneTransclusionHostParams }\"></div></div><!--ko component: { name: 'od-dialog-host' }--><!--/ko--><!--ko component: { name: 'od-overlay-host' }--><!--/ko--><!--ko component: { name: 'ms-panel-host' }--><!--/ko--></div>"}),define("odsp-next/pages/files/odb/Files.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".Files,.Files-infoPane{position:absolute;overflow:hidden;bottom:0}.Files .BreadcrumbBar,.Files-title{vertical-align:text-bottom;display:inline-block}.Files{top:0;left:0;right:0;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:319px}.Files-belowHeader{position:absolute;left:0;right:0;top:50px;bottom:0}.od-Files-offsetTop{top:40px}.Files.has-O365-flex-pane .Files-belowHeader{left:0;right:305px}.Files-leftNav{position:absolute;bottom:0;top:0;box-sizing:border-box;background-color:#fff;z-index:298;width:208px}html[dir=ltr] .Files-leftNav{border-right:1px solid #eaeaea;left:-302px}html[dir=rtl] .Files-leftNav{border-left:1px solid #eaeaea;right:-302px}.lg .Files-leftNav,.md .Files-leftNav,.sm .Files-leftNav{box-shadow:30px 0 30px -30px rgba(0,0,0,.4);width:272px}html[dir=ltr] .lg .Files-leftNav,html[dir=ltr] .md .Files-leftNav,html[dir=ltr] .sm .Files-leftNav{left:-302px}html[dir=ltr] .Files-has-leftNav .Files-leftNav,html[dir=ltr] .Files-leftNavClosing .Files-leftNav,html[dir=rtl] .Files-content{left:0}html[dir=rtl] .lg .Files-leftNav,html[dir=rtl] .md .Files-leftNav,html[dir=rtl] .sm .Files-leftNav{right:-302px}html[dir=rtl] .Files-has-leftNav .Files-leftNav,html[dir=rtl] .Files-leftNavClosing .Files-leftNav{right:0}.lg .Files-leftNav .LeftNav,.md .Files-leftNav .LeftNav,.sm .Files-leftNav .LeftNav{width:272px}.Files-leftNav.od-Files-offsetTop{top:40px}.Files-has-leftNav .Files-leftNav{-webkit-animation-name:fadeIn,slideRight40;animation-name:fadeIn,slideRight40;-webkit-animation-duration:367ms;-moz-animation-duration:367ms;-ms-animation-duration:367ms;-o-animation-duration:367ms;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1);-webkit-animation-fill-mode:both;animation-fill-mode:both}.Files-leftNavClosing .Files-leftNav{-webkit-animation-name:fadeOut,slideLeftOut40;animation-name:fadeOut,slideLeftOut40;-webkit-animation-duration:167ms;-moz-animation-duration:167ms;-ms-animation-duration:167ms;-o-animation-duration:167ms;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both}.Files-content{position:absolute;bottom:0}html[dir=ltr] .Files-content{right:0;left:208px}html[dir=ltr] .Files-content-inner,html[dir=ltr] .lg .Files-content,html[dir=ltr] .md .Files-content,html[dir=ltr] .sm .Files-content,html[dir=rtl] .Files-content-inner{left:0}html[dir=rtl] .Files-content{right:208px}html[dir=ltr] .Files-content-inner,html[dir=rtl] .Files-content-inner,html[dir=rtl] .lg .Files-content,html[dir=rtl] .md .Files-content,html[dir=rtl] .sm .Files-content{right:0}.Files-content-inner{position:absolute;bottom:0;top:38px}.Files-infoPane{z-index:285;background:#fff;width:320px;box-sizing:border-box;-webkit-overflow-scrolling:touch;transition:367ms cubic-bezier(.1,.9,.2,1)}html[dir=ltr] .Files-infoPane{border-left:1px solid #eaeaea;right:-321px;transition-property:right}html[dir=rtl] .Files-infoPane{border-right:1px solid #eaeaea;left:-321px;transition-property:left}.od-userSelect--enabled .Files-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.Files.is-active .Files-infoPane{overflow-y:auto}.Files-footer,.Files-header,.Files-title{overflow:hidden;white-space:nowrap}html[dir=ltr] .Files.has-info-pane .Files-infoPane{right:0}html[dir=rtl] .Files.has-info-pane .Files-infoPane{left:0}.Files.has-info-pane .Files-content{width:auto}html[dir=ltr] .Files.has-info-pane .Files-content{right:320px}html[dir=ltr] .md .has-info-pane .Files-content,html[dir=ltr] .sm .has-info-pane .Files-content,html[dir=rtl] .md .od-Files-TopBar .Files-leftNavExpander,html[dir=rtl] .md .od-Files-TopBar .od-Search,html[dir=rtl] .sm .od-Files-TopBar .Files-leftNavExpander,html[dir=rtl] .sm .od-Files-TopBar .od-Search{right:0}html[dir=rtl] .Files.has-info-pane .Files-content{left:320px}html[dir=ltr] .md .od-Files-TopBar .Files-leftNavExpander,html[dir=ltr] .md .od-Files-TopBar .od-Search,html[dir=ltr] .sm .od-Files-TopBar .Files-leftNavExpander,html[dir=ltr] .sm .od-Files-TopBar .od-Search,html[dir=rtl] .md .has-info-pane .Files-content,html[dir=rtl] .sm .has-info-pane .Files-content{left:0}.od-Files-TopBar{height:40px;background-color:#f8f8f8;position:relative;z-index:294}.Files-footer,.md .od-Files-TopBar .Files-leftNavExpander,.sm .od-Files-TopBar .Files-leftNavExpander{position:absolute}@media screen and (-ms-high-contrast:active){.od-Files-TopBar{border-top:1px solid #fff;border-bottom:1px solid #fff;z-index:304}}@media screen and (-ms-high-contrast:black-on-white){.od-Files-TopBar{border-top:1px solid #000;border-bottom:1px solid #000}}.od-Files-TopBar .od-Search{width:208px;max-width:208px}html[dir=ltr] .od-Files-TopBar .od-Search{float:left;margin-right:24px}html[dir=rtl] .od-Files-TopBar .od-Search{float:right;margin-left:24px}html[dir=ltr] .od-Files-TopBar .od-Search--collapsed{margin-right:0}html[dir=rtl] .od-Files-TopBar .od-Search--collapsed{margin-left:0}.md .od-Files-TopBar .od-Search,.sm .od-Files-TopBar .od-Search{z-index:3;position:absolute}html[dir=ltr] .md .od-Files-TopBar.od--hasLeftNavExpander .od-Search,html[dir=ltr] .sm .od-Files-TopBar.od--hasLeftNavExpander .od-Search{left:50px}html[dir=rtl] .md .od-Files-TopBar.od--hasLeftNavExpander .od-Search,html[dir=rtl] .sm .od-Files-TopBar.od--hasLeftNavExpander .od-Search{right:50px}.Files-footer,html[dir=ltr] .md .od-Files-TopBar .od-Search--collapsed.od-Search--active,html[dir=ltr] .sm .od-Files-TopBar .od-Search--collapsed.od-Search--active,html[dir=rtl] .sm .od-Files-TopBar .od-Search--collapsed.od-Search--active{right:0}html[dir=ltr] .md .od-Files-TopBar .CommandBar,html[dir=ltr] .sm .od-Files-TopBar .CommandBar{padding-left:42px}html[dir=rtl] .md .od-Files-TopBar .CommandBar,html[dir=rtl] .sm .od-Files-TopBar .CommandBar{padding-right:42px}html[dir=ltr] .md .od-Files-TopBar.od--hasLeftNavExpander .CommandBar,html[dir=ltr] .sm .od-Files-TopBar.od--hasLeftNavExpander .CommandBar{padding-left:92px}html[dir=rtl] .md .od-Files-TopBar.od--hasLeftNavExpander .CommandBar,html[dir=rtl] .sm .od-Files-TopBar.od--hasLeftNavExpander .CommandBar{padding-right:92px}.md .od-Files-TopBar .od-Search--collapsed.od-Search--active,.sm .od-Files-TopBar .od-Search--collapsed.od-Search--active{max-width:none}html[dir=ltr] .sm .od-Files-TopBar .od-Search--collapsed.od-Search--active,html[dir=rtl] .md .od-Files-TopBar .od-Search--collapsed.od-Search--active,html[dir=rtl] .sm .od-Files-TopBar .od-Search--collapsed.od-Search--active{left:0}.od-Files-TopBar .CommandBar{padding:0}html[dir=ltr] .md .od-Files-TopBar .CommandBar,html[dir=ltr] .sm .od-Files-TopBar .CommandBar{padding-right:8px}html[dir=rtl] .md .od-Files-TopBar .CommandBar,html[dir=rtl] .sm .od-Files-TopBar .CommandBar{padding-left:8px}html[dir=ltr] .lg .od-Files-TopBar .CommandBar,html[dir=ltr] .md .od-Files-TopBar .CommandBar,html[dir=ltr] .sm .od-Files-TopBar .CommandBar{padding-right:12px}html[dir=rtl] .lg .od-Files-TopBar .CommandBar,html[dir=rtl] .md .od-Files-TopBar .CommandBar,html[dir=rtl] .sm .od-Files-TopBar .CommandBar{padding-left:12px}html[dir=ltr] .xlg .od-Files-TopBar .CommandBar,html[dir=ltr] .xxlg .od-Files-TopBar .CommandBar,html[dir=ltr] .xxxlg .od-Files-TopBar .CommandBar{padding-right:16px}html[dir=rtl] .xlg .od-Files-TopBar .CommandBar,html[dir=rtl] .xxlg .od-Files-TopBar .CommandBar,html[dir=rtl] .xxxlg .od-Files-TopBar .CommandBar{padding-left:16px}.od-Files-TopBar .CommandBarItem-icon .ms-Icon--excel:before{color:#217346}.od-Files-TopBar .CommandBarItem-icon .ms-Icon--onenote:before{color:#5c2d91}.od-Files-TopBar .CommandBarItem-icon .ms-Icon--powerpoint:before{color:#d24726}.od-Files-TopBar .CommandBarItem-icon .ms-Icon--word:before{color:#2b579a}.Files-title,.xlg .Files-title,.xxlg .Files-title,.xxxlg .Files-title{color:#333;font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-weight:400}.sm .od-SearchResults.od-SearchResults{top:40px}.Files-header{height:40px;padding:8px 32px}.Files-footer{padding:0 32px;left:0;bottom:0}.md .Files-footer,.md .Files-header,.sm .Files-footer,.sm .Files-header{padding:8px 20px}.Files-title{max-width:60%;text-overflow:ellipsis;cursor:default;font-size:21px}html[dir=ltr] .Files-title{margin-right:15px}html[dir=rtl] .Files-title{margin-left:15px}.lg .Files-title,.md .Files-title,.sm .Files-title{margin-top:10px}.xlg .Files-title,.xxlg .Files-title,.xxxlg .Files-title{font-size:28px}.od--hasSelection .CommandBar .ContextualMenu-icon,.od--hasSelection .CommandBar .ms-Icon,.od--hasSelection .Files-leftNavExpander .ms-Icon,.od--hasSelection .od-SearchBox .ms-Icon,.od--hasSelection .od-SearchBox .ms-Icon::before{color:#094AB2}.Files.dropping .Files-listView{box-shadow:inset 0 0 0 3px #c8c8c8}.Files-listView{position:relative;padding-bottom:62px}.Files-leftNavOverlay{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(255,255,255,.4);cursor:pointer;z-index:297}.od-Files-TopBar.od--hasSelection{background-color:#beddf4;transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.od--hasSelection .Files-leftNavExpander{transition:initial;background-color:transparent}.od--hasSelection .CommandBar{background-color:transparent}.od--hasSelection .od-SearchBox{transition:initial}.od--hasSelection .od-SearchBox:hover{background-color:#a8d1ef}.od--hasSelection .od-SearchBox.od-SearchBox:hover{background-color:#a8d1ef;border-bottom:1px solid #eaeaea}.od--hasSelection .od-SearchBox.od-SearchBox--active,.od--hasSelection .od-SearchBox.od-SearchBox--active:hover{background-color:#d7eaf9;color:#000;border-bottom:1px solid #eaeaea}.od--hasSelection .od-SearchBox.od-SearchBox--active .ms-Icon,.od--hasSelection .od-SearchBox.od-SearchBox--active .ms-Icon::before{color:#094AB2}.od--hasSelection .Files-leftNavExpander{color:#666}.od--hasSelection .Files-leftNavExpander:hover{background-color:#a8d1ef}.Files-leftNavExpander{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#094AB2;background-color:#e6f2fb;width:50px;height:40px;padding-top:6px;text-align:center;cursor:pointer;box-sizing:border-box;transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}html[dir=ltr] .Files-leftNavExpander{float:left;margin-right:8px}html[dir=rtl] .Files-leftNavExpander{float:right;margin-left:8px}.Files-leftNavExpander:hover{background-color:#d7eaf9}.Files-leftNavExpander .ms-Icon{color:#094AB2;font-size:18px;display:inline-block;width:48px;border-right:1px solid #c8c8c8;height:28px;line-height:31px}@media print{.Files-leftNav,.od-Files-TopBar,.od-SuiteNav{display:none!important}}")
}),define("odsp-next/bindings/contextMenu/ContextMenuAlignment",["require","exports"],function(){var e;return function(e){e[e.Left=0]="Left",e[e.Top=0]="Top",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom",e[e.Center=4]="Center",e[e.VerticalCenter=8]="VerticalCenter",e[e.BottomCenter=6]="BottomCenter",e[e.RightVerticalCenter=9]="RightVerticalCenter"}(e||(e={})),e}),define("odsp-next/bindings/imageDefault/ImageDefaultBinding",["require","exports","odsp-utilities/events/EventGroup","knockout"],function(e,t,o,i){var n=new o(window),a=function(){function e(){}return e.init=function(e,t){var o=t(),a=o.defaultSrc;n.on(e,"load",function(){n.off(e,"load"),1===e.naturalWidth&&1===e.naturalHeight&&(e.src=a)}),n.on(e,"error",function(){n.off(e),e.src=a}),i.utils.domNodeDisposal.addDisposeCallback(e,function(){n.off(e)})},e.update=function(e,t){var o=t();e.src=o.src()},e}();return a}),define("odsp-next/models/suiteNav/WebImUserState",["require","exports"],function(){var e;return function(e){e[e.offline=0]="offline",e[e.available=1]="available",e[e.invisible=2]="invisible"}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/suiteNavFallback/SuiteNavFallbackViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../bindings/contextMenu/ContextMenuAlignment","../../resources/DataSourceResourceKeys","../commands/CommandViewModel","../../bindings/imageDefault/ImageDefaultBinding","../../utilities/locale/Locale","./SuiteNavFallback.resx","../../actions/NavigationAction","../../bindings/dismiss/DismissBinding","../../utilities/features/Features","odsp-shared/utilities/string/StringHelper","../../models/suiteNav/SuiteNavLinkIds","../../resources/ControlResourceKeys","../../models/suiteNav/WebImUserState","../../resources/PagesResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b,v){var x=5e3,y=function(t){function i(i){var y=this;t.call(this,i),this.userTileDefaultUrl=!!window.FilesConfig&&FilesConfig.imgBaseUrl+"/ic/bluemanm.png"||"",this.signInUrl=!!window.FilesConfig&&FilesConfig.si,this._dataSource=this.resources.consume(a.suiteNav),this._urlDataSource=this.resources.consume(a.url),this.isAppLauncherVisible=o.observable(!1),this.addBindingHandlers({dismiss:u,image:s}),this.userName=o.observable(""),this.userTileUrl=o.observable(""),this.optionsChildren=o.observableArray(),this.meChildren=o.observableArray(),this.menuAlignment=o.observable(l.isRightToLeft?n.Left:n.Right),this.menuLeft=o.observable(l.isRightToLeft?"0":"auto"),this.userState=o.observable(f.offline),this.isUserAvailable=this.createComputed(function(){return y.userState()===f.available}),this.isWebimOpened=this.resources.consume(b.files.isWebimOpened);var C=this.resources.consume(v.userInfo);if(this.isAuthenticated=C&&C.isAuthenticated(),this._dataSource?(this._dataSource.loadData().done(function(e){var t=e.data;y.userName(y._dataSource.getUserName()),y.userTileUrl(y._dataSource.getUserTileUrl());var o,i=y.resources.consume(g.actionMap),n=[],a=t.CurrentWorkloadSettingsSubLinks;for(o=0;o<a.length;o++){var s,l=a[o];s=l.Id===h.FEEDBACK&&m.default.isFeatureEnabled(m.default.NextLegacyBundle)?new(y.managed(i.FeedbackAction)):l.Id===h.DIAGNOSTICS?new(y.managed(i.ToggleDebugWindowAction)):new(y.managed(c))({url:l.Url,target:l.TargetWindow}),n.push(new r({text:l.Text,action:s,url:l.Url}))}var u=[],f=t.CurrentWorkloadUserSubLinks;u.push(new r({text:d.strings.available,isToggleable:!0,action:new(y.managed(i.AvailabilityAction))({isAvailable:!0,userState:y.userState})})),u.push(new r({text:d.strings.invisible,isToggleable:!0,action:new(y.managed(i.AvailabilityAction))({isAvailable:!1,userState:y.userState}),hasLineBreakAfter:!0}));var b,v=y._dataSource.getUserEmail();for(b=v?p.format(d.strings.SignOutEmail,v):d.strings.SignOut,u.push(new r({text:b,action:new(y.managed(i.SignOutAction))({url:t.SignOutLink.Url}),url:t.SignOutLink.Url})),o=0;o<f.length;o++){var x=f[o];u.push(new r({text:x.Text,action:new(y.managed(c))({url:x.Url,target:x.TargetWindow}),url:x.Url}))}y.optionsChildren(n),y.meChildren(u)}),this._dataSource.getCapabilities().showO365Text&&(this.o365text=d.strings.Office365)):(this.userName("Jon Smith"),this.userTileUrl("https://www.placeimg.com/50/50/people"),this.optionsChildren([new r({text:d.strings.Options,action:new(this.managed(c))({url:"https://bing.com"})})]),this.meChildren([new r({text:d.strings.SignOut})])),this.isOptionsOpen=o.observable(!1),this.isMeMenuOpen=o.observable(!1),this.currentApp=d.strings.AppTitle,this.currentAppUrl=this._urlDataSource.getRootUrl(),m.default.isFeatureEnabled(m.default.NextLegacyBundle)){var S=this;this.async.setTimeout(function(){e(["webim"],function(){window.$WLXIM&&jQuery($WLXIM).bind("stateChange",function(){$WLXIM.user&&S.userState($WLXIM.user.get_presence().get_status())})},function(){})},x)}}return __extends(i,t),i.prototype.onOptionsDismiss=function(){this.isOptionsOpen(!1)},i.prototype.onMeMenuDismiss=function(){this.isMeMenuOpen(!1)},i.prototype.onAppLauncherClick=function(){this.isAppLauncherVisible(!this.isAppLauncherVisible())},i.prototype.onAppLauncherDismiss=function(){this.isAppLauncherVisible(!1)},i.prototype.onMeMenuClick=function(){this.isMeMenuOpen(!this.isMeMenuOpen())},i.prototype.onOptionsMenuClick=function(){this.isOptionsOpen(!this.isOptionsOpen())},i.prototype.onWebImClick=function(){m.default.isFeatureEnabled(m.default.NextLegacyBundle)?e(["webim"],function(){window.$WLXIM&&$WLXIM.toggleSidebar()}):this.isWebimOpened&&(this.isWebimOpened(!this.isWebimOpened()),o.utils.triggerEvent(document.body,"resize"))},i}(i);return y}),define("odsp-next/controls/suiteNavFallback/SuiteNavFallback.html",[],function(){return'<div class=od-SuiteNavFallback><a href=# class="od-SuiteNavFallback-appButton ms-Icon ms-Icon--waffle" data-bind="click: onAppLauncherClick, clickBubble: false, dismiss: onAppLauncherDismiss"></a><header><!--ko if: $data.o365text--><span class="od-SuiteNavFallback-o365Title ms-fontWeight-semilight" data-bind=text:o365text></span><span class=od-SuiteNavFallback-divider></span><!--/ko--><a class="od-SuiteNavFallback-selectedApp ms-fontWeight-semilight" data-bind="attr: { href: currentAppUrl }, text: currentApp"></a></header><ul class=od-SuiteNavFallback-rightActions><li><a href=# class="od-SuiteNavFallback-link od-SuiteNavFallback-webimLink" data-bind="click: onWebImClick"><i class="ms-Icon ms-Icon--chat"></i></a></li><li class=od-SuiteNavFallback-options><a href=# class="od-SuiteNavFallback-link od-SuiteNavFallback-optionsLink" data-bind="click: onOptionsMenuClick, dismiss: onOptionsDismiss"><i class="ms-Icon ms-Icon--gear"></i></a><!--ko if: $data.isOptionsOpen--><div class=od-SuiteNavFallback-menuContainer><ms-contextual-menu params="{ items: optionsChildren, isOpen: isOptionsOpen, alignment: menuAlignment, left: menuLeft }"></ms-contextual-menu></div><!--/ko--></li><!--ko if: $data.isAuthenticated--><li class=od-SuiteNavFallback-persona data-bind="css: { \'online\': isUserAvailable() }"><a href=# class="od-SuiteNavFallback-link od-SuiteNavFallback-meLink" data-bind="click: onMeMenuClick, dismiss: onMeMenuDismiss"><img height=50 width=50 data-bind="image: { src: userTileUrl, defaultSrc: userTileDefaultUrl }, attr: { alt: userName }"></a><!--ko if: $data.isMeMenuOpen--><div class=od-SuiteNavFallback-menuContainer><ms-contextual-menu params="{ items: meChildren, isOpen: isMeMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></div><!--/ko--></li><!--/ko--><!--ko if: !$data.isAuthenticated--><li class=od-SuiteNavFallback-persona><a href=# data-bind="attr: { href: signInUrl }"><img class=od-SuiteNavFallback-personaImage height=50 width=50 data-bind="attr: { src: userTileDefaultUrl }"></a></li><!--/ko--></ul><ms-app-launcher data-bind="visible: isAppLauncherVisible"></ms-app-launcher></div>'}),define("odsp-next/controls/suiteNavFallback/SuiteNavFallback.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles("html[dir=ltr] .od-SuiteNavFallback-rightActions,html[dir=ltr] .od-SuiteNavFallback-rightActions .ms-ContextualMenu{right:0}html[dir=rtl] .od-SuiteNavFallback-rightActions,html[dir=rtl] .od-SuiteNavFallback-rightActions .ms-ContextualMenu{left:0}.od-SuiteNavFallback{background:#000;color:#fff;box-sizing:border-box;height:50px;position:absolute;top:0;left:0;right:0;z-index:2001}.od-SuiteNavFallback header{font-size:22px;display:inline-block;line-height:50px;padding:0 0 0 18px;height:50px}html[dir=rtl] .od-SuiteNavFallback header{padding:0 18px 0 0}.od-SuiteNavFallback-divider{margin:5px 15px 0 0}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-style:solid;border-left-width:1px;border-left-color:rgba(255,255,255,.35)}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-style:solid;border-right-width:1px;border-right-color:rgba(255,255,255,.35);margin:5px 0 0 15px}html[dir=ltr] .od-SuiteNavFallback-o365Title{padding-right:15px}html[dir=rtl] .od-SuiteNavFallback-o365Title{padding-left:15px}.od-SuiteNavFallback-selectedApp{color:#fff;text-decoration:none;height:50px}.od-SuiteNavFallback-selectedApp:active,.od-SuiteNavFallback-selectedApp:hover{color:#fff}.od-SuiteNavFallback-appButton{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:#0078d7;display:inline-block;color:#fff;height:50px;width:50px;cursor:pointer;font-size:18px;text-align:center;padding-top:16px;transition:background-color 467ms cubic-bezier(.1,.9,.2,1) 34ms;box-sizing:border-box}html[dir=ltr] .od-SuiteNavFallback-appButton{float:left;border-right-style:solid;border-right-color:rgba(255,255,255,.2);border-right-width:1px}html[dir=rtl] .od-SuiteNavFallback-appButton{float:right;border-left-style:solid;border-left-color:rgba(255,255,255,.2);border-left-width:1px}.od-SuiteNavFallback-appButton:active,.od-SuiteNavFallback-appButton:hover{color:#fff;background-color:#104a7d}.od-SuiteNavFallback-rightActions{display:block;height:50px;position:absolute;top:0;white-space:nowrap;margin:0;padding:0;list-style-type:none}.od-SuiteNavFallback-rightActions li{height:50px;line-height:0;width:51px;cursor:pointer;position:relative;box-sizing:border-box;margin:0;padding:0}html[dir=ltr] .od-SuiteNavFallback-rightActions li{float:left;border-left-style:solid;border-left-width:1px;border-left-color:#767676}html[dir=rtl] .od-SuiteNavFallback-rightActions li{float:right;border-right-style:solid;border-right-width:1px;border-right-color:#767676}.od-SuiteNavFallback-rightActions .ms-Icon{line-height:50px}.od-SuiteNavFallback-persona{display:inline-block;width:55px;vertical-align:top;height:50px}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-style:solid;border-left-width:1px;border-left-color:#767676;text-align:right}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-style:solid;border-right-width:1px;border-right-color:#767676;text-align:left}.od-SuiteNavFallback-persona.online{background:#5dd255}html[dir=ltr] .od-SuiteNavFallback-persona .ms-ContextualMenu{text-align:left}html[dir=rtl] .od-SuiteNavFallback-persona .ms-ContextualMenu{text-align:right}html[dir=ltr] .od-SuiteNavFallback-personaImage{float:right}html[dir=rtl] .od-SuiteNavFallback-personaImage{float:left}.od-SuiteNavFallback-link{display:inline-block;height:50px;width:50px;color:#fff;font-size:20px;text-align:center}.od-SuiteNavFallback-link.selected,.od-SuiteNavFallback-link:hover{color:#fff;background:#104a7d}.od-SuiteNavFallback-meLink{display:inline-block}.od-SuiteNavFallback-options .ms-ContextualMenu{margin-top:19px!important}.od-SuiteNavFallback-menuContainer{display:inline-block;z-index:-1}")}),define("odsp-next/controls/appLauncher/AppLauncherViewModel",["require","exports"],function(){var e=function(){function e(){this.apps=[{id:1,key:"c_h_mail",name:"Outlook",icon:"ms-Icon--outlook",color:"#0072c6",img:"",text:"",size:"small",appType:"o365",link:"https://mail.live.com",pinned:!0},{id:2,key:"c_h_ppl",name:"People",icon:"ms-Icon--person",color:"#d24726",img:"",text:"",size:"small",appType:"o365",link:"https://people.live.com",pinned:!0},{id:3,key:"c_h_cal",name:"Calendar",icon:"ms-Icon--calendar",color:"#5133ab",img:"",text:"",size:"wide",appType:"o365",link:"https://calendar.live.com",pinned:!0},{id:4,key:"c_h_sd",name:"OneDrive",icon:"ms-Icon--onedrive",color:"#094ab2",img:"",text:"",size:"small",appType:"o365",link:"https://onedrive.live.com",pinned:!0},{id:5,key:"c_h_wd",name:"Word",icon:"ms-Icon--word",color:"#2B579A",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/word.aspx",pinned:!0},{id:6,key:"c_h_xl",name:"Excel",icon:"ms-Icon--excel",color:"#217346",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/excel.aspx",pinned:!0},{id:7,key:"c_h_ppt",name:"PowerPoint",icon:"ms-Icon--powerpoint",color:"#D24726",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/powerpoint.aspx",pinned:!0},{id:8,key:"c_h_on",name:"OneNote",icon:"ms-Icon--onenote",color:"#80397B",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/onenote.aspx",pinned:!0},{id:9,key:"c_h_sw",name:"Sway",icon:"ms-Icon--sway",color:"#008272",img:"",text:"",size:"small",appType:"office",link:"https://g.live.com/8seskydrive/switchersway",pinned:!0},{id:10,key:"c_h_oo",name:"Office",icon:"ms-Icon--officeThreshold",color:"#eb3c00",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/default.aspx",pinned:!0}]}return e.prototype.getAppText=function(e,t){return window.$Config&&$Config.headerTiles&&$Config.headerTiles[e]&&$Config.headerTiles[e].text||t},e.prototype.getAppClassString=function(e){return"AppLauncher-listItem "+e},e.prototype.getAppUrl=function(e,t){return window.$Config&&$Config.headerTiles&&$Config.headerTiles[e]&&$Config.headerTiles[e].href||t},e.prototype.getAppInnerClassString=function(e){return"AppLauncher-inner "+e},e.prototype.getAppIconClassString=function(e){return"ms-Icon "+e},e.prototype.getAppTileColor=function(e){return"background-color: "+e+";outline-color: "+e},e}();return e}),define("odsp-next/controls/appLauncher/AppLauncher.html",[],function(){return"<div class=AppLauncher><div class=AppLauncher-beak></div><span data-bind=\"foreach: apps\"><div data-bind=\"attr: { 'class': $component.getAppClassString(name) }\"><a data-bind=\"attr: { 'class': $component.getAppInnerClassString(size), 'href': $component.getAppUrl(key, link), 'style': $component.getAppTileColor(color) }\"><i data-bind=\"attr: { 'class': $component.getAppIconClassString(icon) }\"></i> <span class=AppLauncher-menuTitle data-bind=\"text: $component.getAppText(key, name)\"></span></a></div></span></div>"}),define("odsp-next/controls/appLauncher/AppLauncher.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".AppLauncher{background:#fff;border:1px solid #b6b6b6;box-shadow:0 1px 15px rgba(0,0,0,.4);box-sizing:content-box!important;padding:20px 0 10px 20px;position:absolute;top:50px;margin:10px;width:auto;height:auto;min-width:240px;max-width:840px;max-height:990px;z-index:100;transition-property:max-height,max-width;transition-duration:267ms;transition-timing-function:cubic-bezier(.1,.9,.2,1);-webkit-transition-property:max-height,max-width;-webkit-transition-duration:267ms;-webkit-transition-timing-function:cubic-bezier(.1,.9,.2,1)}html[dir=rtl] .AppLauncher{padding:20px 20px 10px 0;right:0}html[dir=ltr] .AppLauncher{left:0}.AppLauncher-beak{position:absolute;top:0;z-index:10}html[dir=ltr] .AppLauncher-beak{left:0}html[dir=rtl] .AppLauncher-beak{right:0}.AppLauncher-beak:after,.AppLauncher-beak:before{content:' ';border:solid transparent;height:0;position:absolute;width:0}.AppLauncher-beak:before{border-width:9px;border-bottom-color:#B6B6B6;top:-18px}html[dir=ltr] .AppLauncher-beak:before{left:5px}html[dir=rtl] .AppLauncher-beak:before{right:5px}.AppLauncher-beak:after{border-width:8px;border-bottom-color:#fff;top:-16px}html[dir=ltr] .AppLauncher-beak:after{left:6px}html[dir=rtl] .AppLauncher-beak:after{right:6px}.AppLauncher-greybackground{background-color:#999;width:100%;height:100%}.AppLauncher-listItem{width:109px;height:109px;display:block;margin:0 10px 10px 0;position:relative;color:#fff;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:moz-none;-ms-user-select:none;user-select:none;transition:167ms transform cubic-bezier(.1,.9,.2,1);box-sizing:border-box}html[dir=ltr] .AppLauncher-listItem{float:left}html[dir=rtl] .AppLauncher-listItem{float:right;margin:0 0 10px 10px}.AppLauncher-listItem:hover .app-more-menu-button{display:block}.AppLauncher-listItem.wide{width:230px}.AppLauncher-listItem:active{-ms-transform:scale(.95);transform:scale(.95);-webkit-transform:scale(.95)}.AppLauncher-listItem i::before{color:#fff}.AppLauncher-listItem .AppLauncher-inner{top:0;right:0;bottom:0;left:0;position:absolute;text-align:center;background:#094AB2;border:2px solid transparent}.AppLauncher-listItem .AppLauncher-inner:hover{outline-width:2px;outline-style:solid}.AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{font-size:12px;color:#fff;position:absolute;bottom:5px;width:85px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{left:8px;text-align:left}html[dir=rtl] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{right:8px;text-align:right}.AppLauncher-listItem .AppLauncher-inner .ms-Icon{position:relative;font-size:49px;top:26px;color:#fff!important}.AppLauncher-listItem .AppLauncher-inner img{position:absolute;top:20px}html[dir=ltr] .AppLauncher-listItem .AppLauncher-inner img{left:24px}html[dir=rtl] .AppLauncher-listItem .AppLauncher-inner img{right:24px}.AppLauncher-listItem .word{background:#2B579A}.AppLauncher-listItem .excel{background:#207346}.AppLauncher-listItem .powerpoint{background:#D24725;padding:0!important}.AppLauncher-listItem .onenote{background:#80397B}.AppLauncher-listItem .project{background-color:#5133ab}.AppLauncher-listItem .tasks{background:#31752E}.AppLauncher-listItem .oslo .ms-Icon{font-size:64px;padding-top:3px}.AppLauncher-listItem .more-apps{background-color:#eaeaea}.AppLauncher-listItem .more-apps .ms-Icon{top:40px;font-size:25px}.app-more-menu-container{position:absolute}html[dir=ltr] .app-more-menu-container{right:0}html[dir=rtl] .app-more-menu-container{left:0}.app-more-menu-container .app-more-menu-button{font-size:16px;cursor:pointer;color:#fff;text-align:center;width:30px;height:20px;display:none}.app-more-menu-container .more-menu-list{display:none;background:#fff;border:1px solid #E5F0F9;list-style-type:none;width:165px;margin:0;padding:0;position:absolute;top:0;z-index:999;box-shadow:0 0 8px rgba(0,0,0,.6);font-size:12px}html[dir=ltr] .app-more-menu-container .more-menu-list{left:100%;text-align:left}html[dir=rtl] .app-more-menu-container .more-menu-list{right:100%;text-align:right}.app-more-menu-container .more-menu-list li a{padding:5px 15px;width:auto;display:block;color:#000}.app-more-menu-container .more-menu-list li a:hover{background-color:#E5F0F9}.app-more-menu-container.open .more-menu-list{display:block}.appmenu-app-more{background-color:#FFF;vertical-align:bottom;margin:0 20px 10px 0}html[dir=ltr] .appmenu-app-more{float:right;text-align:right}html[dir=rtl] .appmenu-app-more{float:left;text-align:left;margin:0 0 10px 20px}.appmenu-app-more a.appmenu-app-moretext{color:#000;font-size:12px;font-family:SegoeUI-SemiBold-final,Segoe,Tahoma,Helvetica,Arial,sans-serif}.app-provisioning:hover,.appmenu-app-more:hover{outline:0}.app-provisioning{opacity:.2}@media (max-width:940px){.AppLauncher{max-width:486px}}@media (max-width:580px){.AppLauncher{max-width:335px}.AppLauncher-listItem{width:55px;height:55px}.AppLauncher-listItem .AppLauncher-inner .ms-Icon{font-size:25px;top:13px}.AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{display:none}}@media (max-width:460px){.AppLauncher{max-width:205px;min-width:205px}}@media (max-height:950px){.AppLauncher{max-height:730px}}@media (max-height:820px){.AppLauncher{max-height:610px}}@media (max-height:700px){.AppLauncher{max-height:490px}}@media (max-height:600px){.AppLauncher{max-height:360px}}@media (max-height:460px){.AppLauncher{max-height:240px}}")}),define("odsp-next/controls/appLauncher/AppLauncher",["require","exports","knockout","./AppLauncherViewModel","./AppLauncher.html","./AppLauncher.css"],function(e,t,o,i){var n={tagName:"ms-app-launcher",template:e("./AppLauncher.html"),viewModel:i};return o.components.isRegistered(n.tagName)||o.components.register(n.tagName,n),n}),define("odsp-next/controls/suiteNavFallback/SuiteNavFallback",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./SuiteNavFallbackViewModel","./SuiteNavFallback.html","./SuiteNavFallback.css","../appLauncher/AppLauncher"],function(e,t,o,i){var n=o.registerComponent({tagName:"ms-suitenav-fallback",template:e("./SuiteNavFallback.html"),viewModel:i});return n}),define("odsp-next/bindings/activate/ActivateBinding",["require","exports","knockout"],function(e,t,o){var i=function(){function e(){}return e.init=function(e,t,i,n,a){var r=o.utils.unwrapObservable(t()),s=r&&r.activate||r;s&&s.call(a.$data,e)},e}();return i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/suiteNav/SuiteNavViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../suiteNavFallback/SuiteNavFallback","../../resources/ProviderResourceKeys","../../resources/UtilityResourceKeys","../../bindings/activate/ActivateBinding","../../utilities/browser/WindowSize","odsp-utilities/logging/events/Qos.event"],function(e,t,o,i,n,a,r,s,l,d){var c=function(e){function t(t){e.call(this,t),t=t||{};var i=t.hamburgerCallback;this._hamburgerCallback=o.isObservable(i)?i:o.observable(i),this._responsiveUI=this.resources.consume(r.responsiveUI),this._provider=this.resources.consume(a.suiteNav),this._provider&&(this._capabilities=this._provider.getCapabilities(),this._dataPromise=this._provider.loadData()),this._capabilities||(this._capabilities={supportsCaching:!1,supportsRealSuiteNav:!1,showO365Text:!0}),this.supportsRealSuiteNav=this._capabilities.supportsRealSuiteNav,this.mockTagName=n.tagName,this.addBindingHandlers({activate:s})}return __extends(t,e),t.prototype.render=function(e){e.id||(e.id="SuiteNav-"+String(t._suiteNavNum++));var o=this.resources.consume(r.navigation);if(this.supportsRealSuiteNav&&this._dataPromise&&"1"!==o.viewParams.nosuite){var i=new d.Qos({name:"SuiteNav.Render"}),n=this;this._dataPromise.done(function(t){return t?void n._provider.getO365Shell().done(function(o){if(!o)return void n._recordFailure(i,!1,"NoO365Shell");try{o.SetData(t)}catch(a){return n._recordFailure(i,!1,"SetDataException",a),void d.Qos.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n._provider.loadData(!0)})}try{o.RenderAsync({top:e.id,disableDelayLoad:!0,disableShellPlus:!0,layout:"Mouse"},function(){i.end({resultType:d.ResultTypeEnum.Success}),n._onRender(o,t)},function(){i.end({resultType:d.ResultTypeEnum.Success})})}catch(a){n._recordFailure(i,!1,"RenderException",a)}o.OnHasMember("LoadShellPlus",function(){n._handleShellPlus(o,t)}),o.OnHasMember("OnDataChanged",function(){o.OnDataChanged(function(){d.Qos.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n._provider.loadData(!0)})})})},function(e){n._recordFailure(i,!1,"LoadShellError",e)}):void n._recordFailure(i,!1,"NoData")},function(e){n._recordFailure(i,!1,"LoadDataError",e)})}},t.prototype._onRender=function(e,t){var o=this;t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var i=t.ActionsMap[e.Id];i&&(e.Cancel=!i.call(o,o.resources))}),this._hamburgerCallback()&&e.Navigation.OnHamburgerButtonClick&&e.Navigation.OnHamburgerButtonClick(this._hamburgerCallback()),this._hamburgerCallback.subscribe(function(t){e.Navigation.OnHamburgerButtonClick(t)}),e.OnSuiteAPILoaded(function(){var e=o.resources.consume(r.newFeatureExperienceEnabler);e&&e.initializeNewFeatureExperience()})},t.prototype._handleShellPlus=function(e,t){var o=this,i=this._responsiveUI.formFactorSize();if(this._capabilities.isResponsiveSuiteNavEnabled||i!==l.Small&&i!==l.Medium||t.FlightName&&-1!==t.FlightName.indexOf("ShellResponsive")||(this._modifyForSmallScreen(i),i!==l.Small)){var n;this.async.setTimeout(function(){try{n=new d.Qos({name:"SuiteNav.LoadShellPlus"}),e.LoadShellPlus(),n.end({resultType:d.ResultTypeEnum.Success})}catch(t){o._recordFailure(n,!1,"Exception",t)}},500)}},t.prototype._recordFailure=function(e,t,o,i){var n={resultType:t?d.ResultTypeEnum.ExpectedFailure:d.ResultTypeEnum.Failure,resultCode:o};i&&(n.extraData={message:String(i)}),e.end(n)},t.prototype._modifyForSmallScreen=function(e){function t(e){for(var t=0;t<e.length;t++){var o=e[t];o&&o.style&&(o.style.display="none")}}t(document.getElementsByClassName("o365cs-nav-centerAlign")),document.getElementById("O365_MainLink_Logo")&&(t(document.getElementsByClassName("o365cs-nav-appTitle")),t(document.getElementsByClassName("o365cs-nav-appTitleLine"))),e===l.Small&&t([document.getElementById("O365_MainLink_Help")])},t._suiteNavNum=0,t}(i);return c}),define("odsp-next/controls/suiteNav/SuiteNav.html",[],function(){return'<div class=od-SuiteNav data-bind="activate: render"><!--ko if:!supportsRealSuiteNav--><div class=od-SuiteNavFallback data-bind="component: { name: mockTagName }"></div><!--/ko--></div>'}),define("odsp-next/controls/suiteNav/SuiteNav.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-SuiteNav{background:#333;height:50px;position:absolute;width:100%}.od-userSelect--enabled div#o365cs-flexpane-overlay{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.pluginNoSize{width:0;height:0;padding:0;position:absolute}")}),define("odsp-next/controls/suiteNav/SuiteNav",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./SuiteNavViewModel","./SuiteNav.html","./SuiteNav.css"],function(e,t,o,i){var n=o.registerComponent({tagName:"ms-suite-nav",template:e("./SuiteNav.html"),viewModel:i});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/leftPane/LeftPaneViewModel",["require","exports","knockout","./LeftPane.resx","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../bindings/selection/SelectionBinding","../../resources/DataSourceResourceKeys","odsp-shared/utilities/string/StringHelper","../../utilities/features/Features"],function(e,t,o,i,n,a,r,s,l,d){var c=function(e){function t(t){e.call(this,t),this.addBindingHandlers({selection:r}),this._actionMap=this.resources.consume(a.actionMap),this.viewParams=this.resources.consume(a.viewParams),this.leftNavDataSource=this.resources.consume(s.leftNav),this.item=this.resources.consume(a.currentItem),this.manageStorageLink=d.default.isFeatureEnabled(d.default.NewDealExperience)?this.leftNavDataSource.getLinkToManageStorage():null,this.linkGroups=this.leftNavDataSource.getLinkGroups(this.viewParams),this.accounts=o.observableArray(this.leftNavDataSource.getAccounts()),this.spaceAvailable=this.createComputed(this._makeSpaceAvailableText,this),this.isLeftNavVisible=t.isLeftNavVisible||o.observable(!0),this.notificationLinks={text:"Notifications",url:null,isActive:this.createPureComputed(function(){return!1}),isFocused:this.createPureComputed(function(){return!1}),links:this.leftNavDataSource.getNotificationLinks(),isExpanded:this.createPureComputed(function(){return!0})}}return __extends(t,e),t.prototype.navigateToManageStorage=function(){return new(this.managed(this._actionMap.NavigationAction))({url:this.manageStorageLink,target:""}).execute({}),!1},t.prototype._userHasExceededSpace=function(){return this.item().properties.quota.exceeded>0},t.prototype._makeSpaceAvailableText=function(){var e=this.item&&this.item();if(!(e&&e.properties&&e.properties.quota))return this.manageStorageLink?i.strings.NewManageStorage:"";var t=e.properties.quota,o=t.display;return this._userHasExceededSpace()?l.format(i.strings.QuotaUsageExceededFormat,o.exceeded):l.format(i.strings.QuotaAvailableFormat,o.remaining)},t}(n);return c}),define("odsp-next/controls/leftPane/LeftPane.html",[],function(){return'<div class=LeftPane><div class=LeftPane-scroll><table class=LeftPane-table cellpadding=0 cellspacing=0 role=presentation><tr valign=top><td><ms-left-nav params="linkGroups: linkGroups, isLeftNavVisible: isLeftNavVisible"></ms-left-nav></td></tr><tr valign=bottom><td><!--ko foreach: accounts--><a href=# class=LeftPane-account data-bind="attr: { href: url, tabindex: $parent.isLeftNavVisible() ? 0: -1 }"><span class="LeftPane-accountName ms-font-l" data-bind="text: text"></span> <i class="LeftPane-accountIcon ms-Icon ms-Icon--arrowRight"></i></a><!--/ko--><!--ko if: notificationLinks.links().length > 0--><hr class=LeftPane-quotaDivider><div class=LeftPane-quotaArea><!--ko if: !manageStorageLink--><p class="LeftPane-quotaLink ms-font-m" data-bind="text: spaceAvailable"></p><!--/ko--><!--ko if: !!manageStorageLink--><a class="LeftPane-quotaLink LeftPane-storageLink ms-font-m" href=javascript:void(0); data-bind="text: spaceAvailable, click: navigateToManageStorage"></a><!--/ko--></div><div class=LeftPane-notificationArea><!--ko component: { name: \'ms-left-nav-sublink\', params: { linkGroup: notificationLinks, resources: resources } }--><!--/ko--></div><!--/ko--></td></tr></table></div></div>'}),define("odsp-next/controls/leftPane/LeftPane.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".LeftPane,.LeftPane-scroll{position:absolute;left:0;right:0}.LeftPane{top:0;bottom:0;-webkit-overflow-scrolling:touch}.LeftPane-scroll{top:0;bottom:0;overflow-y:auto;overflow-x:hidden}.LeftPane-table{width:100%;height:100%;table-layout:fixed}.LeftPane-expandButton.ms-Icon{position:absolute;width:30px;height:40px;line-height:40px;text-align:center;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);transition:-webkit-transform 167ms cubic-bezier(.1,.9,.2,1);transition:transform 167ms cubic-bezier(.1,.9,.2,1);transition:transform 167ms cubic-bezier(.1,.9,.2,1),-webkit-transform 167ms cubic-bezier(.1,.9,.2,1)}html[dir=ltr] .LeftPane-expandButton.ms-Icon{left:0}html[dir=rtl] .LeftPane-expandButton.ms-Icon{right:0}.LeftPane-account{text-decoration:none;padding:5px 30px;display:inline-block;white-space:nowrap}html[dir=ltr] .LeftPane-accountName{margin-right:3px}html[dir=rtl] .LeftPane-accountName{margin-left:3px}.LeftPane-accountIcon{color:#0078d7;-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg)}.LeftPane-quotaArea{padding-bottom:15px}.LeftPane-quotaDivider{border:none;border-top:1px solid #eaeaea;margin:5px 20px}.LeftPane-notificationArea,html[dir=rtl] .LeftPane-notificationArea{margin:-20px 0 20px}.LeftPane-quotaLink{display:block;margin:0;padding:9px 40px;height:auto;line-height:14px;font-size:12px}.lg .LeftPane-quotaLink,.md .LeftPane-quotaLink,.sm .LeftPane-quotaLink{font-size:14px;line-height:18px;padding:11px 40px}.LeftPane-backToClassicLink,.LeftPane-updateLink{display:block;margin:0;padding:9px 40px;height:auto;line-height:14px}.LeftPane-backToClassicLink{font-size:12px}.lg .LeftPane-backToClassicLink,.md .LeftPane-backToClassicLink,.sm .LeftPane-backToClassicLink{font-size:14px}.LeftPane-updateLink{font-size:12px;background-color:#f4f4f4}.LeftPane-storageLink{color:#2f69c0}")
}),define("odsp-next/utilities/events/EventTargetFilters",["require","exports"],function(e,t){function o(e){"use strict";var t=e,o=t&&(t.tagName in n||t.isContentEditable);return o}function i(e){"use strict";var t=e,o=t&&t.tagName in a;return o}var n={INPUT:!0,TEXTAREA:!0},a={A:!0,BUTTON:!0};t.isInputElement=o,t.isButtonElement=i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/keyboard/KeyboardBinding",["require","exports","../BaseBinding","knockout","odsp-utilities/events/EventGroup","../../utilities/locale/Locale","../../utilities/events/EventTargetFilters"],function(e,t,o,i,n,a,r){function s(e,t){"use strict";var o=!!e.useRtlMappings&&a.isRightToLeft,i=o&&c[t]||t,n=e.mappings[i];return n}function l(e){"use strict";var t;return t=d(e.keyCode),e.metaKey&&(t="Meta"+t),e.ctrlKey&&(t="Ctrl"+t),e.altKey&&(t="Alt"+t),e.shiftKey&&(t="Shift"+t),t}function d(e){"use strict";var t;if(e>=65&&91>=e)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 191:t="/";break;default:t=""}return t}var c={Left:"Right",Right:"Left"},u=function(e){function t(o){e.call(this,o);var i,n=this.valueAccessor();if(n instanceof Array){i=n;for(var a=function(e){return function(){return e}},r=0;r<n.length;r++){var s=n[r];new(this.managed(t))({element:this.element,valueAccessor:a(s),bindingContext:this.bindingContext,allBindingsAccessor:this.allBindingsAccessor})}}else{if("object"!=typeof n)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var l=n.mappings&&n||{mappings:n},d=l.target||this.element;this._options=l,this.events.on(d,"keydown",this._onKeyDown)}}return __extends(t,e),t.prototype._onKeyDown=function(e){var t=this._options,o=i.isObservable(t.isActive)?t.isActive.peek():!0,a=t.allowInputEvents,d=t.allowButtonEvents,c=t.context||this.bindingContext.$data,u=!!t.preventDefault,m=e.target;if(!d&&r.isButtonElement(m)||!a&&r.isInputElement(m)||o&&!o)return!0;var p=l(e),h=s(t,p);if(h){u&&e.preventDefault&&e.preventDefault();var g;g=h instanceof Array?h:[h];for(var f=0;f<g.length;f++){var b=g[f];if(b.call(c,c,e)===!1)return n.stopPropagation(e),!1}}return!0},t}(o);return u}),define("odsp-next/bindings/focus/OnFocusBinding",["require","exports","knockout","odsp-utilities/events/EventGroup"],function(e,t,o,i){var n=function(){function e(){}return e.init=function(e,t){var n=new i(null);n.on(e,"focus",o.unwrap(t()).bind(o.dataFor(e))),o.utils.domNodeDisposal.addDisposeCallback(e,function(){n.dispose()})},e}();return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/searchBox/SearchBoxViewModel",["require","exports","odsp-shared/base/ViewModel","./SearchBox.resx","../../bindings/keyboard/KeyboardBinding","../../bindings/focus/OnFocusBinding"],function(e,t,o,i,n,a){var r=function(e){function t(t){e.call(this,t),this.strings=i.strings,this.addBindingHandlers({focus:a,keyboard:n}),this.context=t.context}return __extends(t,e),t}(o);return r}),define("odsp-next/controls/searchBox/SearchBox.html",[],function(){return'<div class=od-SearchBox data-bind="click: context.focusInput, css: { \'od-SearchBox--active\': context.isActive, \'od-SearchBox--collapsed\': context.isCollapsed, \'od-SearchBox--hasBack\': context.hasBack, \'od-SearchBox--hasText\': context.searchText, \'od-SearchBox--searchIconLeft\': context.searchIconLeft, \'od-SearchBox--searchIconRight\': context.searchIconRight }"><span class="od-SearchBox-iconWrapper od-SearchBox-iconArrowWrapper" data-bind="attr: { title: strings.BackIconLabel }"><button class="ms-Icon ms-Icon--arrowLeft" data-bind="click: context.onBack, clickBubble: false"></button></span> <input class=od-SearchBox-input type=text data-bind="hasFocus: context.inputFocused, keyboard: { allowInputEvents: true, preventDefault: true, mappings: { Enter: context.onEnter, Down: context.onArrowDown, Up: context.onFocusUp } }, attr: { placeholder: context.placeholder, \'aria-label\': strings.SearchBoxLabel, \'aria-autocomplete\': context.ariaAutoComplete, \'aria-owns\': context.ariaResultsId, \'aria-activedescendant\': context.ariaFocusedResultId() }, textInput: context.searchText, automation: \'SearchBox-Input\', click: context.focusInput, clickBubble: false"> <span class="od-SearchBox-iconWrapper od-SearchBox-iconSearchWrapper" data-bind="attr: { title: strings.SearchIconLabel }"><button class="ms-Icon ms-Icon--search" data-bind="click: context.onSearchClick, clickBubble: false"></button></span> <span class="od-SearchBox-iconWrapper od-SearchBox-iconClearWrapper ms-font-s" data-bind="attr: { title: strings.ClearIconLabel }"><button class="ms-Icon ms-Icon--x" data-bind="click: context.clearInput, clickBubble: false"></button></span></div>'}),define("odsp-next/controls/searchBox/SearchBox.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-SearchBox,.od-SearchBox-input{box-sizing:border-box;height:40px}.od-SearchBox{width:100%;background-color:#d7eaf9;color:#333;position:relative;border-color:transparent;transition:367ms cubic-bezier(.1,.9,.2,1);transition-property:width,background-color}@media screen and (-ms-high-contrast:active){.od-SearchBox{border-right:1px solid #fff;z-index:304}}@media screen and (-ms-high-contrast:black-on-white){.od-SearchBox{border-right:1px solid #000}}.od-SearchBox .ms-Icon--search{margin-top:12px;vertical-align:top}.od-SearchBox button.ms-Icon{background:0 0;padding:0;border:none}.od-SearchBox--active,.od-SearchBox:hover{background-color:#a8d1ef;color:#000}.od-SearchBox--collapsed:not(.od-SearchBox--active){overflow:hidden;background-color:transparent;width:40px}.lg .od-SearchBox--collapsed:not(.od-SearchBox--active),.md .od-SearchBox--collapsed:not(.od-SearchBox--active),.sm .od-SearchBox--collapsed:not(.od-SearchBox--active){width:40px}.md .od-SearchBox--collapsed:not(.od-SearchBox--active),.sm .od-SearchBox--collapsed:not(.od-SearchBox--active){width:36px}.od-SearchBox-input{padding:8px 8px 8px 0;border:none;background-color:transparent;width:100%;outline:0;font-size:14px;-webkit-appearance:none;-webkit-border-radius:0}html[dir=rtl] .od-SearchBox-input{padding:8px 0 8px 8px;border-right:40px solid transparent}html[dir=ltr] .od-SearchBox-input{border-left:40px solid transparent}@media screen and (-ms-high-contrast:active){html[dir=ltr] .od-SearchBox-input{border-left:40px solid #000}html[dir=rtl] .od-SearchBox-input{border-right:40px solid #000}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] .od-SearchBox-input{border-left:40px solid #fff}html[dir=rtl] .od-SearchBox-input{border-right:40px solid #fff}}.od-SearchBox-input::-ms-clear{display:none}.od-SearchBox-input::-webkit-input-placeholder{color:#333;opacity:1;font-size:14px}.od-SearchBox-input::-moz-placeholder{color:#333;opacity:1;font-size:14px}.od-SearchBox-input:-ms-input-placeholder{color:#333;opacity:1;font-size:14px}.od-SearchBox-input::placeholder{color:#333;opacity:1;font-size:14px}.od-SearchBox-input:placeholder{color:#333;opacity:1;font-size:14px}.od-SearchBox-iconSearchWrapper{display:block}.od-SearchBox--active .od-SearchBox-iconSearchWrapper,.od-SearchBox-iconArrowWrapper{display:none}html[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-right:17px}html[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-left:17px;padding-right:6px}html[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-left:6px}html[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-right:16px}html[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-left:16px;padding-right:7px}html[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-left:7px}.od-SearchBox-iconArrowWrapper,.od-SearchBox-iconSearchWrapper{top:0}.od-SearchBox-iconClearWrapper{display:none;top:1px}html[dir=rtl] .od-SearchBox-iconClearWrapper{padding-right:11px}html[dir=ltr] .od-SearchBox-iconClearWrapper{padding-left:11px;padding-right:12px;right:0}html[dir=rtl] .od-SearchBox-iconClearWrapper{padding-left:12px;left:0}html[dir=ltr] .od-SearchBox--active .od-SearchBox-input{border-left-width:8px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input,html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{border-left-width:40px}html[dir=rtl] .od-SearchBox--active .od-SearchBox-input{border-right-width:8px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input,html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{border-right-width:40px}.od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-iconArrowWrapper,.od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-iconClearWrapper,.od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-iconSearchWrapper,.od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{display:block}html[dir=ltr] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-right:40px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-left:40px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{border-left-width:73px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{border-right-width:73px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-left:40px;padding-left:10px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-right:40px;padding-right:10px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{right:0}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{left:0;padding-right:11px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:11px;padding-right:12px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:12px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-right:40px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-left:40px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-right:68px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-left:68px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-right:40px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-left:40px;padding-right:6px}html[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:6px;padding-right:5px}html[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:5px}.od-SearchBox-iconWrapper{height:40px;line-height:40px;cursor:pointer;position:absolute}.od-SearchBox .ms-Icon::before{font-size:17px;color:#094AB2}")}),define("odsp-next/controls/searchBox/SearchBox",["require","exports","./SearchBoxViewModel","odsp-shared/utilities/knockout/ComponentFactory","./SearchBox.html","./SearchBox.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-search-box",template:e("./SearchBox.html"),viewModel:o});return n}),define("odsp-next/controls/searchResults/SearchResultTemplates",["require","exports"],function(){var e=function(){function e(){}return e.Default="od-search-result-default",e.Expanded="od-search-result-expanded",e.Glyph="od-search-result-glyph",e.Upscope="od-search-result-upscope",e}();return e}),define("odsp-next/bindings/css/VisibilityBinding",["require","exports","knockout"],function(e,t,o){var i=function(){function e(){}return e.update=function(e,t){var i=o.unwrap(t());e.style.visibility=i?"inherit":"hidden"},e}();return i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/searchResults/SearchResultsViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","./SearchResults.resx","../progressSpinnerFlat/ProgressSpinnerFlat","./SearchResultTemplates","../../models/search/SearchResultType","../../bindings/css/VisibilityBinding","../../bindings/selection/SelectionBinding","../../utilities/datetime/DateTime"],function(e,t,o,i,n,a,r,s,l,d,c){var u=function(e){function t(t){var i=this;e.call(this,t),this.addBindingHandlers({visibility:l,selection:d}),this.fadeIn=o.observable(!1),this.context=t.context,this.DateTime=c,this.parentFolderLabel=n.strings.ParentFolderLabel,this.accessibleTextNewResults=n.strings.NewSearchResultsAccessibleText,this.progressSpinnerFlatTagName=a.tagName,this.noResults=o.observable(!1),this.statusMessage=this.context.capabilities.showOnlyResults?o.observable(""):this.createComputed(function(){var e,t=i.context.errorMessage(),o=i.context.searchText,a=i.context.capabilities.minimumQueryLength;if(t)e=t;else{var r=i.context.searchData(),s=!r.containers.length||!r.containers[0].results.length;i.noResults(s),e=o&&o().length<a?n.strings.TypeToSearchStatus:i.context.queryInProgress()?n.strings.SearchingStatus:s&&i.context.capabilities.showNoResults?n.strings.NoResults:""}return e}).extend({rateLimit:150})}return __extends(t,e),t.prototype.onClickResult=function(e){this.context.searchResultClicked(e)},t.prototype.getTemplate=function(e){var t;switch(e.type){case s.Expanded:t=r.Expanded;break;case s.Tag:case s.History:t=r.Glyph;break;case s.UpscopeSearch:t=r.Upscope;break;default:t=r.Default}return{name:t}},t}(i);return u}),define("odsp-next/utilities/css/utilities.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".ms-noList ol,.ms-noList ul,ol.ms-noList,ul.ms-noList{list-style-type:none;margin-top:0;margin-bottom:0}html[dir=ltr] .ms-noList ol,html[dir=ltr] .ms-noList ul,html[dir=ltr] ol.ms-noList,html[dir=ltr] ul.ms-noList{padding-left:0}html[dir=rtl] .ms-noList ol,html[dir=rtl] .ms-noList ul,html[dir=rtl] ol.ms-noList,html[dir=rtl] ul.ms-noList{padding-right:0}.ms-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}.ms-dotSeparatorAfter::after{content:'\\a0\\b7'}.ms-dotSeparatorBefore::before{content:'\\b7\\a0'}.ms-enquote::before{content:'\\93'}.ms-enquote::after{content:'\\94'}@media print{.ms-noPrint{display:none!important}}")}),define("odsp-next/controls/searchResults/SearchResults.html",[],function(){return'<div class=od-SearchResults data-bind="css: { \'od-SearchResults-hasStatus\': !!statusMessage() }"><div class=ms-accessible role=alert data-bind="text: accessibleTextNewResults, visible: !context.queryInProgress() && !statusMessage()"></div><div class=od-SearchResults-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visible: context.queryInProgress()"></div><div class="od-SearchResults-status ms-font-m-plus" data-bind="text: statusMessage"></div><ul class="od-SearchResults-resultsBox ms-noList" data-bind="attr: { id: context.ariaResultsId }" aria-expanded=true role=listbox><!--ko foreach: context.searchData().containers--><!--ko foreach: results--><!--ko template: $component.getTemplate.call($component, $data)--><!--/ko--><!--/ko--><!--ko if: ($index() < $parent.context.searchData().containers.length - 1)--><li class=od-SearchResults-separator><hr class=od-SearchResults-separator-line></li><!--/ko--><!--/ko--></ul></div>'}),define("odsp-next/controls/searchResults/SearchResults.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-SearchResults,.od-SearchResults-result-metadata,.od-SearchResults-result-summary,.od-SearchResults-result-title{box-sizing:border-box}html[dir=ltr] .od-SearchResults-progressBox,html[dir=ltr] .od-SearchResults-result-title{left:0}html[dir=rtl] .od-SearchResults-progressBox,html[dir=rtl] .od-SearchResults-result-title{right:0}.od-SearchResults{background-color:#fff;border:1px solid transparent;padding:0 12px;box-shadow:0 0 5px 0 rgba(0,0,0,.4);width:432px}.md .od-SearchResults,.sm .od-SearchResults{width:100%}.od-SearchResults-hasStatus>.od-SearchResults-status{display:block}.od-SearchResults-status{display:none;margin:10px auto}.od-SearchResults-hasStatus>.od-SearchResults-resultsBox{display:none}.od-SearchResults-resultsBox{box-sizing:border-box;width:100%}.od-SearchResults-result-glyph,.od-SearchResults-result-icon{height:24px;width:24px;position:relative;display:inline-block}.od-SearchResults-result{text-decoration:none;position:relative;margin-bottom:2px}.od--isNonMobile .od-SearchResults-result-link:hover{background:#e6f2fb;outline:transparent solid 1px}.od--isNonMobile .od-SearchResults-result-link:hover.is-selected{background:#beddf4}.od-SearchResults-result-link--focused{background:#d7eaf9}.od-focus--enabled .od-SearchResults-result-link--focused{box-shadow:0 0 0 1px #767676 inset;outline:transparent solid 1px}.od-SearchResults-expanded-result i{background-color:#f4f4f4;font-style:normal;border:solid #f4f4f4;border-width:1px 0}.od-SearchResults-result-highlight{font-family:'Segoe UI Semibold WestEuropean','Segoe UI Semibold','Segoe WP Semibold','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-weight:600}.od-SearchResults-result-icon{margin-top:5px}.od-SearchResults-result-parentFolder{display:inline-block;color:#767676}.od-SearchResults-result-glyph{color:#767676}html[dir=ltr] .od-SearchResults-result-metadata,html[dir=ltr] .od-SearchResults-result-summary,html[dir=ltr] .od-SearchResults-result-title{padding-left:36px}html[dir=rtl] .od-SearchResults-result-metadata,html[dir=rtl] .od-SearchResults-result-summary,html[dir=rtl] .od-SearchResults-result-title{padding-right:36px}.od-SearchResults-result-metadata,.od-SearchResults-result-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-SearchResults-result-title{position:absolute;top:0;width:100%}.od-SearchResults-result-title-text{vertical-align:top;display:inline-block;overflow:hidden;text-overflow:ellipsis;max-width:100%}html[dir=ltr] .od-SearchResults-result-title-text{margin-right:6px}html[dir=rtl] .od-SearchResults-result-title-text{margin-left:6px}.od-SearchResults-result-link{text-decoration:none;display:block;height:34px;line-height:34px;margin:0 -12px;padding:0 12px;cursor:pointer}.od-SearchResults-result-folderLink{text-decoration:none}.od-SearchResults-upscope-result .od-SearchResults-result-glyph{color:#094AB2}.od-SearchResults-progressBox{position:absolute;width:100%;top:2px}.od-SearchResults-separator-line{margin:0 -12px;border:0;border-bottom:1px solid #eaeaea}")});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/imageLoader/ImageLoaderBinding",["require","exports","../BaseBinding","odsp-utilities/async/Signal","../../utilities/auth/DomainAuthenticator","knockout"],function(e,t,o,i,n,a){var r=function(e){function t(t){var o=this;e.call(this,t),this.createComputed(function(){var e=t.valueAccessor(),r=e.isLoaded,s=e.actualSize,l=a.utils.unwrapObservable(e.src);o._loadImagePromise&&(o._loadImagePromise.cancel(),o._loadImagePromise=null),r&&r(!1);var d=o._loadImagePromise=o.trackPromise(n.authenticate(l).then(function(){var e=new i(function(){return o.events.off(o.element)});return o.events.on(o.element,"load",function(){o.events.off(o.element),e.complete()}),o.events.on(o.element,"error",function(){o.events.off(o.element),e.error()}),o.element.src=l,e.getPromise()}).then(function(){d===o._loadImagePromise&&(o._loadImagePromise=null,s&&s({width:o.element.naturalWidth||o.element.width,height:o.element.naturalHeight||o.element.height}),r&&r(!0))}))})}return __extends(t,e),t}(o);return r});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/thumbnailTile/ThumbnailImageViewModel",["require","exports","odsp-shared/base/ViewModel","../../bindings/imageLoader/ImageLoaderBinding","odsp-utilities/math/Rectangle","odsp-utilities/object/ObjectUtil","knockout"],function(e,t,o,i,n,a,r){var s="px",l=function(e){function t(t){var o=this;e.call(this,t),this.addBindingHandlers({imageLoader:i}),this.fadeIn=t.fadeIn,this.image=t.image,this._fitToSize=Boolean(this.image)&&!!this.image.fitToSize,this.url=t.url,this.isLoaded=t.isLoaded||r.observable(!1),this._rotation=t.rotation||r.observable(0),this._scale=t.scale||r.observable(1),this.actualSize=r.observable({width:0,height:0}),this.actualSize.equalityComparer=a.deepCompare,this._desiredSize=t.desiredSize,this._shouldContainImage=t.shouldContainImage,this._finalSize=this.createComputed(this._computeFinalSize),this._finalSize.equalityComparer=a.deepCompare,this.imageStyle=this.createComputed(this._computeImageStyle),this.imageStyle.equalityComparer=a.deepCompare,this.isRotating=r.observable(!1),this.createComputed(function(){o._rotation(),r.computedContext.isInitial()||o.isRotating(!0)}),this.createComputed(function(){o.isRotating()&&o.isRotating(!1)}).extend({rateLimit:1e3}),this.isPortrait=this.createPureComputed(function(){var e=o.actualSize();return e?e.width>e.height:!1})}return __extends(t,e),t.prototype._computeImageStyle=function(){var e=this._finalSize(),t=this._desiredSize(),o=this._rotation()%4*90,i="",a={"-webkit-transform":i,"-ms-transform":i,transform:i},l=this.actualSize();if(e&&e.width&&t&&t.width&&(!this._fitToSize||Boolean(l)&&(0!==l.width||0!==l.height))){var d,c=new n(0,0,e.width,e.height),u=new n(0,0,t.width,t.height),m=c.fit(u,this._shouldContainImage);if(this._rotation()%2===0)d=1;else{var p=new n(0,0,e.height,e.width).fit(u,this._shouldContainImage);d=p.width/m.height}i=i+" rotate("+o+"deg) scale("+d+", "+d+")";var h={"-webkit-transform":i,"-ms-transform":i,transform:i};this._fitToSize?l.width>l.height?h.height=Math.round(m.height)+s:h.width=Math.round(m.width)+s:(h.height=Math.round(m.height)+s,h.width=Math.round(m.width)+s),r.utils.extend(a,h)}return a},t.prototype._computeFinalSize=function(){var e,t=this.image,o=this._scale();if(t.width)e={width:t.width*o,height:t.height*o};else{var i=this.actualSize(),n=window.devicePixelRatio||1;e={width:i.width*o/n,height:i.height*o/n}}return e},t}(o);return l});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/thumbnailTile/ThumbnailCache",["require","exports","odsp-shared/base/BaseModel","knockout"],function(e,t,o,i){var n=6e4,a=4,r=function(e){function t(t,o){e.call(this,t),this._recordsByThumbnailKey={},this._bucketsByImageKey={},this.lastAccessedDate=i.observable(new Date);var a=o&&o.pruneThumbnailsExtenders||{rateLimit:n};this.createComputed(this._pruneThumbnails).extend(a)}return __extends(t,e),t.getInstance=function(){var e=new t;return t.getInstance=function(){return e},e},t.prototype.getCoveragePercent=function(e,t){var o=this._getPixels(e),i=this._getPixels(t);return Math.sqrt(i/o)},t.prototype.register=function(e,t,o,i){void 0===o&&(o=t),void 0===i&&(i=!0);var n=this.getCoveragePercent(e,o),a=this._getBucket(n),r=this._getThumbnailKey(e),s=this._getThumbnailKey(t);this.lastAccessedDate(new Date);var l=this._recordsByThumbnailKey[r]||{lastAccessed:void 0,buckets:{}};l.lastAccessed=this.lastAccessedDate.peek();var d=l.buckets[a];(!d||this.getCoveragePercent(d.size,o)>1)&&(d&&delete this._bucketsByImageKey[d.key],d=l.buckets[a]={key:s,size:o,image:t,isLoaded:i}),this._bucketsByImageKey[s]=d,this._recordsByThumbnailKey[r]=l},t.prototype.record=function(e){var t=this._getThumbnailKey(e),o=this._bucketsByImageKey[t];o&&(o.isLoaded=!0)},t.prototype.retrieve=function(e,t,o){void 0===t&&(t=1),void 0===o&&(o=t);var i,n=this._getThumbnailKey(e),a=this._recordsByThumbnailKey[n];if(this.lastAccessedDate(new Date),a){var r=a.buckets;a.lastAccessed=this.lastAccessedDate.peek();var s=this._getBucket(t),l=this._getBucket(o),d=-1/0,c=!1;for(var u in r){var m=Number(u);s>=m&&m>=l&&r[m].isLoaded&&(d=Math.max(d,m),c=!0)}var p=c&&r[d];i=p&&p.image||null}else i=null;return i},t.prototype._getThumbnailKey=function(e){return JSON.stringify(e)},t.prototype._getBucket=function(e){return Math.floor(Math.log(e)/Math.log(2)*a)},t.prototype._getPixels=function(e){return e.width*e.height},t.prototype._pruneThumbnails=function(){for(var e=this.lastAccessedDate(),t=0,o=Object.keys(this._recordsByThumbnailKey);t<o.length;t++){var i=o[t],a=this._recordsByThumbnailKey[i];e.getTime()-a.lastAccessed.getTime()>n&&delete this._recordsByThumbnailKey[i];for(var r in a.buckets){var s=a.buckets[r],l=s.key;delete this._bucketsByImageKey[l]}}},t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=r});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/thumbnailTile/ThumbnailTileViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","odsp-shared/utilities/string/StringHelper","./ThumbnailImageViewModel","odsp-utilities/math/Rectangle","./ThumbnailCache","odsp-utilities/object/ObjectUtil","odsp-shared/utilities/knockout/Projections"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t,i){var n=this;e.call(this,t),this._thumbnailCache=i&&i.thumbnailCache||s.default.getInstance(),this.fadeIn=t.fadeIn||o.observable(!0),this._shouldContainImage=!!t.shouldContainImage,this.image=o.isObservable(t.image)?t.image:o.observable(t.image),this.desiredSize=o.isObservable(t.desiredSize)?this.createComputed(function(){return t.desiredSize()}):o.observable(t.desiredSize),this.desiredSize.equalityComparer=l.deepCompare,this._scale=t.scale||o.observable(1),this._isLoaded=o.isObservable(t.isLoaded)?t.isLoaded:o.observable(!1),this._coverage=o.isObservable(t.coverage)?t.coverage:o.observable({minimum:1,maximum:1}),this._allowLoading=t.allowLoading||o.observable(!0),this._thumbnails=o.observableArray(),this.createComputed(function(){n._isLoaded(!!n._thumbnails().filter(function(e){return e.isLoaded()}).length)}),this._initializeThumbnails();var a=i&&i.createThumbnailsExtenders||{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}},r=i&&i.cleanThumbnailsExtenders||{rateLimit:{timeout:2e3,method:"notifyWhenChangesStop"}};this.createComputed(this._createThumbnails).extend(a),this.createComputed(this._cleanThumbnails).extend(r),this.createComputed(function(){!n._thumbnails().length&&n.image()&&n.desiredSize().width&&n._createThumbnails()}).extend({rateLimit:0}),this.isPortrait=this.createPureComputed(function(){var e=n.thumbnails(),t=e[e.length-1],o=t?t.actualSize():null;return o?o.width>o.height:!1})}return __extends(t,e),t.prototype._initializeThumbnails=function(){var e=this;this.thumbnails=this.addDisposable(this._thumbnails.map({mappingWithDisposeCallback:function(t){var i=o.pureComputed(function(){return e.desiredSize()}),n=o.pureComputed(function(){return e._scale()}),r=o.computed(function(){t.isLoaded()&&e._thumbnailCache.register(t.original,t.current)}),s=new(e.resources.injected(a))({image:t.original,url:t.current.url,isLoaded:t.isLoaded,desiredSize:i,rotation:t.rotation,scale:n,shouldContainImage:e._shouldContainImage,fadeIn:e.fadeIn});return{mappedValue:s,dispose:function(){r.dispose(),s.dispose(),i.dispose(),n.dispose()}}}}))},t.prototype._createThumbnails=function(){var e=this.desiredSize(),t=this.image(),i=this._coverage(),n=this._allowLoading();if(e.width&&e.height&&t){var a=window.devicePixelRatio||1,s={width:e.width*a,height:e.height*a},l=new r(0,0,s.width,s.height),d=new r(0,0,t.width||s.width,t.height||s.height),c=d.fit(l,this._shouldContainImage),u=this._thumbnailCache.getCoveragePercent(d,c),m=i.minimum*u,p=i.maximum*u,h={width:c.width,height:c.height,url:this._formatUrl(t.url,{width:Math.ceil(c.width),height:Math.ceil(c.height)})},g=this._thumbnailCache.retrieve(t,p,m),f=this._thumbnails.peek().slice(-1)[0];f&&f.isLoaded.peek()&&this._isSameImage(f,h)?f.rotation(t.rotation):(!this._thumbnails.peek().length||n)&&(g&&this._thumbnails.push({original:t,current:g,isLoaded:o.observable(!1),rotation:o.observable(t.rotation)}),(!g||g.width*g.height<c.width*c.height)&&this._thumbnails.push({original:t,current:h,isLoaded:o.observable(!1),rotation:o.observable(t.rotation)}))}else this._thumbnails.splice(0,this._thumbnails.peek().length)},t.prototype._formatUrl=function(e,t){return n.format(e,t.width,t.height)},t.prototype._cleanThumbnails=function(){var e=this._thumbnails.slice(-1),t=e[0];t&&t.isLoaded()&&this._thumbnails.splice(0,this._thumbnails().length-1)},t.prototype._isSameImage=function(e,t){return e.current.url===t.url&&e.current.width===t.width&&e.current.height===t.height},t}(i);return d}),define("odsp-next/controls/thumbnailTile/ThumbnailTile.html",[],function(){return"<div class=ThumbnailTile data-bind=\"template: { foreach: thumbnails }\"><div class=ThumbnailTile-thumbnail data-bind=\"css: { 'ThumbnailTile-thumbnail--portrait': isPortrait, 'ThumbnailTile-thumbnail--loaded': isLoaded, 'ThumbnailTile-thumbnail--rotating': isRotating, 'ThumbnailTile-thumbnail--fadeIn': fadeIn }\"><div class=ThumbnailTile-image><img data-bind=\"imageLoader: { src: url, isLoaded: isLoaded, actualSize: actualSize }, style: imageStyle\"></div></div></div>"}),define("odsp-next/controls/thumbnailTile/ThumbnailTile.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".ThumbnailTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.ThumbnailTile-thumbnail{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%}.ThumbnailTile-thumbnail.ThumbnailTile-thumbnail--loaded{opacity:1}.ThumbnailTile-thumbnail.ThumbnailTile-thumbnail--loaded.ThumbnailTile-thumbnail--fadeIn{transition:opacity 217ms linear 50ms}.ThumbnailTile-thumbnail img{display:block}.ThumbnailTile-image{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ThumbnailTile-thumbnail--rotating img{transition:-webkit-transform 167ms cubic-bezier(.1,.25,.75,.9);transition:transform 167ms cubic-bezier(.1,.25,.75,.9);transition:transform 167ms cubic-bezier(.1,.25,.75,.9),-webkit-transform 167ms cubic-bezier(.1,.25,.75,.9)}")}),define("odsp-next/controls/thumbnailTile/ThumbnailTile",["require","exports","./ThumbnailTileViewModel","odsp-shared/utilities/knockout/ComponentFactory","./ThumbnailTile.html","./ThumbnailTile.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-thumbnail-tile",template:e("./ThumbnailTile.html"),viewModel:o,synchronous:!0});return n}),define("odsp-next/controls/searchResults/SearchResult.html",[],function(){return'<li class=od-SearchResults-result><div class=od-SearchResults-result-link data-bind="click: $component.onClickResult.bind($component), clickBubble: false, css: { \'od-SearchResults-result-link--focused\': isFocused }, attr: { id: ariaId() }" tabindex=-1 role=option><div class=od-SearchResults-result-icon data-bind="component: { name: \'ms-thumbnail-tile\', params: { image: { url: iconUrl }, desiredSize: { width: 24, height: 24 }, fadeIn: $component.fadeIn } }"></div><div class=od-SearchResults-result-title><span class="ms-font-m-plus od-SearchResults-result-title-text" data-bind="html: title"></span><!--ko if: !!$data.parentFolder--><span class="od-SearchResults-result-parentFolder ms-dotSeparatorBefore" data-bind="text: parentFolder"></span><!--/ko--></div></div></li>'
}),define("odsp-next/controls/searchResults/ExpandedSearchResult.html",[],function(){return'<li class="od-SearchResults-result od-SearchResults-expanded-result"><div class=od-SearchResults-result-link data-bind="click: $component.onClickResult.bind($component), clickBubble: false, css: { \'od-SearchResults-result-link--focused\': isFocused }, attr: { id: ariaId() }" tabindex=-1 role=link><div class=od-SearchResults-result-icon data-bind="component: { name: \'ms-thumbnail-tile\', params: { image: { url: iconUrl }, desiredSize: { width: 24, height: 24 }, fadeIn: $component.fadeIn } }"></div><span class="od-SearchResults-result-title ms-font-m-plus" data-bind="html: title"></span></div><!--ko if: !!$data.lastModifiedBy && !!$data.lastModifiedDate && !!$data.parentFolder--><div class="od-SearchResults-result-metadata ms-font-s ms-fontColor-neutralSecondary"><span data-bind="text: lastModifiedBy" class=ms-dotSeparatorAfter></span> <a data-bind="text: parentFolder, attr: { href: parentUrl, title: $component.parentFolderLabel }" class="od-SearchResults-result-folderLink ms-font-s ms-fontColor-themePrimary" target=_blank tabindex=-1></a> <span data-bind="text: $component.DateTime.GetRelativeDateTimeStringPast(lastModifiedDate)" class=ms-dotSeparatorBefore></span></div><!--/ko--><!--ko if: $data.showSummary && !!$data.summary--><div class="od-SearchResults-result-summary ms-font-s ms-fontColor-neutralSecondary"><span data-bind="html: summary" class=ms-enquote></span></div><!--/ko--></li>'}),define("odsp-next/controls/searchResults/GlyphSearchResult.html",[],function(){return'<li class="od-SearchResults-result od-SearchResults-glyph-result"><div class=od-SearchResults-result-link data-bind="click: $component.onClickResult.bind($component), clickBubble: false, css: { \'od-SearchResults-result-link--focused\': isFocused }, attr: { id: ariaId() }" tabindex=-1 role=option><div class=od-SearchResults-result-glyph data-bind="component: { name: \'od-icon-glyph\', params: { icon: glyph } }"></div><span class="od-SearchResults-result-title ms-font-m-plus" data-bind="html: title"></span></div></li>'}),define("odsp-next/controls/searchResults/UpscopeSearchResult.html",[],function(){return'<li class="od-SearchResults-result od-SearchResults-upscope-result"><div class=od-SearchResults-result-link data-bind="click: $component.onClickResult.bind($component), clickBubble: false, css: { \'od-SearchResults-result-link--focused\': isFocused }, attr: { id: ariaId() }" tabindex=-1 role=option><div class=od-SearchResults-result-glyph data-bind="component: { name: \'od-icon-glyph\', params: { icon: glyph } }"></div><span class="od-SearchResults-result-title ms-font-m-plus" data-bind="text: title"></span></div></li>'}),define("odsp-next/controls/searchResults/SearchResults",["require","exports","./SearchResultsViewModel","odsp-shared/utilities/knockout/ComponentFactory","./SearchResultTemplates","./../../utilities/css/utilities.css","./SearchResults.html","./SearchResults.css","../thumbnailTile/ThumbnailTile","./SearchResult.html","./ExpandedSearchResult.html","./GlyphSearchResult.html","./UpscopeSearchResult.html"],function(e,t,o,i,n){var a=i.registerComponent({tagName:"ms-search-results",template:e("./SearchResults.html"),viewModel:o});return i.registerTemplate(n.Default,e("./SearchResult.html")),i.registerTemplate(n.Expanded,e("./ExpandedSearchResult.html")),i.registerTemplate(n.Glyph,e("./GlyphSearchResult.html")),i.registerTemplate(n.Upscope,e("./UpscopeSearchResult.html")),a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/search/SearchContext",["require","exports","knockout","../../resources/ProviderResourceKeys","../../models/search/SearchData","../../models/search/SearchResultType","odsp-shared/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/UtilityResourceKeys","../../utilities/optimizely/OptimizelyHelper","odsp-utilities/logging/events/Engagement.event","odsp-utilities/async/Promise","../../utilities/features/Features","../../resources/ControlResourceKeys","../../utilities/icons/Icon","odsp-next/dataSources/url/QueryType","odsp-utilities/logging/events/Qos.event","odsp-utilities/logging/events/Qos.event","../searchResults/SearchResults.resx"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b,v){var x=function(e){function t(r){var u=this;e.call(this,r),this.search=function(){var e=u.searchText.peek();u._searchProvider&&e&&(c.Engagement.logData({name:"Search.UpscopeSearchClicked"}),u._onNavigateAway(),u._searchProvider.upscopeSearch(e),u.unfocusInput())},this.onEnter=function(){var e=u.focusedItem.peek();e?u.searchResultClicked(e):u.search()},this.clearInput=function(){u.searchText(""),u.focusInput()},this.focusInput=function(){d.trackEvent(d.EXPERIMENTS.searchBoxGlyph,d.EVENTS.searchBoxClicked),u.inputFocused(!0),u._setFocusItem(null),u.isActive(!0);var e=u.searchText.peek();""===e&&u._autoSuggest("")},this.onSearchClick=function(){u.isActive.peek()?u.search():u.focusInput()},this.unfocusInput=function(){u.inputFocused(!0),u.inputFocused(!1),u.isActive(!1)},this.onBack=function(){u.clearInput(),u.unfocusInput()},this.onArrowDown=function(){var e=u.allResults.peek();if(e&&e.length){var t=u.focusedItem.peek(),o=e[0];if(null!==t){var i=e.indexOf(t);i+=1,o=i===e.length?null:e[i]}u._setFocusItem(o)}},this.onFocusUp=function(){var e=u.allResults.peek();if(e&&e.length){var t=u.focusedItem.peek(),o=e[e.length-1];if(null!==t){var i=e.indexOf(t);0!==i?(i-=1,o=e[i]):o=null}u._setFocusItem(o)}},this.searchResultClicked=function(e){if(u._setFocusItem(null),u._searchProvider&&e)if(e.type===a.UpscopeSearch)u.search();else if(c.Engagement.logData({name:"Search.ResultClicked"}),u._searchProvider.searchResultClicked(e),u._updateText(e,!1),u._instrumentationProvider&&e.instrumentationUrl&&u._instrumentationProvider.userClickSuggestion(e.instrumentationUrl),e.key){var t=u._urlDataSource.getItemUrl(e.key);u._onNavigateAway(),u._navigation.navigateTo({url:t})}else e.url&&(u._onNavigateAway(),u._navigation.navigateTo({url:e.url,frameId:"_blank"}));u.unfocusInput()},this.placeholder=r.searchParams.searchPlaceholder,this.isCollapsed=r.searchParams.isCollapsed,this.hasBack=r.searchParams.hasBack,this.searchIconLeft=o.observable(!1),this.searchIconRight=o.observable(!1),this._initOptimizelyExperiments(),this._searchProvider=this.resources.consume(i.search),this._urlDataSource=this.resources.consume(s.url),this._navigation=this.resources.consume(l.navigation),this._instrumentationProvider=this.resources.consume(i.instrumentation),this._currentItem=this.resources.consume(p.currentItem),this.capabilities=this._searchProvider.getCapabilities(),this.isFocused=o.observable(!1),this.isActive=o.observable(!1),this.ariaAutoComplete=this.capabilities.supportsResultsWheeling?"list":"none",this.ariaResultsId="od-searchResults-list-"+t.resultsId++,this.ariaFocusedResultId=o.observable(""),this.searchText=o.observable(""),this.inputFocused=o.observable(!1),this._ignorableTextUpdateCount=0,this._isTemporarySuggestion=!1,this._hadResults=!1,this.searchData=o.observable(new n("")),this.allResults=o.observableArray(),this.focusedItem=o.observable(null),this.subscribe(this.allResults,function(){u._setFocusItem(null)}),this.queryInProgress=o.observable(!1),this.errorMessage=o.observable(""),this.createComputed(this._computeSearchTextChanged).extend({rateLimit:this.capabilities.maxQueryRate}),this.createComputed(function(){u.isActive(u.isFocused()?!0:!1)}),this.showResults=this.addDisposable(o.pureComputed({read:function(){var e=!0;if(u.capabilities.showOnlyResults){var t=u.allResults();t&&t.length&&(u._hadResults||t.length>1)?(e=!0,u._hadResults=!0):e=!1}return u.capabilities.supportsResultsWheeling&&u.isFocused()&&e},write:function(){}}))}return __extends(t,e),t.prototype._computeSearchTextChanged=function(){var e=this.searchText();this.capabilities.supportsResultsWheeling&&this.isFocused.peek()&&this._previousSearchText!==e&&0===this._ignorableTextUpdateCount&&(this._isTemporarySuggestion=!1,this._autoSuggest(e)),this._ignorableTextUpdateCount&&this._ignorableTextUpdateCount--},t.prototype._autoSuggest=function(e){this.queryInProgress.peek()&&this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel(),this.queryInProgress(!0),this._searchProvider.getItems&&!this._urlDataSource.isCurrentQuery(g.Photos)&&(this._searchResultsRequestPromise=f.Qos.instrumentPromise({name:"SearchResultsRequest"},this._searchProvider.getItems.bind(this._searchProvider,e,this._currentItem?this._currentItem.peek():null),null,function(e){return u.default.isCanceled(e)?{resultType:b.ResultTypeEnum.Success}:{resultType:b.ResultTypeEnum.Failure,error:e}}),this._searchResultsRequestPromise.done(this._resultCallback(),this._errorCallback()),this._previousSearchText=e)},t.prototype._clearResults=function(){this.searchData(new n("")),this.allResults.removeAll()},t.prototype._resultCallback=function(){var e=this;return function(t){if(e.queryInProgress(!1),e.errorMessage(""),t.upscopeAvailable){var o=m.default.isFeatureEnabled(m.default.EnablePersonalSearchSuggestions)?v.strings.SearchOneDrive:v.strings.SearchEverything;t.containers.push({results:[{type:a.UpscopeSearch,title:o,glyph:h.search}]})}var i=e._viewFromISearchResult(t),n=i.containers.reduce(function(e,t){return e.concat(t.results)},[]);e.capabilities.showOnlyResults&&!n.length&&e.showResults(!1),e.searchData(i),e.allResults(n)}},t.prototype._errorCallback=function(){var e=this;return function(t){u.default.isCanceled(t)||(e.queryInProgress(!1),e.errorMessage(String(t)),e._clearResults())}},t.prototype._viewFromISearchResult=function(e){var t=e.containers.map(function(e){var t=e.results.map(function(e,t){var i=o.utils.extend({},e);return i.isFocused=o.observable(!1),i.ariaId=o.observable("od-searchResults-result-"+t),i});return{results:t}});return new n(e.query,t,e.upscopeAvailable)},t.prototype._onNavigateAway=function(){this._isTemporarySuggestion=!1,this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel()},t.prototype._setFocusItem=function(e){var t=this.focusedItem.peek();t!==e&&(t&&t.isFocused(!1),this.focusedItem(e),e?(e.isFocused(!0),this.ariaFocusedResultId(e.ariaId.peek()),this._updateText(e,!0)):this.ariaFocusedResultId(""))},t.prototype._updateText=function(e,t){e.type===a.History?(this._ignorableTextUpdateCount++,this.searchText(e.titleText),this._isTemporarySuggestion=t):this._isTemporarySuggestion&&(this._ignorableTextUpdateCount++,this.searchText(this._previousSearchText),this._isTemporarySuggestion=!1)},t.prototype._initOptimizelyExperiments=function(){var e=this;d.GetVariationIdsMapForExperiment(d.SEARCHBOX_GLYPH_EXPERIMENT_ID).done(function(t){if(t&&t.length){var o=parseInt(t[0],10);o===d.SEARCHBOX_GLYPH_VARIATION_LEFT_ID?e.searchIconLeft(!0):o===d.SEARCHBOX_GLYPH_VARIATION_RIGHT_ID&&e.searchIconRight(!0)}})},t.resultsId=0,t}(r);Object.defineProperty(t,"__esModule",{value:!0}),t.default=x});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/focus/ChildFocusBinding",["require","exports","knockout","../BaseBinding","odsp-utilities/events/EventGroup","odsp-utilities/domUtils/DomUtils"],function(e,t,o,i,n,a){var r=function(e){function t(o){e.call(this,o),this._hasFocus=o.valueAccessor();var i=t._bindingCount;t._bindingCount++,!i&&t._bindingCount&&(t._events=new n(null),t._events.on(document.body,"focus",t._onDocumentFocus,!0),t._events.on(document.body,"blur",t._onDocumentBlur,!0)),this._initializeHasFocus()}return __extends(t,e),t._onDocumentFocus=function(){t._activeElement(document.activeElement)},t._onDocumentBlur=function(){t._activeElement(document.activeElement)},t.prototype.dispose=function(){var o=t._bindingCount;t._bindingCount--,o&&!t._bindingCount&&(t._events.dispose(),t._events=null),e.prototype.dispose.call(this)},t.prototype._initializeHasFocus=function(){var e=this;this.createComputed(function(){var o=t._finalActiveElement();e._hasFocus(o&&e._isWithinElement(o))})},t.prototype._isWithinElement=function(e){for(;e&&e!==this.element&&a.getParent(e);)e=a.getParent(e);return e===this.element},t._activeElement=o.observable(document.activeElement),t._finalActiveElement=o.pureComputed(function(){return t._activeElement(document.activeElement),t._activeElement()}).extend({rateLimit:0}),t._bindingCount=0,t}(i);return r});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/search/SearchViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/UtilityResourceKeys","./Search.resx","../searchBox/SearchBox","../searchResults/SearchResults","./SearchContext","../../bindings/focus/ChildFocusBinding","../../bindings/keyboard/KeyboardBinding"],function(e,t,o,i,n,a,r,s,l,d,c){var u=function(e){function t(t){var i=this;e.call(this),this.addBindingHandlers({keyboard:c,hasChildFocus:d}),this._responsiveUI=this.resources.consume(n.responsiveUI),this.alignResultsToSearch=this.createPureComputed(function(){var e=!0;if(i._responsiveUI){var t=i._responsiveUI.formFactorSize();(t===i._responsiveUI.windowSize.Medium||t===i._responsiveUI.windowSize.Small)&&(e=!1)}return e}),this.searchBoxTagName=r.tagName,this.searchResultsTagName=s.tagName,this.params=t,this.params.searchPlaceholder=this.params.searchPlaceholder||a.strings.SearchPlaceholder,this.params.isCollapsed=this.params.isCollapsed||o.observable(!1),this.params.hasBack=this.params.hasBack||o.observable(!1),this.context=new(this.managed(l.default))({searchParams:this.params}),this.searchBoxParams={context:this.context},this.searchResultsParams={context:this.context}}return __extends(t,e),t}(i);return u}),define("odsp-next/controls/search/Search.html",[],function(){return"<div class=od-Search role=search data-bind=\"keyboard: { allowInputEvents: true, mappings: { Esc: context.clearInput } }, css: { 'od-Search--collapsed': params.isCollapsed, 'od-Search--active': context.isActive }, hasChildFocus: context.isFocused\"><!--ko component: { name: searchBoxTagName, params: searchBoxParams }--><!--/ko--><!--ko if: context.showResults()--><!--ko component: { name: 'od-overlay', params: { alignToParent: alignResultsToSearch }}--><div class=od-Search-overlay data-bind=\"component: { name: searchResultsTagName, params: searchResultsParams }, css: { 'od-Search--active': context.isActive }\"></div><!--/ko--><!--/ko--></div>"}),define("odsp-next/controls/search/Search.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-Search{width:100%}.od-Search.od-Search.od-Search--collapsed{width:auto}.od-Search-overlay .od-SearchResults{position:absolute;top:40px}.md .od-Search-overlay .od-SearchResults,.sm .od-Search-overlay .od-SearchResults{top:90px;left:0;right:0}")}),define("odsp-next/utilities/accessibility/Accessibility",["require","exports"],function(){var e=function(){function e(){}return e.focusFirstTabStop=function(t){if(t){var o=e.getFirstTabStop(t);o&&o.focus()}},e.focusLastTabStop=function(t){if(t){var o=e.getLastTabStop(t);o&&o.focus()}},e.focusNextTabStop=function(t){if(t){var o=e.getNextTabStop(t);o&&o.focus()}},e.focusPreviousTabStop=function(t){if(t){var o=e.getPreviousTabStop(t);o&&o.focus()}},e.getFirstTabStop=function(t){if(!t)return null;if(e.isTabStop(t))return t;for(var o=t.children,i=o.length,n=0;i>n;n++){var a=o[n],r=e.getFirstTabStop(a);if(r)return r}return null},e.getLastTabStop=function(t){if(!t)return null;for(var o=t.children,i=o.length-1;i>=0;i--){var n=e.getLastTabStop(o[i]);if(n)return n}return e.isTabStop(t)?t:null},e.getNextTabStop=function(t){if(!t)return null;e._getNextTabStopElemFound=!1;var o=e._walkTheTree(document.body,t);return e._getNextTabStopElemFound=!1,o},e.getPreviousTabStop=function(t){if(!t)return null;e._getPreviousTabStopElemFound=!1;var o=e._walkTheTreeBack(document.body,t);return e._getPreviousTabStopElemFound=!1,o},e.isTabStop=function(e){if(!e)return!1;var t=e.tagName.toLowerCase();return"a"!==t&&"input"!==t&&"area"!==t&&"button"!==t&&"select"!==t&&"textarea"!==t&&"object"!==t&&"undefined"==typeof e.attributes.tabindex?!1:-1===e.tabIndex?!1:"none"===e.style.display.toLowerCase()||"hidden"===e.style.visibility.toLowerCase()?!1:0===e.offsetWidth&&0===e.offsetHeight?!1:e.disabled?!1:"input"===t&&"hidden"===e.type.toLowerCase()?!1:!0},e._walkTheTree=function(t,o){if(!t||!o)return null;for(var i=t.children.length,n=null,a=0;i>a;a++){var r=t.children[a];if(e._getNextTabStopElemFound&&e.isTabStop(r))return r;if(r===o&&(e._getNextTabStopElemFound=!0),n=e._walkTheTree(r,o))return n}return null},e._walkTheTreeBack=function(t,o){var i=null;if(!t||!o)return null;for(var n=t.children.length-1;n>=0;n--){var a=t.children[n];if(i=e._walkTheTreeBack(a,o))return i}return e._getPreviousTabStopElemFound&&e.isTabStop(t)?t:(t===o&&(e._getPreviousTabStopElemFound=!0),null)},e._getNextTabStopElemFound=!1,e._getPreviousTabStopElemFound=!1,e}();return e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/focus/PreserveFocusBinding",["require","exports","../../utilities/accessibility/Accessibility","../BaseBinding","odsp-utilities/domUtils/DomUtils"],function(e,t,o,i,n){var a=function(e){function t(t){e.call(this,t),this._shouldRestoreFocus=t.valueAccessor();var o=null;try{o=document.activeElement}catch(i){}for(this._preserveActiveElementAncestors=[];o&&o!==document.body;)this._preserveActiveElementAncestors.push(o),o=n.getParent(o,!0)}return __extends(t,e),t.prototype.dispose=function(){if(this._shouldRestoreFocus)for(var t=0,i=this._preserveActiveElementAncestors;t<i.length;t++){var n=i[t];if(n&&o.isTabStop(n)&&document.body.contains(n)){n.focus();break}}this._preserveActiveElementAncestors=[],e.prototype.dispose.call(this)},t}(i);return a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/component/ComponentContextBinding",["require","exports","../BaseBinding","knockout"],function(e,t,o,i){var n=function(e){function t(t){e.call(this,t);var o=this.valueAccessor(),n=this._getComponentBindingContext(),a=n.$parentContext;if("function"==typeof o){var r=o;r({bindingContext:a,templateNodes:this.bindingContext.$componentTemplateNodes})}else i.applyBindingsToDescendants(this.bindingContext.extend({$componentParentContext:n}),this.element),this.controlsDescendantBindings=!0}return __extends(t,e),t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t},t.supportsVirtualElements=!0,t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/host/HostBinding",["require","exports","../BaseBinding","../component/ComponentContextBinding","knockout"],function(e,t,o,i,n){var a=function(e){function t(t){var o=this;e.call(this,t),this._componentContextBinding=new(this.managed(i.default))({element:this.element,bindingContext:this.bindingContext,allBindingsAccessor:this.allBindingsAccessor,valueAccessor:function(){return o._onReceiveComponentParentContext.bind(o)}}),this.controlsDescendantBindings=!0}return __extends(t,e),t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),o="object"==typeof t?t:{},i=o.data,a=void 0===i?this.bindingContext.$data:i,r=o.afterRender;n.applyBindingsToNode(this.element,{template:{nodes:e.templateNodes,afterRender:r}},e.bindingContext.extend({$host:a,$hostContext:this.bindingContext}))},t.supportsVirtualElements=!0,t}(o);return a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/models/overlay/Overlay",["require","exports","odsp-shared/base/BaseModel","knockout"],function(e,t,o,i){var n=function(e){function t(t){e.call(this,t),this.topTab=t.topTab,this.bottomTab=t.bottomTab,this.animation=t.animation,this.alignToParent=t.alignToParent||i.observable(!0)}return __extends(t,e),t}(o);return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/overlays/OverlayViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/ProviderResourceKeys","../../bindings/element/ElementBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/host/HostBinding","../../models/overlay/Overlay"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t){e.call(this,t),this.addBindingHandlers({host:s,element:a,preserveFocus:r}),this.overlayProvider=this.resources.consume(n.overlay),this.topTab=o.observable(null),this.bottomTab=o.observable(null),this.restoreFocusOnClose=t.restoreFocusOnClose||!1,this.overlay=new l({alignToParent:o.isObservable(t.alignToParent)?t.alignToParent:o.observable(t.alignToParent),animation:t.animation,topTab:this.topTab,bottomTab:this.bottomTab})}return __extends(t,e),t}(i);return d}),define("odsp-next/controls/overlays/Overlay.html",[],function(){return'<a href=javascript:; class=ms-accessible aria-hidden=true data-bind="element: topTab"></a> <a href=javascript:; class=ms-accessible aria-hidden=true data-bind="element: bottomTab"></a><div class="od-Overlay ms-accessible" data-bind="component: { name: \'od-transclusion-content\', params: { provider: overlayProvider, parentElement: $element, options: overlay } }, preserveFocus: restoreFocusOnClose"><!--ko host: {}--><!--/ko--></div>'}),define("odsp-next/controls/overlays/Overlay.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-Overlay{height:0;width:0;overflow:hidden}")}),define("odsp-next/models/transclusion/TransclusionContext",["require","exports","knockout"],function(e,t,o){var i=function(){function e(e){this.templateNodes=e.templateNodes,this.bindingContext=e.bindingContext,this.renderCount=e.renderCount||o.observable(0),this.parentElement=e.parentElement||null,this.options=e.options||null}return e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/transclusion/content/TransclusionContentBinding",["require","exports","../../BaseBinding","../../../models/transclusion/TransclusionContext","../../component/ComponentContextBinding"],function(e,t,o,i,n){var a=function(e){function t(t){var o=this;e.call(this,t),this._componentContextBinding=new(this.managed(n.default))({element:this.element,bindingContext:this.bindingContext,allBindingsAccessor:this.allBindingsAccessor,valueAccessor:function(){return o._onReceiveComponentParentContext.bind(o)}}),this.controlsDescendantBindings=!0}return __extends(t,e),t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),o=new i.default({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(o)},t.supportsVirtualElements=!0,t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/transclusion/content/TransclusionContentViewModel",["require","exports","odsp-shared/base/ViewModel","../../../bindings/transclusion/content/TransclusionContentBinding","knockout"],function(e,t,o,i,n){var a=function(e){function t(t){var o=this;e.call(this,t),this.addBindingHandlers({transclusionContent:i.default}),this._provider=t.provider,this.bindingParams={context:n.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options},this.createComputed(function(){var e=o.bindingParams.context();o._transclusion&&(o._transclusion.dispose(),o._transclusion=null),e&&(o._transclusion=o.addDisposable(o._provider.transclude(e)))})}return __extends(t,e),t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}),define("odsp-next/controls/transclusion/content/TransclusionContent.html",[],function(){return"<!--ko transclusionContent: bindingParams--><!--/ko-->"}),define("odsp-next/controls/transclusion/content/TransclusionContent",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./TransclusionContentViewModel","./TransclusionContent.html"],function(e,t,o,i){var n=o.registerComponent({tagName:"od-transclusion-content",template:e("./TransclusionContent.html"),viewModel:i.default,synchronous:!0});Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/controls/overlays/Overlay",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./OverlayViewModel","./Overlay.html","./Overlay.css","../transclusion/content/TransclusionContent"],function(e,t,o,i){var n=o.registerComponent({tagName:"od-overlay",template:e("./Overlay.html"),viewModel:i,synchronous:!0});return n}),define("odsp-next/controls/search/Search",["require","exports","./SearchViewModel","odsp-shared/utilities/knockout/ComponentFactory","./Search.html","./Search.css","../overlays/Overlay"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-search",template:e("./Search.html"),viewModel:o});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/leftNav/LeftNavViewModel",["require","exports","knockout","../../utilities/browser/WindowSize","odsp-shared/base/ViewModel","../../bindings/selection/SelectionBinding","odsp-utilities/logging/events/Engagement.event","odsp-shared/utilities/logging/LoggingHelper","../../utilities/features/Features","odsp-shared/utilities/string/StringHelper","./LeftNav.resx","../../bindings/keyboard/KeyboardBinding","../../resources/UtilityResourceKeys"],function(e,t,o,i,n,a,r,s,l,d,c,u,m){var p=function(e){function t(t){e.call(this,t),this.addBindingHandlers({selection:a,keyboard:u}),this.linkGroups=t.linkGroups?o.isObservable(t.linkGroups)?t.linkGroups:o.observableArray(t.linkGroups):o.observableArray(),this.isLeftNavVisible=t.isLeftNavVisible||o.observable(!0),this.leftNavLinkGroupAriaLabelEnabled=l.default.isFeatureEnabled(l.default.LeftNavLinkGroupAriaLabelEnabled),this.responsiveUI=this.resources.consume(m.responsiveUI),this._initializeSubSections()}return __extends(t,e),t.prototype.toggleExpanded=function(e){var t=e.engagementName;return t&&(t=t.replace(/\s/g,""),t+=e.isExpanded()?"Collapse":"Expand",r.Engagement.logData({name:t+".LeftNav.Click"})),e.isExpanded(!e.isExpanded()),e.keepOpen=o.observable(!0),!1},t.prototype.onClick=function(e,t){return e.engagementName&&r.Engagement.logData({name:e.engagementName+".LeftNav.Click",extraData:{action:s.capitalizeFirstLetter(t.type)}}),e.action?(e.action.execute(t),!1):!0},t.prototype.getLinkGroupAriaLabel=function(e){var t,o=null;return this.leftNavLinkGroupAriaLabelEnabled&&(t=e.isExpanded()?c.strings.ariaLabelForLeftNavLinkGroupHeaderExpanded:c.strings.ariaLabelForLeftNavLinkGroupHeaderClosed,o=d.format(t,e.text)),o},t.prototype._processGroups=function(e){for(var t=1;t<this.linkGroups().length;t++)this.linkGroups()[t].keepOpen||this.linkGroups()[t].isExpanded(e)},t.prototype._initializeSubSections=function(){var e=this;this.createComputed(function(){var t=e.responsiveUI.formFactorSize();switch(t){case i.Small:case i.Medium:case i.Large:return e._processGroups(!1),!1;default:return e._processGroups(!0),!0}})},t}(n);return p}),define("odsp-next/controls/leftNav/LeftNav.html",[],function(){return"<div class=LeftNav><div class=LeftNav-linkArea data-bind=\"foreach: linkGroups\"><!--ko if: links().length> 0--><div class=LeftNav-linkGroup role=tree data-bind=\"css: { 'is-expanded': isExpanded }, selection: {data: links, mode: 'single', direction: 'vertical', properties: { focused: 'isFocused', href: 'url'} }\"><div class=LeftNav-linkGroupClip><a class=\"LeftNav-link ms-font-l\" role=treeitem data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : '', tabindex: $parent.isLeftNavVisible() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $parent.getLinkGroupAriaLabel($data) }, 'aria-role': 'menu', 'aria-expanded': isExpanded, keyboard: { mappings: { Enter: $parent.toggleExpanded, Space: $parent.toggleExpanded }, preventDefault: true }\"><i class=\"LeftNav-expandButton ms-Icon ms-Icon--chevronDown\" data-bind=\"click: $parent.toggleExpanded\"></i> <span data-bind=\"text: text, click: $parent.toggleExpanded\"></span></a><!--ko if: $data.plusIconProperties && $data.plusIconProperties()--><a class=LeftNav-linkGroup-plusWrapper role=button data-bind=\"attr: {'aria-label': $data.plusIconProperties().text, 'title': $data.plusIconProperties().text, tabindex: $parent.isLeftNavVisible() ? 0: -1 }, click: function(context, event) { $component.onClick($data.plusIconProperties(), event); }\"><i class=\"LeftNav-linkGroup-plus ms-Icon ms-Icon--plus\"></i></a><!--/ko--></div><!--ko component: { name: 'ms-left-nav-sublink', params: { linkGroup: $data, resources: $parent.resources } }--><!--/ko--></div><!--/ko--></div></div>"}),define("odsp-next/controls/leftNav/LeftNav.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".selection-active .LeftNav-subLink.LeftNav-is-active,a.LeftNav-link.LeftNav-is-active,a.LeftNav-link.LeftNav-is-active:hover,a.LeftNav-subLink.LeftNav-is-active,a.LeftNav-subLink.LeftNav-is-active:hover{font-family:'Segoe UI Semibold WestEuropean','Segoe UI Semibold','Segoe WP Semibold','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-weight:600}.LeftNav-expandButton.ms-Icon{position:absolute;text-align:center;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;line-height:32px;height:32px}html[dir=ltr] .LeftNav-expandButton.ms-Icon{left:17px}html[dir=rtl] .LeftNav-expandButton.ms-Icon{right:17px}.lg .LeftNav-expandButton.ms-Icon,.md .LeftNav-expandButton.ms-Icon,.sm .LeftNav-expandButton.ms-Icon{height:40px;line-height:40px}.LeftNav-linkGroup.is-expanded .LeftNav-expandButton{-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.LeftNav-linkGroup{padding:8px 0 0}.LeftNav-linkGroup:first-child{padding:20px 0 0}.xlg .LeftNav-linkGroup:first-child,.xxlg .LeftNav-linkGroup:first-child,.xxxlg .LeftNav-linkGroup:first-child{padding:30px 0 0}.LeftNav-subLinksClip{overflow:hidden}.LeftNav-subLinks{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.LeftNav-subLinks:focus{outline:0}a.LeftNav-link,a.LeftNav-subLink{display:block;padding:0 20px 0 40px;margin:0;line-height:29px;height:32px;cursor:pointer;border:none;background:0 0;color:#333;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{padding:0 40px 0 20px}a.LeftNav-link:hover:not(.LeftNav-is-active),a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:#e6f2fb}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid #000}html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid #000}html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid #fff}html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid #fff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid #fff}html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid #fff}html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid #000}html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid #000}}a.LeftNav-link.LeftNav-is-active:hover,a.LeftNav-subLink.LeftNav-is-active:hover{background:#a8d1ef}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #37006e}}a.LeftNav-link.LeftNav-is-active,a.LeftNav-subLink.LeftNav-is-active{background:#d7eaf9}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #37006e}}.lg a.LeftNav-link,.lg a.LeftNav-subLink,.md a.LeftNav-link,.md a.LeftNav-subLink,.sm a.LeftNav-link,.sm a.LeftNav-subLink{height:40px;line-height:35px}a.LeftNav-subLink{line-height:32px;height:32px;font-size:12px}.lg a.LeftNav-subLink,.md a.LeftNav-subLink,.sm a.LeftNav-subLink{line-height:40px;font-size:14px}html[dir=ltr] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-left:56px}html[dir=rtl] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-right:56px}.LeftNav-loadingTemplate,.LeftNav-subLinksAsText{color:#333;padding:8px 20px 8px 40px}html[dir=rtl] .LeftNav-loadingTemplate,html[dir=rtl] .LeftNav-subLinksAsText{padding:8px 40px 8px 20px}.lg .LeftNav-loadingTemplate,.lg .LeftNav-subLinksAsText,.md .LeftNav-loadingTemplate,.md .LeftNav-subLinksAsText,.sm .LeftNav-loadingTemplate,.sm .LeftNav-subLinksAsText{font-size:14px}.xlg .LeftNav-loadingTemplate,.xlg .LeftNav-subLinksAsText,.xxlg .LeftNav-loadingTemplate,.xxlg .LeftNav-subLinksAsText,.xxxlg .LeftNav-loadingTemplate,.xxxlg .LeftNav-subLinksAsText{font-size:12px}.selection-active .LeftNav-subLink.LeftNav-is-active{background:#eaeaea}a.LeftNav-link:hover{color:#212121;cursor:default}.LeftNav-link .ms-Icon--chevronDown:hover,a.LeftNav-subLink:hover{color:#212121}.LeftNav-linkGroupClip{position:relative;height:32px}.lg .LeftNav-linkGroupClip,.md .LeftNav-linkGroupClip,.sm .LeftNav-linkGroupClip{height:40px}.LeftNav-linkGroup-plusWrapper{cursor:pointer;margin:auto;position:absolute;top:0;width:30px;height:32px;font-size:14px}html[dir=ltr] .LeftNav-linkGroup-plusWrapper{right:8px}html[dir=rtl] .LeftNav-linkGroup-plusWrapper{left:8px}.lg .LeftNav-linkGroup-plusWrapper,.md .LeftNav-linkGroup-plusWrapper,.sm .LeftNav-linkGroup-plusWrapper{height:40px;line-height:40px}.LeftNav-linkGroup-plus{color:#094AB2;width:14px;height:14px;margin:auto;position:absolute;top:0;bottom:0;right:0;left:0}html[dir=ltr] .LeftNav-sublinks-icon,html[dir=ltr] .LeftNav-sublinks-portrait{margin-right:10px}html[dir=rtl] .LeftNav-sublinks-icon,html[dir=rtl] .LeftNav-sublinks-portrait{margin-left:10px}.LeftNav-sublinks-icon{color:#094AB2}.LeftNav-sublinks-portrait{border-radius:50%;overflow:hidden;width:28px;height:28px;background-color:#a6a6a6;color:#fff;vertical-align:top;font-size:28px;margin-top:2px;position:relative;display:inline-block}.lg .LeftNav-sublinks-portrait,.md .LeftNav-sublinks-portrait,.sm .LeftNav-sublinks-portrait{height:32px;width:32px;margin-top:4px}.LeftNav-sublinks-portrait.ms-Icon--group:before{font-size:24px;display:inline-block;margin-top:7px;vertical-align:top;width:39px}html[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--group:before{padding-right:6px;text-align:right;margin-left:-6px}html[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--group:before{padding-left:6px;text-align:left;margin-right:-6px}.lg .LeftNav-sublinks-portrait.ms-Icon--group:before,.md .LeftNav-sublinks-portrait.ms-Icon--group:before,.sm .LeftNav-sublinks-portrait.ms-Icon--group:before{font-size:28px;margin-top:8px;vertical-align:top;width:46px}html[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--group:before,html[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--group:before,html[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--group:before{padding-right:6px;text-align:right;margin-left:-7px}html[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--group:before,html[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--group:before,html[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--group:before{padding-left:6px;text-align:left;margin-right:-7px}.LeftNav-sublinks-portrait img{width:28px;height:28px;position:absolute;top:0}html[dir=ltr] .LeftNav-sublinks-portrait img{left:0}html[dir=rtl] .LeftNav-sublinks-portrait img{right:0}.lg .LeftNav-sublinks-portrait img,.md .LeftNav-sublinks-portrait img,.sm .LeftNav-sublinks-portrait img{height:32px;width:32px}.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:36px}.lg.od-Browser--ie .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:42px}.lg.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:43px}.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:32px}.LeftNav-basicLink,.LeftNav-notificationLink{display:block;margin:0;padding:9px 40px;height:auto;line-height:14px;font-size:12px}.LeftNav-notificationLink.LeftNav-is-active{background-color:#f4f4f4}.lg .LeftNav-basicLink,.md .LeftNav-basicLink,.sm .LeftNav-basicLink{font-size:14px;line-height:18px;padding:11px 40px}")
});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublinkViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../LeftNavRenderStyle","./LeftNavSublink","odsp-utilities/logging/events/Engagement.event","odsp-shared/utilities/logging/LoggingHelper","../LeftNav.resx"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t){var i=this;e.call(this,t),this._linksTruncatedWithMore=o.observable(!1),this.leftNavItems=t.linkGroup,isNaN(Number(this.leftNavItems.hideLinksAfterFoldAfter))||this._linksTruncatedWithMore(!0),this.leftNavRenderedItems=this.createPureComputed(function(){if(i._linksTruncatedWithMore()&&Number(i.leftNavItems.hideLinksAfterFoldAfter)<i.leftNavItems.links().length){var e=i.leftNavItems.links().filter(function(e,t){return t<i.leftNavItems.hideLinksAfterFoldAfter});return e.push({text:l.strings.moreLabel,isActive:i.createPureComputed(function(){return!1}),isFocused:o.observable(!1),renderAs:n._More}),e}return i.leftNavItems.links()}),this.shouldMoreBeRendered=this.createPureComputed(function(){return i._linksTruncatedWithMore()&&i.leftNavItems.hideLinksAfterFoldAfter<i.leftNavItems.links().length})}return __extends(t,e),t.prototype.onClick=function(e,t){return e.engagementName&&r.Engagement.logData({name:e.engagementName+".LeftNav.Click",extraData:{action:s.capitalizeFirstLetter(t.type)}}),e.action?(e.action.execute(t),!1):!0},t.prototype.toggleMore=function(){this._linksTruncatedWithMore(!1)},t.prototype.renderMode=function(e){if(null===e.renderAs||void 0===e.renderAs)return a.LINK_TEMPLATE;switch(e.renderAs){case n.Text:return a.TEXT_TEMPLATE;case n.Load:return a.LOAD_TEMPLATE;case n.GroupLink:return a.GROUPLINK_TEMPLATE;case n._More:return a.MORE_TEMPLATE;case n.Notification:return a.NOTIFICATION_TEMPLATE;case n.IndentedLink:return a.INDENTED_TEMPLATE;case n.BasicLink:return a.BASIC_LINK_TEMPLATE;default:return a.LINK_TEMPLATE}},t}(i);return d}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavLinkTemplate.html",[],function(){return"<a role=treeitem class=\"LeftNav-subLink ms-font-m\" data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick, automationType: 'Link'\"><!--ko if: $data.icon--><i class=\"LeftNav-sublinks-icon ms-Icon\" data-bind=\"css: $data.icon.getClass()\"><!--ko if: $data.iconOverlayImageUrl--><img onerror=\"this.style.display = 'none';\" data-bind=\"attr: { src: $data.iconOverlayImageUrl }\"><!--/ko--></i><!--/ko--><span data-bind=\"text: $data.text\"></span></a>"}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavIndentedLinkTemplate.html",[],function(){return"<a role=treeitem class=\"LeftNav-subLink LeftNav-subLinkIndent ms-font-m\" data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick, automationType: 'Link'\"><span data-bind=\"text: $data.text\"></span></a>"}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavLoadTemplate.html",[],function(){return'<div class=LeftNav-loadingTemplate><!--ko component: { name: "ms-loadingSpinner", params: { "loadingText": text } }--><!--/ko--></div>'}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavTextTemplate.html",[],function(){return'<div class=LeftNav-subLinksAsText data-bind="html: $data.text"></div>'}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavGroupLinkTemplate.html",[],function(){return'<a role=treeitem tabindex=-1 class="LeftNav-subLink ms-font-m" data-bind="attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? \'_blank\' : null, \'aria-selected\': isFocused, title: $data.text }, hasFocus: isFocused, css: { \'LeftNav-is-active\': isActive, \'LeftNav-is-focused\': isFocused }, click: $component.onClick, automationType: \'Link\'"><!--ko if: $data.icon--><i class="LeftNav-sublinks-portrait ms-Icon" data-bind="css: $data.icon.getClass()"><!--ko if: $data.iconOverlayImageUrl--><img style=display:none; onload="this.style.display=\'block\'" data-bind="attr: { src: $data.iconOverlayImageUrl }"><!--/ko--></i><!--/ko--><span data-bind="text: $data.text"></span></a>'}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavNotificationLinkTemplate.html",[],function(){return"<a role=treeitem class=LeftNav-notificationLink data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: $parentContext.$parent.isLeftNavVisible() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, hasFocus: isFocused, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick, automation: $data.automationId, automationType: 'Link'\"><span data-bind=\"text: $data.text\"></span></a>"}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavMoreTemplate.html",[],function(){return"<div class=LeftNav-subLinksAsText><a href=# data-bind=\"click: $parent.toggleMore.bind($parent), attr: { tabindex: isFocused() ? 0: -1, 'aria-selected': isFocused }, text: $data.text, title: $data.text\"></a></div>"}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.html",[],function(){return"<div class=LeftNav-subLinksClip><div tabindex=-1 class=LeftNav-subLinks data-bind=\"style: { marginTop: leftNavItems.isExpanded() ? 0: ((leftNavItems.links().length * -40) + 'px') }, template: { name: renderMode, foreach: leftNavRenderedItems, as: 'linkItem' }\"></div></div>"}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavBasicLinkTemplate.html",[],function(){return"<a class=LeftNav-basicLink role=treeitem data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : '', tabindex: $parentContext.$parent.isLeftNavVisible() ? 0: -1 }, text: text, automation: $data.automationId, click: $component.onClick\"></a>"});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/loadingSpinner/LoadingSpinnerViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/DataSourceResourceKeys","../../bindings/imageLoader/ImageLoaderBinding","./LoadingSpinner","./LoadingSpinner.resx"],function(e,t,o,i,n,a,r,s){var l=function(t){function i(i){t.call(this,i),this.LoadingSpinnerTagName=r.tagName,this.loadingText=i&&void 0!==i.loadingText?i.loadingText:s.strings.LoadingText,this.addBindingHandlers({imageLoader:a}),this.isVisible=o.observable(!0),this.isImageLoaded=o.observable(!1),this.loadingImageUrl=e.toUrl(this.resources.consume(n.settings).mediaBaseUrl+"/images/loading/loadingspinner.gif")}return __extends(i,t),i.prototype.hideSpinner=function(){this.isVisible(!1)},i}(i);return l}),define("odsp-next/controls/loadingSpinner/LoadingSpinner.html",[],function(){return'<div class=od-LoadingSpinner><img class=od-LoadingSpinner-loadingGif data-bind="click: hideSpinner, visible: isVisible, attr: { text: loadingText, alt: loadingText }, imageLoader: { src: loadingImageUrl, isLoaded: isImageLoaded }"> <span class=od-LoadingSpinner-loadingText data-bind="text: loadingText"></span></div>'}),define("odsp-next/controls/loadingSpinner/LoadingSpinner.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}")}),define("odsp-next/controls/loadingSpinner/LoadingSpinner",["require","exports","./LoadingSpinnerViewModel","odsp-shared/utilities/knockout/ComponentFactory","./LoadingSpinner.html","./LoadingSpinner.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-loadingSpinner",template:e("./LoadingSpinner.html"),viewModel:o});return n}),define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink",["require","exports","./LeftNavSublinkViewModel","odsp-shared/utilities/knockout/ComponentFactory","./LeftNavLinkTemplate.html","./LeftNavIndentedLinkTemplate.html","./LeftNavLoadTemplate.html","./LeftNavTextTemplate.html","./LeftNavGroupLinkTemplate.html","./LeftNavNotificationLinkTemplate.html","./LeftNavMoreTemplate.html","./LeftNavSublink.html","./LeftNavBasicLinkTemplate.html","../LeftNav.css","../../loadingSpinner/LoadingSpinner"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-left-nav-sublink",template:e("./LeftNavSublink.html"),viewModel:o,synchronous:!0});t.LINK_TEMPLATE="ms-left-nav-link",t.LOAD_TEMPLATE="ms-left-nav-load",t.TEXT_TEMPLATE="ms-left-nav-text",t.GROUPLINK_TEMPLATE="ms-left-nav-groupLink",t.MORE_TEMPLATE="ms-left-nav-more",t.NOTIFICATION_TEMPLATE="ms-left-nav-notificationLink",t.INDENTED_TEMPLATE="ms-left-nav-indentedlink",t.BASIC_LINK_TEMPLATE="ms-left-nav-basicLink",i.registerTemplate(t.LINK_TEMPLATE,e("./LeftNavLinkTemplate.html")),i.registerTemplate(t.INDENTED_TEMPLATE,e("./LeftNavIndentedLinkTemplate.html")),i.registerTemplate(t.LOAD_TEMPLATE,e("./LeftNavLoadTemplate.html")),i.registerTemplate(t.TEXT_TEMPLATE,e("./LeftNavTextTemplate.html")),i.registerTemplate(t.GROUPLINK_TEMPLATE,e("./LeftNavGroupLinkTemplate.html")),i.registerTemplate(t.MORE_TEMPLATE,e("./LeftNavMoreTemplate.html")),i.registerTemplate(t.NOTIFICATION_TEMPLATE,e("./LeftNavNotificationLinkTemplate.html")),i.registerTemplate(t.BASIC_LINK_TEMPLATE,e("./LeftNavBasicLinkTemplate.html")),Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/controls/leftNav/LeftNav",["require","exports","./LeftNavViewModel","odsp-shared/utilities/knockout/ComponentFactory","./LeftNav.html","./LeftNav.css","./leftNavSublink/LeftNavSublink"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-left-nav",template:e("./LeftNav.html"),viewModel:o,synchronous:!0});return n}),define("odsp-next/controls/leftPane/LeftPane",["require","exports","./LeftPaneViewModel","odsp-shared/utilities/knockout/ComponentFactory","./LeftPane.html","./LeftPane.css","../search/Search","../leftNav/LeftNav"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-left-pane",template:e("./LeftPane.html"),viewModel:o,synchronous:!0});return n}),define("odsp-shared/utilities/knockout/AsyncComponentLoader",["require","exports","odsp-utilities/async/Promise","odsp-utilities/logging/RequireJSErrorHandler","knockout"],function(e,t,o,i,n){var a=function(){function e(){}return e.loadComponent=function(e,t,a){return new o.default(function(o,r){n.components.isRegistered(a)?n.components.get(a,o):e([t],o,function(e){i.log(e),r(e)})})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}),define("odsp-next/bindings/contextMenu/ContextMenuHelper",["require","exports"],function(){var e=function(){function e(e){this.items=e.items,this.rootElementClass=e.rootElementClass||null,this.boundingElementClass=e.boundingElementClass||null}return e}();return e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/contextualMenu/ContextualMenuViewModel",["require","exports","knockout","../commands/CommandViewModel","odsp-shared/base/ViewModel","../../bindings/measure/MeasureBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../bindings/beakAdorner/BeakAdornerBinding","../../bindings/contextMenu/ContextMenuAlignment","odsp-utilities/math/Point","odsp-utilities/math/Rectangle","../../utilities/locale/Locale"],function(e,t,o,i,n,a,r,s,l,d,c,u,m){var p=function(e){function t(n){var p=this;e.call(this,n),this.addBindingHandlers({selection:s,measure:a,keyboard:r,beakAdorner:l});var h=o.isObservable(n.items)?n.items:o.observableArray(n.items);this.items=h.filter(function(e){return e.isVisible()}),this.isOpen=n.isOpen||o.observable(!0),this.isSubMenu=n.isSubMenu||!1,this.isBeakVisible=n.isBeakVisible||o.observable(!0),this.isScrollable=o.observable(!1),this.offset=n.offset||o.observable(new c),this.menuRect=o.observable(),this.scrollOffset=o.observable(0),this.left=n.left||o.observable("auto"),this.top=n.top||o.observable("auto"),this.width=o.observable("auto"),this.height=o.observable("auto"),this.hasExplicitAlignment=n.hasExplicitAlignment||!1,this.allowHorizontalMenuNudging="undefined"!=typeof n.allowHorizontalMenuNudging?n.allowHorizontalMenuNudging:!0,this.allowVerticalMenuNudging="undefined"!=typeof n.allowVerticalMenuNudging?n.allowVerticalMenuNudging:!0,this.isActive=o.observable(!1),this.focusedItem=o.observable(),this.selectedItems=o.observableArray(),this.subMenuItems=o.observableArray(),this.subMenuIsOpen=o.observable(!1),this.subMenuIsBeakVisible=o.observable(!1),this.subMenuOffset=o.observable(new c),this.target=n.target,this.bounds=n.bounds,this.displayInputElements=o.observable(!1),this.alignment=n.alignment?"string"==typeof n.alignment?o.observable(d[n.alignment]):o.isObservable(n.alignment)?n.alignment:o.observable(n.alignment):o.observable(d.Left|d.Top);var g=new i({children:this.items});this.addDisposable(this.items.map({mappingWithDisposeCallback:function(e){return e.parentCommand=g,{mappedValue:e,dispose:function(){e.parentCommand=null}}}})),this.computedOffset=this.createComputed(function(){var e=new c(0,0),o=p.bounds||new u(0,0,document.body.clientWidth,document.body.clientHeight),i="auto",n="auto",a=!1;if(p.menuRect()){e=e.add(p.offset());var r=p.alignment();p.hasExplicitAlignment||(r=t.determineBestFitAlignment(p.menuRect().translate(e),r,o)),e=t.transformMenuCoordinate(e,p.menuRect(),r);var s=p.menuRect().translate(e);if(!o.contains(s)){var l=s;if(p.allowHorizontalMenuNudging||p.allowVerticalMenuNudging){var d=s.nudge(o);l=new u(p.allowHorizontalMenuNudging?d.x:s.x,p.allowVerticalMenuNudging?d.y:s.y,s.width,s.height)}o.contains(l)||(l=l.clip(o),i=l.width+"px",n=l.height+"px",a=!0),e=e.add(new c(l.x-s.x,l.y-s.y))}}return p.width(i),p.height(n),p.isScrollable(a),e}),this.offsetLeft=this.createComputed(function(){return Math.floor(p.computedOffset().x)+"px"}),this.offsetTop=this.createComputed(function(){return Math.floor(p.computedOffset().y)+"px"}),this.measurementReady=function(e){p.async.setImmediate(function(){return p.displayInputElements(!0)}),p.menuRect(e)},this.scrolled=function(e,t){p.closeAnySubMenus(),p.scrollOffset(t.target.scrollTop)},this.hasItemWithCheckbox=this.createComputed(function(){return p.items().some(function(e){return e.isVisible()&&e.isToggleable})}),this.hasItemWithIcon=this.createComputed(function(){return p.items().some(function(e){return e.isVisible()&&(Boolean(e.icon)&&Boolean(e.icon())||Boolean(e.iconUrl)&&Boolean(e.iconUrl()))})}),this.createComputed(function(){if(p.isOpen()&&p.menuRect()){var e=p.items.peek();e.forEach(function(e){e.isOpen(!1)}),p.isActive(!0);var o=t.activeMenu;!p.isSubMenu&&o&&o.isOpen.peek()&&o.isOpen(!1),p.isSubMenu||(t.activeMenu=p)}else p.isOpen()||t.activeMenu!==p||(t.activeMenu=null)}),this.addDisposable({dispose:function(){t.activeMenu===p&&(t.activeMenu=null)}});var f=this.createComputed(function(){for(var e=p.items(),t=0,o=e.length;o>t;t++){var i=e[t];if(i.isOpen())return i}return null});this.addDisposable(f.subscribe(function(e){if(e){p.subMenuItems(e.children());var o=p.menuRect().translate(p.offset()),i=e.bounds().translate(o.getPoint().negate()),n=new c(0,i.y-p.scrollOffset()+t.subMenuMargin.y);p.subMenuAlignment=d.Top,m.isRightToLeft?(p.subMenuAlignment|=d.Right,n.x-=t.subMenuMargin.x):(p.subMenuAlignment|=d.Left,n.x+=o.width,n.x+=t.subMenuMargin.x),p.subMenuBounds=p.bounds,p.subMenuOffset(n),p.subMenuIsOpen(!0)}else p.subMenuIsOpen(!1)}))}return __extends(t,e),t.determineBestFitAlignment=function(e,o,i){var n=o,a=e.getPoint();if(e.width<=i.width&&e.height<=i.height){var r=t.transformMenuCoordinate(a,e,n);(r.x<i.x||r.x+e.width>i.getRight())&&(n^=d.Right),(r.y<i.y||r.y+e.height>i.getBottom())&&(n^=d.Bottom)}return n},t.transformMenuCoordinate=function(e,t,o){var i=new c(e.x,e.y);return o&d.Right?i.x-=t.width:o&d.Center&&(i.x-=t.width/2),o&d.Bottom?i.y-=t.height:o&d.VerticalCenter&&(i.y-=t.height/2),i},t.prototype.onEnter=function(e,t){var o=this.focusedItem();if(o){for(var i,n=t.target.getElementsByClassName("ms-ContextualMenu-item"),a=0;a<n.length&&(i=n[a],i.textContent!==o.label());a++)i=null;i&&i.click.apply(i)}},t.prototype.onClick=function(e,t){0===e.children().length&&this.dismiss(),e.onClick(e,t)},t.prototype.dismiss=function(){return t.activeMenu&&t.activeMenu.isOpen(!1),this.target&&this.target.focus(),!1},t.prototype.itemHover=function(e){this.focusedItem(e),this.selectedItems([e])},t.prototype.itemLongHover=function(e){this.closeAnySubMenus(),!e.isCollapsed()&&e.children().length>0&&e.isOpen(!0)},t.prototype.mouseOut=function(){this.focusedItem(null)},t.prototype.navigateLeft=function(){m.isRightToLeft?this.navigateFar():this.navigateNear()},t.prototype.navigateRight=function(){m.isRightToLeft?this.navigateNear():this.navigateFar()},t.prototype.closeAnySubMenus=function(){this.items().forEach(function(e){e.isOpen(!1)})},t.prototype.navigateNear=function(){this.isOpen(!1)},t.prototype.navigateFar=function(){var e=this.focusedItem();e&&e.hasVisibleChildren()?e.isOpen(!0):this.isOpen(!1)},t.subMenuMargin=new c(4,-1),t}(n);return p}),define("odsp-next/controls/contextualMenu/ContextualMenu.html",[],function(){return"<div tabindex=0 role=menu class=\"ms-ContextualMenu ContextualMenu\" data-bind=\"css: { 'is-open': isOpen, 'has-icon': hasItemWithIcon, 'has-checkbox': hasItemWithCheckbox }, style: { left: left, top: top, marginLeft: offsetLeft, marginTop: offsetTop }, selection: { data: items, mode: 'single', direction: 'vertical', focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: true, selectFirstItemOnActivate: false }, hasFocus: isActive, keyboard: { mappings: { Left: navigateLeft, Right: navigateRight, Enter: onEnter, Esc: dismiss }, preventDefault: true }, beakAdorner: { isVisible: isBeakVisible, trigger: computedOffset }, event: { mouseout: mouseOut }, visible: items().length > 0\"><!--ko if: subMenuIsOpen--><!--ko component: { name: 'ms-contextual-menu', params: { items: subMenuItems, isOpen: subMenuIsOpen, left: '0px', top: '0px', offset: subMenuOffset, isBeakVisible: subMenuIsBeakVisible, hasExplicitAlignment: true, alignment: subMenuAlignment, isSubMenu: true, bounds: subMenuBounds } }--><!--/ko--><!--/ko--><div data-bind=\"foreach: items, css: { 'ContextualMenu-scrollable': isScrollable }, style: { width: width, height: height }, measure: measurementReady, event: { scroll: scrolled }\"><!--ko if: hasLineBreakBefore && ($index() > 0)--><hr><!--/ko--><div class=\"od-ContextualMenu-itemContainer ms-ContextualMenu-itemContainer command\" role=menuitemcheckbox data-bind=\"event: { mouseover: $parent.itemHover.bind($parent, $data) }, hasFocus: focused, longHover: { callback: $parent.itemLongHover.bind($parent, $data) }, attr: { tabindex: tabindex, 'aria-label': label, 'aria-checked': isToggled }\"><a tabindex=-1 class=\"od-ContextualMenu-item ms-ContextualMenu-item\" data-bind=\"measure: { measure: $data.measurementReady, async:true }, attr: { 'href': url, 'title': tooltip }, click: $parent.onClick.bind($parent), css: { 'is-focused': focused, 'isChecked': isToggleable && isToggled }, automation: automationId + '-link'\"><!--ko if: $parent.hasItemWithCheckbox--><span class=\"ContextualMenu-itemCheck ms-Icon\" data-bind=\"css: { 'isChecked': isToggled }\"></span><!--/ko--><!--ko if: $parent.hasItemWithIcon--><!--ko if: $data.icon--><i data-bind=\"css: getIcon('ContextualMenu-icon ms-Icon')\"></i><!--/ko--><!--ko if: !$data.icon && $data.iconUrl--><i data-bind=\"css: 'ContextualMenu-icon ms-Icon ms-Icon--custom', style: { backgroundImage: 'url(\\'' + iconUrl() + '\\')' }\"></i><!--/ko--><!--/ko--><span class=ContextualMenu-text><span class=ContextualMenu-commandText data-bind=\"text: label\"></span><!--ko if: subtext--><br><span class=ContextualMenu-commandSubtext data-bind=\"text: subtext\"></span><!--/ko--></span><!--ko if: visibleChildren().length && !hidesMenuChevron && !isCollapsed()--><i data-bind=\"css: getChevron('ContextualMenu-chevron ms-Icon')\"></i><!--/ko--></a><!--ko if: $component.displayInputElements--><!--ko if: targetCommand().isFileUpload--><div class=ContextualMenu-uploadInput data-bind=\"automation: 'fileInput' + $index()\"><input class=ContextualMenu-fileInput data-bind=\"element: fileInputElement, event: { change: onInputChange }\" type=file multiple></div><!--/ko--><!--ko if: targetCommand().isFolderUpload--><div class=ContextualMenu-uploadInput data-bind=\"automation: 'fileInput' + $index()\"><input class=ContextualMenu-folderInput data-bind=\"element: fileInputElement, event: { change: onInputChange }\" type=file webkitdirectory directory></div><!--/ko--><!--/ko--><!--ko if: targetCommand().isSilverlightFileUpload--><!--ko component: { name: 'ms-silverlight-upload' }--><!--/ko--><!--/ko--><!--ko if: targetCommand().isDownlevelFileUpload--><!--ko component: { name: 'ms-downlevel-upload', params: { isOpen: $parent.isOpen, classToFind: 'od-ContextualMenu-itemContainer' } }--><!--/ko--><!--/ko--></div><!--ko if: hasLineBreakAfter && ($index() < ($parent.items().length - 1))--><hr><!--/ko--></div></div>"}),define("odsp-next/controls/contextualMenu/ContextualMenu.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".ContextualMenu.ContextualMenu:focus,.ms-ContextualMenu-itemContainer:focus,a.od-ContextualMenu-item:focus{outline:transparent solid 1px}.ContextualMenu.ContextualMenu{min-width:180px;width:auto}.ContextualMenu.ContextualMenu.is-open{width:auto}.od-theme--darkTransparent .ContextualMenu.ContextualMenu.is-open{background-color:rgba(0,0,0,.7);color:#fff;border-color:rgba(0,0,0,.7)}html[dir=ltr] .ContextualMenu.ContextualMenu.has-icon .od-ContextualMenu-item{padding-left:40px}html[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .od-ContextualMenu-item{padding-right:40px}.ContextualMenu.ContextualMenu.has-icon .ContextualMenu-commandText{display:inline-block;vertical-align:top;margin-top:2px}html[dir=ltr] .ContextualMenu.ContextualMenu.has-icon .ContextualMenu-commandText{margin-left:13px}html[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .ContextualMenu-commandText{margin-right:13px}html[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .ms-Icon{margin-right:-32px}html[dir=ltr] .ContextualMenu.ContextualMenu.has-icon .ms-Icon{margin-left:-32px;margin-right:0}html[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .ms-Icon{margin-left:0}html[dir=ltr] .ContextualMenu.ContextualMenu.has-checkbox .od-ContextualMenu-item{padding-left:27px}html[dir=rtl] .ContextualMenu.ContextualMenu.has-checkbox .od-ContextualMenu-item{padding-right:27px}html[dir=ltr] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ms-Icon{margin-left:1px}html[dir=rtl] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ms-Icon{margin-right:1px}html[dir=ltr] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-commandText{margin-left:2px}html[dir=rtl] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-commandText{margin-right:2px}.ContextualMenu-commandSubtext{font-size:12px;white-space:normal}.ContextualMenu-itemCheck:before{display:block;height:14px;position:absolute;top:12px;width:14px}html[dir=ltr] .ContextualMenu-itemCheck:before{left:0;margin-left:20px}html[dir=rtl] .ContextualMenu-itemCheck:before{right:0;margin-right:20px}.ContextualMenu-itemCheck.isChecked{background-color:#094AB2}.ContextualMenu-itemCheck.isChecked:after{content:'\\e041';color:#666;font-size:14px;line-height:8px;position:absolute;top:14px}html[dir=ltr] .ContextualMenu-itemCheck.isChecked:after{left:6px}html[dir=rtl] .ContextualMenu-itemCheck.isChecked:after{right:6px}.ContextualMenu-scrollable{overflow-y:auto}.ms-ContextualMenu-itemContainer{position:relative}.od-focus--enabled .selection-active .od-ContextualMenu-itemContainer:focus a.od-ContextualMenu-item:before{content:'';position:absolute;width:100%;height:38px;top:1%;border:1px solid #767676}html[dir=ltr] .od-focus--enabled .selection-active .od-ContextualMenu-itemContainer:focus a.od-ContextualMenu-item:before{left:-1px}html[dir=rtl] .od-focus--enabled .selection-active .od-ContextualMenu-itemContainer:focus a.od-ContextualMenu-item:before{right:-1px}a.od-ContextualMenu-item{background-color:#fff;cursor:pointer;display:block;overflow:visible;padding:10px 20px;text-decoration:none;white-space:nowrap;color:#333;position:relative}html[dir=ltr] a.od-ContextualMenu-item{text-align:left}html[dir=rtl] a.od-ContextualMenu-item{text-align:right}.od-theme--darkTransparent a.od-ContextualMenu-item{background-color:rgba(0,0,0,.7);color:#fff}.od-theme--darkTransparent a.od-ContextualMenu-item:focus{border:1px solid #c8c8c8}a.od-ContextualMenu-item:active,a.od-ContextualMenu-item:hover{background-color:#e6f2fb;color:#000}a.od-ContextualMenu-item:active .ContextualMenu-chevron,a.od-ContextualMenu-item:hover .ContextualMenu-chevron{color:#212121}.od-theme--darkTransparent a.od-ContextualMenu-item:active,.od-theme--darkTransparent a.od-ContextualMenu-item:hover{color:#fff}.od-theme--darkTransparent a.od-ContextualMenu-item:hover{background-color:rgba(102,102,102,.6)}.od-theme--darkTransparent a.od-ContextualMenu-item:active{background-color:#666}a.od-ContextualMenu-item.isChecked{font-family:'Segoe UI Semibold WestEuropean','Segoe UI Semibold','Segoe WP Semibold','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-weight:600}a.od-ContextualMenu-item .ContextualMenu-chevron{position:absolute;margin:0;top:13px;font-size:17px;color:#333}html[dir=ltr] a.od-ContextualMenu-item .ContextualMenu-chevron{right:0;margin-right:6px}html[dir=rtl] a.od-ContextualMenu-item .ContextualMenu-chevron{left:0;margin-left:6px}a.od-ContextualMenu-item .ms-Icon--circleInfo{margin-top:2px}a.od-ContextualMenu-item .ms-Icon--excel:before{color:#217346;font-size:20px}a.od-ContextualMenu-item .ms-Icon--onenote:before{color:#5c2d91;font-size:20px}a.od-ContextualMenu-item .ms-Icon--powerpoint:before{color:#d24726;font-size:20px}a.od-ContextualMenu-item .ms-Icon--word:before{color:#2b579a;font-size:20px}.ContextualMenu-icon{color:#094AB2;font-size:18px;width:20px;vertical-align:middle}.od-theme--darkTransparent .ContextualMenu-icon{color:#fff}.ms-Icon--custom{width:20px;height:20px;background-size:cover}.selection-active .od-ContextualMenu-item.is-focused{background-color:#e6f2fb;color:#000}.ContextualMenu hr{border:none;border-bottom:1px solid #eaeaea;margin:0}.ContextualMenu-childMenuContainer{display:inline-block}.ContextualMenu-uploadInput{position:absolute;top:0;bottom:0;left:0;right:0;opacity:.0001;cursor:pointer;overflow:hidden;z-index:9999999}.ContextualMenu-uploadInput input{position:absolute;top:0;font-size:200px;height:100px;cursor:pointer;margin:0;padding:0}html[dir=ltr] .ContextualMenu-uploadInput input{right:0}html[dir=rtl] .ContextualMenu-uploadInput input{left:0}.od--hasSelection .CommandBar{background-color:transparent}.od--hasSelection .CommandBar .ContextualMenu-icon{color:#094AB2}.od-theme--darkTransparent .od--hasSelection .CommandBar .ContextualMenu-icon{color:#fff}")}),define("odsp-next/controls/contextualMenu/ContextualMenu",["require","exports","./ContextualMenuViewModel","odsp-shared/utilities/knockout/ComponentFactory","./ContextualMenu.html","./ContextualMenu.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-contextual-menu",template:e("./ContextualMenu.html"),viewModel:o});return n}),define("odsp-next/bindings/contextMenu/ContextMenuBinding",["require","exports","knockout","odsp-utilities/domUtils/DomUtils","odsp-shared/utilities/knockout/LocalBindingProvider","../dismiss/DismissBinding","./ContextMenuAlignment","../../resources/ControlResourceKeys","odsp-shared/utilities/knockout/ResourceComponentLoader","../../utilities/locale/Locale","odsp-utilities/math/Point","odsp-utilities/math/Rectangle","../../controls/contextualMenu/ContextualMenu"],function(e,t,o,i,n,a,r,s,l,d,c,u){var m=function(){function e(){}return e.init=function(t,o,i,n,a){e.registerEventHandler(t,o,i,o,a)},e.update=function(t,o,i,n,a){e.registerEventHandler(t,o,i,o,a)},e.registerEventHandler=function(t,n,a,r,d){var c=o.utils.unwrapObservable(n()),u=l.getCurrentResourceScope(d),m=u.consume(s.itemsSelection),p=function(){e._contextMenu&&(o.removeNode(e._contextMenu),e._contextMenu=null)};o.utils.registerEventHandler(t,"contextmenu",function(t){p();var n=t.target,a=o.dataFor(n),r=null;if(i.hasClass(n,"noContextMenu")||t.shiftKey||!c)return!0;for(e._parentElement=i.findAncestor(n,c.rootElementClass);n!==e._parentElement&&a&&(!r&&a.item&&(r=a.item),!r);)n=i.getParent(n),a=n?o.dataFor(n):null;return m&&a&&(r&&m.isItemSelected(r)||(m.clear(),r&&a.isSelected&&(m.toggleItemSelected(r),m.setItemFocus(r)))),c&&r?(e._parentElement&&(e._contextMenu=e.createContextMenu(t,c,d,p)),t.preventDefault(),t.stopPropagation(),!1):!0})},e.createContextMenu=function(e,t,s,l){var m=null,p=i.findAncestor(e.target,t.rootElementClass);if(p&&t.rootElementClass&&t.items&&t.items.length>0){var h;if(e.clientX<=0&&e.clientY<=0||!Boolean(e.clientX)&&!Boolean(e.clientY)){var g=e.target.getBoundingClientRect();h=new c(g.left,g.bottom)}else h=new c(e.clientX,e.clientY);var f=p.getBoundingClientRect();h.x-=f.left,h.y-=f.top;var b=o.observable(h.x+"px"),v=o.observable(h.y+"px"),x=t.alignment||r.Left|r.Top;d.isRightToLeft&&(x|=r.Right);var y=null;if(t.boundingElementClass){var C=i.findAncestor(e.target,t.boundingElementClass);y=new u(C.getBoundingClientRect())}var S=document.createElement("div");m=S,p.appendChild(S);var k={component:{name:"ms-contextual-menu",params:{items:t.items,left:b,top:v,alignment:o.observable(x),offset:o.observable(t.point||c.ORIGIN),target:e.target,bounds:y}}};l||(l=function(){m&&(o.removeNode(m),m=null)}),k[n.getInstance().getUniqueKeyForBindingHandler(a,"dismiss")]={close:l,dismissOnResize:!0},o.applyBindingsToNode(S,k,s)}return m},e}();return m}),define("odsp-next/bindings/autoScroll/AutoScrollBinding",["require","exports","knockout","odsp-utilities/async/Async"],function(e,t,o,i){var n=100,a=30,r=15,s=function(){function e(){}return e.init=function(e,t){function s(){var t=d.enabled();if(c.clearTimeout(l),l=null,t){var o=e.getBoundingClientRect(),i=d.y(),u=o.top,m=u+o.height,p=0;u+n>=i?p=-(1-(i-o.top)/n):i>=m-n&&(p=1-(o.top+o.height-i)/n)}p&&(e.scrollTop=Math.min(e.scrollHeight-o.height,Math.max(0,e.scrollTop+p*r)),l=c.setTimeout(s,a))}var l,d=o.utils.unwrapObservable(t()),c=new i,u=o.computed(s);o.utils.domNodeDisposal.addDisposeCallback(e,function(){u.dispose(),c.dispose()})},e}();return s}),define("odsp-next/bindings/selection/MarqueeSelection.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-MarqueeSelection{position:absolute;z-index:4500;top:0;left:0;width:100%;min-height:100%;background:rgba(255,0,0,0);cursor:default}.od-MarqueeSelection-box{position:absolute;box-sizing:border-box;border:1px solid #3a96dd;background-color:rgba(58,150,221,.1)}")});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/selection/MarqueeSelectionBinding",["require","exports","knockout","../BaseBinding","../../models/selection/BaseSelectionModel","odsp-utilities/math/Rectangle","odsp-utilities/math/Point","../../utilities/locale/Locale","odsp-utilities/domUtils/DomUtils","../../resources/ControlResourceKeys","../../resources/UtilityResourceKeys","./MarqueeSelection.css"],function(e,t,o,i,n,a,r,s,l,d,c){var u=5,m=40,p=function(e){function t(t){e.call(this,t);
var i=t.valueAccessor();this._selectionModel=i.selectionModel,this._layout=i.layout||o.observable(null),this._offsetElementClass=i.offsetElementClass,this._throttledEvaluateSelection=this.async.throttle(this._evaluateSelection,m),this._isSelecting=i.isSelecting||o.observable(!1),this._yOffset=i.yOffset||o.observable(0),this._canUserSelect=this.resources.consume(d.canUserSelect)||o.observable(!0),this._isMobile=this.resources.consume(c.platformDetection).isMobile,this.events.on(this.element,"mousedown",this._onMouseDown)}return __extends(t,e),t.prototype._getRegion=function(e,t){var o=this.element.getBoundingClientRect(),i=this.element.scrollTop,n=this.element.scrollLeft,r=Math.max(o.left,t.clientX),s=Math.max(o.top,t.clientY),l=new a(Math.min(e.x,r+n)-o.left,Math.min(e.y,Math.max(0,s)+i)-o.top,Math.abs(r+n-e.x),Math.abs(s+i-e.y));return l.x=Math.max(0,l.x),l.y=Math.max(0,l.y),l.width=Math.min(o.width-l.x,l.width),l.height=Math.min(this.element.scrollHeight-l.y,l.height),l},t.prototype._getOffsetRegion=function(e){var t=new a(e);if(this._offsetElementClass){var o=this.element.getElementsByClassName(this._offsetElementClass)[0];if(o){var i=this.element.getBoundingClientRect(),n=o.getBoundingClientRect();t.x-=n.left-i.left+this.element.scrollLeft,t.y-=n.top-i.top+this.element.scrollTop,s.isRightToLeft&&(t.x=n.width-t.x-t.width)}}return t},t.prototype._canSelect=function(e){var t=this._layout();return!!t&&!this._isMobile&&this._selectionModel.mode===n.SelectionMode.multiple&&!this._selectionModel.isIndexSelected(t.getItemIndicesInRegion(e)[0])&&this._canUserSelect()},t.prototype._onScroll=function(){this._marqueeBox&&(this._onMouseMove(this._lastMouseEvent),this._throttledEvaluateSelection())},t.prototype._onMouseDown=function(e){if(1===e.buttons){var t=new r(e.clientX,e.clientY+this.element.scrollTop),o=this._getRegion(t,e),i=this._getOffsetRegion(o);this._marqueeBox||!this._canSelect(i)||this._isClickInScrollBar(e)||(this._downPoint=t,this._lastMouseEvent=e,this._downPoint=new r(e.clientX,e.clientY+this.element.scrollTop),this._shouldClearSelection=!e.shiftKey,this.events.on(window,"mousemove",this._onMouseMove),this.events.on(window,"mouseup",this._onMouseUp),this.events.on(this.element,"scroll",this._onScroll))}},t.prototype._isClickInScrollBar=function(e){if(s.isRightToLeft)return e.clientX<this.element.clientLeft;var t=this.element.getClientRects()[0];return e.clientX>this.element.clientWidth+t.left},t.prototype._initializeDrag=function(e){this._marqueeArea=l.ce("div",{"class":"od-MarqueeSelection"}),this._marqueeBox=l.ce("div",{"class":"od-MarqueeSelection-box"}),this._shouldClearSelection&&this._selectionModel.clear(),this._isSelecting(!0),this._onMouseMove(e),this._marqueeArea.appendChild(this._marqueeBox),this.element.appendChild(this._marqueeArea),this._canUserSelect(!1)},t.prototype._onMouseMove=function(e){if(1!==e.buttons)return void this._onMouseUp(e);if(this._downPoint&&!this._marqueeBox){var t=Math.abs(e.clientX-this._downPoint.x),o=Math.abs(e.clientY+this.element.scrollTop-this._downPoint.y);(t>u||o>u)&&this._initializeDrag(e)}if(this._marqueeBox){this._marqueeArea.style.height=this.element.scrollHeight+"px",this._lastMouseEvent=e;var i=this._getRegion(this._downPoint,e),n=this._marqueeBox.style;return this._yOffset(e.clientY),n.left=i.x+"px",n.top=i.y+"px",n.width=i.width+"px",n.height=i.height+"px",this._lastRegion=i,this._throttledEvaluateSelection(),!1}},t.prototype._evaluateSelection=function(){var e=this._lastRegion,t=this._getOffsetRegion(e),o=this._layout();if(o){for(var i=o.getItemIndicesInRegion(t),n=this._lastIndicesInRegion||[],a=0;a<i.length;a++){for(var r=i[a];n.length&&n[0]!==r;)this._selectionModel.setIndexSelected(n[0],!1),n.shift();n.length?n.shift():this._selectionModel.setIndexSelected(i[a],!0)}for(;n.length;)this._selectionModel.setIndexSelected(n[0],!1),n.shift()}this._lastIndicesInRegion=i},t.prototype._onMouseUp=function(e){return 0===e.button?(this._marqueeBox&&this.element.removeChild(this._marqueeArea),this._isSelecting(!1),this._lastIndicesInRegion=this._downPoint=this._marqueeArea=this._marqueeBox=null,this.events.off(window,"mousemove",this._onMouseMove),this.events.off(window,"mouseup",this._onMouseUp),this.events.off(this.element,"scroll",this._onScroll),this._canUserSelect(!0),!1):void 0},t}(i);return p}),define("odsp-next/dataSources/url/PhotoType",["require","exports"],function(){var e;return function(e){e[e.AllMyPhotos=0]="AllMyPhotos",e[e.Albums=1]="Albums",e[e.allTags=2]="allTags",e[e.allPlaces=3]="allPlaces",e[e.allPeople=4]="allPeople",e[e.singleAlbum=5]="singleAlbum",e[e.singleTag=6]="singleTag",e[e.singlePlace=7]="singlePlace",e[e.singlePerson=8]="singlePerson"}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/emptyFolder/EmptyFolderViewModel",["require","exports","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../dataSources/url/QueryType","../../dataSources/url/PhotoType","odsp-shared/utilities/string/StringHelper","./EmptyFolder.resx"],function(e,t,o,i,n,a,r,s,l){var d="/images/emptyfolder/empty_",c='<i class="EmptyFolder-icon ms-Icon--plus" ></i>',u="Music",m=function(t){function o(o){var a=this;void 0===o&&(o={}),t.call(this,o);var r=o.isViewOnly,s=void 0===r?!1:r;this._isViewOnly=s,this._urlDataSource=this.resources.consume(n.url),this._viewParams=this.resources.consume(i.viewParams),this._item=this.resources.consume(i.currentItem),this._mediaBaseUrl=e.toUrl(this.resources.consume(n.settings).mediaBaseUrl+d),this._content=this.createPureComputed(this._computeContent),this.subText=this.createPureComputed(function(){return a._content().subText}),this.subTextPostIcon=this.createPureComputed(function(){return a._content().subTextPostIcon}),this.subTextMobile=this.createPureComputed(function(){return a._content().subTextMobile||a._content().subText}),this.title=this.createPureComputed(function(){return a._content().title}),this.url=this.createPureComputed(function(){return a._content().url})}return __extends(o,t),o.prototype.HasInsertPermission=function(){return!this._isViewOnly},o.prototype._computeContent=function(){var e,t=this._item(),o=t.queryType,i=this.HasInsertPermission();switch(o){case a.Recent:e={url:this._mediaBaseUrl+"recent.svg",title:l.strings.emptyRecentTitle,subText:l.strings.emptyRecentSubText};break;case a.RecycleBin:e={url:this._mediaBaseUrl+"recycle.svg",title:l.strings.emptyRecycleBinTitle,subText:l.strings.emptyRecycleBinSubText};break;case a.Search:e={url:this._mediaBaseUrl+"search.svg",title:l.strings.emptySearchTitle,subText:l.strings.emptySearchSubText};break;case a.SharedWithMe:case a.SharedWithMeODB:e={url:this._mediaBaseUrl+"shared.svg",title:l.strings.emptySharedTitle,subText:l.strings.emptySharedSubText};break;case a.DocsInCommon:e={url:this._mediaBaseUrl+"shared.svg",title:l.strings.emptyDocsInCommonTitle,subText:l.strings.emptyDocsInCommonSubText};break;case a.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:for(var n=!1;t&&t.parent;)t.specialFolderCanonicalName===u&&(n=!0),t=t.parent;if(n){e={url:this._mediaBaseUrl+"music.svg",title:l.strings.emptyMusicFolderTitle,subText:i&&l.strings.emptyMusicFolderSubText||"",subTextMobile:i&&s.format(l.strings.emptyMusicFolderMobileSubText,c)||""};break}e={url:this._mediaBaseUrl+"folder.svg",title:l.strings.emptyFolderTitle,subText:i&&l.strings.emptyFolderSubText||"",subTextMobile:i&&s.format(l.strings.emptyFolderMobileSubText,c)}}return e},o.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams(),o=this._urlDataSource.getPhotoType(t);switch(o){case r.singleAlbum:e={url:this._mediaBaseUrl+"album.svg",title:l.strings.emptyAlbumsListTitle,subText:l.strings.emptyAlbumsListSubText};break;case r.Albums:e={url:this._mediaBaseUrl+"albumview.svg",title:l.strings.emptyAlbumsListTitle,subText:l.strings.emptyAlbumsListSubText};break;case r.allTags:e={url:this._mediaBaseUrl+"tags.svg",title:l.strings.emptyPhotosTagsTitle,subText:s.format(l.strings.emptyPhotosTagsSubTextFormat,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>")};break;case r.allPlaces:e={url:this._mediaBaseUrl+"photos.svg",title:l.strings.emptyAllPhotosTitle,subText:""};break;default:e={url:this._mediaBaseUrl+"photos.svg",title:l.strings.emptyAllPhotosTitle,subText:""}}return e},o}(o);return m});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/emptyFolder/odb/EmptyFolderViewModel",["require","exports","../EmptyFolderViewModel","../../../actions/odb/PermissionMask","../../../resources/ControlResourceKeys"],function(e,t,o,i,n){var a=function(e){function t(t){e.call(this,t);var o=t.layoutIterationObservable;if(Boolean(o)){var i=o.peek();o(i+1)}}return __extends(t,e),t.prototype.HasInsertPermission=function(){var e=this.resources.consume(n.currentItem)();return i.hasItemPermission(e,i.InsertListItems)},t}(o);return a}),define("odsp-next/controls/emptyFolder/EmptyFolder.html",[],function(){return'<div class=EmptyFolder><div class=EmptyFolder-image><img id=emptyFolderImg data-bind="attr: { src: url }"></div><div class=EmptyFolder-title data-bind="text: title"></div><div class=EmptyFolder-subText><span class=EmptyFolder-pc data-bind="html: subText"></span> <span class=EmptyFolder-mobile data-bind="html: subTextMobile"></span></div></div>'}),define("odsp-next/controls/emptyFolder/EmptyFolder.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".EmptyFolder-subText,.EmptyFolder-title{max-width:400px;margin:0 auto;font-weight:400}.EmptyFolder{text-align:center}.EmptyFolder-image{padding-top:52px;height:208px;width:208px;margin:0 auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title,html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0}.EmptyFolder-title{font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:21px;color:#666}.md .EmptyFolder-title,.sm .EmptyFolder-title{color:#333;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.EmptyFolder-subText{padding:6px 16px 0;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;color:#666}html[dir=rtl] .EmptyFolder-subText{padding:6px 16px 0}.EmptyFolder-icon{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Office365Icons;font-style:normal;font-weight:400;line-height:1;speak:none;display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}")}),define("odsp-next/controls/emptyFolder/odb/EmptyFolder",["require","exports","./EmptyFolderViewModel","odsp-shared/utilities/knockout/ComponentFactory","../EmptyFolder.html","../EmptyFolder.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-odb-empty-folder",template:e("../EmptyFolder.html"),viewModel:o});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/error/ErrorViewModel",["require","exports","odsp-shared/base/ViewModel","../../resources/DataSourceResourceKeys","../../dataSources/item/ItemDataSource.resx","odsp-utilities/logging/ErrorHelper","../../resources/UtilityResourceKeys","odsp-shared/utilities/string/StringHelper"],function(e,t,o,i,n,a,r,s){var l=n.strings,d=4,c="/images/error/error",u=function(t){function o(o){t.call(this,o),this._urlDataSource=this.resources.consume(i.url);var n=o.error;this.errorTitle=n&&n.errorTitle||l.DefaultTitle,this.errorDetailedText=n&&n.errorDetailedText||l.DefaultSubText,this.actionText=n&&n.actionText||l.DefaultActionText,this.showErrorCode=n&&n.errorCode&&this.errorTitle===l.DefaultTitle,this.showErrorCode?(a.log(n,"ServerError",n.errorCode),this.errorCodeText=s.format(l.errorCodeText,n.errorCode)):this.errorCodeText="",this.actionUrl=n&&n.actionUrl||this._urlDataSource.getRootUrl(),this._mediaBaseUrl=e.toUrl(this.resources.consume(i.settings).mediaBaseUrl+c),this.imageUrl=this._getRandomImage()}return __extends(o,t),o.prototype.onButtonClick=function(){var e=this.resources.consume(r.navigation);return e.navigateTo(this.actionUrl),!1},o.prototype._getRandomImage=function(){var e=Math.ceil(Math.random()*d);return this._mediaBaseUrl+e+".svg"},o}(o);return u}),define("odsp-next/controls/error/Error.html",[],function(){return'<div class=Error><div class=Error-image><img data-bind="attr:{src: imageUrl}"></div><div class=Error-title data-bind="text: errorTitle"></div><div class=Error-subText data-bind="text: errorDetailedText"></div><form class=Error-button data-bind="attr:{action: actionUrl}" method=get><button class=ms-Button data-bind="click: onButtonClick"><span class=ms-Button-label data-bind="text: actionText"></span></button></form><div class="Error-code ms-font-s" data-bind="visible: showErrorCode, text: errorCodeText"></div></div>'}),define("odsp-next/controls/error/Error.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".Error-subText,.Error-title{max-width:400px;margin:0 auto}.Error{text-align:center}.Error-image{padding-top:52px;height:208px;width:208px;margin:0 auto}.md .Error-image,.sm .Error-image{padding-top:20px;height:168px;width:168px}.Error-title,html[dir=rtl] .Error-title{padding:16px 16px 0}.Error-title{font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;color:#666}.Error-subText,html[dir=rtl] .Error-subText{padding:6px 16px 0}.md .Error-title,.sm .Error-title{color:#333;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.Error-button,.Error-subText{font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.Error-subText{color:#666}.Error-code{padding-top:8px;color:#a6a6a6}.Error-button{padding-top:16px;color:#333}")}),define("odsp-next/controls/error/Error",["require","exports","./ErrorViewModel","odsp-shared/utilities/knockout/ComponentFactory","./Error.html","./Error.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-error",template:e("./Error.html"),viewModel:o,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/standaloneList/StandaloneListViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../resources/ControlResourceKeys","../../resources/UtilityResourceKeys","../../resources/PagesResourceKeys","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","odsp-utilities/events/EventGroup","odsp-utilities/async/RequireHelper","odsp-utilities/domUtils/DomUtils","odsp-shared/utilities/knockout/AsyncComponentLoader","../../bindings/contextMenu/ContextMenuHelper","../../bindings/contextMenu/ContextMenuBinding","../../bindings/autoScroll/AutoScrollBinding","../../bindings/selection/MarqueeSelectionBinding","../../bindings/dragAndDrop/DragAndDropBinding","../list/layouts/LayoutType","../emptyFolder/odb/EmptyFolder","../error/Error","../progressSpinnerFlat/ProgressSpinnerFlat","../dragAndDrop/DragType","../dragAndDrop/DropHelper"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b,v,x,y,C,S,k,I){var _=function(t){function i(i){var l=this;t.call(this,i),this.listRegionLabel="",this.folderPathRegionLabel="",this.infoPaneRegionLabel="",this.commandBarRegionLabel="";var d=this.resources.consume(s.infoPane);this.hideCommandBar=i.hideCommandBar,this.hideOverlayHost=i.hideOverlayHost,this.hideDialogHost=i.hideDialogHost,this.hidePanelHost=i.hidePanelHost,this.hideDragAndDropComponent=i.hideDragAndDropComponent,this.isCustomList=i.isCustomList;var m=i.skipNavigation;this.hideContextMenus=i.hideContextMenus,this.isTitleVisible=this.createComputed(this._computeTitleVisible,{deferEvaluation:!0}),this.isViewCommandBarVisible=this.createComputed(this._computeViewCommandBarVisible,{deferEvaluation:!0}),this.activeLayout=o.observable(),this.breadcrumbBuilder=i.breadcrumbBuilder,this.infoPaneTransclusionContentParams={provider:d},this.infoPaneComponent=o.observable({name:S.tagName,params:{}}),this.isInfoPaneExpanded=this.resources.consume(r.files.isInfoPaneExpanded),this.infoPaneRole=o.observable(null);var p=this.isInfoPaneExpanded.subscribe(function(t){if(t&&l.infoPaneComponent().name===S.tagName){var o=u.promise(e,"../infoPane/InfoPane");o.then(function(e){l.infoPaneComponent({name:e.default.tagName,params:{}}),l.infoPaneRole("contentinfo")}),p.dispose()}},this);this.autoScrollEnabled=o.observable(!1),this.autoScrollYPosition=o.observable(0),this.dataManager=this.resources.consume(r.dataManager),this.layoutIteration=o.observable(0),this.dataManager.setLayoutIteration(this.layoutIteration),this.title=this.dataManager.title,this.item=this.dataManager.item,this.itemSet=this.dataManager.itemSet,this.children=this.dataManager.currentItemChild,this.requiredRange=this.dataManager.requiredRange,this.itemsPerGroup=this.dataManager.itemsPerGroup,this.itemSelectionModel=this.resources.consume(n.itemsSelection),this.isRetrievingData=this.dataManager.isRetrievingData,this.isOneUp=this.dataManager.isOneUp,this.oneUpComponentName=o.observable(S.tagName),this.focusItem=this.dataManager.focusItem,this.layoutType=this.resources.consume(r.files.layoutType),this.layoutTypeComponent=o.observable(S.tagName),this.subscribe(this.layoutType,this._onLayoutTypeChanged),this.isDroppable=o.observable(!0),this.isDroppingTarget=o.observable(!1),this._dropHelper=new(this.managed(I));var h=this.resources.consume(r.files.resx);if(h&&(this.listTooltip=h.listTooltip,this.listRegionLabel=h.listRegionLabel,this.folderPathRegionLabel=h.folderPathRegionLabel,this.infoPaneRegionLabel=h.infoPaneRegionLabel,this.commandBarRegionLabel=h.commandBarRegionLabel),this.isActive=i.isActive?i.isActive:this.createComputed(this._computeIsActive),this._isEmptyView=this.dataManager.isEmptyView,this._showErrorPage=this.dataManager.showErrorPage,this.error=this.dataManager.error,this.createComputed(this._computeIsEmpty),this.platform=this.resources.consume(a.platformDetection),this.printEnabled=!this.platform.isIE9,this._setUpSmartBanner(),this._setupCommandSets(i.topCommandSet,i.viewCommandSet),this.addBindingHandlers({marqueeSelection:b,contextMenu:g,autoScroll:f,dragAndDrop:v.default}),this.events.on(this.dataManager,"pageLoadComplete",function(){l._initializeDeferredComponents(),l.events.off(l.dataManager,"pageLoadComplete")}),!m){var x=this.resources.consume(n.viewParams),y=this.resources.consume(a.navigation),C=new c(this);C.on(y,"change",function(){x(y.viewParams)})}this.createComputed(function(){var t=l.oneUpComponentName.peek();if(t===S.tagName&&l.isOneUp()){var o=u.promise(e,"../oneUp/OneUp");o.then(function(e){l.oneUpComponentName(e.tagName)})}})}return __extends(i,t),i.prototype.onClick=function(e,t){return(m.hasClass(t.target,"StandaloneList-listView")||m.hasClass(t.target,"StandaloneList-innerContent")||m.hasClass(t.target,"StandaloneList-header"))&&this.itemSelectionModel.selection().length>0&&this.itemSelectionModel.clear(),!0},i.prototype.onMayReceiveDrop=function(e){var t=this.item&&this.item.peek&&this.item.peek();return this._dragType=e.type,t&&e.type===k.FileUpload?{targetName:t.name}:null},i.prototype.onDragging=function(e){this.isDroppingTarget(this._dragType===k.FileUpload?e:!1)},i.prototype.onReceiveDrop=function(e){var t=this._dropHelper.processDrop(e,this.item.peek());return t},i.prototype._computeTitleVisible=function(){var e=o.utils.unwrapObservable(this.focusItem())||this.item(),t=!0;return e&&e.parent&&(t=!1),t},i.prototype._computeViewCommandBarVisible=function(){if(this.isCustomList){var e=this.layoutType();return e===x.CustomGridList}return!1},i.prototype._onLayoutTypeChanged=function(t){var o=this,i=this._isEmptyView(),n=this._showErrorPage();if(n)return this.error=this.dataManager.error,void this.layoutTypeComponent(C.tagName);if(this.isRetrievingData())this.layoutTypeComponent(S.tagName);else{var a=p.default.loadComponent(e,"../list/"+x.Path[t],t);a.then(function(){o.layoutTypeComponent(i?y.tagName:t),i||o.dataManager.cacheLayoutContext()})}},i.prototype._computeIsActive=function(){var e=this.resources.consume(s.dialog),t=this.isOneUp(),o=!!e.currentDialog();return!t&&!o},i.prototype._computeIsEmpty=function(){this._onLayoutTypeChanged(this.layoutType())},i.prototype._setUpSmartBanner=function(){this.isBannerApplicable=this.platform.isIOS,this.isSmartBannerVisible=o.observable(!1)},i.prototype._setupCommandSets=function(e,t){this.listViewContextMenuHelper=this.resources.expose(r.listViewContextMenuHelper,o.observable(new h({items:[],rootElementClass:""}))),this.contextMenuHelper=o.observable(new h({items:[],rootElementClass:""})),this.topLevelCommandSet=e||o.observable(null),this.viewCommandSet=t||o.observable(null)},i.prototype._initializeDeferredComponents=function(){var t=this,o=this.resources.consume(l.url),i=o.getPageModulePath(d.Files);i="../../../"+i.substr(0,i.lastIndexOf("/"));var n=this.platform.isMobile?u.promise(e,i+"/commandSets/MobileCommandSet"):u.promise(e,i+"/commandSets/TopLevelCommandSet");if(n.then(function(e){t.topLevelCommandSet(new(t.managed(e))({}))}),!this.hideContextMenus&&!this.platform.isMobile){var a=u.promise(e,i+"/commandSets/ListViewContextMenuCommandSet");a.then(function(e){t.listViewContextMenuCommandSet=t.resources.expose(r.listViewContextMenuCommandSet,new(t.managed(e))({})),t.listViewContextMenuHelper(new h({items:t.listViewContextMenuCommandSet.commands(),rootElementClass:"List",boundingElementClass:"StandaloneList-content"}))});var s=u.promise(e,i+"/commandSets/ContextMenuCommandSet");s.then(function(e){var o=new(t.managed(e))({});t.contextMenuHelper(new h({items:o.commands(),rootElementClass:"StandaloneList",boundingElementClass:"StandaloneList-content"}))})}},i}(i);return _}),define("odsp-next/controls/standaloneList/StandaloneList.html",[],function(){return"<div class=StandaloneList data-bind=\"css: { 'is-active': isActive, 'has-smart-banner': isSmartBannerVisible(), 'has-one-up': isOneUp, 'has-command-bar': !hideCommandBar, dropping: isDroppingTarget, 'printEnabled': printEnabled }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: onDragging, receiveDrop: onReceiveDrop }\"><!--ko if: !hideCommandBar--><div class=StandaloneList-commandBar data-bind=\"component: { name: 'ms-command-bar', params: {commandSet: topLevelCommandSet, isMobile: false, isActive: isActive } }\"></div><!--/ko--><div class=\"StandaloneList-content od-Files-offsetTop\" data-bind=\"marqueeSelection: { selectionModel: itemSelectionModel, layout: activeLayout, offsetElementClass: 'List-surface', isSelecting: autoScrollEnabled, yOffset: autoScrollYPosition }, css: { 'CustomList-content': isCustomList }, contextMenu: contextMenuHelper, click: onClick, autoScroll: { enabled: autoScrollEnabled, y: autoScrollYPosition }, automation: 'content'\"><div class=StandaloneList-innerContent><!--ko if: isBannerApplicable--><ms-smart-banner class=StandaloneList-smartBanner params=\"{ isVisible: isSmartBannerVisible }\"></ms-smart-banner><!--/ko--><div class=StandaloneList-header role=navigation data-bind=\"attr: { 'aria-label': folderPathRegionLabel }\"><!--ko if: isTitleVisible--><span class=StandaloneList-title data-bind=\"text: title, automation: 'TitleSpan'\"></span><!--/ko--><!--ko component: { name: \"ms-breadcrumb-bar\", params: {item: item, getCrumbs: breadcrumbBuilder} }--><!--/ko--><!--ko if: isViewCommandBarVisible--><div class=StandaloneList-viewCommandBar data-bind=\"component: { name: 'ms-command-bar', params: { commandSet: viewCommandSet, isMobile: false, isActive: isActive } }\"></div><!--/ko--></div><div class=StandaloneList-listView role=application data-bind=\"attr: { 'aria-label': listRegionLabel }, component: { name: layoutTypeComponent, params: { itemSet: itemSet, activeLayout: activeLayout, requiredRange: requiredRange, itemsPerGroup: itemsPerGroup, scroll: 'StandaloneList-content', isDefault: true, isActive: isActive, selectionModel: itemSelectionModel, contextMenuHelper:listViewContextMenuHelper, tooltip: listTooltip, layoutIterationObservable: layoutIteration, error: error } }\"></div><ms-footer class=StandaloneList-footer></ms-footer></div></div><!--ko if: isInfoPaneExpanded() && !isOneUp()--><!--ko component: { name: 'od-transclusion-content', params: infoPaneTransclusionContentParams }--><div data-bind=\"component: infoPaneComponent, attr: { 'aria-label': infoPaneRegionLabel, role: infoPaneRole }\"></div><!--/ko--><!--/ko--><!--ko if: isOneUp--><!--ko component: {\n name: 'od-one-up-overlay',\n params: {}\n }--><!--ko component: {\n name: $component.oneUpComponentName,\n params: {\n item: focusItem,\n itemSet: itemSet\n }\n }--><!--/ko--><!--/ko--><!--/ko--><!--ko if:!hideDragAndDropComponent--><!--ko component: \"ms-drag-and-drop\"--><!--/ko--><!--/ko--><!--ko if: !hideDialogHost--><!--ko component: { name: 'od-dialog-host' }--><!--/ko--><!--/ko--><!--ko if: !hidePanelHost--><!--ko component: { name: 'ms-panel-host' }--><!--/ko--><!--/ko--><!--ko if: !hideOverlayHost--><!--ko component: { name: 'od-overlay-host' }--><!--/ko--><!--/ko--></div>"}),define("odsp-next/controls/standaloneList/StandaloneList.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles("html[dir=ltr] .StandaloneList-content,html[dir=rtl] .StandaloneList-content{left:0}.StandaloneList-title,.xlg .StandaloneList-title,.xxlg .StandaloneList-title,.xxxlg .StandaloneList-title{color:#333;font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-weight:400}.StandaloneList{position:absolute;width:100%;height:100%}.StandaloneList:not(.has-smart-banner) .StandaloneList-smartBanner{display:none}.StandaloneList .BreadcrumbBar,.StandaloneList-title{display:inline-block;vertical-align:text-bottom}.StandaloneList-content{position:absolute;top:0;bottom:0;overflow-y:hidden;overflow-x:hidden;-webkit-overflow-scrolling:touch}html[dir=ltr] .StandaloneList-content,html[dir=rtl] .StandaloneList-content{right:0}.StandaloneList.has-command-bar .StandaloneList-content{top:40px}.StandaloneList-viewCommandBar{width:145px}html[dir=ltr] .StandaloneList-viewCommandBar{float:right}html[dir=rtl] .StandaloneList-viewCommandBar{float:left}.StandaloneList.is-active .StandaloneList-content{overflow-y:scroll;-webkit-overflow-scrolling:touch}.CustomList-content{overflow-x:scroll}.StandaloneList-footer,.StandaloneList-header,.StandaloneList-title{overflow:hidden;white-space:nowrap}.StandaloneList-innerContent{position:relative;min-height:100%}.StandaloneList-header{height:36px;padding:22px 54px 1px 30px}html[dir=rtl] .StandaloneList-header{padding:22px 30px 1px 54px}.lg .StandaloneList-header,.md .StandaloneList-header,.sm .StandaloneList-header{padding:10px 20px;height:auto}.lg .StandaloneList-footer,.md .StandaloneList-footer,.sm .StandaloneList-footer{padding:10px 20px}.StandaloneList-footer{padding:0 30px;position:absolute;left:0;right:0;bottom:0}.StandaloneList-title{max-width:60%;text-overflow:ellipsis;cursor:default;font-size:21px}html[dir=ltr] .StandaloneList-title{margin-right:15px}html[dir=rtl] .StandaloneList-title{margin-left:15px}.xlg .StandaloneList-title,.xxlg .StandaloneList-title,.xxxlg .StandaloneList-title{font-size:28px}.StandaloneList.dropping .StandaloneList-listView{box-shadow:inset 0 0 0 3px #c8c8c8}.StandaloneList-listView{position:relative;padding-bottom:60px}.xlg .StandaloneList-listView,.xxlg .StandaloneList-listView,.xxxlg .StandaloneList-listView{padding-top:20px}@media print{html[dir=rtl] .printEnabled .StandaloneList-content{right:0!important}html[dir=ltr] .printEnabled .StandaloneList-content{left:0!important;right:auto!important}html[dir=rtl] .printEnabled .StandaloneList-content{left:auto!important}.printEnabled .StandaloneList-innerContent{margin-top:0!important}}")}),define("odsp-next/bindings/css/ClassesBinding",["require","exports","knockout"],function(e,t,o){var i=function(){function e(){}return e.update=function(e,t,i,n,a){var r=o.utils.unwrapObservable(t());o.bindingHandlers.css.update(e,function(){return o.unwrap(r.base)||""},i,n,a),o.bindingHandlers.css.update(e,function(){return o.unwrap(r.mappings)||{}},i,n,a)},e}();return i});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/dialogHost/DialogHostViewModel",["require","exports","odsp-shared/base/ViewModel","../../resources/ProviderResourceKeys","odsp-shared/bindings/automation/AutomationBinding","../../bindings/dismiss/DismissBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/focus/ChildFocusBinding","../../utilities/browser/ResponsiveUI","./DialogHost.resx","../../bindings/css/ClassesBinding","../../bindings/element/ElementBinding","../../bindings/focus/OnFocusBinding","../../utilities/accessibility/Accessibility","odsp-utilities/math/Rectangle","odsp-utilities/math/Point","../../utilities/locale/Locale","knockout"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g,f,b){var v=function(e){function t(t){var o=this;e.call(this,t),this.closeLabel=d.strings.CloseLabel,this.addBindingHandlers({dismiss:a,keyboard:r,classes:c,automation:n,element:u,focus:m,childFocus:s}),this.dialog=this.resources.consume(i.dialog).currentDialog,this.contentRoot=b.observable(),this.Accessibility=p,this._launchPoint=new g(-1,-1),this.dialogStyle=this.createComputed(this._computeDialogStyle),this.hasFocus=b.observable(!1),this.hasChildFocus=b.observable(!1),this.createComputed(function(){o.hasChildFocus()||o.hasFocus(!0)}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})}return __extends(t,e),t.prototype.dismiss=function(){var e=this.dialog();return e&&e.isDismissable?(e.dismiss(),!1):!0},t.prototype.executeDefaultAction=function(){var e=this.dialog();if(e&&e.executeDefaultAction){var t=b.utils.arrayFirst(e.actions,function(e){return e.isDefault});if(t)return this.execute(t)}return!0},t.prototype.execute=function(e){var t=this.dialog();return t&&e.isAvailable()?(e.isExecuting(!0),e.execute().done(function(o){e.isExecuting(!1),t.state(o)}),!1):!0},t.prototype.determineDialogCssClass=function(e){var t=[],o="ms-Dialog-main--";t.push(o+l.determineCssClass(e.size));var i=o+(Boolean(e.isCallout)?"callout":"dialog");return t.push(i),t.join(" ")},t.prototype._computeDialogStyle=function(){var e={left:"-1000px",top:"-1000px"};return Boolean(this.dialog())?Boolean(this.dialog().calloutHeight)&&Boolean(this.dialog().calloutHeight())&&Boolean(this.dialog.peek().isCallout)?(this.ensureLaunchPointCalculated(),e.left=this._launchPoint.x+"px",e.top=this._launchPoint.y+"px",e):null:e},t.prototype.ensureLaunchPointCalculated=function(){var e=this.dialog.peek().invokerEvent;if(Boolean(e)&&Boolean(this.contentRoot())){var t=this.contentRoot().getBoundingClientRect(),o=e.clientX,i=e.clientY;if(0>=o&&0>=i||!Boolean(o)&&!Boolean(i)){var n=e.target.getBoundingClientRect();o=n.left,i=n.bottom}var a=f.isRightToLeft?o-t.width:o,r=i,s=new h(a,r,t.width,t.height),l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=new h(0,0,l,d),u=s.nudge(c);
this._launchPoint.x=u.getLeft(),this._launchPoint.y=u.getTop()}},t}(o);return v}),define("odsp-next/controls/dialogHost/DialogHost.html",[],function(){return'<div class=od-DialogHost data-bind="css: { \'is-active\': dialog }, preserveFocus, childFocus: hasChildFocus"><!--ko with: dialog--><!--ko component: {\n name: \'od-overlay\',\n params: {\n animation: {\n beforeRemove: 500\n },\n alignToParent: isCallout,\n restoreFocusOnClose: true\n }\n }--><a class=ms-accessible href=javascript:; aria-hidden=true data-bind="focus: function() { $parent.Accessibility.focusLastTabStop.call($data, $parent.contentRoot()) }"></a><div class="ms-Dialog ms-Dialog--close"><div class=ms-ModalOverlay data-bind="visible: !isCallout"></div><div class=ms-Dialog-main tabindex=-1 data-bind="dismiss: isDismissable && $component.dismiss.bind($component), classes: { base: $component.determineDialogCssClass($data), mappings: { \'ms-Dialog--close\': isDismissable } }, hasFocus: $component.hasFocus, keyboard: { allowInputEvents: true, allowButtonEvents: false, mappings: { Enter: $component.executeDefaultAction.bind($component) } }, automation: automationId, style: $component.dialogStyle, element: $parent.contentRoot"><div class="ms-Dialog-header ms-Dialog-header--s"><p class=ms-Dialog-title><!--ko if: titleAction && titleAction.isVisible()--><button class="ms-Dialog-button ms-Dialog-button--back" data-bind="attr: {\'aria-label\': titleAction.name, title: titleAction.name}, click: titleAction.execute"><!--ko if: titleAction.icon--><span data-bind="component: { name: \'od-icon-glyph\', params: { icon: titleAction.icon } }"></span><!--/ko--></button><!--/ko--><!--ko text: title--><!--/ko--></p></div><button class="ms-Dialog-button ms-Dialog-button--close" data-bind="attr: {\'aria-label\': $parent.closeLabel, title: $parent.closeLabel}, click: isDismissable && $component.dismiss.bind($component)"><i class="ms-Icon ms-Icon--x"></i></button><div class=ms-Dialog-inner><!--ko if: component--><div class=ms-Dialog-content data-bind="component: component"></div><!--/ko--><!--ko if: actions.length && actionsVisible--><div class=ms-Dialog-actions data-bind="automation: \'actionsSection\'"><div class=ms-Dialog-actionsRight data-bind="foreach: actions"><!--ko if: isVisible--><button class="ms-Dialog-action ms-Button" data-bind="css: { \'ms-Button--primary\': isDefault }, click: $component.execute.bind($component), enable: isAvailable, automation: automationId"><!--ko if: icon--><span class=ms-Button-icon data-bind="component: { name: \'od-icon-glyph\', params: { icon: icon } }"></span><!--/ko--><span class=ms-Button-label data-bind="text: name"></span></button><!--/ko--><!--ko if: isVisible() && isExecuting()--><div class=od-Dialog-actionsLoading data-bind="component: { name: \'ms-loadingSpinner\', params: { loadingText: \'\' } }"></div><!--/ko--></div></div><!--/ko--></div></div></div><a class=ms-accessible href=javascript:; aria-hidden=true data-bind="focus: $parent.Accessibility.focusFirstTabStop.bind($data, $parent.contentRoot())"></a><!--/ko--><!--/ko--></div>'}),define("odsp-next/controls/dialogHost/DialogHost.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".ms-Dialog-header .ms-Dialog-title,.ms-Dialog-header.ms-Dialog-header--large .ms-Dialog-title{font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif}.od-DialogHost{display:none}.od-Dialog-actionsLoading{display:inline-block;padding-bottom:7px;vertical-align:bottom}html[dir=ltr] .od-Dialog-actionsLoading{padding-right:5px}html[dir=rtl] .od-Dialog-actionsLoading{padding-left:5px}.ms-Dialog{background-color:transparent;position:absolute;height:100%;width:100%;top:0;font-size:0;line-height:100vh;text-align:center;display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-align:center;-webkit-align-items:center;align-items:center}.ms-Dialog-main,.ms-Dialog::before{vertical-align:middle;display:inline-block}html[dir=ltr] .ms-Dialog{left:0}html[dir=rtl] .ms-Dialog{right:0}.ms-Dialog::before{content:\"\";height:100%;width:0}.sm .ms-Dialog{-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;box-sizing:border-box;padding:0}.ms-Dialog-main{box-shadow:0 0 16px 0 rgba(0,0,0,.4);background-color:#fff;box-sizing:border-box;line-height:normal;width:100%}html[dir=ltr] .ms-Dialog-main{text-align:left}html[dir=rtl] .ms-Dialog-main{text-align:right}.ms-Dialog-main--dialog{margin:auto;position:relative}.ms-Dialog-main--callout{position:absolute}.ms-Dialog-main--callout .ms-Dialog-header,.ms-Dialog-main--callout .ms-Dialog-inner{padding:0}.ms-Dialog-main:focus{outline:0}.ms-Dialog-main--sm{width:320px}.sm .ms-Dialog-main--sm{width:100%;height:100%;top:50px}.sm .ms-Dialog-main--sm .ms-Dialog-header,html[dir=rtl] .sm .ms-Dialog-main--sm .ms-Dialog-header{padding:48px 16px 0}.sm .ms-Dialog-main--sm .ms-Dialog-inner{padding:16px}.sm .ms-Dialog-main--sm .ms-Dialog-actions{position:absolute;top:0;left:0;right:0;margin-top:0;background-color:#e6f2fb;padding:0 10px 0 0;height:40px}html[dir=rtl] .sm .ms-Dialog-main--sm .ms-Dialog-actions{padding:0 0 0 10px}html[dir=ltr] .sm .ms-Dialog-main--sm .ms-Dialog-action,html[dir=rtl] .sm .ms-Dialog-main--sm .ms-Dialog-action{padding-right:16px}html[dir=ltr] .sm .ms-Dialog-main--sm .ms-Dialog-actions .ms-Dialog-actionsRight{float:left}html[dir=ltr] .ms-Dialog-actionsRight,html[dir=rtl] .sm .ms-Dialog-main--sm .ms-Dialog-actions .ms-Dialog-actionsRight{float:right}.sm .ms-Dialog-main--sm .ms-Dialog-action{background:0 0;height:40px}html[dir=ltr] .sm .ms-Dialog-main--sm .ms-Dialog-action,html[dir=rtl] .sm .ms-Dialog-main--sm .ms-Dialog-action{padding-left:16px}.sm .ms-Dialog-main--sm .ms-Dialog-action .ms-Button-icon{display:inline;margin-right:6px;color:#094AB2}.sm .ms-Dialog-main--sm .ms-Dialog-action:hover{background-color:#d7eaf9;color:#094AB2}.sm .ms-Dialog-main--sm .ms-Button--primary{border:none}.sm .ms-Dialog-main--sm .ms-Button--primary[disabled=disabled],.sm .ms-Dialog-main--sm .ms-Button--primary[disabled=disabled]:before{color:#c8c8c8}.sm .ms-Dialog-main--sm .ms-Button.ms-Button--primary .ms-Button-label{font-size:14px;color:#333}.sm .ms-Dialog-main--sm.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--close{z-index:1;top:8px}.ms-Dialog-main--md{max-width:480px}.ms-Dialog-main--lg{max-width:640px}.ms-Dialog-main--xlg{max-width:1024px}.ms-Dialog-main--xxlg{max-width:1366px}.ms-Dialog-main--xxxlg{max-width:1920px}.ms-Dialog-button.ms-Dialog-button--close{display:none}.ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--close{display:block;position:absolute;margin:0;border:0;background:0 0;cursor:pointer;top:12px;padding:4px;z-index:1}.ms-Dialog-actions,.ms-Dialog-content,.ms-Dialog-header{position:relative;width:100%}html[dir=ltr] .ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--close{right:12px}html[dir=rtl] .ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--close{left:12px}.ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--close .ms-Icon.ms-Icon--x{color:#666;font-size:14px}.ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--back{padding:5px 10px 5px 0;background:0 0;border:0;cursor:pointer}html[dir=rtl] .ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--back{padding:5px 0 5px 10px}.ms-Dialog.ms-Dialog--close .ms-Dialog-button.ms-Dialog-button--back .ms-Icon.ms-Icon--arrowLeft{color:#666;font-size:17px}.ms-Dialog-header{box-sizing:border-box;padding:24px 32px 0}.ms-Dialog-header .ms-Dialog-title{margin:0;font-size:21px;color:#333;display:inline}.ms-Dialog-header.ms-Dialog-header--large{padding:30px 20px;margin-bottom:10px;background-color:#0078d7}.ms-Dialog-header.ms-Dialog-header--large .ms-Dialog-title{font-size:28px;color:#fff}.ms-Dialog-inner{height:100%;padding:16px 32px 20px}.ms-Dialog-content .ms-Button.ms-Button--compound:not(:last-child){margin-bottom:20px}.ms-Dialog-subText{margin:0 0 20px;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;color:#333}.ms-Dialog-subText.ms-Dialog-subText--s{font-size:12px}.ms-Dialog-subText.ms-Dialog-subText--m{font-size:14px}.ms-Dialog-subText.ms-Dialog-subText--l{font-size:17px}.ms-Dialog-actions{height:30px;margin-top:24px}.ms-Dialog-actions:after,.ms-Dialog-actions:before{display:table;content:\"\";line-height:0}.ms-Dialog-actions:after{clear:both}.ms-Dialog-action .ms-Button-icon{display:none}html[dir=rtl] .ms-Dialog-actionsRight{float:left}html[dir=ltr] .ms-Dialog-actionsRight .ms-Dialog-action:not(:last-child){margin-right:5px}html[dir=rtl] .ms-Dialog-actionsRight .ms-Dialog-action:not(:last-child){margin-left:5px}html[dir=ltr] .ms-Dialog.ms-Dialog--lgHeader .ms-Dialog-actionsRight{float:right}html[dir=rtl] .ms-Dialog.ms-Dialog--lgHeader .ms-Dialog-actionsRight{float:left}html[dir=ltr] .ms-Dialog.ms-Dialog--lgHeader .ms-Dialog-actionsRight .ms-Dialog-action:not(:last-child){margin-right:15px}html[dir=rtl] .ms-Dialog.ms-Dialog--lgHeader .ms-Dialog-actionsRight .ms-Dialog-action:not(:last-child){margin-left:15px}.ms-ModalOverlay{display:block;position:absolute;cursor:pointer;top:0;height:100%;width:100%;background-color:rgba(255,255,255,.4)}html[dir=ltr] .ms-ModalOverlay{left:0}html[dir=rtl] .ms-ModalOverlay{right:0}.ms-Dialog--multiline{width:95%}html[dir=rtl] .ms-Dialog-button--close{left:14px}html[dir=ltr] .ms-Dialog-button--close{right:14px;left:auto}html[dir=rtl] .ms-Dialog-button--close{right:auto}.ms-Dialog-content{font-size:12px}.od-OverlayHost-overlay .ms-ModalOverlay{-webkit-animation-name:fadeIn;animation-name:fadeIn;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:167ms;animation-duration:167ms}.od-OverlayHost-overlay .ms-Dialog-main{-webkit-animation-name:fadeIn,slideDown10;animation-name:fadeIn,slideDown10;-webkit-animation-duration:167ms;-moz-animation-duration:167ms;-ms-animation-duration:167ms;-o-animation-duration:167ms;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{-webkit-animation-name:fadeOut;animation-name:fadeOut;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:167ms;animation-duration:167ms}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-Dialog-main{-webkit-animation-name:fadeOut,slideUpOut10;animation-name:fadeOut,slideUpOut10;-webkit-animation-duration:167ms;-moz-animation-duration:167ms;-ms-animation-duration:167ms;-o-animation-duration:167ms;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-Dialog{visibility:hidden;transition:visibility 0s linear 267ms}")}),define("odsp-next/controls/dialogHost/DialogHost",["require","exports","./DialogHostViewModel","odsp-shared/utilities/knockout/ComponentFactory","./DialogHost.html","./DialogHost.css","../overlays/Overlay"],function(e,t,o,i){var n=i.registerComponent({tagName:"od-dialog-host",template:e("./DialogHost.html"),viewModel:o});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/panelHost/PanelHostViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../models/panel/PanelState","../../resources/ProviderResourceKeys","../../bindings/dismiss/DismissBinding","../../bindings/css/ClassesBinding","../../utilities/browser/ResponsiveUI","../../utilities/accessibility/Accessibility","../../bindings/element/ElementBinding","../../bindings/focus/OnFocusBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/focus/ChildFocusBinding","../../bindings/focus/PreserveFocusBinding","./PanelHost.resx"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p,h,g){var f=function(e){function t(t){var i=this;e.call(this,t),this.closePanelLabel=g.strings.closePanelLabel,this.addBindingHandlers({dismiss:r,classes:s,element:c,focus:u,keyboard:m,childFocus:p,preserveFocus:h}),this.contentRoot=o.observable(),this.Accessibility=d,this._panelProvider=this.resources.consume(a.panel),this.panels=this._panelProvider.currentPanels,this.hasFocus=o.observable(!1),this.hasChildFocus=o.observable(!1),this.createComputed(function(){i.hasChildFocus()||i.hasFocus(!0)}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})}return __extends(t,e),t.prototype.onEnter=function(e,t){return this.closePanel(e),t.stopPropagation(),!1},t.prototype.closePanel=function(e){return e.state(n.closed),!1},t.prototype.determinePanelCssClass=function(e){return"od-Panel--"+l.determineCssClass(e.size)},t}(i);return f}),define("odsp-next/controls/panelHost/PanelHost.html",[],function(){return'<div class=od-PanelHost data-bind="foreach: panels, preserveFocus, childFocus: hasChildFocus"><!--ko component: {\r\n name: \'od-overlay\',\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500\r\n },\r\n alignToParent: false,\r\n restoreFocusOnClose: true\r\n }\r\n }--><a class=ms-accessible href=javascript:; aria-hidden=true data-bind="focus: function() { $parent.Accessibility.focusLastTabStop.call($data, $parent.contentRoot()) }"></a><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel-padding" role=dialog tabindex=-1 data-bind="dismiss: { close: $component.closePanel.bind($component) }, classes: { base: $component.determinePanelCssClass($data), mappings: { \'od-Panel--scrollable\': $data.forceScrollbar, \'od-Panel--hasCommandBar\': hasCommandBar } }, hasFocus: $component.hasFocus, attr: { \'aria-label\': title }, element: $parent.contentRoot"><button class="od-Panel-button od-Panel-button--close" tabindex=0 data-bind="click: $component.closePanel.bind($component), attr: { \'aria-label\': $component.closePanelLabel }, keyboard: { mappings: { Enter: $component.onEnter.bind($component) } }"><i class="ms-Icon ms-Icon--x"></i></button><!--ko ifnot: noTitle--><div class="od-Panel-title ms-font-xl ms-fontWeight-semilight" data-bind="text: title"></div><!--/ko--><div class=od-Panel-content data-bind="component: component"></div></div><a class=ms-accessible href=javascript:; aria-hidden=true data-bind="focus: $parent.Accessibility.focusFirstTabStop.bind($data, $parent.contentRoot())"></a><!--/ko--></div>'}),define("odsp-next/controls/panelHost/PanelHost.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-PanelHost{display:none}.od-Panel{position:absolute;top:50px;bottom:0;width:100%;max-width:100%;background:#fff;box-sizing:border-box;overflow:auto;transition:width .3s ease-out;box-shadow:-30px 0 30px -30px rgba(0,0,0,.4);z-index:298}html[dir=ltr] .od-Panel{right:0}html[dir=rtl] .od-Panel{left:0;box-shadow:30px 0 30px -30px rgba(0,0,0,.4)}.lg .od-Panel,.md .od-Panel,.xlg .od-Panel,.xxlg .od-Panel,.xxxlg .od-Panel{width:340px}.od-Panel-padding{padding:40px 20px 20px}.lg .od-Panel-padding,.md .od-Panel-padding,.sm .od-Panel-padding{padding-top:40px;padding-left:16px;padding-right:16px}.lg .od-Panel-padding{padding-left:32px;padding-right:32px}.xlg .od-Panel-padding,.xxlg .od-Panel-padding,.xxxlg .od-Panel-padding{padding-top:70px;padding-left:32px;padding-right:32px}.xxlg .od-Panel-padding,.xxxlg .od-Panel-padding{padding-left:40px;padding-right:40px}.od-Panel--scrollable{overflow-y:scroll}.lg .od-Panel--lg,.md .od-Panel--lg,.xlg .od-Panel--lg,.xxlg .od-Panel--lg,.xxxlg .od-Panel--lg{width:355px;padding-right:15px;padding-left:15px}html[dir=ltr] .webim-opened .od-Panel{right:300px}html[dir=rtl] .webim-opened .od-Panel{left:300px}.od-Panel-title{margin-bottom:8px}.lg .od-Panel-title,.md .od-Panel-title,.sm .od-Panel-title{line-height:48px}.od-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;top:16px;padding:5px}html[dir=ltr] .od-Panel-button--close{right:14px}html[dir=rtl] .od-Panel-button--close{left:14px}.od-Panel-button--close .ms-Icon--x{color:#666;font-size:14px}.od-Panel--hasCommandBar .od-Panel-button--close{top:9px;z-index:4000}html[dir=ltr] .od-Panel--hasCommandBar .od-Panel-button--close{right:18px}html[dir=rtl] .od-Panel--hasCommandBar .od-Panel-button--close{left:18px}.od-OverlayHost-overlay .od-Panel{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{opacity:1;-webkit-animation-name:fadeIn,slideLeft40;animation-name:fadeIn,slideLeft40;-webkit-animation-duration:367ms;-moz-animation-duration:367ms;-ms-animation-duration:367ms;-o-animation-duration:367ms;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1);-webkit-animation-fill-mode:both;animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{-webkit-animation-name:fadeOut,slideRightOut40;animation-name:fadeOut,slideRightOut40;-webkit-animation-duration:167ms;-moz-animation-duration:167ms;-ms-animation-duration:167ms;-o-animation-duration:167ms;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both}.od-PanelOverlay.ms-ModalOverlay{top:50px}")}),define("odsp-next/controls/panelHost/PanelHost",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./PanelHostViewModel","./PanelHost.html","./PanelHost.css","../overlays/Overlay"],function(e,t,o,i){var n=o.registerComponent({tagName:"ms-panel-host",template:e("./PanelHost.html"),viewModel:i,synchronous:!0});return n}),define("odsp-next/bindings/overflow/OverflowBinding",["require","exports","knockout","odsp-utilities/events/EventGroup"],function(e,t,o,i){var n=function(){function e(){}return e.init=function(t,n,a){var r=o.observable();o.computed(function(){r();var i=o.utils.unwrapObservable(n()),s=a(),l=null;l=i.data?i.data:s.foreach&&s.foreach.data||s.foreach||s.template&&s.template.foreach;var d=o.utils.unwrapObservable(l),c=o.utils.unwrapObservable(i.alwaysVisibleItems);e._calculateElementVisibility(t,i,d,c)},null,{disposeWhenNodeIsRemoved:t}).extend({throttle:1});var s=new i(t);o.utils.domNodeDisposal.addDisposeCallback(t,function(){s.dispose()}),s.on(t,"layoutChange",function(){r.notifySubscribers()}),s.on(document,"resize",function(){r.notifySubscribers()}),s.on(document,"transitionend",function(){r.notifySubscribers()})},e._calculateElementVisibility=function(t,i,n,a){var r=t.getBoundingClientRect(),s=r.right-r.left,l=0,d=[],c=[];if(a&&n)for(var u=0,m=a.length;m>u;u++){var p=a[u],h=o.utils.arrayIndexOf(n,p);if(h>-1&&h<t.children.length){var g=t.children[h],f=e._measureElement(g);s-=f.width}}for(u=0,m=t.children.length;m>u;u++){g=t.children[u];var b;n&&(b=n[u]);var v=e._measureElement(g);l+=v.width;var x=a&&b&&o.utils.arrayIndexOf(a,b)>-1,y=!x&&l>s;if(!x){var C="none"!==g.style.display;y||C?y&&C&&(g.style.display="none"):g.style.display=""}y&&(d.push(g),b&&c.push(b))}i&&(o.isObservable(i.overflowElements)&&i.overflowElements(d),o.isObservable(i.overflowItems)&&i.overflowItems(c))},e._measureElement=function(e){var t=e.style.display;e.style.display="";var o=e.getBoundingClientRect(),i=window.getComputedStyle(e),n=parseFloat(i.marginLeft),a=parseFloat(i.marginRight),r=parseFloat(i.marginTop),s=parseFloat(i.marginBottom);e.style.display=t;var l={left:o.left-n,right:o.right+a,top:o.top-r,bottom:o.bottom+s,width:o.right-o.left+n+a,height:o.bottom-o.top+r+s};return l},e}();return n}),define("odsp-shared/utilities/knockout/Translators",["require","exports"],function(){var e;return function(e){"use strict";function t(e,t){var o=function(){var o=e.peek(),i=t.peek();t.valueWillMutate(),i.splice.apply(i,[0,i.length].concat(o)),t.valueHasMutated()},i=e.subscribe(o,null,"arrayChange");return o([]),i}e.replicateArray=t}(e||(e={})),e});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/commandBar/CommandBarViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../bindings/overflow/OverflowBinding","../../bindings/element/ElementBinding","odsp-shared/utilities/knockout/Translators","odsp-shared/utilities/knockout/Projections"],function(e,t,o,i,n,a,r,s,l){var d=function(e){function t(t){var i=this;e.call(this,t),this._allCommands=o.observableArray(),this.overflowCommands=o.observableArray(),this.focusedCommand=o.observable(),this.fixedCommands=[],this._overflowCommandsSubscription=null,this._commandSetCommandsReplicationSubscription=null,this.addBindingHandlers({selection:a,overflow:r,keyboard:n,element:s}),this.isMobile=!!t.isMobile||!1,this._isKeyboardActive=o.isObservable(t.isActive)?t.isActive:o.observable(!0),this._skipFocus=!1,this.keyboardOptions=[{isActive:this._isKeyboardActive,target:null,mappings:{Down:this.onNavigateDown,Enter:this.onEnter,ShiftTab:this.onShiftTab}},{isActive:this._isKeyboardActive,target:window,mappings:{}}],this._initializeCommandsObservables(),this._initializeFocusLogic(),this._commandSet=o.isObservable(t.commandSet)?t.commandSet:o.observable(t.commandSet),this._initializeCommandSet(this._commandSet.peek()),this.subscribe(this._commandSet,function(e){i._initializeCommandSet(e)})}return __extends(t,e),t.prototype.getCommandBarItemParams=function(e,t,i){var n=this;return void 0===i&&(i=!1),{command:e,index:i?o.pureComputed(function(){return t()+n.mainCommands().length}):t}},t.prototype.onNavigateDown=function(e,t){var o=this.focusedCommand();return o&&o.openMenu()&&t.preventDefault(),!1},t.prototype.onEnter=function(e,t){var o=this.focusedCommand();return o?o.onClick(o,t):!0},t.prototype.onShiftTab=function(){return this._skipFocus=!0,this.topTab()&&this.topTab().focus(),!0},t.prototype.onMousedown=function(){this._skipFocus=!0},t.prototype.animateIn=function(e,t,i){i.hasAnimation()===!0&&1===e.nodeType&&(o.utils.toggleDomNodeCssClass(e,"is-animatingIn",!0),this.async.setTimeout(function(){o.utils.toggleDomNodeCssClass(e,"is-animatingIn",!1)},1e3))},t.prototype.animateOut=function(e,t,i){i.hasAnimation()===!0&&1===e.nodeType?(o.utils.toggleDomNodeCssClass(e,"is-animatingOut",!0),this.async.setTimeout(function(){o.removeNode(e)},1e3)):o.removeNode(e)},t.prototype._addCommandKeyboardShortcuts=function(e){for(var t=this.keyboardOptions[1].mappings,o=0;o<e.length;o++){var i=e[o];if(i.keys)for(var n=i.onClick.bind(i),a=0;a<i.keys.length;a++){var r=i.keys[a];t[r]||(t[r]=[]),t[r].push(n)}var s=i.children();s.length&&this._addCommandKeyboardShortcuts(s)}},t.prototype._initializeCommandSet=function(e){if(this._overflowCommandsSubscription&&(this._overflowCommandsSubscription.dispose(),this._overflowCommandsSubscription=null),this._commandSetCommandsReplicationSubscription&&(this._commandSetCommandsReplicationSubscription.dispose(),this._commandSetCommandsReplicationSubscription=null),this._allCommands([]),this.fixedCommands=[],e){if(this._commandSetCommandsReplicationSubscription=l.replicateArray(e.commands,this._allCommands),this.addDisposable(this._commandSetCommandsReplicationSubscription),e.overflowHostCommand){this.fixedCommands.push(e.overflowHostCommand);var t=e.overflowHostCommand.children()||[];this._overflowCommandsSubscription=this.subscribe(this.overflowCommands,function(o){var i=o.concat(t);e.overflowHostCommand.children(i)})}this._addCommandKeyboardShortcuts(e.commands())}},t.prototype._initializeCommandsObservables=function(){var e=this;this._visibleCommands=this.addDisposable(this._allCommands.filter(function(e){return e.isVisible()})),this.mainCommands=this.addDisposable(this._visibleCommands.filter(function(e){return!e.isSideCommand})),this.sideCommands=this.addDisposable(this._visibleCommands.filter(function(e){return e.isSideCommand})),this.selectableCommands=this.addDisposable(this._visibleCommands.filter(function(t){var o=e._isOverflowEnabled()&&-1!==e.overflowCommands.indexOf(t);return!o&&!t.isDisabled()}))},t.prototype._initializeFocusLogic=function(){var e=this,t=this.addDisposable(this._visibleCommands.filter(function(e){return e.isOpen()})),i=this.createComputed(function(){return t().length>0});this.createComputed(function(){i()||o.computedContext.isInitial()||document.activeElement&&document.activeElement!==document.body||!e.topTab.peek()||e.topTab.peek().focus()}).extend({rateLimit:0}),this._isFocusInEventRegistered=!1,this.topTab=o.observable(null),this.createComputed(function(){e.topTab()&&!e._isFocusInEventRegistered&&(e.events.on(e.topTab(),"focusin",function(t){if(!e._skipFocus&&e.topTab()&&t.target===e.topTab()&&e.mainCommands()&&e.mainCommands().length>0){var o=e.mainCommands()[0];o.focused(!0),e.focusedCommand(o)}e._skipFocus=!1}),e._isFocusInEventRegistered=!0)})},t.prototype._isOverflowEnabled=function(){return!!this._commandSet.peek()&&!!this._commandSet.peek().overflowHostCommand},t}(i);return d}),define("odsp-next/controls/commandBar/CommandBar.html",[],function(){return"<div class=CommandBar tabindex=0 role=menubar data-bind=\"keyboard: keyboardOptions, css: { 'CommandBar-mobile': isMobile }, selection: { data: selectableCommands, mode: 'single', direction: 'horizontal', focused: focusedCommand }, event: { mousedown: onMousedown }, element: topTab\"><div class=CommandBar-sideArea data-bind=\"template: { foreach: sideCommands, afterAdd: $component.animateIn.bind($component), beforeRemove: $component.animateOut.bind($component) }\"><!--ko component: { \n name: 'ms-command-bar-item', \n params: $component.getCommandBarItemParams($data, $index, true)\n }--><!--/ko--></div><div class=CommandBar-mainArea data-bind=\"template: { foreach: mainCommands }, overflow: { overflowItems: overflowCommands, alwaysVisibleItems: fixedCommands }\"><!--ko component: {\n name: 'ms-command-bar-item',\n params: $component.getCommandBarItemParams($data, $index) }--><!--/ko--></div></div>"}),define("odsp-next/controls/commandBar/CommandBar.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".CommandBar .is-animatingIn,.CommandBar .is-animatingOut{-webkit-animation-duration:167ms;-moz-animation-duration:167ms;-ms-animation-duration:167ms;-o-animation-duration:167ms}.CommandBar{background-color:#e6f2fb;height:40px;white-space:nowrap;padding:0 15px;border:0}.od-theme--darkTransparent .CommandBar,.od-theme--darkTransparent .od--hasSelection .CommandBar{background-color:rgba(0,0,0,.7)}.CommandBar:focus{outline:0}.CommandBar .is-shadowed{box-shadow:0 0 0 1px #767676 inset}.CommandBar .is-animatingIn{-webkit-animation-name:fadeIn,slideUp10;animation-name:fadeIn,slideUp10;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both}.CommandBar .is-animatingOut{overflow:hidden;-webkit-animation-name:fadeOut,slideDownOut10;animation-name:fadeOut,slideDownOut10;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both}.CommandBar-mobile{height:48px;text-align:center}.CommandBar-mainArea{overflow:hidden}html[dir=ltr] .CommandBar-sideArea{float:right;text-align:right}html[dir=rtl] .CommandBar-sideArea{float:left;text-align:left}.md .CommandBar-sideArea,.sm .CommandBar-sideArea{min-width:128px}.lg .CommandBar-sideArea{min-width:260px}.xlg .CommandBar-sideArea,.xxlg .CommandBar-sideArea,.xxxlg .CommandBar-sideArea{min-width:345px}.sm .CommandBar-sideArea{width:auto}")});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/commandBarItem/CommandBarItemViewModel",["require","exports","odsp-shared/base/ViewModel","../../bindings/css/ClassesBinding","odsp-shared/utilities/string/StringHelper","../commands/Commands.resx","knockout"],function(e,t,o,i,n,a,r){var s=a.strings,l=function(e){function t(t){var o=this;e.call(this,t),this.addBindingHandlers({classes:i}),this.command=t.command,this.index=t.index||r.observable(-1),this.automationId=t.command.automationId,this.accessibleLabel=this.createPureComputed(function(){return 0===o.index()?n.format(s.firstCommandAccessibleLabelFormat,o.command.label()):o.command.label()}),this.hasPayload=this.createComputed(this._computeHasPayload)}return __extends(t,e),t.prototype.dispose=function(){this.command.isOpen()&&this.command.isOpen(!1),e.prototype.dispose.call(this)},t.prototype._computeHasPayload=function(){return!(!this.command.payload||!this.command.isOpen()||this.command.action&&this.command.action.isToggled())},t}(o);return l}),define("odsp-next/controls/commandBarItem/CommandBarItem.html",[],function(){return"<!--ko with: command--><div class=\"CommandBarItem beak-anchor command\" role=menuitem data-bind=\"css: { 'is-toggled': isToggled, 'is-disabled': isDisabled, 'is-open': isOpen, 'is-focused': focused, 'CommandBarItem--hasPayload': $component.hasPayload, 'icon-only': hasIconOnly, 'is-current-view': isCurrentView, 'is-pivot': isCurrentView !== null, 'is-last-pivot': isLastPivot }, hasFocus: isActive, raiseEventOnChange: { eventName: 'layoutChange', bubbleEvent: true, data: layoutChanged }, dismiss: { isOpen: isOpen, isAutomatic: !!payload, timeout: !!payload && 4000, dismissOnResize: true }, with: targetCommand(), attr: { tabindex: tabindex, 'aria-label': $parent.accessibleLabel, 'aria-live': (payload ? 'assertive' : ''), 'aria-haspopup': (visibleChildren().length > 0 || !!payload), 'aria-selected': isToggled, id: newFeatureExperienceAnchor }, teachingBubble: teachingBubble\"><div class=CommandBarItem-linkWrapper><div class=CommandBarItem-link data-bind=\"measure: { measure: $parent.measurementReady, async: true }, click: onClick, automation: 'link', attr: { 'title': $parent.tooltip }\"><!--ko if: $parent.icon--><span class=CommandBarItem-icon data-bind=\"component: { name: 'od-icon-glyph', params: { icon: $parent.icon, badge: $parent.iconBadge } }, attr: { 'is-flipped': $parent.positionIconRight }\"></span><!--/ko--><!--ko if: $parent.label() && $parent.isLabelVisible()--><span role=status aria-live=polite class=\"CommandBarItem-commandText ms-font-m ms-fontWeight-regular\" data-bind=\"text: $parent.label, attr: { 'is-flipped': $parent.positionIconRight }\"></span><!--/ko--><!--ko if: visibleChildren().length && !hidesMenuChevron && !isCollapsed() && $parent.isLabelVisible()--><i class=\"ms-Icon ms-Icon--chevronDown\"></i><!--/ko--></div><!--ko if: $data.isFileUpload--><div class=CommandBarItem-uploadInput data-bind=\"automation: 'fileInput'\"><input class=CommandBarItem-fileInput tabindex=-1 data-bind=\"element: fileInputElement, event: { change: onInputChange }\" type=file multiple></div><!--/ko--><!--ko if: $data.isFolderUpload--><div class=CommandBarItem-uploadInput data-bind=\"automation: 'fileInput'\"><input class=CommandBarItem-folderInput tabindex=-1 data-bind=\"element: fileInputElement, event: { change: onInputChange }\" type=file webkitdirectory directory></div><!--/ko--><!--ko if: $data.isSilverlightFileUpload--><!--ko component: { name: 'ms-silverlight-upload' }--><!--/ko--><!--/ko--><!--ko if: $data.isDownlevelFileUpload--><!--ko component: { name: 'ms-downlevel-upload', params: { isOpen: $parent.isOpen, classToFind: 'CommandBarItem-linkWrapper' } }--><!--/ko--><!--/ko--></div><!--ko if: children().length && isOpen()--><ms-contextual-menu params=\"items: children, isOpen: isOpen, alignment: menuAlignment, offset: menuOffset, focused: menuFocus, hasExplicitAlignment: true, allowVerticalMenuNudging: false\"></ms-contextual-menu><!--/ko--><!--ko if: $component.hasPayload--><div role=alert aria-live=assertive class=CommandBarItem-payload data-bind=\"component: { name: 'ms-anchor-overlay', params: { alignment: menuAlignment, offset: menuOffset, hasExplicitAlignment: true, allowMenuNudging: true, trigger: layoutChanged } }\"><!--ko component: payload--><!--/ko--></div><!--/ko--></div><!--/ko-->"
}),define("odsp-next/controls/commandBarItem/CommandBarItem.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".CommandBarItem{display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#094AB2;height:40px;outline:0;vertical-align:top}html[dir=ltr] .CommandBarItem{margin-right:8px}html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=rtl] .CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus,html[dir=rtl] .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis{margin-right:0}html[dir=rtl] .CommandBarItem{margin-left:8px}html[dir=ltr] .CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus,html[dir=ltr] .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis{margin-left:0}.CommandBarItem.is-hidden{display:none}.CommandBarItem.is-disabled:hover{background-color:transparent}.CommandBarItem.is-disabled .CommandBarItem-link{cursor:default}.CommandBarItem:hover{background-color:#d7eaf9;color:#094AB2}@media screen and (-ms-high-contrast:active){.CommandBarItem{border-left:1px solid #000;border-right:1px solid #000;height:38px;outline:0}.CommandBarItem:hover{border-left:1px solid #fff;border-right:1px solid #fff}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem{border-left:1px solid #fff;border-right:1px solid #fff;height:38px;outline:0}.CommandBarItem:hover{border-left:1px solid #000;border-right:1px solid #000}}.CommandBarItem.is-toggled{background:#a8d1ef;color:#07288b}@media screen and (-ms-high-contrast:active){.CommandBarItem.is-toggled{border-left:1px solid #fff;border-right:1px solid #fff}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem.is-toggled{border-left:1px solid #000;border-right:1px solid #000}}.CommandBarItem.is-toggled:hover{background:#9ccbf0;color:#07288b}@media screen and (-ms-high-contrast:active){.CommandBarItem.is-toggled:hover{border-left:1px solid #fff;border-right:1px solid #fff}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem.is-toggled:hover{border-left:1px solid #000;border-right:1px solid #000}}.od-theme--darkTransparent .CommandBarItem,.od-theme--darkTransparent .CommandBarItem:hover{color:#fff}.od-theme--darkTransparent .CommandBarItem.is-focused,.od-theme--darkTransparent .CommandBarItem.is-selected{background:0 0}.od-theme--darkTransparent .CommandBarItem.is-toggled{background-color:#666}.od-theme--darkTransparent .CommandBarItem:not(.is-focused):not(.is-toggled):hover:not(.is-disabled),.od-theme--darkTransparent .od--hasSelection .CommandBarItem.is-focused,.od-theme--darkTransparent .od--hasSelection .CommandBarItem.is-selected,.od-theme--darkTransparent .od--hasSelection .CommandBarItem.is-toggled{background-color:rgba(102,102,102,.6)}.CommandBarItem .CommandBarItem-icon .ms-Icon--ellipsis{font-size:12px;line-height:12px}.CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus{font-size:1.3em;display:inline-block;vertical-align:top;margin-top:10px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circlePlus{width:20px}.md .CommandBarItem .CommandBarItem-icon .ms-Icon--upload,.sm .CommandBarItem .CommandBarItem-icon .ms-Icon--upload{width:14px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile{width:20px}html[dir=ltr] .md .CommandBarItem .CommandBarItem-icon .ms-Icon--upload,html[dir=ltr] .sm .CommandBarItem .CommandBarItem-icon .ms-Icon--upload{margin-left:-4px}html[dir=rtl] .md .CommandBarItem .CommandBarItem-icon .ms-Icon--upload,html[dir=rtl] .sm .CommandBarItem .CommandBarItem-icon .ms-Icon--upload{margin-right:-4px}html[dir=ltr] .CommandBarItem .CommandBarItem-icon .ms-Icon--download{margin-left:1px}html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile{margin-left:0}html[dir=rtl] .CommandBarItem .CommandBarItem-icon .ms-Icon--download{margin-right:1px}html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--tile{margin-right:0}.CommandBarItem .CommandBarItem-icon .ms-Icon--tile{font-size:.9em;line-height:.9em;vertical-align:top;margin-top:14px}.CommandBarItem .CommandBarItem-icon .ms-Icon--listBullets{display:inline-block;vertical-align:top;margin-top:11px;font-size:1.2em;line-height:1em}.CommandBarItem .CommandBarItem-icon .ms-Icon--share{font-size:17px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share{width:18px}html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share{margin-right:5px}html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--share{margin-left:5px}.CommandBarItem .CommandBarItem-icon .ms-Icon--x{font-size:.9em}.CommandBarItem .CommandBarItem-icon .ms-Icon--folderMove{font-size:20px;line-height:20px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--folderMove,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--folderMove,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--folderMove,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--folderMove{width:20px}.CommandBarItem .CommandBarItem-icon .ms-Icon--onedriveAdd{font-size:22px;line-height:22px}.CommandBarItem .CommandBarItem-icon .ms-Icon--plus{font-size:.9em;line-height:1em;vertical-align:top;margin-top:13px}html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus{margin-right:4px}html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--plus{margin-left:4px}html[dir=ltr] .CommandBarItem .CommandBarItem-icon .ms-Icon--link{padding-right:6px}html[dir=rtl] .CommandBarItem .CommandBarItem-icon .ms-Icon--link{padding-left:6px}.CommandBarItem .CommandBarItem-icon .ms-Icon--editBox{vertical-align:top;margin-top:11px;font-size:18px;line-height:18px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox{width:18px}html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox{margin-right:5px}html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--editBox{margin-left:5px}.CommandBarItem .CommandBarItem-icon .ms-Icon--chevronDown{color:#333;line-height:16px}.CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines{margin-top:10px;vertical-align:top;font-size:20px;line-height:21px}html[dir=ltr] .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines{margin-left:2px}html[dir=rtl] .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines{margin-right:2px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines{width:22px}html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines{margin-right:3px}html[dir=ltr] .lg .CommandBarItem,html[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,html[dir=ltr] .md .CommandBarItem,html[dir=ltr] .sm .CommandBarItem,html[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,html[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,html[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle{margin-right:0}html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--sortLines{margin-left:3px}html[dir=rtl] .lg .CommandBarItem,html[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,html[dir=rtl] .md .CommandBarItem,html[dir=rtl] .sm .CommandBarItem,html[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,html[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,html[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle{margin-left:0}.CommandBarItem .CommandBarItem-icon .ms-Icon--circle{font-size:11px;line-height:11px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--circle{width:19px}.CommandBarItem .CommandBarItem-icon .ms-Icon--circleInfo{font-size:1.3em;display:inline-block;vertical-align:top;margin-top:10px}.CommandBarItem .CommandBarItem-icon .ms-Icon--info{border:none;margin-top:10px;vertical-align:top;border-radius:0;width:22px}.CommandBarItem .CommandBarItem-icon .ms-Icon--info:before{border-radius:50%;border:.12em solid;height:20px;line-height:20px;overflow:hidden;text-align:center;width:1.7em;box-sizing:content-box;padding:2px}.CommandBarItem .CommandBarItem-icon .ms-Icon--progress{top:2px;width:14px;height:14px}.CommandBarItem .CommandBarItem-icon .ms-Icon--progress:before{display:inline-block}.CommandBarItem .CommandBarItem-icon .ms-Icon--progress.is-active:before{-webkit-animation:rotate-progress 1.1s infinite linear;animation:rotate-progress 1.1s infinite linear}.CommandBarItem .CommandBarItem-icon .ms-Icon--embed{font-size:1.4em;width:21px;display:inline-block;vertical-align:top;margin-top:9px}.CommandBarItem .CommandBarItem-icon .ContextualMenu.has-icon .ms-Icon--embed{margin-top:2px}.CommandBarItem .CommandBarItem-icon .ms-Icon--pictureAdd{width:19px}.CommandBarItem .CommandBarItem-icon .ms-Icon--print{width:17px}[is-flipped].CommandBarItem-icon{clear:both;line-height:35px;padding:3px 0 0 6px}html[dir=ltr] [is-flipped].CommandBarItem-icon{float:right;margin-left:2px}html[dir=rtl] [is-flipped].CommandBarItem-icon{float:left;padding:3px 6px 0 0;margin-right:2px}[is-flipped].CommandBarItem-commandText{line-height:40px}html[dir=ltr] [is-flipped].CommandBarItem-commandText{margin-left:0;float:right}html[dir=rtl] [is-flipped].CommandBarItem-commandText{margin-right:0;float:left}.od--hasSelection .CommandBarItem{color:#666}.od--hasSelection .CommandBarItem .CommandBarItem-icon{color:#094AB2}.od-theme--darkTransparent .od--hasSelection .CommandBarItem .CommandBarItem-icon{color:#fff}.od--hasSelection .CommandBarItem:hover{background-color:#a8d1ef;color:#07288b}.od--hasSelection .is-toggled.CommandBarItem{background-color:#9ccbf0;color:#07288b}.od--hasSelection .is-toggled.CommandBarItem:hover{background:#88bded;color:#07288b}.od--hasSelection .ms-Icon--chevronDown,.od--hasSelection .ms-Icon--chevronDown:hover{color:#07288b}.od-focus--enabled .CommandBarItem.is-focused:focus .CommandBarItem-link:before{content:'';border:1px solid #767676;margin:4px;position:absolute;top:1px;left:1px;right:1px;bottom:1px}.od--hasSelection .od-focus--enabled .CommandBarItem.is-focused:focus .CommandBarItem-link:before{border:1px solid #666}.od-focus--enabled .CommandBarItem.is-focused.icon-only:focus .CommandBarItem-link:before,.od-focus--enabled.md .CommandBarItem.is-focused:focus .CommandBarItem-link:before,.od-focus--enabled.sm .CommandBarItem.is-focused:focus .CommandBarItem-link:before{width:72%;left:50%}html[dir=ltr] .od-focus--enabled .CommandBarItem.is-focused.icon-only:focus .CommandBarItem-link:before,html[dir=ltr] .od-focus--enabled.md .CommandBarItem.is-focused:focus .CommandBarItem-link:before,html[dir=ltr] .od-focus--enabled.sm .CommandBarItem.is-focused:focus .CommandBarItem-link:before{margin-left:-13px}html[dir=rtl] .od-focus--enabled .CommandBarItem.is-focused.icon-only:focus .CommandBarItem-link:before,html[dir=rtl] .od-focus--enabled.md .CommandBarItem.is-focused:focus .CommandBarItem-link:before,html[dir=rtl] .od-focus--enabled.sm .CommandBarItem.is-focused:focus .CommandBarItem-link:before{margin-right:-13px}.selection-active .CommandBarItem.is-selected{background:#fff;color:#000}.CommandBarItem-linkWrapper{position:relative}.CommandBarItem-link{line-height:39px;padding:0 6px;cursor:pointer;height:40px;min-width:22px;text-align:center;position:relative}.CommandBarItem-link.is-open{background-color:#f8f8f8}.CommandBarItem-link .ms-Icon--chevronDown{vertical-align:top;padding-bottom:3px;margin-top:14px;font-size:1.1em;line-height:1em}.CommandBarItem-link .ms-Icon--chevronDown:before{height:10px;line-height:16px}.lg .CommandBarItem-link,.md .CommandBarItem-link,.sm .CommandBarItem-link{padding:0 6px}html[dir=rtl] .lg .CommandBarItem-link,html[dir=rtl] .xlg .CommandBarItem-link,html[dir=rtl] .xxlg .CommandBarItem-link,html[dir=rtl] .xxxlg .CommandBarItem-link{padding-left:8px}html[dir=ltr] .lg .CommandBarItem-link,html[dir=ltr] .xlg .CommandBarItem-link,html[dir=ltr] .xxlg .CommandBarItem-link,html[dir=ltr] .xxxlg .CommandBarItem-link{padding-right:8px;padding-left:6px}html[dir=ltr] .lg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=ltr] .xlg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=ltr] .xxlg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=ltr] .xxxlg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=rtl] .lg .CommandBarItem-link,html[dir=rtl] .xlg .CommandBarItem-link,html[dir=rtl] .xxlg .CommandBarItem-link,html[dir=rtl] .xxxlg .CommandBarItem-link{padding-right:6px}html[dir=rtl] .lg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=rtl] .xlg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=rtl] .xxlg .CommandBarItem.icon-only .CommandBarItem-link,html[dir=rtl] .xxxlg .CommandBarItem.icon-only .CommandBarItem-link{padding-left:6px}html[dir=ltr] .CommandBarItem.icon-only .CommandBarItem-link .CommandBarItem-icon{margin-right:0}html[dir=rtl] .CommandBarItem.icon-only .CommandBarItem-link .CommandBarItem-icon{margin-left:0}.CommandBar-mobile .CommandBarItem-link{height:48px;line-height:48px}.CommandBarItem-commandText,.CommandBarItem-commandTextLeft{color:#333;line-height:16px}.lg .CommandBarItem-commandText,.lg .CommandBarItem-commandTextLeft,.xlg .CommandBarItem-commandText,.xlg .CommandBarItem-commandTextLeft,.xxlg .CommandBarItem-commandText,.xxlg .CommandBarItem-commandTextLeft,.xxxlg .CommandBarItem-commandText,.xxxlg .CommandBarItem-commandTextLeft{margin:0 4px}.od-theme--darkTransparent .CommandBarItem-commandText,.od-theme--darkTransparent .CommandBarItem-commandTextLeft{color:#fff}html[dir=ltr] .CommandBarItem-commandText{margin-left:6px}html[dir=rtl] .CommandBarItem-commandText{margin-right:6px}html[dir=ltr] .CommandBarItem-commandTextLeft{margin-right:12px}html[dir=rtl] .CommandBarItem-commandTextLeft{margin-left:12px}.od-Browser--ie .CommandBarItem .ms-Icon--sortLines{margin-top:11px}.od-Browser--ie .CommandBarItem .ms-Icon--circlePlus{margin-top:10px}.od-Browser--ie [is-flipped].CommandBarItem-commandText{line-height:39px}.CommandBarItem-uploadInput{position:absolute;height:40px;top:0;left:0;right:0;opacity:.0001;cursor:pointer;overflow:hidden;z-index:2}.CommandBarItem-uploadInput input{position:absolute;top:0;font-size:200px;height:100px;cursor:pointer;margin:0;padding:0}html[dir=ltr] .CommandBarItem-uploadInput input{right:0}html[dir=rtl] .CommandBarItem-uploadInput input{left:0}.CommandBarItem-payload{display:none;white-space:normal}html[dir=ltr] .CommandBarItem-payload{text-align:left}html[dir=rtl] .CommandBarItem-payload{text-align:right}.CommandBarItem--hasPayload .CommandBarItem-payload{display:block}")});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/overlays/anchor/AnchorOverlayViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/beakAdorner/BeakAdornerBinding","../../../bindings/measure/MeasureBinding","odsp-utilities/math/Point","odsp-utilities/math/Rectangle","../../../bindings/contextMenu/ContextMenuAlignment"],function(e,t,o,i,n,a,r,s,l,d){var c=function(e){function t(t){var i=this;e.call(this,t),this.addBindingHandlers({host:n,beakAdorner:a,measure:r,offset:s}),this.renderedTemplate=o.observable(),this._trigger=t.trigger||o.observable(),this._hasExplicitAlignment=!!t.hasExplicitAlignment,this._allowMenuNudging=!!t.allowMenuNudging,this.clientRect=o.observable(new l(0,0,0,0)),this.isBeakVisible=t.isBeakVisible||o.observable(!0),this._offset=t.offset||o.observable(new s(0,a.size/2+4)),this.beak=o.observable(),this.anchorElement=t.anchorElement||null,this._assignAlignment(t),this.isScrollable=o.observable(!1),this._left=t.left||o.observable(""),this._top=t.top||o.observable(""),this.style=o.observable({}),this.contentStyle=o.observable({}),this.createComputed(this._computeStyles),this.measureTrigger=this.createComputed(function(){return i.renderedTemplate(),i._trigger(),{}})}return __extends(t,e),t.prototype._assignAlignment=function(e){this._alignment=e.alignment?"string"==typeof e.alignment?o.observable(d[e.alignment]):o.isObservable(e.alignment)?e.alignment:o.observable(e.alignment):o.observable(d.Left|d.Top)},t.prototype._computeStyles=function(){var e=new s(0,0),t=new l(0,0,document.body.clientWidth,document.body.clientHeight),o="",i="",n=!1;if(this.renderedTemplate()&&this.clientRect()){var a=this.clientRect().translate(-parseFloat(this.style().marginLeft),-parseFloat(this.style().marginTop));this._trigger(),e=e.add(this._offset());var r=this._alignment();this._hasExplicitAlignment||(r=this._determineBestFitAlignment(a,r)),e=this._transformMenuCoordinate(e,a,r);var d=a.translate(e);if(!t.contains(d)){var c=this._allowMenuNudging?d.nudge(t):d;t.contains(c)||(c=c.clip(t),o=c.width+"px",i=c.height+"px",n=!0),e=e.add(new s(c.x-d.x,c.y-d.y))}}this.style({left:this._left(),top:this._top(),marginLeft:Math.floor(e.x)+"px",marginTop:Math.floor(e.y)+"px"}),this.contentStyle({width:o,height:i}),this.isScrollable(n),this.beak({})},t.prototype._determineBestFitAlignment=function(e,t){var o=t,i=e.getPoint();if(e.width<=document.body.clientWidth&&e.height<=document.body.clientHeight){var n=this._transformMenuCoordinate(i,e,o);(n.x<0||n.x+e.width>document.body.clientWidth)&&(o^=d.Right),(n.y<0||n.y+e.height>document.body.clientHeight)&&(o^=d.Bottom)}return o},t.prototype._transformMenuCoordinate=function(e,t,o){var i=new s(e.x,e.y);return o&d.Right?i.x-=t.width:o&d.Center&&(i.x-=t.width/2),o&d.Bottom?i.y-=t.height:o&d.VerticalCenter&&(i.y-=t.height/2),i},t}(i);return c}),define("odsp-next/controls/overlays/anchor/AnchorOverlay.html",[],function(){return'<div class=AnchorOverlay data-bind="beakAdorner: { trigger: beak, isBeakVisible: isBeakVisible, anchorElement: anchorElement }, style: style, measure: { measure: clientRect, trigger: measureTrigger }"><div class=AnchorOverlay-content tabindex=-1 data-bind="style: contentStyle, css: { \'is-scrollable\': isScrollable }, host: { afterRender: $component.renderedTemplate }"></div></div>'}),define("odsp-next/controls/overlays/anchor/AnchorOverlay.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".AnchorOverlay{color:#333;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;box-sizing:border-box;margin:0;padding:0;display:block;position:absolute;box-shadow:0 0 5px 0 rgba(0,0,0,.4);background-color:#fff;border:1px solid #c8c8c8}.AnchorOverlay-content{padding:10px;background-color:#fff;position:relative}")}),define("odsp-next/controls/overlays/anchor/AnchorOverlay",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./AnchorOverlayViewModel","./AnchorOverlay.html","./AnchorOverlay.css"],function(e,t,o,i){var n=o.registerComponent({tagName:"ms-anchor-overlay",template:e("./AnchorOverlay.html"),viewModel:i,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/teachingBubble/TeachingBubbleViewModel",["require","exports","odsp-shared/base/ViewModel","../../bindings/beakAdorner/BeakAdornerBinding","../../resources/ProviderResourceKeys","odsp-utilities/math/Point","../../resources/ControlResourceKeys","knockout"],function(e,t,o,i,n,a,r,s){var l=100,d=function(e){function t(t){var o=this;e.call(this,t),this.addBindingHandlers({beakAdorner:i}),this._teachingBubbleProvider=this.resources.consume(n.teachingBubble),this._isUserDismissed=s.observable(!1),this.teachingBubbleInstance=s.unwrap(t.teachingBubbleInstance),this.menuAlignment=s.observable(0),this.menuOffset=s.observable(new a(0,i.size/2+4)),this.layoutChanged=s.observable(),this._isElementHidden=s.observable(!0),this.left=s.observable("auto"),this.top=s.observable("auto"),this.events.on(window,"resize",this._onResize),this.isHidden=this.createComputed(function(){return o._isElementHidden()||o._isUserDismissed()}),this._viewParams=this.resources.consume(r.viewParams),this.subscribe(this._viewParams,this._onResize),s.utils.domNodeDisposal.addDisposeCallback(this.teachingBubbleInstance.anchorElement,function(){o._isElementHidden(!0)}),this._onResize(),this._markBubbleAsShown()}return __extends(t,e),t.prototype.closeTeachingBubble=function(){this._isUserDismissed(!0),this._teachingBubbleProvider.markBubbleAsDismissed(this.teachingBubbleInstance.campaign)},t.prototype._markBubbleAsShown=function(){this._teachingBubbleProvider.markBubbleAsSeen(this.teachingBubbleInstance.campaign)},t.prototype._onResize=function(){var e=this;this.async.setTimeout(function(){var t=window.getComputedStyle(e.teachingBubbleInstance.anchorElement),o=e.teachingBubbleInstance.anchorElement.clientHeight,i=e._viewParams().o&&"oneup"===e._viewParams().o.toLowerCase();if(t&&""!==t.display&&"none"!==t.display&&o>0&&!i){var n=e.teachingBubbleInstance.anchorElement.getBoundingClientRect();e.top(n.bottom+"px"),e.left(n.left+"px"),e._isElementHidden(!1)}else e._isElementHidden(!0)},l)},t}(o);return d}),define("odsp-next/controls/teachingBubble/TeachingBubble.html",[],function(){return'<div class=od-TeachingBubble-anchor data-bind="component: { name: \'ms-anchor-overlay\', params: { alignment: menuAlignment, offset: menuOffset, hasExplicitAlignment: true, allowMenuNudging: true, trigger: layoutChanged, anchorElement: teachingBubbleInstance.anchorElement, top: top, left: left } }, visible: !isHidden()"><div class=od-TeachingBubble><div class=od-TeachingBubble-campaignWrapper><span class="od-TeachingBubble-closeButton ms-Icon ms-Icon--x" data-bind="click: closeTeachingBubble"></span><p class=ms-font-xl data-bind="text: teachingBubbleInstance.campaign.title"></p><p class=ms-font-s data-bind="text: teachingBubbleInstance.campaign.bodyCopy"></p><!--ko if: !!teachingBubbleInstance.campaign.linkUrl--><a data-bind="text: teachingBubbleInstance.campaign.linkText, attr: { href: teachingBubbleInstance.campaign.linkUrl }"></a><!--/ko--></div></div></div>'}),define("odsp-next/controls/teachingBubble/TeachingBubble.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles('.od-TeachingBubble-anchor .AnchorOverlay-content{padding:0}.od-TeachingBubble-anchor .AnchorOverlay{border:none}.od-TeachingBubble-anchor .Beak-container:before{content:" ";height:17px;left:1px;position:absolute;top:1px;width:25px;background-color:#fff;z-index:4002}.od-TeachingBubble-anchor .Beak-arrow{z-index:4001}.od-TeachingBubble{position:absolute;z-index:3999}.sm .od-TeachingBubble-campaignWrapper{width:140px}.od-TeachingBubble-campaignWrapper{background:#fff;width:250px;max-height:300px;padding:20px 25px 27px;box-shadow:0 0 5px 0 rgba(0,0,0,.4);border:1px solid #c8c8c8}.od-TeachingBubble-campaignWrapper a{margin-top:12px;font-size:14px}.od-TeachingBubble-campaignWrapper p.ms-font-xl{margin:0 0 11px}.od-TeachingBubble-closeButton{position:absolute;top:10px;right:10px;cursor:pointer}')}),define("odsp-next/controls/teachingBubble/TeachingBubble",["require","exports","./TeachingBubbleViewModel","odsp-shared/utilities/knockout/ComponentFactory","./TeachingBubble.html","./TeachingBubble.css","../overlays/Overlay","../overlays/anchor/AnchorOverlay"],function(e,t,o,i){var n=i.registerComponent({tagName:"od-teaching-bubble",template:e("./TeachingBubble.html"),viewModel:o,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/icon/glyph/IconGlyphViewModel",["require","exports","odsp-shared/base/ViewModel","../../../bindings/css/ClassesBinding","knockout"],function(e,t,o,i,n){var a=function(e){function t(t){var o=this;e.call(this,t),this.icon=n.isObservable(t.icon)?t.icon:n.observable(t.icon),this.badge=n.isObservable(t.badge)?t.badge:n.observable(t.badge),this.addBindingHandlers({classes:i}),this.iconClasses=this.createComputed(function(){return o.icon()&&o.icon().getClass()||""}),this.badgeClasses=this.createComputed(function(){return o.badge()&&o.badge().getClass()||""})}return __extends(t,e),t}(o);return a}),define("odsp-next/controls/icon/glyph/IconGlyph.html",[],function(){return'<i class="od-IconGlyph ms-Icon" data-bind="classes: { base: iconClasses, mappings: { \'od-IconGlyph--badged\': badge, \'od-IconGlyph--visible\': icon } }, with: badge"><i class="od-IconGlyph-badge ms-Icon ms-Icon--badge" data-bind="classes: { base: $component.badgeClasses }"></i></i>'}),define("odsp-next/controls/icon/glyph/IconGlyph.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-IconGlyph-badge.ms-Icon,.od-IconGlyph.ms-Icon{width:1em;height:1em;text-align:center;white-space:nowrap}.od-IconGlyph.ms-Icon{display:none;font-size:1.1em;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;color:#a80000}html[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}html[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}")}),define("odsp-next/controls/icon/glyph/IconGlyph",["require","exports","./IconGlyphViewModel","odsp-shared/utilities/knockout/ComponentFactory","./IconGlyph.html","./IconGlyph.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"od-icon-glyph",template:e("./IconGlyph.html"),viewModel:o,synchronous:!0});return n}),define("odsp-next/controls/commandBarItem/CommandBarItem",["require","exports","./CommandBarItemViewModel","odsp-shared/utilities/knockout/ComponentFactory","./CommandBarItem.html","./CommandBarItem.css","../overlays/anchor/AnchorOverlay","../teachingBubble/TeachingBubble","../icon/glyph/IconGlyph"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-command-bar-item",template:e("./CommandBarItem.html"),viewModel:o,synchronous:!0});return n}),define("odsp-next/controls/commandBar/CommandBar",["require","exports","./CommandBarViewModel","odsp-shared/utilities/knockout/ComponentFactory","./CommandBar.html","./CommandBar.css","../commandBarItem/CommandBarItem","../contextualMenu/ContextualMenu"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-command-bar",template:e("./CommandBar.html"),viewModel:o,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/breadcrumbBar/BreadcrumbBarViewModel",["require","exports","knockout","../commands/CommandViewModel","../../bindings/dismiss/DismissBinding","../../bindings/dragAndDrop/DragAndDropBinding","../dragAndDrop/DropHelper","../../actions/OpenAction","../../actions/OpenRelation","odsp-utilities/math/Point","odsp-shared/base/ViewModel","../../resources/DataSourceResourceKeys","../../resources/UtilityResourceKeys","../leftPane/LeftPane.resx"],function(e,t,o,i,n,a,r,s,l,d,c,u,m,p){var h=function(e){function t(t){var i=this;e.call(this,t),this._currentDroppingCrumb=null,this.isDroppable=o.observable(!0),this.isDroppingTarget=o.observable(!1),this.isOverflowOpen=o.observable(!1),this.addBindingHandlers({dismiss:n,dragAndDrop:a.default}),this.overflowMenuOffset=o.observable(new d(0,16)),this._item=t.item,this._urlDataSource=this.resources.consume(u.url),this._responsiveUI=this.resources.consume(m.responsiveUI),this._openActionItem=o.observable(null),this._openAction=new(this.managed(s))({item:this._openActionItem,openRelation:l.specified}),this._dropHelper=new(this.managed(r)),this.overflowCrumbs=o.observableArray(),this.crumbs=this.createComputed(function(){return i._computeCrumbs(t.getCrumbs)
})}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.crumbs.dispose()},t.prototype.onMayReceiveDrop=function(e,t){var i=t?o.dataFor(t):null;return i&&i.item&&i.showNextChevron?(this.onRemoveDropLocation(),this._currentDroppingCrumb=i,this._currentDroppingCrumb.isDroppingTarget(!0),{targetName:i.item.name}):(this.onRemoveDropLocation(),null)},t.prototype.onReceiveDrop=function(e,t){var i=t?o.dataFor(t):null,n=this._dropHelper.processDrop(e,i.item);return n&&this.onRemoveDropLocation(),n},t.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)},t.prototype.onClick=function(e,t){if(e.isOverflow)this.isOverflowOpen(!this.isOverflowOpen());else if(e.item)this._openActionItem(e.item),this._openAction.execute(t);else{var o=this.resources.consume(m.navigation);o.navigateTo(e.url)}},t.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var o=[],i=[],n=t.MAX_FOLDERS_VISIBLE_LPLUS;this._responsiveUI.formFactorSize()<=this._responsiveUI.windowSize.Medium&&(n=t.MAX_FOLDER_VISIBLE_MDOWN);var a=this._item(),r=[];a&&a.key&&(e?r=e(a):a.parent&&(r=this._getCrumbsForNonRoots(a)));for(var s=0;s<r.length;s++)o.length<n?o.unshift(r[s]):i.unshift(this._commandForCrumb(r[s]));return i.length&&o.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1}),this.overflowCrumbs().forEach(function(e){e.dispose()}),this.overflowCrumbs(i),o},t.prototype._getCrumbsForNonRoots=function(e){for(var t=[],i=!1;e;){var n=i,a=!i;e.isStub&&(n=!1,a=!0);var r={key:e.key,url:"#"+e.key,name:e.name||p.strings.Files,showNextChevron:i,isDroppingTarget:o.observable(!1),item:e,isOverflow:!1,isNavItem:n,isStaticItem:a};t.push(r),i=!0,e=e.parent}return t},t.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(i))({text:e.name,url:e.url,callback:function(){e.isNavItem&&t.onClick(e,null)}})},t.MAX_FOLDERS_VISIBLE_LPLUS=4,t.MAX_FOLDER_VISIBLE_MDOWN=2,t}(c);return h}),define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.html",[],function(){return'<div class=BreadcrumbBar><ul class=BreadcrumbBar-list role=menu data-bind="foreach: crumbs, dragAndDrop:{ mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"><li><!--ko if: isOverflow--><a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon ms-Icon--ellipsis" href=# aria-haspopup=true role=menuitem data-bind="click: function(ev) { $parent.onClick($data, ev) }, dismiss: { isOpen: $parent.isOverflowOpen }, attr: { \'aria-expanded\': $parent.isOverflowOpen() }"><!--ko if: $parent.isOverflowOpen()--><ms-contextual-menu params="items: $parent.overflowCrumbs, isOpen: $parent.isOverflowOpen, offset: $parent.overflowMenuOffset"></ms-contextual-menu><!--/ko--></a><!--/ko--><!--ko if: isNavItem--><a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" data-bind="text: name, click: function(ev) { $parent.onClick($data, ev) }, attr: { href: url }, css: { dropping: isDroppingTarget }" role=menuitem></a><!--/ko--><!--ko if: isStaticItem--><span class=BreadcrumbBar-item data-bind="text: name"></span><!--/ko--><!--ko if: showNextChevron--><i class=BreadcrumbBar-item-chevron role=presentation></i><!--/ko--></li></ul></div>'}),define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".xlg .BreadcrumbBar,.xxlg .BreadcrumbBar,.xxxlg .BreadcrumbBar{margin-top:7px}.BreadcrumbBar-list{margin:0;padding:0;display:block;white-space:nowrap;overflow:hidden;font-size:0}html[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}html[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;vertical-align:top;margin:0;padding:0;display:inline-block}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:12px;display:inline-block;color:#094AB2;padding:9px 8px 7px;cursor:pointer}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow{padding-top:11px;padding-bottom:6px}.BreadcrumbBar-overflow:hover{color:#094AB2}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:#f4f4f4}.BreadcrumbBar-item.dropping,.BreadcrumbBar-navItem:active{background:#c8c8c8}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px #c8c8c8 inset}a.BreadcrumbBar-item{color:#333}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{color:#333;font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;height:28px;line-height:32px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{color:#333;font-family:'Segoe UI Semilight WestEuropean','Segoe UI Semilight','Segoe WP Semilight','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item{color:#333;font-family:'Segoe UI Light WestEuropean','Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;padding-bottom:1px;line-height:28px}.BreadcrumbBar-item-chevron{font-size:14px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-family:Office365Icons;font-style:normal;font-weight:400;line-height:1;speak:none;color:#666;vertical-align:top;margin-top:9px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron{font-size:21px;margin-top:7px}.BreadcrumbBar-item-chevron:after{content:'\\e08a'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{content:'\\e089'}")}),define("odsp-next/controls/breadcrumbBar/BreadcrumbBar",["require","exports","./BreadcrumbBarViewModel","odsp-shared/utilities/knockout/ComponentFactory","./BreadcrumbBar.html","./BreadcrumbBar.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-breadcrumb-bar",template:e("./BreadcrumbBar.html"),viewModel:o,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/transclusion/host/TransclusionHostBinding",["require","exports","../../BaseBinding","odsp-utilities/domUtils/DomUtils","knockout"],function(e,t,o,i,n){var a=function(e){function t(t){e.call(this,t);var o=this._context=this.valueAccessor();o.parentElement&&i.setShadowParent(this.element,o.parentElement),n.applyBindingsToNode(this.element,{template:{nodes:o.templateNodes}},o.bindingContext),o.renderCount(o.renderCount.peek()+1),this.controlsDescendantBindings=!0}return __extends(t,e),t.prototype.dispose=function(){this._context.renderCount(this._context.renderCount.peek()-1),e.prototype.dispose.call(this)},t.supportsVirtualElements=!0,t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/focus/FocusForwardBinding",["require","exports","knockout","../../utilities/accessibility/Accessibility","../BaseBinding"],function(e,t,o,i,n){var a=function(e){function t(t){var n=this;e.call(this,t),this._otherElement=o.unwrap(t.valueAccessor()),this._thisElement=o.unwrap(t.element),this.events.on(this._thisElement,"focus",function(){var e=i.getNextTabStop(n._otherElement);e?e.focus():i.focusNextTabStop(n._thisElement)}),this.events.on(this._otherElement,"focus",function(){var e=i.getPreviousTabStop(n._thisElement);e?e.focus():i.focusPreviousTabStop(n._otherElement)})}return __extends(t,e),t}(n);return a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/bindings/focus/FocusBackwardBinding",["require","exports","knockout","../../utilities/accessibility/Accessibility","../BaseBinding"],function(e,t,o,i,n){var a=function(e){function t(t){var n=this;e.call(this,t),this._otherElement=o.unwrap(t.valueAccessor()),this._thisElement=o.unwrap(t.element),this.events.on(this._otherElement,"focus",function(){var e=i.getNextTabStop(n._thisElement);e?e.focus():i.focusNextTabStop(n._otherElement)}),this.events.on(this._thisElement,"focus",function(){var e=i.getPreviousTabStop(n._otherElement);e?e.focus():i.focusPreviousTabStop(n._thisElement)})}return __extends(t,e),t}(n);return a});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/overlays/host/OverlayHostViewModel",["require","exports","knockout","odsp-shared/base/ViewModel","../../../resources/ProviderResourceKeys","odsp-utilities/domUtils/DomUtils","../../../bindings/transclusion/host/TransclusionHostBinding","../../../bindings/focus/FocusForwardBinding","../../../bindings/focus/FocusBackwardBinding","../../../bindings/focus/OnFocusBinding","../../../utilities/accessibility/Accessibility"],function(e,t,o,i,n,a,r,s,l,d,c){var u="od-OverlayHost-overlay--opened",m="od-OverlayHost-overlay--initial",p="od-OverlayHost-overlay--closed",h=function(e){function t(t){e.call(this,t),this.addBindingHandlers({transclusionHost:r.default,focusForward:s,focusBackward:l,focus:d}),this.overlayProvider=this.resources.consume(n.overlay),this.topTab=o.observable(null),this.bottomTab=o.observable(null),this.isReady=o.observable(!1),this.isInitial=o.observable(!0),this.async.setTimeout(this._onIsReadyTimeoutCompleted,0)}return __extends(t,e),t.prototype.onAddOverlayElement=function(e,t,i){var n=i.options.animation,a=n&&n.afterAdd;a?this.async.setTimeout(function(){o.utils.toggleDomNodeCssClass(e,u,!0),o.utils.toggleDomNodeCssClass(e,m,!1)},a):(o.utils.toggleDomNodeCssClass(e,u,!0),o.utils.toggleDomNodeCssClass(e,m,!1))},t.prototype.onRemoveOverlayElement=function(e,t,i){var n=i.options.animation,a=n&&n.beforeRemove;a?(o.utils.toggleDomNodeCssClass(e,m,!1),o.utils.toggleDomNodeCssClass(e,u,!1),o.utils.toggleDomNodeCssClass(e,p,!0),this.async.setTimeout(function(){o.removeNode(e)},a)):o.removeNode(e)},t.prototype.focusedTop=function(){var e=c.getNextTabStop(this.bottomTab());e&&e.focus()},t.prototype.focusedBottom=function(){var e=c.getPreviousTabStop(this.topTab());e&&e.focus()},t.prototype.isPositioned=function(e){return e.alignToParent()},t.prototype.getOverlayStyle=function(e,t){var o={};if(this.isPositioned(e)){var i=a.calculateRect(t.parentElement);o.top=i.getTop()+"px",o.left=i.getLeft()+"px",o.right=window.innerWidth-i.getRight()+"px"}return o},t.prototype._onIsReadyTimeoutCompleted=function(){this.isReady(!0),this.isInitial(!1)},t}(i);return h}),define("odsp-next/controls/overlays/host/OverlayHost.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-OverlayHost,.od-OverlayHost-overlay--positioned{position:absolute}.od-OverlayHost{z-index:4000;top:0;left:0;bottom:0;right:0;visibility:hidden;overflow:hidden}.od-OverlayHost-overlay{visibility:visible}")}),define("odsp-next/controls/overlays/host/OverlayHost.html",[],function(){return'<a href=javascript:; class=ms-accessible aria-hidden=true data-bind="element: topTab, focus: focusedTop"></a><div class=od-OverlayHost data-bind="component: { name: \'od-transclusion-host\', params: { provider: overlayProvider, useCustomTemplate: true } }"><!--ko template: {\n foreach: $host.contexts,\n if: isReady,\n afterAdd: $component.onAddOverlayElement.bind($component),\n beforeRemove: $component.onRemoveOverlayElement.bind($component)\n }--><a href=javascript:; class=ms-accessible aria-hidden=true data-bind="focusBackward: options.topTab"></a><div class=od-OverlayHost-overlay data-bind="css: { \'od-OverlayHost-overlay--positioned\': $component.isPositioned(options), \'od-OverlayHost-overlay--initial\': $component.isInitial.peek() }, style: $component.getOverlayStyle(options, parentElement), transclusionHost: $data"></div><a href=javascript:; class=ms-accessible aria-hidden=true data-bind="focusForward: options.bottomTab"></a><!--/ko--></div><a href=javascript:; class=ms-accessible aria-hidden=true data-bind="element: bottomTab, focus: focusedBottom"></a>'}),define("odsp-next/controls/transclusion/host/templates/TransclusionHostTemplates",["require","exports"],function(e,t){t.DEFAULT="od-transclusion-host-default",t.CUSTOM="od-transclusion-host-custom"});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/transclusion/host/TransclusionHostViewModel",["require","exports","odsp-shared/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/transclusion/host/TransclusionHostBinding","./templates/TransclusionHostTemplates","odsp-shared/utilities/object/EqualityComparers"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){e.call(this,t),this.addBindingHandlers({host:i,transclusionHost:n.default}),this._provider=t.provider,this._renderCount=t.renderCount,this.contexts=this._provider.contexts,this.currentContext=this.createPureComputed(this._computeCurrentContext),this.currentContext.equalityComparer=r.objectStrictEquality;var o;o=t.useCustomTemplate?a.CUSTOM:a.DEFAULT,this.templateName=o,this._renderCount&&this.createComputed(this._computeSetRenderCount)}return __extends(t,e),t.prototype._computeCurrentContext=function(){return this.contexts()[this.contexts().length-1]||null},t.prototype._computeSetRenderCount=function(){this._renderCount(this.contexts().length)},t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s}),define("odsp-next/controls/transclusion/host/TransclusionHost.html",[],function(){return"<!--ko template: templateName--><!--/ko-->"}),define("odsp-next/controls/transclusion/host/templates/TransclusionHostDefault.html",[],function(){return"<!--ko with: currentContext--><!--ko transclusionHost: $data--><!--/ko--><!--/ko-->"}),define("odsp-next/controls/transclusion/host/templates/TransclusionHostCustom.html",[],function(){return"<!--ko host: {\n data: {\n contexts: contexts\n }\n}--><!--/ko-->"}),define("odsp-next/controls/transclusion/host/TransclusionHost",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./TransclusionHostViewModel","./templates/TransclusionHostTemplates","./TransclusionHost.html","./templates/TransclusionHostDefault.html","./templates/TransclusionHostCustom.html"],function(e,t,o,i,n){var a=o.registerComponent({tagName:"od-transclusion-host",template:e("./TransclusionHost.html"),viewModel:i.default,synchronous:!0});o.registerTemplate(n.DEFAULT,e("./templates/TransclusionHostDefault.html")),o.registerTemplate(n.CUSTOM,e("./templates/TransclusionHostCustom.html")),Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}),define("odsp-next/controls/overlays/host/OverlayHost",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./OverlayHostViewModel","./OverlayHost.css","./OverlayHost.html","../../transclusion/host/TransclusionHost"],function(e,t,o,i){var n=o.registerComponent({tagName:"od-overlay-host",template:e("./OverlayHost.html"),viewModel:i,synchronous:!0});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/languagePicker/LanguagePickerViewModel",["require","exports","knockout","../../resources/DataSourceResourceKeys","./LanguagePicker.resx","../../utilities/locale/Locale","odsp-shared/base/ViewModel"],function(e,t,o,i,n,a,r){var s=function(e){function t(t){var r=this;e.call(this,t),this.canary=t.canary,this.selectedLanguage=t.selectedLanguage,this.loadingText=n.strings.loading,this.isLoading=o.observable(!0),this.languages=o.observableArray([]),this.currentLanguage=o.observable(""),this._dataSource=this.resources.consume(i.languagePicker),this._dataSource&&this._dataSource.getLanguages().then(function(e){r.canary(e.canary),r.currentLanguage(e.currentLanguage);for(var t=e.languageList,o=0;o<t.length;o++){var i=t[o];i.displayText=(a.isRightToLeft?"&rlm;":"&lrm;")+i.nativeName+" - "+i.name}r.languages(t),r.isLoading(!1)})}return __extends(t,e),t}(r);return s}),define("odsp-next/controls/languagePicker/LanguagePicker.html",[],function(){return'<form class=LanguagePicker><!--ko if: $data.isLoading--><div data-bind="text: loadingText"></div><!--/ko--><!--ko ifnot: $data.isLoading--><select name=language data-bind="value: selectedLanguage, foreach: languages, automation: \'dropDown\'"><option data-bind="attr: {selected: isoValue === $parent.currentLanguage()}, value: isoValue, html: displayText"></option></select><!--/ko--></form>'}),define("odsp-next/controls/languagePicker/LanguagePicker.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".LanguagePicker select{width:100%}")}),define("odsp-next/controls/languagePicker/LanguagePicker",["require","exports","./LanguagePickerViewModel","odsp-shared/utilities/knockout/ComponentFactory","./LanguagePicker.html","./LanguagePicker.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-language-picker",template:e("./LanguagePicker.html"),viewModel:o});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/actions/LanguagePickerAction",["require","exports","knockout","../base/BaseSelectionAction","../resources/DataSourceResourceKeys","../models/dialog/DialogState","../controls/languagePicker/LanguagePicker","../controls/languagePicker/LanguagePicker.resx","../utilities/navigation/NavigationHelper","../resources/ProviderResourceKeys","odsp-utilities/logging/events/Qos.event","../resources/UtilityResourceKeys","../utilities/icons/Icon"],function(e,t,o,i,n,a,r,s,l,d,c,u,m){var p=function(e){function t(t){e.call(this,t),this.name="LanguagePicker",this._lang=o.observable(""),this._canary=o.observable(""),this._languagePickerDataSource=this.resources.consume(n.languagePicker)}return __extends(t,e),t.prototype.onExecute=function(){var e=this,t=this.resources.consume(d.dialog),i=t.requestDialog({title:s.strings.language,automationId:"languagePicker",component:{name:r.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:s.strings.save,execute:function(){return e.onDialogExecute()},isAvailable:o.observable(!0),icon:m.save,isDefault:!0}]});return i.wait().then(function(){return{resultType:c.ResultTypeEnum.Success}})},t.prototype.onIsAvailable=function(){return!0},t.prototype.onDialogExecute=function(){var e=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(t){var o=e.resources.consume(u.navigation);return o.navigateTo(l.replaceQuery(window.location.href,"mkt",t)),a.completed})},t}(i);return p});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/footer/FooterViewModel",["require","exports","../../resources/DataSourceResourceKeys","../../actions/LanguagePickerAction","odsp-shared/base/ViewModel"],function(e,t,o,i,n){var a=function(e){function t(t){var n=this;e.call(this,t),this.links=[],this._dataSource=this.resources.consume(o.footer),this._dataSource&&(this.links=this._dataSource.getFooterLinks(),this._dataSource.showLanguageLink()&&this.links.push({text:this._dataSource.getLanguageText(),url:"#",onClick:function(e,t){(new(n.managed(i))).execute(t)},automationId:"lp"}),this.showConfidentialText=this._dataSource.showConfidentialText())}return __extends(t,e),t}(n);return a}),define("odsp-next/controls/footer/Footer.html",[],function(){return'<!--ko if: $data.links.length--><ul class=Footer><!--ko foreach: $data.links--><li data-bind="automation: $data.automationId"><!--ko if: $data.url--><!--ko if: $data.encodedText--><a class=Footer-item target=_blank data-bind="html: $data.encodedText, attr: { href: $data.url }, click: $data.onClick"></a><!--/ko--><!--ko if: !$data.encodedText--><a class=Footer-item target=_blank data-bind="text: $data.text, attr: { href: $data.url }, click: $data.onClick"></a><!--/ko--><!--/ko--><!--ko if: !$data.url--><!--ko if: $data.encodedText--><span class="Footer-item is-disabled" data-bind="html: $data.encodedText"></span><!--/ko--><!--ko if: !$data.encodedText--><span class="Footer-item is-disabled" data-bind="text: $data.text"></span><!--/ko--><!--/ko--></li><!--/ko--><!--ko if: $data.showConfidentialText--><li><span class="Footer-item Footer-msconf">Microsoft Confidential</span></li><!--/ko--></ul><!--/ko-->'}),define("odsp-next/controls/footer/Footer.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".Footer{display:block;border-top:1px solid #eaeaea;margin:0;padding:8px 0 0}.Footer li{list-style-type:none;margin:0;padding:5px 10px;display:inline}.Footer-item{font-family:'Segoe UI Regular WestEuropean','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:#666;text-decoration:none;white-space:nowrap;display:inline-block;height:32px}a.Footer-item:focus,a.Footer-item:hover{color:#a6a6a6}.Footer-msconf{font-weight:700;color:#e81123}")}),define("odsp-next/controls/footer/Footer",["require","exports","./FooterViewModel","odsp-shared/utilities/knockout/ComponentFactory","./Footer.html","./Footer.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-footer",template:e("./Footer.html"),viewModel:o});return n}),define("odsp-next/bindings/logClick/ClickContextKeyEnum",["require","exports"],function(){var e;return function(e){e[e.SmartBanner_Close=0]="SmartBanner_Close"}(e||(e={})),e}),define("odsp-next/bindings/logClick/LogClickBinding",["require","exports","knockout","odsp-utilities/logging/events/Engagement.event","odsp-shared/utilities/string/StringHelper","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType"],function(e,t,o,i,n,a,r,s){var l=function(){function e(){}return e.init=function(t,l,d,c,u){var m,p,h,g=o.utils.unwrapObservable(l());if(g&&(m=g.logClickContext.contextKey,a[m]&&o.utils.registerEventHandler(t,e.BINDING_ACTION,function(){p=n.format(e.ENGAGEMENT_NAME_FORMAT,r[g.logClickContext.pageType],s[g.logClickContext.queryType],a[m]),h=i.Engagement.logData({name:p.toLowerCase(),extraData:{action:e.BINDING_ACTION}})}),g.click)){var f=function(){return g.click};return o.bindingHandlers.click.init(t,f,d,c,u)}},e.ENGAGEMENT_NAME_FORMAT="{0}_{1}_{2}",e.BINDING_ACTION="click",e}();return l});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/smartBanner/SmartBannerViewModel",["require","exports","odsp-shared/base/ViewModel","../../resources/UtilityResourceKeys","../../resources/ModelResourceKeys","odsp-utilities/models/store/DataStoreCachingType","../../resources/DataSourceResourceKeys","./SmartBanner.resx","../../bindings/logClick/LogClickBinding","../../bindings/logClick/ClickContextKeyEnum","knockout"],function(e,t,o,i,n,a,r,s,l,d,c){var u=function(e){function t(t){e.call(this,t);var o=this;o.addBindingHandlers({logClick:l}),o._milliAppLaunchDelta=500,o._promptWaitTimeMonths=6,o._millisecondsPerDay=864e5,o._milliAppLaunchWaitTime=1e3,o._daysPerMonth=30,o.resxStrings=c.observable(s.strings),o._navigation=this.resources.consume(i.navigation),o._dataStore=this.resources.consume(n.itemsStore),o._iosMobilePathDataSource=this.resources.consume(r.iosMobileAppPath),o._isVisible=t.isVisible,o._updateIsVisibleBinding(),o._setlogClickOptions()}return __extends(t,e),t.prototype.onCloseClick=function(){this._isVisible(!1),this._dataStore.setValue(t.STORAGE_KEY,Date.now(),a.local)},t.prototype.onContentClick=function(){var e=this,t=Date.now();this.async.setTimeout(function(){var o=Date.now(),i=o-t;i<e._milliAppLaunchDelta+e._milliAppLaunchWaitTime&&e._navigation.navigateTo(e._iosMobilePathDataSource.getStorePath())},this._milliAppLaunchWaitTime),this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())},t.prototype._setlogClickOptions=function(){var e=this.resources.consume(r.url);this.logCloseClickContext={contextKey:d.SmartBanner_Close,pageType:e.getPageType(),queryType:e.getQueryType()}},t.prototype._updateIsVisibleBinding=function(){var e=!1;if(this._iosMobilePathDataSource){e=!0;var o=this._dataStore.getValue(t.STORAGE_KEY,a.local);if(o){var i=this._getPromptWaitTimeMilli();o>i&&(e=!1)}}this._isVisible(e)},t.prototype._getPromptWaitTimeMilli=function(){return Date.now()-this._promptWaitTimeMonths*this._daysPerMonth*this._millisecondsPerDay},t.STORAGE_KEY="oneDriveSmartBannerVisible",t}(o);return u}),define("odsp-next/controls/smartBanner/SmartBanner.html",[],function(){return'<div class=SmartBanner><span class="SmartBanner-close ms-Icon ms-Icon--x" data-bind="logClick: { click: onCloseClick, logClickContext: logCloseClickContext }" role=button></span><div class=SmartBanner-content data-bind="click: onContentClick"><span class=SmartBanner-buttonWrapper><span class=SmartBanner-button data-bind="text: resxStrings().SmartBannerButtonText" role=button></span></span> <span class="SmartBanner-icon ms-Icon ms-Icon--onedrive" role=img></span><div class=SmartBanner-text><div class=SmartBanner-lead data-bind="text: resxStrings().SmartBannerLeadText"></div><div class=SmartBanner-tagline data-bind="text: resxStrings().SmartBannerTaglineText"></div></div></div></div>'}),define("odsp-next/controls/smartBanner/SmartBanner.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles("html[dir=ltr] .SmartBanner .SmartBanner-close,html[dir=ltr] .SmartBanner .SmartBanner-content,html[dir=rtl] .SmartBanner .SmartBanner-content{left:0}.SmartBanner{background-color:#f4f4f4;height:40px;overflow:hidden;cursor:pointer;border-top:1px solid #c8c8c8;border-bottom:1px solid #c8c8c8;position:relative}.SmartBanner .SmartBanner-close,.SmartBanner .SmartBanner-content{position:absolute;top:0;bottom:0}html[dir=rtl] .SmartBanner .SmartBanner-close,html[dir=rtl] .SmartBanner .SmartBanner-content{right:0}.SmartBanner .SmartBanner-close{width:40px;text-align:center;line-height:40px}.SmartBanner .SmartBanner-content{overflow:hidden}html[dir=ltr] .SmartBanner .SmartBanner-content{right:0;left:40px}html[dir=rtl] .SmartBanner .SmartBanner-content{right:40px}.SmartBanner .SmartBanner-content .SmartBanner-buttonWrapper{line-height:40px;padding:0 12px 0 0}html[dir=ltr] .SmartBanner .SmartBanner-content .SmartBanner-buttonWrapper{float:right}html[dir=rtl] .SmartBanner .SmartBanner-content .SmartBanner-buttonWrapper{float:left;padding:0 0 0 12px}.SmartBanner .SmartBanner-content .SmartBanner-buttonWrapper .SmartBanner-button{background-color:#094AB2;color:#fff;font-size:12px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:5px 10px}.SmartBanner .SmartBanner-content .SmartBanner-icon{font-size:34px;background-color:#094AB2;color:#fff;margin:4px 10px 4px 0}html[dir=ltr] .SmartBanner .SmartBanner-content .SmartBanner-icon{float:left}html[dir=rtl] .SmartBanner .SmartBanner-content .SmartBanner-icon{float:right;margin:4px 0 4px 10px}.SmartBanner .SmartBanner-content .SmartBanner-text .SmartBanner-lead{margin-top:3px}.SmartBanner .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:11px;overflow:hidden;height:15px}")}),define("odsp-next/controls/smartBanner/SmartBanner",["require","exports","./SmartBannerViewModel","odsp-shared/utilities/knockout/ComponentFactory","./SmartBanner.html","./SmartBanner.css"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-smart-banner",template:e("./SmartBanner.html"),viewModel:o});return n});var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define("odsp-next/controls/overlays/oneUp/OneUpOverlayViewModel",["require","exports","odsp-shared/base/ViewModel","odsp-next/bindings/host/HostBinding"],function(e,t,o,i){var n=function(e){function t(t){e.call(this,t),this.addBindingHandlers({host:i})}return __extends(t,e),t}(o);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/controls/overlays/oneUp/OneUpOverlay.html",[],function(){return"<!--ko component: {\n name: 'od-overlay',\n params: {\n animation: {\n afterAdd: 1,\n beforeRemove: 500\n },\n alignToParent: false\n }\n}--><div class=od-OneUpOverlay data-bind=host></div><!--/ko-->"}),define("odsp-next/controls/overlays/oneUp/OneUpOverlay.css",["odsp-utilities/domUtils/DomUtils"],function(e){e.loadStyles(".od-OneUpOverlay{position:absolute;top:0;left:0;right:0;bottom:0}.od-OverlayHost-overlay .od-OneUpOverlay{transition:opacity 367ms linear,visibility 0s linear 367ms,-webkit-transform 367ms linear;transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear;transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear,-webkit-transform 367ms linear;opacity:0;visibility:hidden;-webkit-transform:none;-ms-transform:none;transform:none}.od-OverlayHost-overlay.od-OverlayHost-overlay--initial .od-OneUpOverlay,.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-OneUpOverlay{transition-delay:0s,0s,0s;opacity:1;visibility:inherit}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-OneUpOverlay{-webkit-transform:scale(.8,.8);-ms-transform:scale(.8,.8);transform:scale(.8,.8);opacity:0;visibility:hidden}")}),define("odsp-next/controls/overlays/oneUp/OneUpOverlay",["require","exports","odsp-shared/utilities/knockout/ComponentFactory","./OneUpOverlayViewModel","./OneUpOverlay.html","./OneUpOverlay.css","../Overlay"],function(e,t,o,i){var n=o.registerComponent({tagName:"od-one-up-overlay",template:e("./OneUpOverlay.html"),viewModel:i.default,synchronous:!0});Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}),define("odsp-next/controls/standaloneList/StandaloneList",["require","exports","./StandaloneListViewModel","odsp-shared/utilities/knockout/ComponentFactory","./StandaloneList.html","./StandaloneList.css","../dialogHost/DialogHost","../panelHost/PanelHost","../ODFabric.css","../commandBar/CommandBar","../breadcrumbBar/BreadcrumbBar","../overlays/host/OverlayHost","../footer/Footer","../smartBanner/SmartBanner","../dragAndDrop/DragAndDrop","../progressSpinnerFlat/ProgressSpinnerFlat","odsp-next/controls/overlays/oneUp/OneUpOverlay"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-standalone-list",template:e("./StandaloneList.html"),viewModel:o,synchronous:!0});return n}),define("odsp-next/pages/files/odb/Files",["require","exports","./FilesViewModel","odsp-shared/utilities/knockout/ComponentFactory","./Files.html","./Files.css","../../../controls/suiteNav/SuiteNav","../../../controls/leftPane/LeftPane","odsp-utilities/async/Promise","../../../controls/standaloneList/StandaloneList"],function(e,t,o,i){var n=i.registerComponent({tagName:"ms-files",template:e("./Files.html"),viewModel:o});return n});